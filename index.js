!function(t){var e={};function i(r){if(e[r])return e[r].exports;var n=e[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="./",i(i.s=45)}([function(t,e){var i=180/Math.PI,r=Math.PI/180,n=Math.PI/2,s=3*Math.PI/2,o=Math.PI,a=0,h=n,l=s,u=o,c=a,d=2*Math.PI,p=Math.PI/4,g=Math.PI/2;function f(t,e){return function(t,e){return(t%e+e)%e}(t-e+Math.PI,d)-Math.PI>0?1:-1}function _(t,e){var i=Math.abs(t-e)%d;return i>Math.PI?d-i:i}function m(t){return t-d*Math.floor(t/d)}t.exports={UP:n,DOWN:s,LEFT:o,RIGHT:a,NORTH:h,SOUTH:l,WEST:u,EAST:c,PI_2:d,PI_QUARTER:p,PI_HALF:g,toDegrees:function(t){return t*i},toRadians:function(t){return t*r},isAngleBetween:function(t,e,i){if(((i-e)%d+d)%d>=Math.PI){var r=e;e=i,i=r}return e<=i?t>=e&&t<=i:t>=e||t<=i},differenceAnglesSign:f,differenceAngles:_,shortestAngle:function(t,e){return _(e,t)*f(e,t)+t},normalize:m,angleTwoPoints:function(){return 4===arguments.length?Math.atan2(arguments[3]-arguments[1],arguments[2]-arguments[0]):Math.atan2(arguments[1].y-arguments[0].y,arguments[1].x-arguments[0].x)},distanceTwoPoints:function(){return 2===arguments.length?Math.sqrt(Math.pow(arguments[1].x-arguments[0].x,2)+Math.pow(arguments[1].y-arguments[0].y,2)):Math.sqrt(Math.pow(arguments[2]-arguments[0],2)+Math.pow(arguments[3]-arguments[1],2))},distanceTwoPointsSquared:function(){return 2===arguments.length?Math.pow(arguments[1].x-arguments[0].x,2)+Math.pow(arguments[1].y-arguments[0].y,2):Math.pow(arguments[2]-arguments[0],2)+Math.pow(arguments[3]-arguments[1],2)},closestAngle:function(t){var e=_(t,o),i=_(t,a),r=_(t,n),h=_(t,s);return e<=i&&e<=r&&e<=h?o:i<=r&&i<=h?a:r<=h?n:s},equals:function(t,e,i){return i?_(t,e)<i:m(t)===m(e)},explain:function(t){switch(t){case n:return"UP";case s:return"DOWN";case o:return"LEFT";case a:return"RIGHT";default:return"NOT CARDINAL"}}}},function(t,e,i){var r,n,s;!function(i){var o=/iPhone/i,a=/iPod/i,h=/iPad/i,l=/\bAndroid(?:.+)Mobile\b/i,u=/Android/i,c=/\bAndroid(?:.+)SD4930UR\b/i,d=/\bAndroid(?:.+)(?:KF[A-Z]{2,4})\b/i,p=/Windows Phone/i,g=/\bWindows(?:.+)ARM\b/i,f=/BlackBerry/i,_=/BB10/i,m=/Opera Mini/i,y=/\b(CriOS|Chrome)(?:.+)Mobile/i,v=/Mobile(?:.+)Firefox\b/i;function x(t,e){return t.test(e)}function E(t){var e=t||("undefined"!=typeof navigator?navigator.userAgent:""),i=e.split("[FBAN");void 0!==i[1]&&(e=i[0]),void 0!==(i=e.split("Twitter"))[1]&&(e=i[0]);var r={apple:{phone:x(o,e)&&!x(p,e),ipod:x(a,e),tablet:!x(o,e)&&x(h,e)&&!x(p,e),device:(x(o,e)||x(a,e)||x(h,e))&&!x(p,e)},amazon:{phone:x(c,e),tablet:!x(c,e)&&x(d,e),device:x(c,e)||x(d,e)},android:{phone:!x(p,e)&&x(c,e)||!x(p,e)&&x(l,e),tablet:!x(p,e)&&!x(c,e)&&!x(l,e)&&(x(d,e)||x(u,e)),device:!x(p,e)&&(x(c,e)||x(d,e)||x(l,e)||x(u,e))||x(/\bokhttp\b/i,e)},windows:{phone:x(p,e),tablet:x(g,e),device:x(p,e)||x(g,e)},other:{blackberry:x(f,e),blackberry10:x(_,e),opera:x(m,e),firefox:x(v,e),chrome:x(y,e),device:x(f,e)||x(_,e)||x(m,e)||x(v,e)||x(y,e)}};return r.any=r.apple.device||r.android.device||r.windows.device||r.other.device,r.phone=r.apple.phone||r.android.phone||r.windows.phone,r.tablet=r.apple.tablet||r.android.tablet||r.windows.tablet,r}t.exports&&"undefined"==typeof window?t.exports=E:t.exports&&"undefined"!=typeof window?(t.exports=E(),t.exports.isMobile=E):(n=[],r=i.isMobile=E(),void 0===(s="function"==typeof r?r.apply(e,n):r)||(t.exports=s))}(this)},function(t,e,i){!function(t){"use strict";"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(t){if(null==this)throw new TypeError(this+" is not an object");var e=Object(this),i=Math.max(Math.min(e.length,9007199254740991),0)||0,r=1 in arguments&&parseInt(Number(arguments[1]),10)||0;r=r<0?Math.max(i+r,0):Math.min(r,i);var n=2 in arguments&&void 0!==arguments[2]?parseInt(Number(arguments[2]),10)||0:i;for(n=n<0?Math.max(i+arguments[2],0):Math.min(n,i);r<n;)e[r]=t,++r;return e},writable:!0}),Number.isFinite=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)},Number.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(t){return t!=t},Math.trunc=Math.trunc||function(t){return t<0?Math.ceil(t):Math.floor(t)},Math.log2=Math.log2||function(t){return Math.log(t)*Math.LOG2E};class e{constructor(){e.constructor_.apply(this,arguments)}static equalsWithTolerance(t,e,i){return Math.abs(t-e)<=i}getClass(){return e}get interfaces_(){return[]}}function i(t){this.message=t}function r(t,e){this.low=0|e,this.high=0|t}function n(){}var s,o,a,h,l,u;function c(){}function d(){}function p(){}function g(){}function f(t){this.name="RuntimeException",this.message=t,this.stack=(new Error).stack,Error.call(this,t)}e.constructor_=function(){},r.toBinaryString=function(t){for(var e="",i=2147483648;i>0;i>>>=1)e+=(t.high&i)===i?"1":"0";for(i=2147483648;i>0;i>>>=1)e+=(t.low&i)===i?"1":"0";return e},n.isNaN=t=>Number.isNaN(t),n.isInfinite=t=>!Number.isFinite(t),n.MAX_VALUE=Number.MAX_VALUE,"function"==typeof Float64Array&&"function"==typeof Int32Array?(l=new Float64Array(1),u=new Int32Array(l.buffer),n.doubleToLongBits=function(t){l[0]=t;var e=0|u[0],i=0|u[1];return 2146435072==(2146435072&i)&&0!=(1048575&i)&&0!==e&&(e=0,i=2146959360),new r(i,e)},n.longBitsToDouble=function(t){return u[0]=t.low,u[1]=t.high,l[0]}):(s=Math.log2,o=Math.floor,a=Math.pow,h=function(){for(var t=53;t>0;t--){var e=a(2,t)-1;if(o(s(e))+1===t)return e}return 0}(),n.doubleToLongBits=function(t){var e,i,n,l,u,c,d,p,g;if(t<0||1/t===Number.NEGATIVE_INFINITY?(c=1<<31,t=-t):c=0,0===t)return new r(p=c,g=0);if(t===1/0)return new r(p=2146435072|c,g=0);if(t!=t)return new r(p=2146959360,g=0);if(l=0,g=0,(e=o(t))>1)if(e<=h)(l=o(s(e)))<=20?(g=0,p=e<<20-l&1048575):(g=e%(i=a(2,n=l-20))<<32-n,p=e/i&1048575);else for(n=e,g=0;0!==(n=o(i=n/2));)l++,g>>>=1,g|=(1&p)<<31,p>>>=1,i!==n&&(p|=524288);if(d=l+1023,u=0===e,e=t-e,l<52&&0!==e)for(n=0;;){if((i=2*e)>=1?(e=i-1,u?(d--,u=!1):(n<<=1,n|=1,l++)):(e=i,u?0==--d&&(l++,u=!1):(n<<=1,l++)),20===l)p|=n,n=0;else if(52===l){g|=n;break}if(1===i){l<20?p|=n<<20-l:l<52&&(g|=n<<52-l);break}}return p|=d<<20,new r(p|=c,g)},n.longBitsToDouble=function(t){var e,i,r,n,s=t.high,o=t.low;i=s&1<<31?-1:1,r=((2146435072&s)>>20)-1023,n=0,e=1<<19;for(var h=1;h<=20;h++)s&e&&(n+=a(2,-h)),e>>>=1;for(e=1<<31,h=21;h<=52;h++)o&e&&(n+=a(2,-h)),e>>>=1;if(-1023===r){if(0===n)return 0*i;r=-1022}else{if(1024===r)return 0===n?i/0:NaN;n+=1}return i*n*a(2,r)}),f.prototype=Object.create(Error.prototype),f.prototype.constructor=Error;class _ extends f{constructor(){super(),_.constructor_.apply(this,arguments)}getClass(){return _}get interfaces_(){return[]}}_.constructor_=function(){if(0===arguments.length)f.constructor_.call(this);else if(1===arguments.length){let t=arguments[0];f.constructor_.call(this,t)}};class m{constructor(){m.constructor_.apply(this,arguments)}static shouldNeverReachHere(){if(0===arguments.length)m.shouldNeverReachHere(null);else if(1===arguments.length){let t=arguments[0];throw new _("Should never reach here"+(null!==t?": "+t:""))}}static isTrue(){if(1===arguments.length){let t=arguments[0];m.isTrue(t,null)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];if(!t)throw null===e?new _:new _(e)}}static equals(){if(2===arguments.length){let t=arguments[0],e=arguments[1];m.equals(t,e,null)}else if(3===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2];if(!e.equals(t))throw new _("Expected "+t+" but encountered "+e+(null!==i?": "+i:""))}}getClass(){return m}get interfaces_(){return[]}}m.constructor_=function(){};class y{constructor(){y.constructor_.apply(this,arguments)}static hashCode(){if(1===arguments.length&&"number"==typeof arguments[0]){let e=arguments[0];var t=n.doubleToLongBits(e);return Math.trunc(t^t>>>32)}}setOrdinate(t,e){switch(t){case y.X:this.x=e;break;case y.Y:this.y=e;break;case y.Z:this.z=e;break;default:throw new i("Invalid ordinate index: "+t)}}equals2D(){if(1===arguments.length){let t=arguments[0];return this.x===t.x&&this.y===t.y}if(2===arguments.length){let t=arguments[0],i=arguments[1];return!!e.equalsWithTolerance(this.x,t.x,i)&&!!e.equalsWithTolerance(this.y,t.y,i)}}getOrdinate(t){switch(t){case y.X:return this.x;case y.Y:return this.y;case y.Z:return this.z}throw new i("Invalid ordinate index: "+t)}equals3D(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||n.isNaN(this.z)&&n.isNaN(t.z))}equals(t){return t instanceof y&&this.equals2D(t)}equalInZ(t,i){return e.equalsWithTolerance(this.z,t.z,i)}compareTo(t){var e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0}clone(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return m.shouldNeverReachHere("this shouldn't happen because this class is Cloneable"),null;throw t}}copy(){return new y(this)}toString(){return"("+this.x+", "+this.y+", "+this.z+")"}distance3D(t){var e=this.x-t.x,i=this.y-t.y,r=this.z-t.z;return Math.sqrt(e*e+i*i+r*r)}distance(t){var e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)}hashCode(){var t=17;return t=37*(t=37*t+y.hashCode(this.x))+y.hashCode(this.y)}setCoordinate(t){this.x=t.x,this.y=t.y,this.z=t.z}getClass(){return y}get interfaces_(){return[c,d,g]}}class v{constructor(){v.constructor_.apply(this,arguments)}static compare(t,e){return t<e?-1:t>e?1:n.isNaN(t)?n.isNaN(e)?0:-1:n.isNaN(e)?1:0}compare(t,e){var i=t,r=e,n=v.compare(i.x,r.x);if(0!==n)return n;var s=v.compare(i.y,r.y);return 0!==s?s:this._dimensionsToTest<=2?0:v.compare(i.z,r.z)}getClass(){return v}get interfaces_(){return[p]}}function x(t,e){return t.interfaces_&&t.interfaces_.indexOf(e)>-1}function E(){}function w(){}function b(t){this.message=t||""}function I(){}function T(t){this.message=t||""}function S(t){this.message=t||""}function C(){this.array_=[],arguments[0]instanceof w&&this.addAll(arguments[0])}v.constructor_=function(){if(this._dimensionsToTest=2,0===arguments.length)v.constructor_.call(this,2);else if(1===arguments.length){let t=arguments[0];if(2!==t&&3!==t)throw new i("only 2 or 3 dimensions may be specified");this._dimensionsToTest=t}},y.DimensionalComparator=v,y.constructor_=function(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)y.constructor_.call(this,0,0);else if(1===arguments.length){let t=arguments[0];y.constructor_.call(this,t.x,t.y,t.z)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];y.constructor_.call(this,t,e,y.NULL_ORDINATE)}else if(3===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2];this.x=t,this.y=e,this.z=i}},y.serialVersionUID=0x5cbf2c235c7e5800,y.NULL_ORDINATE=n.NaN,y.X=0,y.Y=1,y.Z=2,E.prototype.hasNext=function(){},E.prototype.next=function(){},E.prototype.remove=function(){},w.prototype.add=function(){},w.prototype.addAll=function(){},w.prototype.isEmpty=function(){},w.prototype.iterator=function(){},w.prototype.size=function(){},w.prototype.toArray=function(){},w.prototype.remove=function(){},b.prototype=new Error,b.prototype.name="IndexOutOfBoundsException",I.prototype=Object.create(w.prototype),I.prototype.constructor=I,I.prototype.get=function(){},I.prototype.set=function(){},I.prototype.isEmpty=function(){},T.prototype=new Error,T.prototype.name="NoSuchElementException",S.prototype=new Error,S.prototype.name="OperationNotSupported",C.prototype=Object.create(I.prototype),C.prototype.constructor=C,C.prototype.ensureCapacity=function(){},C.prototype.interfaces_=[I,w],C.prototype.add=function(t){return 1===arguments.length?this.array_.push(t):this.array_.splice(arguments[0],0,arguments[1]),!0},C.prototype.clear=function(){this.array_=[]},C.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},C.prototype.set=function(t,e){var i=this.array_[t];return this.array_[t]=e,i},C.prototype.iterator=function(){return new N(this)},C.prototype.get=function(t){if(t<0||t>=this.size())throw new b;return this.array_[t]},C.prototype.isEmpty=function(){return 0===this.array_.length},C.prototype.size=function(){return this.array_.length},C.prototype.toArray=function(){for(var t=[],e=0,i=this.array_.length;e<i;e++)t.push(this.array_[e]);return t},C.prototype.remove=function(t){for(var e=!1,i=0,r=this.array_.length;i<r;i++)if(this.array_[i]===t){this.array_.splice(i,1),e=!0;break}return e},C.prototype.removeAll=function(t){for(var e=t.iterator();e.hasNext();)this.remove(e.next());return!0};var N=function(t){this.arrayList_=t,this.position_=0};N.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new T;return this.arrayList_.get(this.position_++)},N.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},N.prototype.set=function(t){return this.arrayList_.set(this.position_-1,t)},N.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))};class O extends C{constructor(){super(),O.constructor_.apply(this,arguments)}getCoordinate(t){return this.get(t)}addAll(){if(2===arguments.length&&"boolean"==typeof arguments[1]&&x(arguments[0],w)){let i=arguments[0],r=arguments[1];for(var t=!1,e=i.iterator();e.hasNext();)this.add(e.next(),r),t=!0;return t}return super.addAll.apply(this,arguments)}clone(){for(var t=super.clone.call(this),e=0;e<this.size();e++)t.add(e,this.get(e).clone());return t}toCoordinateArray(){return this.toArray(O.coordArrayType)}add(){if(1===arguments.length){let t=arguments[0];super.add.call(this,t)}else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){let t=arguments[0],e=arguments[1];return this.add(t,e,!0),!0}if(arguments[0]instanceof y&&"boolean"==typeof arguments[1]){let t=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(t))return null;super.add.call(this,t)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1]){let t=arguments[0],e=arguments[1];return this.add(t,e),!0}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){let e=arguments[0],i=arguments[1];if(arguments[2])for(var t=0;t<e.length;t++)this.add(e[t],i);else for(t=e.length-1;t>=0;t--)this.add(e[t],i);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof y){let t=arguments[0],i=arguments[1];if(!arguments[2]){var e=this.size();if(e>0){if(t>0&&this.get(t-1).equals2D(i))return null;if(t<e&&this.get(t).equals2D(i))return null}}super.add.call(this,t,i)}}else if(4===arguments.length){let e=arguments[0],r=arguments[1],n=arguments[2],s=arguments[3];var i=1;for(n>s&&(i=-1),t=n;t!==s;t+=i)this.add(e[t],r);return!0}}closeRing(){this.size()>0&&this.add(new y(this.get(0)),!1)}getClass(){return O}get interfaces_(){return[]}}O.constructor_=function(){if(0===arguments.length);else if(1===arguments.length){let t=arguments[0];this.ensureCapacity(t.length),this.add(t,!0)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this.ensureCapacity(t.length),this.add(t,e)}},O.coordArrayType=new Array(0).fill(null);class P{constructor(){P.constructor_.apply(this,arguments)}static intersects(){if(3===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2];return i.x>=(t.x<e.x?t.x:e.x)&&i.x<=(t.x>e.x?t.x:e.x)&&i.y>=(t.y<e.y?t.y:e.y)&&i.y<=(t.y>e.y?t.y:e.y)}if(4===arguments.length){let n=arguments[0],s=arguments[1],o=arguments[2],a=arguments[3];var t=Math.min(o.x,a.x),e=Math.max(o.x,a.x),i=Math.min(n.x,s.x),r=Math.max(n.x,s.x);return!(i>e||r<t||(t=Math.min(o.y,a.y),e=Math.max(o.y,a.y),i=Math.min(n.y,s.y),r=Math.max(n.y,s.y),i>e||r<t))}}getArea(){return this.getWidth()*this.getHeight()}equals(t){if(!(t instanceof P))return!1;var e=t;return this.isNull()?e.isNull():this._maxx===e.getMaxX()&&this._maxy===e.getMaxY()&&this._minx===e.getMinX()&&this._miny===e.getMinY()}intersection(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new P;var e=this._minx>t._minx?this._minx:t._minx,i=this._miny>t._miny?this._miny:t._miny,r=this._maxx<t._maxx?this._maxx:t._maxx,n=this._maxy<t._maxy?this._maxy:t._maxy;return new P(e,r,i,n)}isNull(){return this._maxx<this._minx}getMaxX(){return this._maxx}covers(){if(1===arguments.length){if(arguments[0]instanceof y){let t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof P){let t=arguments[0];return!this.isNull()&&!t.isNull()&&t.getMinX()>=this._minx&&t.getMaxX()<=this._maxx&&t.getMinY()>=this._miny&&t.getMaxY()<=this._maxy}}else if(2===arguments.length){let t=arguments[0],e=arguments[1];return!this.isNull()&&t>=this._minx&&t<=this._maxx&&e>=this._miny&&e<=this._maxy}}intersects(){if(1===arguments.length){if(arguments[0]instanceof P){let t=arguments[0];return!this.isNull()&&!t.isNull()&&!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}if(arguments[0]instanceof y){let t=arguments[0];return this.intersects(t.x,t.y)}}else if(2===arguments.length){if(arguments[0]instanceof y&&arguments[1]instanceof y){let t=arguments[0],e=arguments[1];return!(this.isNull()||(t.x<e.x?t.x:e.x)>this._maxx||(t.x>e.x?t.x:e.x)<this._minx||(t.y<e.y?t.y:e.y)>this._maxy||(t.y>e.y?t.y:e.y)<this._miny)}if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){let t=arguments[0],e=arguments[1];return!this.isNull()&&!(t>this._maxx||t<this._minx||e>this._maxy||e<this._miny)}}}getMinY(){return this._miny}getMinX(){return this._minx}expandToInclude(){if(1===arguments.length){if(arguments[0]instanceof y){let t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof P){let t=arguments[0];if(t.isNull())return null;this.isNull()?(this._minx=t.getMinX(),this._maxx=t.getMaxX(),this._miny=t.getMinY(),this._maxy=t.getMaxY()):(t._minx<this._minx&&(this._minx=t._minx),t._maxx>this._maxx&&(this._maxx=t._maxx),t._miny<this._miny&&(this._miny=t._miny),t._maxy>this._maxy&&(this._maxy=t._maxy))}}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this.isNull()?(this._minx=t,this._maxx=t,this._miny=e,this._maxy=e):(t<this._minx&&(this._minx=t),t>this._maxx&&(this._maxx=t),e<this._miny&&(this._miny=e),e>this._maxy&&(this._maxy=e))}}minExtent(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t<e?t:e}getWidth(){return this.isNull()?0:this._maxx-this._minx}compareTo(t){var e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this._minx<e._minx?-1:this._minx>e._minx?1:this._miny<e._miny?-1:this._miny>e._miny?1:this._maxx<e._maxx?-1:this._maxx>e._maxx?1:this._maxy<e._maxy?-1:this._maxy>e._maxy?1:0}translate(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)}toString(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"}setToNull(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1}getHeight(){return this.isNull()?0:this._maxy-this._miny}maxExtent(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t>e?t:e}expandBy(){if(1===arguments.length){let t=arguments[0];this.expandBy(t,t)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];if(this.isNull())return null;this._minx-=t,this._maxx+=t,this._miny-=e,this._maxy+=e,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}}contains(){if(1===arguments.length){if(arguments[0]instanceof P){let t=arguments[0];return this.covers(t)}if(arguments[0]instanceof y){let t=arguments[0];return this.covers(t)}}else if(2===arguments.length){let t=arguments[0],e=arguments[1];return this.covers(t,e)}}centre(){return this.isNull()?null:new y((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)}init(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof y){let t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof P){let t=arguments[0];this._minx=t._minx,this._maxx=t._maxx,this._miny=t._miny,this._maxy=t._maxy}}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this.init(t.x,e.x,t.y,e.y)}else if(4===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2],r=arguments[3];t<e?(this._minx=t,this._maxx=e):(this._minx=e,this._maxx=t),i<r?(this._miny=i,this._maxy=r):(this._miny=r,this._maxy=i)}}getMaxY(){return this._maxy}distance(t){if(this.intersects(t))return 0;var e=0;this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx);var i=0;return this._maxy<t._miny?i=t._miny-this._maxy:this._miny>t._maxy&&(i=this._miny-t._maxy),0===e?i:0===i?e:Math.sqrt(e*e+i*i)}hashCode(){var t=17;return t=37*(t=37*(t=37*(t=37*t+y.hashCode(this._minx))+y.hashCode(this._maxx))+y.hashCode(this._miny))+y.hashCode(this._maxy)}getClass(){return P}get interfaces_(){return[c,g]}}function L(){}P.constructor_=function(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length){if(arguments[0]instanceof y){let t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof P){let t=arguments[0];this.init(t)}}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this.init(t.x,e.x,t.y,e.y)}else if(4===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2],r=arguments[3];this.init(t,e,i,r)}},P.serialVersionUID=0x51845cd552189800;class A extends L{constructor(){super(),A.constructor_.apply(this,arguments)}getClass(){return A}get interfaces_(){return[]}}function R(t){this.str=t}function M(t){this.value=t}function D(){}A.constructor_=function(){L.constructor_.call(this,"Projective point not representable on the Cartesian plane.")},R.prototype.append=function(t){this.str+=t},R.prototype.setCharAt=function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)},R.prototype.toString=function(t){return this.str},M.prototype.intValue=function(){return this.value},M.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0},M.isNaN=t=>Number.isNaN(t),D.isWhitespace=t=>t<=32&&t>=0||127==t,D.toUpperCase=t=>t.toUpperCase();class F{constructor(){F.constructor_.apply(this,arguments)}static sqr(t){return F.valueOf(t).selfMultiply(t)}static valueOf(){if("string"==typeof arguments[0]){let t=arguments[0];return F.parse(t)}if("number"==typeof arguments[0]){let t=arguments[0];return new F(t)}}static sqrt(t){return F.valueOf(t).sqrt()}static parse(t){for(var e=0,i=t.length;D.isWhitespace(t.charAt(e));)e++;var r=!1;if(e<i){var n=t.charAt(e);"-"!==n&&"+"!==n||(e++,"-"===n&&(r=!0))}for(var s=new F,o=0,a=0,h=0;!(e>=i);){var l=t.charAt(e);if(e++,D.isDigit(l)){var u=l-"0";s.selfMultiply(F.TEN),s.selfAdd(u),o++}else{if("."!==l){if("e"===l||"E"===l){var c=t.substring(e);try{h=M.parseInt(c)}catch(e){throw e instanceof NumberFormatException?new NumberFormatException("Invalid exponent "+c+" in string "+t):e}break}throw new NumberFormatException("Unexpected character '"+l+"' at position "+e+" in string "+t)}a=o}}var d=s,p=o-a-h;if(0===p)d=s;else if(p>0){var g=F.TEN.pow(p);d=s.divide(g)}else p<0&&(g=F.TEN.pow(-p),d=s.multiply(g));return r?d.negate():d}static createNaN(){return new F(n.NaN,n.NaN)}static copy(t){return new F(t)}static magnitude(t){var e=Math.abs(t),i=Math.log(e)/Math.log(10),r=Math.trunc(Math.floor(i));return 10*Math.pow(10,r)<=e&&(r+=1),r}static stringOfChar(t,e){for(var i=new R,r=0;r<e;r++)i.append(t);return i.toString()}le(t){return this._hi<t._hi||this._hi===t._hi&&this._lo<=t._lo}extractSignificantDigits(t,e){var i=this.abs(),r=F.magnitude(i._hi),n=F.TEN.pow(r);(i=i.divide(n)).gt(F.TEN)?(i=i.divide(F.TEN),r+=1):i.lt(F.ONE)&&(i=i.multiply(F.TEN),r-=1);for(var s=r+1,o=new R,a=F.MAX_PRINT_DIGITS-1,h=0;h<=a;h++){t&&h===s&&o.append(".");var l=Math.trunc(i._hi);if(l<0)break;var u=!1,c=0;l>9?(u=!0,c="9"):c="0"+l,o.append(c),i=i.subtract(F.valueOf(l)).multiply(F.TEN),u&&i.selfAdd(F.TEN);var d=!0,p=F.magnitude(i._hi);if(p<0&&Math.abs(p)>=a-h&&(d=!1),!d)break}return e[0]=r,o.toString()}sqr(){return this.multiply(this)}doubleValue(){return this._hi+this._lo}subtract(){if(arguments[0]instanceof F){let t=arguments[0];return this.add(t.negate())}if("number"==typeof arguments[0]){let t=arguments[0];return this.add(-t)}}equals(){if(1===arguments.length&&arguments[0]instanceof F){let t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}}isZero(){return 0===this._hi&&0===this._lo}selfSubtract(){if(arguments[0]instanceof F){let t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}if("number"==typeof arguments[0]){let t=arguments[0];return this.isNaN()?this:this.selfAdd(-t,0)}}getSpecialNumberString(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null}min(t){return this.le(t)?this:t}selfDivide(){if(1===arguments.length){if(arguments[0]instanceof F){let t=arguments[0];return this.selfDivide(t._hi,t._lo)}if("number"==typeof arguments[0]){let t=arguments[0];return this.selfDivide(t,0)}}else if(2===arguments.length){let h=arguments[0],l=arguments[1];var t,e,i,r,n=null,s=null,o=null,a=null;return i=this._hi/h,a=(n=(o=F.SPLIT*i)-(n=o-i))*(s=(a=F.SPLIT*h)-(s=a-h))-(r=i*h)+n*(e=h-s)+(t=i-n)*s+t*e,a=i+(o=(this._hi-r-a+this._lo-i*l)/h),this._hi=a,this._lo=i-a+o,this}}dump(){return"DD<"+this._hi+", "+this._lo+">"}divide(){if(arguments[0]instanceof F){let n=arguments[0];var t,e,i,r,s=null,o=null,a=null,h=null;return t=(i=this._hi/n._hi)-(s=(a=F.SPLIT*i)-(s=a-i)),h=s*(o=(h=F.SPLIT*n._hi)-(o=h-n._hi))-(r=i*n._hi)+s*(e=n._hi-o)+t*o+t*e,a=(this._hi-r-h+this._lo-i*n._lo)/n._hi,new F(h=i+a,i-h+a)}if("number"==typeof arguments[0]){let t=arguments[0];return n.isNaN(t)?F.createNaN():F.copy(this).selfDivide(t,0)}}ge(t){return this._hi>t._hi||this._hi===t._hi&&this._lo>=t._lo}pow(t){if(0===t)return F.valueOf(1);var e=new F(this),i=F.valueOf(1),r=Math.abs(t);if(r>1)for(;r>0;)r%2==1&&i.selfMultiply(e),(r/=2)>0&&(e=e.sqr());else i=e;return t<0?i.reciprocal():i}ceil(){if(this.isNaN())return F.NaN;var t=Math.ceil(this._hi),e=0;return t===this._hi&&(e=Math.ceil(this._lo)),new F(t,e)}compareTo(t){var e=t;return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0}rint(){return this.isNaN()?this:this.add(.5).floor()}setValue(){if(arguments[0]instanceof F){let t=arguments[0];return this.init(t),this}if("number"==typeof arguments[0]){let t=arguments[0];return this.init(t),this}}max(t){return this.ge(t)?this:t}sqrt(){if(this.isZero())return F.valueOf(0);if(this.isNegative())return F.NaN;var t=1/Math.sqrt(this._hi),e=this._hi*t,i=F.valueOf(e),r=this.subtract(i.sqr())._hi*(.5*t);return i.add(r)}selfAdd(){if(1===arguments.length){if(arguments[0]instanceof F){let t=arguments[0];return this.selfAdd(t._hi,t._lo)}if("number"==typeof arguments[0]){let o=arguments[0];var t=null,e=null,i=null,r=null,n=null,s=null;return r=(i=this._hi+o)-(n=i-this._hi),e=(s=(r=o-n+(this._hi-r))+this._lo)+(i-(t=i+s)),this._hi=t+e,this._lo=e+(t-this._hi),this}}else if(2===arguments.length){let u=arguments[0],c=arguments[1];t=null,e=null;var o,a=null;i=null,r=null,n=null,s=null,i=this._hi+u,o=this._lo+c,r=i-(n=i-this._hi),a=o-(s=o-this._lo);var h=(t=i+(n=(r=u-n+(this._hi-r))+o))+(n=(a=c-s+(this._lo-a))+(e=n+(i-t))),l=n+(t-h);return this._hi=h,this._lo=l,this}}selfMultiply(){if(1===arguments.length){if(arguments[0]instanceof F){let t=arguments[0];return this.selfMultiply(t._hi,t._lo)}if("number"==typeof arguments[0]){let t=arguments[0];return this.selfMultiply(t,0)}}else if(2===arguments.length){let h=arguments[0],l=arguments[1];var t,e,i=null,r=null,n=null,s=null;i=(n=F.SPLIT*this._hi)-this._hi,s=F.SPLIT*h,i=n-i,t=this._hi-i,r=s-h;var o=(n=this._hi*h)+(s=i*(r=s-r)-n+i*(e=h-r)+t*r+t*e+(this._hi*l+this._lo*h)),a=s+(i=n-o);return this._hi=o,this._lo=a,this}}selfSqr(){return this.selfMultiply(this)}floor(){if(this.isNaN())return F.NaN;var t=Math.floor(this._hi),e=0;return t===this._hi&&(e=Math.floor(this._lo)),new F(t,e)}negate(){return this.isNaN()?this:new F(-this._hi,-this._lo)}clone(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return null;throw t}}multiply(){if(arguments[0]instanceof F){let t=arguments[0];return t.isNaN()?F.createNaN():F.copy(this).selfMultiply(t)}if("number"==typeof arguments[0]){let t=arguments[0];return n.isNaN(t)?F.createNaN():F.copy(this).selfMultiply(t,0)}}isNaN(){return n.isNaN(this._hi)}intValue(){return Math.trunc(this._hi)}toString(){var t=F.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()}toStandardNotation(){var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),i=this.extractSignificantDigits(!0,e),r=e[0]+1,n=i;if("."===i.charAt(0))n="0"+i;else if(r<0)n="0."+F.stringOfChar("0",-r)+i;else if(-1===i.indexOf(".")){var s=r-i.length;n=i+F.stringOfChar("0",s)+".0"}return this.isNegative()?"-"+n:n}reciprocal(){var t,e,i,r,n=null,s=null,o=null,a=null;t=(i=1/this._hi)-(n=(o=F.SPLIT*i)-(n=o-i)),s=(a=F.SPLIT*this._hi)-this._hi;var h=i+(o=(1-(r=i*this._hi)-(a=n*(s=a-s)-r+n*(e=this._hi-s)+t*s+t*e)-i*this._lo)/this._hi);return new F(h,i-h+o)}toSciNotation(){if(this.isZero())return F.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),i=this.extractSignificantDigits(!1,e),r=F.SCI_NOT_EXPONENT_CHAR+e[0];if("0"===i.charAt(0))throw new IllegalStateException("Found leading zero: "+i);var n="";i.length>1&&(n=i.substring(1));var s=i.charAt(0)+"."+n;return this.isNegative()?"-"+s+r:s+r}abs(){return this.isNaN()?F.NaN:this.isNegative()?this.negate():new F(this)}isPositive(){return this._hi>0||0===this._hi&&this._lo>0}lt(t){return this._hi<t._hi||this._hi===t._hi&&this._lo<t._lo}add(){if(arguments[0]instanceof F){let t=arguments[0];return F.copy(this).selfAdd(t)}if("number"==typeof arguments[0]){let t=arguments[0];return F.copy(this).selfAdd(t)}}init(){if(1===arguments.length){if("number"==typeof arguments[0]){let t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof F){let t=arguments[0];this._hi=t._hi,this._lo=t._lo}}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this._hi=t,this._lo=e}}gt(t){return this._hi>t._hi||this._hi===t._hi&&this._lo>t._lo}isNegative(){return this._hi<0||0===this._hi&&this._lo<0}trunc(){return this.isNaN()?F.NaN:this.isPositive()?this.floor():this.ceil()}signum(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0}getClass(){return F}get interfaces_(){return[g,c,d]}}F.constructor_=function(){if(this._hi=0,this._lo=0,0===arguments.length)this.init(0);else if(1===arguments.length){if("number"==typeof arguments[0]){let t=arguments[0];this.init(t)}else if(arguments[0]instanceof F){let t=arguments[0];this.init(t)}else if("string"==typeof arguments[0]){let t=arguments[0];F.constructor_.call(this,F.parse(t))}}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this.init(t,e)}},F.PI=new F(3.141592653589793,1.2246467991473532e-16),F.TWO_PI=new F(6.283185307179586,2.4492935982947064e-16),F.PI_2=new F(1.5707963267948966,6.123233995736766e-17),F.E=new F(2.718281828459045,1.4456468917292502e-16),F.NaN=new F(n.NaN,n.NaN),F.EPS=1.23259516440783e-32,F.SPLIT=134217729,F.MAX_PRINT_DIGITS=32,F.TEN=F.valueOf(10),F.ONE=F.valueOf(1),F.SCI_NOT_EXPONENT_CHAR="E",F.SCI_NOT_ZERO="0.0E0";class B{constructor(){B.constructor_.apply(this,arguments)}static orientationIndex(t,e,i){var r=B.orientationIndexFilter(t,e,i);if(r<=1)return r;var n=F.valueOf(e.x).selfAdd(-t.x),s=F.valueOf(e.y).selfAdd(-t.y),o=F.valueOf(i.x).selfAdd(-e.x),a=F.valueOf(i.y).selfAdd(-e.y);return n.selfMultiply(a).selfSubtract(s.selfMultiply(o)).signum()}static signOfDet2x2(){if(arguments[3]instanceof F&&arguments[2]instanceof F&&arguments[0]instanceof F&&arguments[1]instanceof F){let t=arguments[0],e=arguments[1],i=arguments[2],r=arguments[3];return t.multiply(r).selfSubtract(e.multiply(i)).signum()}if("number"==typeof arguments[3]&&"number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){let n=arguments[0],s=arguments[1],o=arguments[2],a=arguments[3];var t=F.valueOf(n),e=F.valueOf(s),i=F.valueOf(o),r=F.valueOf(a);return t.multiply(r).selfSubtract(e.multiply(i)).signum()}}static intersection(t,e,i,r){var n=F.valueOf(r.y).selfSubtract(i.y).selfMultiply(F.valueOf(e.x).selfSubtract(t.x)),s=F.valueOf(r.x).selfSubtract(i.x).selfMultiply(F.valueOf(e.y).selfSubtract(t.y)),o=n.subtract(s),a=F.valueOf(r.x).selfSubtract(i.x).selfMultiply(F.valueOf(t.y).selfSubtract(i.y)),h=F.valueOf(r.y).selfSubtract(i.y).selfMultiply(F.valueOf(t.x).selfSubtract(i.x)),l=a.subtract(h).selfDivide(o).doubleValue(),u=F.valueOf(t.x).selfAdd(F.valueOf(e.x).selfSubtract(t.x).selfMultiply(l)).doubleValue(),c=F.valueOf(e.x).selfSubtract(t.x).selfMultiply(F.valueOf(t.y).selfSubtract(i.y)),d=F.valueOf(e.y).selfSubtract(t.y).selfMultiply(F.valueOf(t.x).selfSubtract(i.x)),p=c.subtract(d).selfDivide(o).doubleValue(),g=F.valueOf(i.y).selfAdd(F.valueOf(r.y).selfSubtract(i.y).selfMultiply(p)).doubleValue();return new y(u,g)}static orientationIndexFilter(t,e,i){var r=null,n=(t.x-i.x)*(e.y-i.y),s=(t.y-i.y)*(e.x-i.x),o=n-s;if(n>0){if(s<=0)return B.signum(o);r=n+s}else{if(!(n<0))return B.signum(o);if(s>=0)return B.signum(o);r=-n-s}var a=B.DP_SAFE_EPSILON*r;return o>=a||-o>=a?B.signum(o):2}static signum(t){return t>0?1:t<0?-1:0}getClass(){return B}get interfaces_(){return[]}}B.constructor_=function(){},B.DP_SAFE_EPSILON=1e-15;class k{constructor(){k.constructor_.apply(this,arguments)}static index(t,e,i){return B.orientationIndex(t,e,i)}static isCCW(t){var e=t.length-1;if(e<3)throw new i("Ring has fewer than 4 points, so orientation cannot be determined");for(var r=t[0],n=0,s=1;s<=e;s++){var o=t[s];o.y>r.y&&(r=o,n=s)}var a=n;do{(a-=1)<0&&(a=e)}while(t[a].equals2D(r)&&a!==n);var h=n;do{h=(h+1)%e}while(t[h].equals2D(r)&&h!==n);var l=t[a],u=t[h];if(l.equals2D(r)||u.equals2D(r)||l.equals2D(u))return!1;var c=k.index(l,r,u);return 0===c?l.x>u.x:c>0}getClass(){return k}get interfaces_(){return[]}}function G(){}k.constructor_=function(){},k.CLOCKWISE=-1,k.RIGHT=k.CLOCKWISE,k.COUNTERCLOCKWISE=1,k.LEFT=k.COUNTERCLOCKWISE,k.COLLINEAR=0,k.STRAIGHT=k.COLLINEAR,G.arraycopy=(t,e,i,r,n)=>{let s=0;for(let o=e;o<e+n;o++)i[r+s]=t[o],s++},G.getProperty=t=>({"line.separator":"\n"})[t];class U{constructor(){U.constructor_.apply(this,arguments)}static intersection(t,e,i,r){var s=t.y-e.y,o=e.x-t.x,a=t.x*e.y-e.x*t.y,h=i.y-r.y,l=r.x-i.x,u=i.x*r.y-r.x*i.y,c=s*l-h*o,d=(o*u-l*a)/c,p=(h*a-s*u)/c;if(n.isNaN(d)||n.isInfinite(d)||n.isNaN(p)||n.isInfinite(p))throw new A;return new y(d,p)}getY(){var t=this.y/this.w;if(n.isNaN(t)||n.isInfinite(t))throw new A;return t}getX(){var t=this.x/this.w;if(n.isNaN(t)||n.isInfinite(t))throw new A;return t}getCoordinate(){var t=new y;return t.x=this.getX(),t.y=this.getY(),t}getClass(){return U}get interfaces_(){return[]}}U.constructor_=function(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){let t=arguments[0];this.x=t.x,this.y=t.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){let t=arguments[0],e=arguments[1];this.x=t,this.y=e,this.w=1}else if(arguments[0]instanceof U&&arguments[1]instanceof U){let t=arguments[0],e=arguments[1];this.x=t.y*e.w-e.y*t.w,this.y=e.x*t.w-t.x*e.w,this.w=t.x*e.y-e.x*t.y}else if(arguments[0]instanceof y&&arguments[1]instanceof y){let t=arguments[0],e=arguments[1];this.x=t.y-e.y,this.y=e.x-t.x,this.w=t.x*e.y-e.x*t.y}}else if(3===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2];this.x=t,this.y=e,this.w=i}else if(4===arguments.length){let o=arguments[0],a=arguments[1],h=arguments[2],l=arguments[3];var t=o.y-a.y,e=a.x-o.x,i=o.x*a.y-a.x*o.y,r=h.y-l.y,n=l.x-h.x,s=h.x*l.y-l.x*h.y;this.x=e*s-n*i,this.y=r*i-t*s,this.w=t*n-r*e}};class Y{constructor(){Y.constructor_.apply(this,arguments)}static log10(t){var e=Math.log(t);return n.isInfinite(e)?e:n.isNaN(e)?e:e/Y.LOG_10}static min(t,e,i,r){var n=t;return e<n&&(n=e),i<n&&(n=i),r<n&&(n=r),n}static clamp(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){let t=arguments[0],e=arguments[1],i=arguments[2];return t<e?e:t>i?i:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){let t=arguments[0],e=arguments[1],i=arguments[2];return t<e?e:t>i?i:t}}static wrap(t,e){return t<0?e- -t%e:t%e}static max(){if(3===arguments.length){let e=arguments[0],i=arguments[1],r=arguments[2];return i>(t=e)&&(t=i),r>t&&(t=r),t}if(4===arguments.length){let e=arguments[0],i=arguments[1],r=arguments[2],n=arguments[3];var t;return i>(t=e)&&(t=i),r>t&&(t=r),n>t&&(t=n),t}}static average(t,e){return(t+e)/2}getClass(){return Y}get interfaces_(){return[]}}Y.constructor_=function(){},Y.LOG_10=Math.log(10);class z{constructor(){z.constructor_.apply(this,arguments)}static segmentToSegment(t,e,i,r){if(t.equals(e))return z.pointToSegment(t,i,r);if(i.equals(r))return z.pointToSegment(r,t,e);var n=!1;if(P.intersects(t,e,i,r)){var s=(e.x-t.x)*(r.y-i.y)-(e.y-t.y)*(r.x-i.x);if(0===s)n=!0;else{var o=(t.y-i.y)*(r.x-i.x)-(t.x-i.x)*(r.y-i.y),a=((t.y-i.y)*(e.x-t.x)-(t.x-i.x)*(e.y-t.y))/s,h=o/s;(h<0||h>1||a<0||a>1)&&(n=!0)}}else n=!0;return n?Y.min(z.pointToSegment(t,i,r),z.pointToSegment(e,i,r),z.pointToSegment(i,t,e),z.pointToSegment(r,t,e)):0}static pointToSegment(t,e,i){if(e.x===i.x&&e.y===i.y)return t.distance(e);var r=(i.x-e.x)*(i.x-e.x)+(i.y-e.y)*(i.y-e.y),n=((t.x-e.x)*(i.x-e.x)+(t.y-e.y)*(i.y-e.y))/r;if(n<=0)return t.distance(e);if(n>=1)return t.distance(i);var s=((e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y))/r;return Math.abs(s)*Math.sqrt(r)}static pointToLinePerpendicular(t,e,i){var r=(i.x-e.x)*(i.x-e.x)+(i.y-e.y)*(i.y-e.y),n=((e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y))/r;return Math.abs(n)*Math.sqrt(r)}static pointToSegmentString(t,e){if(0===e.length)throw new i("Line array must contain at least one vertex");for(var r=t.distance(e[0]),n=0;n<e.length-1;n++){var s=z.pointToSegment(t,e[n],e[n+1]);s<r&&(r=s)}return r}getClass(){return z}get interfaces_(){return[]}}z.constructor_=function(){};class X{constructor(){X.constructor_.apply(this,arguments)}setOrdinate(t,e,i){}size(){}getOrdinate(t,e){}getCoordinate(){}getCoordinateCopy(t){}getDimension(){}getX(t){}expandEnvelope(t){}copy(){}getY(t){}toCoordinateArray(){}getClass(){return X}get interfaces_(){return[d]}}X.constructor_=function(){},X.X=0,X.Y=1,X.Z=2,X.M=3;class q{constructor(){q.constructor_.apply(this,arguments)}create(){1===arguments.length&&(arguments[0]instanceof Array||x(arguments[0],X))}getClass(){return q}get interfaces_(){return[]}}q.constructor_=function(){};class H{constructor(){H.constructor_.apply(this,arguments)}filter(t){}getClass(){return H}get interfaces_(){return[]}}H.constructor_=function(){};class V{constructor(){V.constructor_.apply(this,arguments)}isGeometryCollection(){return this.getTypeCode()===V.TYPECODE_GEOMETRYCOLLECTION}getFactory(){return this._factory}getGeometryN(t){return this}getArea(){return 0}isRectangle(){return!1}equals(){if(arguments[0]instanceof V){let t=arguments[0];return null!==t&&this.equalsTopo(t)}if(arguments[0]instanceof Object){let e=arguments[0];if(!(e instanceof V))return!1;var t=e;return this.equalsExact(t)}}equalsExact(t){return this===t||this.equalsExact(t,0)}geometryChanged(){this.apply(V.geometryChangedFilter)}geometryChangedAction(){this._envelope=null}equalsNorm(t){return null!==t&&this.norm().equalsExact(t.norm())}getLength(){return 0}getNumGeometries(){return 1}compareTo(){if(1===arguments.length){let e=arguments[0];var t=e;return this.getTypeCode()!==t.getTypeCode()?this.getTypeCode()-t.getTypeCode():this.isEmpty()&&t.isEmpty()?0:this.isEmpty()?-1:t.isEmpty()?1:this.compareToSameClass(e)}if(2===arguments.length){let e=arguments[0],i=arguments[1];return t=e,this.getTypeCode()!==t.getTypeCode()?this.getTypeCode()-t.getTypeCode():this.isEmpty()&&t.isEmpty()?0:this.isEmpty()?-1:t.isEmpty()?1:this.compareToSameClass(e,i)}}getUserData(){return this._userData}getSRID(){return this._SRID}getEnvelope(){return this.getFactory().toGeometry(this.getEnvelopeInternal())}checkNotGeometryCollection(t){if(t.getTypeCode()===V.TYPECODE_GEOMETRYCOLLECTION)throw new i("This method does not support GeometryCollection arguments")}equal(t,e,i){return 0===i?t.equals(e):t.distance(e)<=i}norm(){var t=this.copy();return t.normalize(),t}getPrecisionModel(){return this._factory.getPrecisionModel()}getEnvelopeInternal(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new P(this._envelope)}setSRID(t){this._SRID=t}setUserData(t){this._userData=t}compare(t,e){for(var i=t.iterator(),r=e.iterator();i.hasNext()&&r.hasNext();){var n=i.next(),s=r.next(),o=n.compareTo(s);if(0!==o)return o}return i.hasNext()?1:r.hasNext()?-1:0}hashCode(){return this.getEnvelopeInternal().hashCode()}isGeometryCollectionOrDerived(){return this.getTypeCode()===V.TYPECODE_GEOMETRYCOLLECTION||this.getTypeCode()===V.TYPECODE_MULTIPOINT||this.getTypeCode()===V.TYPECODE_MULTILINESTRING||this.getTypeCode()===V.TYPECODE_MULTIPOLYGON}get interfaces_(){return[d,c,g]}getClass(){return V}static hasNonEmptyElements(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1}static hasNullElements(t){for(var e=0;e<t.length;e++)if(null===t[e])return!0;return!1}}V.constructor_=function(t){t&&(this._envelope=null,this._userData=null,this._factory=t,this._SRID=t.getSRID())},V.serialVersionUID=0x799ea46522854c00,V.TYPECODE_POINT=0,V.TYPECODE_MULTIPOINT=1,V.TYPECODE_LINESTRING=2,V.TYPECODE_LINEARRING=3,V.TYPECODE_MULTILINESTRING=4,V.TYPECODE_POLYGON=5,V.TYPECODE_MULTIPOLYGON=6,V.TYPECODE_GEOMETRYCOLLECTION=7,V.TYPENAME_POINT="Point",V.TYPENAME_MULTIPOINT="MultiPoint",V.TYPENAME_LINESTRING="LineString",V.TYPENAME_LINEARRING="LinearRing",V.TYPENAME_MULTILINESTRING="MultiLineString",V.TYPENAME_POLYGON="Polygon",V.TYPENAME_MULTIPOLYGON="MultiPolygon",V.TYPENAME_GEOMETRYCOLLECTION="GeometryCollection",V.geometryChangedFilter={get interfaces_(){return[H]},filter(t){t.geometryChangedAction()}};class j{constructor(){j.constructor_.apply(this,arguments)}filter(t){}getClass(){return j}get interfaces_(){return[]}}j.constructor_=function(){};class W{constructor(){W.constructor_.apply(this,arguments)}isInBoundary(t){}getClass(){return W}get interfaces_(){return[]}}class K{constructor(){K.constructor_.apply(this,arguments)}isInBoundary(t){return t%2==1}getClass(){return K}get interfaces_(){return[W]}}K.constructor_=function(){};class Z{constructor(){Z.constructor_.apply(this,arguments)}isInBoundary(t){return t>0}getClass(){return Z}get interfaces_(){return[W]}}Z.constructor_=function(){};class J{constructor(){J.constructor_.apply(this,arguments)}isInBoundary(t){return t>1}getClass(){return J}get interfaces_(){return[W]}}J.constructor_=function(){};class Q{constructor(){Q.constructor_.apply(this,arguments)}isInBoundary(t){return 1===t}getClass(){return Q}get interfaces_(){return[W]}}Q.constructor_=function(){},W.Mod2BoundaryNodeRule=K,W.EndPointBoundaryNodeRule=Z,W.MultiValentEndPointBoundaryNodeRule=J,W.MonoValentEndPointBoundaryNodeRule=Q,W.constructor_=function(){},W.MOD2_BOUNDARY_RULE=new K,W.ENDPOINT_BOUNDARY_RULE=new Z,W.MULTIVALENT_ENDPOINT_BOUNDARY_RULE=new J,W.MONOVALENT_ENDPOINT_BOUNDARY_RULE=new Q,W.OGC_SFS_BOUNDARY_RULE=W.MOD2_BOUNDARY_RULE;class ${constructor(){$.constructor_.apply(this,arguments)}static isRing(t){return!(t.length<4||!t[0].equals2D(t[t.length-1]))}static ptNotInList(t,e){for(var i=0;i<t.length;i++){var r=t[i];if($.indexOf(r,e)<0)return r}return null}static scroll(t,e){var i=$.indexOf(e,t);if(i<0)return null;var r=new Array(t.length).fill(null);G.arraycopy(t,i,r,0,t.length-i),G.arraycopy(t,0,r,t.length-i,i),G.arraycopy(r,0,t,0,t.length)}static equals(){if(2===arguments.length){let e=arguments[0],i=arguments[1];if(e===i)return!0;if(null===e||null===i)return!1;if(e.length!==i.length)return!1;for(var t=0;t<e.length;t++)if(!e[t].equals(i[t]))return!1;return!0}if(3===arguments.length){let e=arguments[0],i=arguments[1],r=arguments[2];if(e===i)return!0;if(null===e||null===i)return!1;if(e.length!==i.length)return!1;for(t=0;t<e.length;t++)if(0!==r.compare(e[t],i[t]))return!1;return!0}}static intersection(t,e){for(var i=new O,r=0;r<t.length;r++)e.intersects(t[r])&&i.add(t[r],!0);return i.toCoordinateArray()}static hasRepeatedPoints(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1}static removeRepeatedPoints(t){return $.hasRepeatedPoints(t)?new O(t,!1).toCoordinateArray():t}static reverse(t){for(var e=t.length-1,i=Math.trunc(e/2),r=0;r<=i;r++){var n=t[r];t[r]=t[e-r],t[e-r]=n}}static removeNull(t){for(var e=0,i=0;i<t.length;i++)null!==t[i]&&e++;var r=new Array(e).fill(null);if(0===e)return r;var n=0;for(i=0;i<t.length;i++)null!==t[i]&&(r[n++]=t[i]);return r}static copyDeep(){if(1===arguments.length){let i=arguments[0];for(var t=new Array(i.length).fill(null),e=0;e<i.length;e++)t[e]=new y(i[e]);return t}if(5===arguments.length){let t=arguments[0],i=arguments[1],r=arguments[2],n=arguments[3],s=arguments[4];for(e=0;e<s;e++)r[n+e]=new y(t[i+e])}}static isEqualReversed(t,e){for(var i=0;i<t.length;i++){var r=t[i],n=e[t.length-i-1];if(0!==r.compareTo(n))return!1}return!0}static envelope(t){for(var e=new P,i=0;i<t.length;i++)e.expandToInclude(t[i]);return e}static toCoordinateArray(t){return t.toArray($.coordArrayType)}static atLeastNCoordinatesOrNothing(t,e){return e.length>=t?e:[]}static indexOf(t,e){for(var i=0;i<e.length;i++)if(t.equals(e[i]))return i;return-1}static increasingDirection(t){for(var e=0;e<Math.trunc(t.length/2);e++){var i=t.length-1-e,r=t[e].compareTo(t[i]);if(0!==r)return r}return 1}static compare(t,e){for(var i=0;i<t.length&&i<e.length;){var r=t[i].compareTo(e[i]);if(0!==r)return r;i++}return i<e.length?-1:i<t.length?1:0}static minCoordinate(t){for(var e=null,i=0;i<t.length;i++)(null===e||e.compareTo(t[i])>0)&&(e=t[i]);return e}static extract(t,e,i){e=Y.clamp(e,0,t.length);var r=(i=Y.clamp(i,-1,t.length))-e+1;i<0&&(r=0),e>=t.length&&(r=0),i<e&&(r=0);var n=new Array(r).fill(null);if(0===r)return n;for(var s=0,o=e;o<=i;o++)n[s++]=t[o];return n}getClass(){return $}get interfaces_(){return[]}}class tt{constructor(){tt.constructor_.apply(this,arguments)}compare(t,e){var i=t,r=e;return $.compare(i,r)}getClass(){return tt}get interfaces_(){return[p]}}tt.constructor_=function(){};class et{constructor(){et.constructor_.apply(this,arguments)}compare(t,e){var i=t,r=e;if(i.length<r.length)return-1;if(i.length>r.length)return 1;if(0===i.length)return 0;var n=$.compare(i,r);return $.isEqualReversed(i,r)?0:n}OLDcompare(t,e){var i=t,r=e;if(i.length<r.length)return-1;if(i.length>r.length)return 1;if(0===i.length)return 0;for(var n=$.increasingDirection(i),s=$.increasingDirection(r),o=n>0?0:i.length-1,a=s>0?0:i.length-1,h=0;h<i.length;h++){var l=i[o].compareTo(r[a]);if(0!==l)return l;o+=n,a+=s}return 0}getClass(){return et}get interfaces_(){return[p]}}function it(){}function rt(){}function nt(){}function st(){this.array_=[],arguments[0]instanceof w&&this.addAll(arguments[0])}et.constructor_=function(){},$.ForwardComparator=tt,$.BidirectionalComparator=et,$.constructor_=function(){},$.coordArrayType=new Array(0).fill(null),it.prototype.get=function(){},it.prototype.put=function(){},it.prototype.size=function(){},it.prototype.values=function(){},it.prototype.entrySet=function(){},rt.prototype=new it,nt.prototype=new w,nt.prototype.contains=function(){},st.prototype=new nt,st.prototype.contains=function(t){for(var e=0,i=this.array_.length;e<i;e++)if(this.array_[e]===t)return!0;return!1},st.prototype.add=function(t){return!this.contains(t)&&(this.array_.push(t),!0)},st.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},st.prototype.remove=function(t){throw new javascript.util.OperationNotSupported},st.prototype.size=function(){return this.array_.length},st.prototype.isEmpty=function(){return 0===this.array_.length},st.prototype.toArray=function(){for(var t=[],e=0,i=this.array_.length;e<i;e++)t.push(this.array_[e]);return t},st.prototype.iterator=function(){return new ot(this)};var ot=function(t){this.hashSet_=t,this.position_=0};ot.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new T;return this.hashSet_.array_[this.position_++]},ot.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},ot.prototype.remove=function(){throw new S};const at=0;function ht(t){return null==t?at:t.color}function lt(t){return null==t?null:t.parent}function ut(t,e){null!==t&&(t.color=e)}function ct(t){return null==t?null:t.left}function dt(t){return null==t?null:t.right}function pt(){this.root_=null,this.size_=0}pt.prototype=new rt,pt.prototype.get=function(t){for(var e=this.root_;null!==e;){var i=t.compareTo(e.key);if(i<0)e=e.left;else{if(!(i>0))return e.value;e=e.right}}return null},pt.prototype.put=function(t,e){if(null===this.root_)return this.root_={key:t,value:e,left:null,right:null,parent:null,color:at,getValue(){return this.value},getKey(){return this.key}},this.size_=1,null;var i,r,n=this.root_;do{if(i=n,(r=t.compareTo(n.key))<0)n=n.left;else{if(!(r>0)){var s=n.value;return n.value=e,s}n=n.right}}while(null!==n);var o={key:t,left:null,right:null,value:e,parent:i,color:at,getValue(){return this.value},getKey(){return this.key}};return r<0?i.left=o:i.right=o,this.fixAfterInsertion(o),this.size_++,null},pt.prototype.fixAfterInsertion=function(t){for(t.color=1;null!=t&&t!=this.root_&&1==t.parent.color;){var e;lt(t)==ct(lt(lt(t)))?1==ht(e=dt(lt(lt(t))))?(ut(lt(t),at),ut(e,at),ut(lt(lt(t)),1),t=lt(lt(t))):(t==dt(lt(t))&&(t=lt(t),this.rotateLeft(t)),ut(lt(t),at),ut(lt(lt(t)),1),this.rotateRight(lt(lt(t)))):1==ht(e=ct(lt(lt(t))))?(ut(lt(t),at),ut(e,at),ut(lt(lt(t)),1),t=lt(lt(t))):(t==ct(lt(t))&&(t=lt(t),this.rotateRight(t)),ut(lt(t),at),ut(lt(lt(t)),1),this.rotateLeft(lt(lt(t))))}this.root_.color=at},pt.prototype.values=function(){var t=new C,e=this.getFirstEntry();if(null!==e)for(t.add(e.value);null!==(e=pt.successor(e));)t.add(e.value);return t},pt.prototype.entrySet=function(){var t=new st,e=this.getFirstEntry();if(null!==e)for(t.add(e);null!==(e=pt.successor(e));)t.add(e);return t},pt.prototype.rotateLeft=function(t){if(null!=t){var e=t.right;t.right=e.left,null!=e.left&&(e.left.parent=t),e.parent=t.parent,null==t.parent?this.root_=e:t.parent.left==t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e}},pt.prototype.rotateRight=function(t){if(null!=t){var e=t.left;t.left=e.right,null!=e.right&&(e.right.parent=t),e.parent=t.parent,null==t.parent?this.root_=e:t.parent.right==t?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e}},pt.prototype.getFirstEntry=function(){var t=this.root_;if(null!=t)for(;null!=t.left;)t=t.left;return t},pt.successor=function(t){if(null===t)return null;if(null!==t.right){for(var e=t.right;null!==e.left;)e=e.left;return e}e=t.parent;for(var i=t;null!==e&&i===e.right;)i=e,e=e.parent;return e},pt.prototype.size=function(){return this.size_},pt.prototype.containsKey=function(t){for(var e=this.root_;null!==e;){var i=t.compareTo(e.key);if(i<0)e=e.left;else{if(!(i>0))return!0;e=e.right}}return!1};class gt{constructor(){gt.constructor_.apply(this,arguments)}getClass(){return gt}get interfaces_(){return[]}}function ft(){}function _t(){this.array_=[],arguments[0]instanceof w&&this.addAll(arguments[0])}gt.constructor_=function(){},ft.prototype=new nt,_t.prototype=new ft,_t.prototype.contains=function(t){for(var e=0,i=this.array_.length;e<i;e++)if(0===this.array_[e].compareTo(t))return!0;return!1},_t.prototype.add=function(t){if(this.contains(t))return!1;for(var e=0,i=this.array_.length;e<i;e++)if(1===this.array_[e].compareTo(t))return this.array_.splice(e,0,t),!0;return this.array_.push(t),!0},_t.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},_t.prototype.remove=function(t){throw new S},_t.prototype.size=function(){return this.array_.length},_t.prototype.isEmpty=function(){return 0===this.array_.length},_t.prototype.toArray=function(){for(var t=[],e=0,i=this.array_.length;e<i;e++)t.push(this.array_[e]);return t},_t.prototype.iterator=function(){return new yt(this)};var mt,yt=function(t){this.treeSet_=t,this.position_=0};function vt(){}yt.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new T;return this.treeSet_.array_[this.position_++]},yt.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},yt.prototype.remove=function(){throw new S},vt.sort=function(){var t,e,i,r,n=arguments[0];if(1===arguments.length)return r=function(t,e){return t.compareTo(e)},void n.sort(r);if(2===arguments.length)i=arguments[1],r=function(t,e){return i.compare(t,e)},n.sort(r);else{if(3===arguments.length){(e=n.slice(arguments[1],arguments[2])).sort();var s=n.slice(0,arguments[1]).concat(e,n.slice(arguments[2],n.length));for(n.splice(0,n.length),t=0;t<s.length;t++)n.push(s[t]);return}if(4===arguments.length){for(e=n.slice(arguments[1],arguments[2]),i=arguments[3],r=function(t,e){return i.compare(t,e)},e.sort(r),s=n.slice(0,arguments[1]).concat(e,n.slice(arguments[2],n.length)),n.splice(0,n.length),t=0;t<s.length;t++)n.push(s[t]);return}}},vt.asList=function(t){for(var e=new C,i=0,r=t.length;i<r;i++)e.add(t[i]);return e};class xt{constructor(){xt.constructor_.apply(this,arguments)}static toDimensionSymbol(t){switch(t){case xt.FALSE:return xt.SYM_FALSE;case xt.TRUE:return xt.SYM_TRUE;case xt.DONTCARE:return xt.SYM_DONTCARE;case xt.P:return xt.SYM_P;case xt.L:return xt.SYM_L;case xt.A:return xt.SYM_A}throw new i("Unknown dimension value: "+t)}static toDimensionValue(t){switch(D.toUpperCase(t)){case xt.SYM_FALSE:return xt.FALSE;case xt.SYM_TRUE:return xt.TRUE;case xt.SYM_DONTCARE:return xt.DONTCARE;case xt.SYM_P:return xt.P;case xt.SYM_L:return xt.L;case xt.SYM_A:return xt.A}throw new i("Unknown dimension symbol: "+t)}getClass(){return xt}get interfaces_(){return[]}}xt.constructor_=function(){},xt.P=0,xt.L=1,xt.A=2,xt.FALSE=-1,xt.TRUE=-2,xt.DONTCARE=-3,xt.SYM_FALSE="F",xt.SYM_TRUE="T",xt.SYM_DONTCARE="*",xt.SYM_P="0",xt.SYM_L="1",xt.SYM_A="2";class Et{constructor(){Et.constructor_.apply(this,arguments)}filter(t){}getClass(){return Et}get interfaces_(){return[]}}Et.constructor_=function(){};class wt{constructor(){wt.constructor_.apply(this,arguments)}filter(t,e){}isDone(){}isGeometryChanged(){}getClass(){return wt}get interfaces_(){return[]}}wt.constructor_=function(){};class bt extends V{constructor(){super(),bt.constructor_.apply(this,arguments)}computeEnvelopeInternal(){for(var t=new P,e=0;e<this._geometries.length;e++)t.expandToInclude(this._geometries[e].getEnvelopeInternal());return t}getGeometryN(t){return this._geometries[t]}getCoordinates(){for(var t=new Array(this.getNumPoints()).fill(null),e=-1,i=0;i<this._geometries.length;i++)for(var r=this._geometries[i].getCoordinates(),n=0;n<r.length;n++)t[++e]=r[n];return t}getArea(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getArea();return t}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof V){let i=arguments[0],r=arguments[1];if(!this.isEquivalentClass(i))return!1;var t=i;if(this._geometries.length!==t._geometries.length)return!1;for(var e=0;e<this._geometries.length;e++)if(!this._geometries[e].equalsExact(t._geometries[e],r))return!1;return!0}return super.equalsExact.apply(this,arguments)}normalize(){for(var t=0;t<this._geometries.length;t++)this._geometries[t].normalize();vt.sort(this._geometries)}getCoordinate(){return this.isEmpty()?null:this._geometries[0].getCoordinate()}getBoundaryDimension(){for(var t=xt.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getBoundaryDimension());return t}getTypeCode(){return V.TYPECODE_GEOMETRYCOLLECTION}getDimension(){for(var t=xt.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getDimension());return t}getLength(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getLength();return t}getNumPoints(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getNumPoints();return t}getNumGeometries(){return this._geometries.length}reverse(){for(var t=this._geometries.length,e=new Array(t).fill(null),i=0;i<this._geometries.length;i++)e[i]=this._geometries[i].reverse();return this.getFactory().createGeometryCollection(e)}compareToSameClass(){if(1===arguments.length){let i=arguments[0];var t=new _t(vt.asList(this._geometries)),e=new _t(vt.asList(i._geometries));return this.compare(t,e)}if(2===arguments.length){let t=arguments[0],e=arguments[1];for(var i=t,r=this.getNumGeometries(),n=i.getNumGeometries(),s=0;s<r&&s<n;){var o=this.getGeometryN(s),a=i.getGeometryN(s),h=o.compareToSameClass(a,e);if(0!==h)return h;s++}return s<r?1:s<n?-1:0}}apply(){if(x(arguments[0],j)){let e=arguments[0];for(var t=0;t<this._geometries.length;t++)this._geometries[t].apply(e)}else if(x(arguments[0],wt)){let e=arguments[0];if(0===this._geometries.length)return null;for(t=0;t<this._geometries.length&&(this._geometries[t].apply(e),!e.isDone());t++);e.isGeometryChanged()&&this.geometryChanged()}else if(x(arguments[0],Et)){let e=arguments[0];for(e.filter(this),t=0;t<this._geometries.length;t++)this._geometries[t].apply(e)}else if(x(arguments[0],H)){let e=arguments[0];for(e.filter(this),t=0;t<this._geometries.length;t++)this._geometries[t].apply(e)}}getBoundary(){return this.checkNotGeometryCollection(this),m.shouldNeverReachHere(),null}getGeometryType(){return V.TYPENAME_GEOMETRYCOLLECTION}copy(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new bt(t,this._factory)}isEmpty(){for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isEmpty())return!1;return!0}getClass(){return bt}get interfaces_(){return[]}}bt.constructor_=function(){if(this._geometries=null,0===arguments.length);else if(2===arguments.length){let t=arguments[0],e=arguments[1];if(V.constructor_.call(this,e),null===t&&(t=[]),V.hasNullElements(t))throw new i("geometries must not contain null elements");this._geometries=t}},bt.serialVersionUID=-0x4f07bcb1f857d800;class It extends bt{constructor(){super(),It.constructor_.apply(this,arguments)}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof V){let t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&super.equalsExact.call(this,t,e)}return super.equalsExact.apply(this,arguments)}getBoundaryDimension(){return this.isClosed()?xt.FALSE:0}isClosed(){if(this.isEmpty())return!1;for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isClosed())return!1;return!0}getTypeCode(){return V.TYPECODE_MULTILINESTRING}getDimension(){return 1}reverse(){for(var t=this._geometries.length,e=new Array(t).fill(null),i=0;i<this._geometries.length;i++)e[t-1-i]=this._geometries[i].reverse();return this.getFactory().createMultiLineString(e)}getBoundary(){return new Tt(this).getBoundary()}getGeometryType(){return V.TYPENAME_MULTILINESTRING}copy(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new It(t,this._factory)}getClass(){return It}get interfaces_(){return[gt]}}It.constructor_=function(){let t=arguments[0],e=arguments[1];bt.constructor_.call(this,t,e)},It.serialVersionUID=0x7155d2ab4afa8000;class Tt{constructor(){Tt.constructor_.apply(this,arguments)}static getBoundary(){if(1===arguments.length){let t=arguments[0];return new Tt(t).getBoundary()}if(2===arguments.length){let t=arguments[0],e=arguments[1];return new Tt(t,e).getBoundary()}}boundaryMultiLineString(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var e=this.computeBoundaryCoordinates(t);return 1===e.length?this._geomFact.createPoint(e[0]):this._geomFact.createMultiPointFromCoords(e)}getBoundary(){return this._geom instanceof Ft?this.boundaryLineString(this._geom):this._geom instanceof It?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()}boundaryLineString(t){return this._geom.isEmpty()?this.getEmptyMultiPoint():t.isClosed()?this._bnRule.isInBoundary(2)?t.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])}getEmptyMultiPoint(){return this._geomFact.createMultiPoint()}computeBoundaryCoordinates(t){var e=new C;this._endpointMap=new pt;for(var i=0;i<t.getNumGeometries();i++){var r=t.getGeometryN(i);0!==r.getNumPoints()&&(this.addEndpoint(r.getCoordinateN(0)),this.addEndpoint(r.getCoordinateN(r.getNumPoints()-1)))}for(var n=this._endpointMap.entrySet().iterator();n.hasNext();){var s=n.next(),o=s.getValue().count;this._bnRule.isInBoundary(o)&&e.add(s.getKey())}return $.toCoordinateArray(e)}addEndpoint(t){var e=this._endpointMap.get(t);null===e&&(e=new St,this._endpointMap.put(t,e)),e.count++}getClass(){return Tt}get interfaces_(){return[]}}Tt.constructor_=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,1===arguments.length){let t=arguments[0];Tt.constructor_.call(this,t,W.MOD2_BOUNDARY_RULE)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this._geom=t,this._geomFact=t.getFactory(),this._bnRule=e}};class St{constructor(){St.constructor_.apply(this,arguments)}getClass(){return St}get interfaces_(){return[]}}St.constructor_=function(){this.count=null};class Ct{constructor(){Ct.constructor_.apply(this,arguments)}static ofLine(t){var e=t.size();if(e<=1)return 0;var i=0,r=new y;t.getCoordinate(0,r);for(var n=r.x,s=r.y,o=1;o<e;o++){t.getCoordinate(o,r);var a=r.x,h=r.y,l=a-n,u=h-s;i+=Math.sqrt(l*l+u*u),n=a,s=h}return i}getClass(){return Ct}get interfaces_(){return[]}}function Nt(){}function Ot(){}function Pt(){}function Lt(){}function At(){}Ct.constructor_=function(){};class Rt{constructor(){Rt.constructor_.apply(this,arguments)}static chars(t,e){for(var i=new Array(e).fill(null),r=0;r<e;r++)i[r]=t;return new String(i)}static getStackTrace(){if(1===arguments.length){let i=arguments[0];var t=new Pt,e=new Nt(t);return i.printStackTrace(e),t.toString()}if(2===arguments.length){let e=arguments[0],s=arguments[1];for(var i="",r=new At(new Ot(Rt.getStackTrace(e))),n=0;n<s;n++)try{i+=r.readLine()+Rt.NEWLINE}catch(t){if(!(t instanceof Lt))throw t;m.shouldNeverReachHere()}return i}}static split(t,e){for(var i=e.length,r=new C,n=""+t,s=n.indexOf(e);s>=0;){var o=n.substring(0,s);r.add(o),s=(n=n.substring(s+i)).indexOf(e)}n.length>0&&r.add(n);for(var a=new Array(r.size()).fill(null),h=0;h<a.length;h++)a[h]=r.get(h);return a}static toString(){if(1===arguments.length&&"number"==typeof arguments[0]){let t=arguments[0];return Rt.SIMPLE_ORDINATE_FORMAT.format(t)}}static spaces(t){return Rt.chars(" ",t)}getClass(){return Rt}get interfaces_(){return[]}}function Mt(t){this.str=t}Rt.constructor_=function(){},Rt.NEWLINE=G.getProperty("line.separator"),Rt.SIMPLE_ORDINATE_FORMAT=new function(){}("0.#"),Mt.prototype.append=function(t){this.str+=t},Mt.prototype.setCharAt=function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)},Mt.prototype.toString=function(t){return this.str};class Dt{constructor(){Dt.constructor_.apply(this,arguments)}static copyCoord(t,e,i,r){for(var n=Math.min(t.getDimension(),i.getDimension()),s=0;s<n;s++)i.setOrdinate(r,s,t.getOrdinate(e,s))}static isRing(t){var e=t.size();return 0===e||!(e<=3)&&t.getOrdinate(0,X.X)===t.getOrdinate(e-1,X.X)&&t.getOrdinate(0,X.Y)===t.getOrdinate(e-1,X.Y)}static isEqual(t,e){var i=t.size();if(i!==e.size())return!1;for(var r=Math.min(t.getDimension(),e.getDimension()),s=0;s<i;s++)for(var o=0;o<r;o++){var a=t.getOrdinate(s,o),h=e.getOrdinate(s,o);if(!(t.getOrdinate(s,o)===e.getOrdinate(s,o)||n.isNaN(a)&&n.isNaN(h)))return!1}return!0}static extend(t,e,i){var r=t.create(i,e.getDimension()),n=e.size();if(Dt.copy(e,0,r,0,n),n>0)for(var s=n;s<i;s++)Dt.copy(e,n-1,r,s,1);return r}static reverse(t){for(var e=t.size()-1,i=Math.trunc(e/2),r=0;r<=i;r++)Dt.swap(t,r,e-r)}static swap(t,e,i){if(e===i)return null;for(var r=0;r<t.getDimension();r++){var n=t.getOrdinate(e,r);t.setOrdinate(e,r,t.getOrdinate(i,r)),t.setOrdinate(i,r,n)}}static copy(t,e,i,r,n){for(var s=0;s<n;s++)Dt.copyCoord(t,e+s,i,r+s)}static toString(){if(1===arguments.length&&x(arguments[0],X)){let s=arguments[0];var t=s.size();if(0===t)return"()";var e=s.getDimension(),i=new Mt;i.append("(");for(var r=0;r<t;r++){r>0&&i.append(" ");for(var n=0;n<e;n++)n>0&&i.append(","),i.append(Rt.toString(s.getOrdinate(r,n)))}return i.append(")"),i.toString()}}static ensureValidRing(t,e){var i=e.size();return 0===i?e:i<=3?Dt.createClosedRing(t,e,4):e.getOrdinate(0,X.X)===e.getOrdinate(i-1,X.X)&&e.getOrdinate(0,X.Y)===e.getOrdinate(i-1,X.Y)?e:Dt.createClosedRing(t,e,i+1)}static createClosedRing(t,e,i){var r=t.create(i,e.getDimension()),n=e.size();Dt.copy(e,0,r,0,n);for(var s=n;s<i;s++)Dt.copy(e,0,r,s,1);return r}getClass(){return Dt}get interfaces_(){return[]}}Dt.constructor_=function(){};class Ft extends V{constructor(){super(),Ft.constructor_.apply(this,arguments)}computeEnvelopeInternal(){return this.isEmpty()?new P:this._points.expandEnvelope(new P)}isRing(){return this.isClosed()&&this.isSimple()}getCoordinates(){return this._points.toCoordinateArray()}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof V){let i=arguments[0],r=arguments[1];if(!this.isEquivalentClass(i))return!1;var t=i;if(this._points.size()!==t._points.size())return!1;for(var e=0;e<this._points.size();e++)if(!this.equal(this._points.getCoordinate(e),t._points.getCoordinate(e),r))return!1;return!0}return super.equalsExact.apply(this,arguments)}normalize(){for(var t=0;t<Math.trunc(this._points.size()/2);t++){var e=this._points.size()-1-t;if(!this._points.getCoordinate(t).equals(this._points.getCoordinate(e))){if(this._points.getCoordinate(t).compareTo(this._points.getCoordinate(e))>0){var i=this._points.copy();Dt.reverse(i),this._points=i}return null}}}getCoordinate(){return this.isEmpty()?null:this._points.getCoordinate(0)}getBoundaryDimension(){return this.isClosed()?xt.FALSE:0}isClosed(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))}getEndPoint(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)}getTypeCode(){return V.TYPECODE_LINESTRING}getDimension(){return 1}getLength(){return Ct.ofLine(this._points)}getNumPoints(){return this._points.size()}reverse(){var t=this._points.copy();return Dt.reverse(t),this.getFactory().createLineString(t)}compareToSameClass(){if(1===arguments.length){for(var t=arguments[0],e=0,i=0;e<this._points.size()&&i<t._points.size();){var r=this._points.getCoordinate(e).compareTo(t._points.getCoordinate(i));if(0!==r)return r;e++,i++}return e<this._points.size()?1:i<t._points.size()?-1:0}if(2===arguments.length)return t=arguments[0],arguments[1].compare(this._points,t._points)}apply(){if(x(arguments[0],j)){let e=arguments[0];for(var t=0;t<this._points.size();t++)e.filter(this._points.getCoordinate(t))}else if(x(arguments[0],wt)){let e=arguments[0];if(0===this._points.size())return null;for(t=0;t<this._points.size()&&(e.filter(this._points,t),!e.isDone());t++);e.isGeometryChanged()&&this.geometryChanged()}else x(arguments[0],Et)?arguments[0].filter(this):x(arguments[0],H)&&arguments[0].filter(this)}getBoundary(){return new Tt(this).getBoundary()}isEquivalentClass(t){return t instanceof Ft}getCoordinateN(t){return this._points.getCoordinate(t)}getGeometryType(){return V.TYPENAME_LINESTRING}copy(){return new Ft(this._points.copy(),this._factory)}getCoordinateSequence(){return this._points}isEmpty(){return 0===this._points.size()}init(t){if(null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),1===t.size())throw new i("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this._points=t}isCoordinate(t){for(var e=0;e<this._points.size();e++)if(this._points.getCoordinate(e).equals(t))return!0;return!1}getStartPoint(){return this.isEmpty()?null:this.getPointN(0)}getPointN(t){return this.getFactory().createPoint(this._points.getCoordinate(t))}getClass(){return Ft}get interfaces_(){return[gt]}}Ft.constructor_=function(){if(this._points=null,0===arguments.length);else if(2===arguments.length){let t=arguments[0],e=arguments[1];V.constructor_.call(this,e),this.init(t)}},Ft.serialVersionUID=0x2b2b51ba435c8e00;class Bt{constructor(){Bt.constructor_.apply(this,arguments)}getClass(){return Bt}get interfaces_(){return[]}}Bt.constructor_=function(){};class kt extends V{constructor(){super(),kt.constructor_.apply(this,arguments)}computeEnvelopeInternal(){if(this.isEmpty())return new P;var t=new P;return t.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),t}getCoordinates(){return this.isEmpty()?[]:[this.getCoordinate()]}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof V){let t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&(!(!this.isEmpty()||!t.isEmpty())||this.isEmpty()===t.isEmpty()&&this.equal(t.getCoordinate(),this.getCoordinate(),e))}return super.equalsExact.apply(this,arguments)}normalize(){}getCoordinate(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null}getBoundaryDimension(){return xt.FALSE}getTypeCode(){return V.TYPECODE_POINT}getDimension(){return 0}getNumPoints(){return this.isEmpty()?0:1}reverse(){return this.copy()}getX(){if(null===this.getCoordinate())throw new IllegalStateException("getX called on empty Point");return this.getCoordinate().x}compareToSameClass(){if(1===arguments.length){var t=arguments[0];return this.getCoordinate().compareTo(t.getCoordinate())}if(2===arguments.length)return t=arguments[0],arguments[1].compare(this._coordinates,t._coordinates)}apply(){if(x(arguments[0],j)){let t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(x(arguments[0],wt)){let t=arguments[0];if(this.isEmpty())return null;t.filter(this._coordinates,0),t.isGeometryChanged()&&this.geometryChanged()}else x(arguments[0],Et)?arguments[0].filter(this):x(arguments[0],H)&&arguments[0].filter(this)}getBoundary(){return this.getFactory().createGeometryCollection()}getGeometryType(){return V.TYPENAME_POINT}copy(){return new kt(this._coordinates.copy(),this._factory)}getCoordinateSequence(){return this._coordinates}getY(){if(null===this.getCoordinate())throw new IllegalStateException("getY called on empty Point");return this.getCoordinate().y}isEmpty(){return 0===this._coordinates.size()}init(t){null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),m.isTrue(t.size()<=1),this._coordinates=t}isSimple(){return!0}getClass(){return kt}get interfaces_(){return[Bt]}}kt.constructor_=function(){this._coordinates=null;let t=arguments[0],e=arguments[1];V.constructor_.call(this,e),this.init(t)},kt.serialVersionUID=0x44077bad161cbc00;class Gt{constructor(){Gt.constructor_.apply(this,arguments)}static ofRing(){if(arguments[0]instanceof Array){let t=arguments[0];return Math.abs(Gt.ofRingSigned(t))}if(x(arguments[0],X)){let t=arguments[0];return Math.abs(Gt.ofRingSigned(t))}}static ofRingSigned(){if(arguments[0]instanceof Array){let s=arguments[0];if(s.length<3)return 0;for(var t=0,e=s[0].x,i=1;i<s.length-1;i++){var r=s[i].x-e,n=s[i+1].y;t+=r*(s[i-1].y-n)}return t/2}if(x(arguments[0],X)){let r=arguments[0];var s=r.size();if(s<3)return 0;var o=new y,a=new y,h=new y;for(r.getCoordinate(0,a),r.getCoordinate(1,h),e=a.x,h.x-=e,t=0,i=1;i<s-1;i++)o.y=a.y,a.x=h.x,a.y=h.y,r.getCoordinate(i+1,h),h.x-=e,t+=a.x*(o.y-h.y);return t/2}}getClass(){return Gt}get interfaces_(){return[]}}Gt.constructor_=function(){};class Ut{constructor(){Ut.constructor_.apply(this,arguments)}getClass(){return Ut}get interfaces_(){return[]}}Ut.constructor_=function(){};class Yt extends V{constructor(){super(),Yt.constructor_.apply(this,arguments)}computeEnvelopeInternal(){return this._shell.getEnvelopeInternal()}getCoordinates(){if(this.isEmpty())return[];for(var t=new Array(this.getNumPoints()).fill(null),e=-1,i=this._shell.getCoordinates(),r=0;r<i.length;r++)t[++e]=i[r];for(var n=0;n<this._holes.length;n++)for(var s=this._holes[n].getCoordinates(),o=0;o<s.length;o++)t[++e]=s[o];return t}getArea(){var t=0;t+=Gt.ofRing(this._shell.getCoordinateSequence());for(var e=0;e<this._holes.length;e++)t-=Gt.ofRing(this._holes[e].getCoordinateSequence());return t}isRectangle(){if(0!==this.getNumInteriorRing())return!1;if(null===this._shell)return!1;if(5!==this._shell.getNumPoints())return!1;for(var t=this._shell.getCoordinateSequence(),e=this.getEnvelopeInternal(),i=0;i<5;i++){if((s=t.getX(i))!==e.getMinX()&&s!==e.getMaxX())return!1;if((o=t.getY(i))!==e.getMinY()&&o!==e.getMaxY())return!1}var r=t.getX(0),n=t.getY(0);for(i=1;i<=4;i++){var s,o;if((s=t.getX(i))!==r==((o=t.getY(i))!==n))return!1;r=s,n=o}return!0}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof V){let n=arguments[0],s=arguments[1];if(!this.isEquivalentClass(n))return!1;var t=n,e=this._shell,i=t._shell;if(!e.equalsExact(i,s))return!1;if(this._holes.length!==t._holes.length)return!1;for(var r=0;r<this._holes.length;r++)if(!this._holes[r].equalsExact(t._holes[r],s))return!1;return!0}return super.equalsExact.apply(this,arguments)}normalize(){if(0===arguments.length){this.normalize(this._shell,!0);for(var t=0;t<this._holes.length;t++)this.normalize(this._holes[t],!1);vt.sort(this._holes)}else if(2===arguments.length){let t=arguments[0],r=arguments[1];if(t.isEmpty())return null;var e=new Array(t.getCoordinates().length-1).fill(null);G.arraycopy(t.getCoordinates(),0,e,0,e.length);var i=$.minCoordinate(t.getCoordinates());$.scroll(e,i),G.arraycopy(e,0,t.getCoordinates(),0,e.length),t.getCoordinates()[e.length]=e[0],k.isCCW(t.getCoordinates())===r&&$.reverse(t.getCoordinates())}}getCoordinate(){return this._shell.getCoordinate()}getNumInteriorRing(){return this._holes.length}getBoundaryDimension(){return 1}getTypeCode(){return V.TYPECODE_POLYGON}getDimension(){return 2}getLength(){var t=0;t+=this._shell.getLength();for(var e=0;e<this._holes.length;e++)t+=this._holes[e].getLength();return t}getNumPoints(){for(var t=this._shell.getNumPoints(),e=0;e<this._holes.length;e++)t+=this._holes[e].getNumPoints();return t}reverse(){var t=this.copy();t._shell=this._shell.copy().reverse(),t._holes=new Array(this._holes.length).fill(null);for(var e=0;e<this._holes.length;e++)t._holes[e]=this._holes[e].copy().reverse();return t}convexHull(){return this.getExteriorRing().convexHull()}compareToSameClass(){if(1===arguments.length){let i=arguments[0];var t=this._shell,e=i._shell;return t.compareToSameClass(e)}if(2===arguments.length){let u=arguments[0],c=arguments[1];var i=u,r=(t=this._shell,e=i._shell,t.compareToSameClass(e,c));if(0!==r)return r;for(var n=this.getNumInteriorRing(),s=i.getNumInteriorRing(),o=0;o<n&&o<s;){var a=this.getInteriorRingN(o),h=i.getInteriorRingN(o),l=a.compareToSameClass(h,c);if(0!==l)return l;o++}return o<n?1:o<s?-1:0}}apply(){if(x(arguments[0],j)){let e=arguments[0];this._shell.apply(e);for(var t=0;t<this._holes.length;t++)this._holes[t].apply(e)}else if(x(arguments[0],wt)){let e=arguments[0];if(this._shell.apply(e),!e.isDone())for(t=0;t<this._holes.length&&(this._holes[t].apply(e),!e.isDone());t++);e.isGeometryChanged()&&this.geometryChanged()}else if(x(arguments[0],Et))arguments[0].filter(this);else if(x(arguments[0],H)){let e=arguments[0];for(e.filter(this),this._shell.apply(e),t=0;t<this._holes.length;t++)this._holes[t].apply(e)}}getBoundary(){if(this.isEmpty())return this.getFactory().createMultiLineString();var t=new Array(this._holes.length+1).fill(null);t[0]=this._shell;for(var e=0;e<this._holes.length;e++)t[e+1]=this._holes[e];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)}getGeometryType(){return V.TYPENAME_POLYGON}copy(){for(var t=this._shell.copy(),e=new Array(this._holes.length).fill(null),i=0;i<this._holes.length;i++)e[i]=this._holes[i].copy();return new Yt(t,e,this._factory)}getExteriorRing(){return this._shell}isEmpty(){return this._shell.isEmpty()}getInteriorRingN(t){return this._holes[t]}getClass(){return Yt}get interfaces_(){return[Ut]}}Yt.constructor_=function(){this._shell=null,this._holes=null;let t=arguments[0],e=arguments[1],r=arguments[2];if(V.constructor_.call(this,r),null===t&&(t=this.getFactory().createLinearRing()),null===e&&(e=[]),V.hasNullElements(e))throw new i("holes must not contain null elements");if(t.isEmpty()&&V.hasNonEmptyElements(e))throw new i("shell is empty but holes are not");this._shell=t,this._holes=e},Yt.serialVersionUID=-0x307ffefd8dc97200;class zt extends bt{constructor(){super(),zt.constructor_.apply(this,arguments)}isValid(){return!0}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof V){let t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&super.equalsExact.call(this,t,e)}return super.equalsExact.apply(this,arguments)}getCoordinate(){if(1===arguments.length&&Number.isInteger(arguments[0])){let t=arguments[0];return this._geometries[t].getCoordinate()}return super.getCoordinate.apply(this,arguments)}getBoundaryDimension(){return xt.FALSE}getTypeCode(){return V.TYPECODE_MULTIPOINT}getDimension(){return 0}getBoundary(){return this.getFactory().createGeometryCollection()}getGeometryType(){return V.TYPENAME_MULTIPOINT}copy(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new zt(t,this._factory)}getClass(){return zt}get interfaces_(){return[Bt]}}zt.constructor_=function(){let t=arguments[0],e=arguments[1];bt.constructor_.call(this,t,e)},zt.serialVersionUID=-0x6fb1ed4162e0fc00;class Xt extends Ft{constructor(){super(),Xt.constructor_.apply(this,arguments)}getBoundaryDimension(){return xt.FALSE}isClosed(){return!!this.isEmpty()||super.isClosed.call(this)}getTypeCode(){return V.TYPECODE_LINEARRING}reverse(){var t=this._points.copy();return Dt.reverse(t),this.getFactory().createLinearRing(t)}validateConstruction(){if(!this.isEmpty()&&!super.isClosed.call(this))throw new i("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<Xt.MINIMUM_VALID_SIZE)throw new i("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")}getGeometryType(){return V.TYPENAME_LINEARRING}copy(){return new Xt(this._points.copy(),this._factory)}getClass(){return Xt}get interfaces_(){return[]}}Xt.constructor_=function(){if(arguments[0]instanceof Array&&arguments[1]instanceof oe){let t=arguments[0],e=arguments[1];Xt.constructor_.call(this,e.getCoordinateSequenceFactory().create(t),e)}else if(x(arguments[0],X)&&arguments[1]instanceof oe){let t=arguments[0],e=arguments[1];Ft.constructor_.call(this,t,e),this.validateConstruction()}},Xt.MINIMUM_VALID_SIZE=4,Xt.serialVersionUID=-0x3b229e262367a600;class qt extends bt{constructor(){super(),qt.constructor_.apply(this,arguments)}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof V){let t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&super.equalsExact.call(this,t,e)}return super.equalsExact.apply(this,arguments)}getBoundaryDimension(){return 1}getTypeCode(){return V.TYPECODE_MULTIPOLYGON}getDimension(){return 2}reverse(){for(var t=this._geometries.length,e=new Array(t).fill(null),i=0;i<this._geometries.length;i++)e[i]=this._geometries[i].reverse();return this.getFactory().createMultiPolygon(e)}getBoundary(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var t=new C,e=0;e<this._geometries.length;e++)for(var i=this._geometries[e].getBoundary(),r=0;r<i.getNumGeometries();r++)t.add(i.getGeometryN(r));var n=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(n))}getGeometryType(){return V.TYPENAME_MULTIPOLYGON}copy(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new qt(t,this._factory)}getClass(){return qt}get interfaces_(){return[Ut]}}qt.constructor_=function(){let t=arguments[0],e=arguments[1];bt.constructor_.call(this,t,e)},qt.serialVersionUID=-0x7a5aa1369171980;class Ht{constructor(){Ht.constructor_.apply(this,arguments)}setCopyUserData(t){this._isUserDataCopied=t}edit(t,e){if(null===t)return null;var i=this.editInternal(t,e);return this._isUserDataCopied&&i.setUserData(t.getUserData()),i}editInternal(t,e){return null===this._factory&&(this._factory=t.getFactory()),t instanceof bt?this.editGeometryCollection(t,e):t instanceof Yt?this.editPolygon(t,e):t instanceof kt?e.edit(t,this._factory):t instanceof Ft?e.edit(t,this._factory):(m.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)}editGeometryCollection(t,e){for(var i=e.edit(t,this._factory),r=new C,n=0;n<i.getNumGeometries();n++){var s=this.edit(i.getGeometryN(n),e);null===s||s.isEmpty()||r.add(s)}return i.getClass()===zt?this._factory.createMultiPoint(r.toArray([])):i.getClass()===It?this._factory.createMultiLineString(r.toArray([])):i.getClass()===qt?this._factory.createMultiPolygon(r.toArray([])):this._factory.createGeometryCollection(r.toArray([]))}editPolygon(t,e){var i=e.edit(t,this._factory);if(null===i&&(i=this._factory.createPolygon()),i.isEmpty())return i;var r=this.edit(i.getExteriorRing(),e);if(null===r||r.isEmpty())return this._factory.createPolygon();for(var n=new C,s=0;s<i.getNumInteriorRing();s++){var o=this.edit(i.getInteriorRingN(s),e);null===o||o.isEmpty()||n.add(o)}return this._factory.createPolygon(r,n.toArray([]))}getClass(){return Ht}get interfaces_(){return[]}}function Vt(){}Ht.GeometryEditorOperation=Vt;class jt{constructor(){jt.constructor_.apply(this,arguments)}edit(t,e){return t}getClass(){return jt}get interfaces_(){return[Vt]}}jt.constructor_=function(){};class Wt{constructor(){Wt.constructor_.apply(this,arguments)}edit(t,e){var i=this.edit(t.getCoordinates(),t);return t instanceof Xt?null===i?e.createLinearRing():e.createLinearRing(i):t instanceof Ft?null===i?e.createLineString():e.createLineString(i):t instanceof kt?null===i||0===i.length?e.createPoint():e.createPoint(i[0]):t}getClass(){return Wt}get interfaces_(){return[Vt]}}Wt.constructor_=function(){};class Kt{constructor(){Kt.constructor_.apply(this,arguments)}edit(t,e){return t instanceof Xt?e.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof Ft?e.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof kt?e.createPoint(this.edit(t.getCoordinateSequence(),t)):t}getClass(){return Kt}get interfaces_(){return[Vt]}}Kt.constructor_=function(){},Ht.NoOpGeometryOperation=jt,Ht.CoordinateOperation=Wt,Ht.CoordinateSequenceOperation=Kt,Ht.constructor_=function(){if(this._factory=null,this._isUserDataCopied=!1,0===arguments.length);else if(1===arguments.length){let t=arguments[0];this._factory=t}};class Zt{constructor(){Zt.constructor_.apply(this,arguments)}setOrdinate(t,e,r){switch(e){case X.X:this._coordinates[t].x=r;break;case X.Y:this._coordinates[t].y=r;break;case X.Z:this._coordinates[t].z=r;break;default:throw new i("invalid ordinateIndex")}}size(){return this._coordinates.length}getOrdinate(t,e){switch(e){case X.X:return this._coordinates[t].x;case X.Y:return this._coordinates[t].y;case X.Z:return this._coordinates[t].z}return n.NaN}getCoordinate(){if(1===arguments.length){let t=arguments[0];return this._coordinates[t]}if(2===arguments.length){let t=arguments[0],e=arguments[1];e.x=this._coordinates[t].x,e.y=this._coordinates[t].y,e.z=this._coordinates[t].z}}getCoordinateCopy(t){return new y(this._coordinates[t])}getDimension(){return this._dimension}getX(t){return this._coordinates[t].x}expandEnvelope(t){for(var e=0;e<this._coordinates.length;e++)t.expandToInclude(this._coordinates[e]);return t}copy(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].copy();return new Zt(t,this._dimension)}toString(){if(this._coordinates.length>0){var t=new Mt(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(var e=1;e<this._coordinates.length;e++)t.append(", "),t.append(this._coordinates[e]);return t.append(")"),t.toString()}return"()"}getY(t){return this._coordinates[t].y}toCoordinateArray(){return this._coordinates}getClass(){return Zt}get interfaces_(){return[X,g]}}Zt.constructor_=function(){if(this._dimension=3,this._coordinates=null,1===arguments.length){if(arguments[0]instanceof Array){let t=arguments[0];Zt.constructor_.call(this,t,3)}else if(Number.isInteger(arguments[0])){let e=arguments[0];this._coordinates=new Array(e).fill(null);for(var t=0;t<e;t++)this._coordinates[t]=new y}else if(x(arguments[0],X)){let e=arguments[0];if(null===e)return this._coordinates=new Array(0).fill(null),null;for(this._dimension=e.getDimension(),this._coordinates=new Array(e.size()).fill(null),t=0;t<this._coordinates.length;t++)this._coordinates[t]=e.getCoordinateCopy(t)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){let t=arguments[0],e=arguments[1];this._coordinates=t,this._dimension=e,null===t&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){let e=arguments[0],i=arguments[1];for(this._coordinates=new Array(e).fill(null),this._dimension=i,t=0;t<e;t++)this._coordinates[t]=new y}},Zt.serialVersionUID=-0xcb44a778db18e00;class Jt{constructor(){Jt.constructor_.apply(this,arguments)}static instance(){return Jt.instanceObject}readResolve(){return Jt.instance()}create(){if(1===arguments.length){if(arguments[0]instanceof Array){let t=arguments[0];return new Zt(t)}if(x(arguments[0],X)){let t=arguments[0];return new Zt(t)}}else if(2===arguments.length){let t=arguments[0],e=arguments[1];return e>3&&(e=3),e<2?new Zt(t):new Zt(t,e)}}getClass(){return Jt}get interfaces_(){return[q,g]}}Jt.constructor_=function(){},Jt.serialVersionUID=-0x38e49fa6cf6f2e00,Jt.instanceObject=new Jt;var Qt=Object.defineProperty,$t=function(t,e){function i(t){if(!this||this.constructor!==i)return new i(t);this._keys=[],this._values=[],this._itp=[],this.objectOnly=e,t&&function(t){this.add?t.forEach(this.add,this):t.forEach(function(t){this.set(t[0],t[1])},this)}.call(this,t)}return e||Qt(t,"size",{get:ee}),t.constructor=i,i.prototype=t,i}({delete:function(t){return this.has(t)&&(this._keys.splice(mt,1),this._values.splice(mt,1),this._itp.forEach(function(t){mt<t[0]&&t[0]--})),mt>-1},has:function(t){return function(t,e){if(this.objectOnly&&e!==Object(e))throw new TypeError("Invalid value used as weak collection key");if(e!=e||0===e)for(mt=t.length;mt--&&(i=t[mt])!==(r=e)&&(i==i||r==r););else mt=t.indexOf(e);var i,r;return mt>-1}.call(this,this._keys,t)},get:function(t){return this.has(t)?this._values[mt]:void 0},set:function(t,e){return this.has(t)?this._values[mt]=e:this._values[this._keys.push(t)-1]=e,this},keys:function(){return te(this._itp,this._keys)},values:function(){return te(this._itp,this._values)},entries:function(){return te(this._itp,this._keys,this._values)},forEach:function(t,e){for(var i=this.entries();;){var r=i.next();if(r.done)break;t.call(e,r.value[1],r.value[0],this)}},clear:function(){(this._keys||0).length=this._values.length=0}});function te(t,e,i){var r=[0],n=!1;return t.push(r),{next:function(){var s,o=r[0];return!n&&o<e.length?(s=i?[e[o],i[o]]:e[o],r[0]++):(n=!0,t.splice(t.indexOf(r),1)),{done:n,value:s}}}}function ee(){return this._values.length}let ie="undefined"!=typeof Map&&Map.prototype.values?Map:$t;function re(){this.map_=new ie}re.prototype=new it,re.prototype.get=function(t){return this.map_.get(t)||null},re.prototype.put=function(t,e){return this.map_.set(t,e),e},re.prototype.values=function(){const t=new C,e=this.map_.values();let i=e.next();for(;!i.done;)t.add(i.value),i=e.next();return t},re.prototype.entrySet=function(){const t=new st;return this.map_.entries().forEach(e=>t.add(e)),t},re.prototype.size=function(){return this.map_.size()};class ne{constructor(){ne.constructor_.apply(this,arguments)}static mostPrecise(t,e){return t.compareTo(e)>=0?t:e}equals(t){if(!(t instanceof ne))return!1;var e=t;return this._modelType===e._modelType&&this._scale===e._scale}compareTo(t){var e=t,i=this.getMaximumSignificantDigits(),r=e.getMaximumSignificantDigits();return new M(i).compareTo(new M(r))}getScale(){return this._scale}isFloating(){return this._modelType===ne.FLOATING||this._modelType===ne.FLOATING_SINGLE}getType(){return this._modelType}toString(){var t="UNKNOWN";return this._modelType===ne.FLOATING?t="Floating":this._modelType===ne.FLOATING_SINGLE?t="Floating-Single":this._modelType===ne.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t}makePrecise(){if("number"==typeof arguments[0]){let t=arguments[0];return n.isNaN(t)?t:this._modelType===ne.FLOATING_SINGLE?t:this._modelType===ne.FIXED?Math.round(t*this._scale)/this._scale:t}if(arguments[0]instanceof y){let t=arguments[0];if(this._modelType===ne.FLOATING)return null;t.x=this.makePrecise(t.x),t.y=this.makePrecise(t.y)}}getMaximumSignificantDigits(){var t=16;return this._modelType===ne.FLOATING?t=16:this._modelType===ne.FLOATING_SINGLE?t=6:this._modelType===ne.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t}setScale(t){this._scale=Math.abs(t)}getClass(){return ne}get interfaces_(){return[g,c]}}class se{constructor(){se.constructor_.apply(this,arguments)}readResolve(){return se.nameToTypeMap.get(this._name)}toString(){return this._name}getClass(){return se}get interfaces_(){return[g]}}se.constructor_=function(){this._name=null;let t=arguments[0];this._name=t,se.nameToTypeMap.put(t,this)},se.serialVersionUID=-552860263173159e4,se.nameToTypeMap=new re,ne.Type=se,ne.constructor_=function(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=ne.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof se){let t=arguments[0];this._modelType=t,t===ne.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){let t=arguments[0];this._modelType=ne.FIXED,this.setScale(t)}else if(arguments[0]instanceof ne){let t=arguments[0];this._modelType=t._modelType,this._scale=t._scale}},ne.serialVersionUID=0x6bee6404e9a25c00,ne.FIXED=new se("FIXED"),ne.FLOATING=new se("FLOATING"),ne.FLOATING_SINGLE=new se("FLOATING SINGLE"),ne.maximumPreciseValue=9007199254740992;class oe{constructor(){oe.constructor_.apply(this,arguments)}static toMultiPolygonArray(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}static toGeometryArray(t){if(null===t)return null;var e=new Array(t.size()).fill(null);return t.toArray(e)}static getDefaultCoordinateSequenceFactory(){return Jt.instance()}static toMultiLineStringArray(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}static toLineStringArray(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}static toMultiPointArray(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}static toLinearRingArray(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}static toPointArray(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}static toPolygonArray(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}static createPointFromInternalCoord(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)}toGeometry(t){return t.isNull()?this.createPoint():t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new y(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new y(t.getMinX(),t.getMinY()),new y(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new y(t.getMinX(),t.getMinY()),new y(t.getMinX(),t.getMaxY()),new y(t.getMaxX(),t.getMaxY()),new y(t.getMaxX(),t.getMinY()),new y(t.getMinX(),t.getMinY())]),null)}createLineString(){if(0===arguments.length)return this.createLineString(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){let t=arguments[0];return this.createLineString(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(x(arguments[0],X)){let t=arguments[0];return new Ft(t,this)}}}createMultiLineString(){if(0===arguments.length)return new It(null,this);if(1===arguments.length){let t=arguments[0];return new It(t,this)}}buildGeometry(t){for(var e=null,i=!1,r=!1,n=t.iterator();n.hasNext();){var s=n.next(),o=s.getClass();null===e&&(e=o),o!==e&&(i=!0),s instanceof bt&&(r=!0)}if(null===e)return this.createGeometryCollection();if(i||r)return this.createGeometryCollection(oe.toGeometryArray(t));var a=t.iterator().next();if(t.size()>1){if(a instanceof Yt)return this.createMultiPolygon(oe.toPolygonArray(t));if(a instanceof Ft)return this.createMultiLineString(oe.toLineStringArray(t));if(a instanceof kt)return this.createMultiPoint(oe.toPointArray(t));m.shouldNeverReachHere("Unhandled class: "+a.getClass().getName())}return a}createMultiPointFromCoords(t){return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)}createPoint(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof y){let t=arguments[0];return this.createPoint(null!==t?this.getCoordinateSequenceFactory().create([t]):null)}if(x(arguments[0],X)){let t=arguments[0];return new kt(t,this)}}}getCoordinateSequenceFactory(){return this._coordinateSequenceFactory}createPolygon(){if(0===arguments.length)return this.createPolygon(null,null);if(1===arguments.length){if(x(arguments[0],X)){let t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){let t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Xt){let t=arguments[0];return this.createPolygon(t,null)}}else if(2===arguments.length){let t=arguments[0],e=arguments[1];return new Yt(t,e,this)}}getSRID(){return this._SRID}createGeometryCollection(){if(0===arguments.length)return new bt(null,this);if(1===arguments.length){let t=arguments[0];return new bt(t,this)}}createGeometry(t){return new Ht(this).edit(t,new ae(this._coordinateSequenceFactory))}getPrecisionModel(){return this._precisionModel}createLinearRing(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){let t=arguments[0];return this.createLinearRing(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(x(arguments[0],X)){let t=arguments[0];return new Xt(t,this)}}}createMultiPolygon(){if(0===arguments.length)return new qt(null,this);if(1===arguments.length){let t=arguments[0];return new qt(t,this)}}createMultiPoint(){if(0===arguments.length)return new zt(null,this);if(1===arguments.length){if(arguments[0]instanceof Array){let t=arguments[0];return new zt(t,this)}if(x(arguments[0],X)){let r=arguments[0];if(null===r)return this.createMultiPoint(new Array(0).fill(null));for(var t=new Array(r.size()).fill(null),e=0;e<r.size();e++){var i=this.getCoordinateSequenceFactory().create(1,r.getDimension());Dt.copy(r,e,i,0,1),t[e]=this.createPoint(i)}return this.createMultiPoint(t)}}}getClass(){return oe}get interfaces_(){return[g]}}class ae extends Ht.CoordinateSequenceOperation{constructor(){super(),ae.constructor_.apply(this,arguments)}edit(){if(2===arguments.length&&arguments[1]instanceof V&&x(arguments[0],X)){let t=arguments[0];return this.coordinateSequenceFactory.create(t)}return super.edit.apply(this,arguments)}getClass(){return ae}get interfaces_(){return[]}}ae.constructor_=function(){this.coordinateSequenceFactory=null;let t=arguments[0];this.coordinateSequenceFactory=t},oe.CloneOp=ae,oe.constructor_=function(){if(this._precisionModel=null,this._coordinateSequenceFactory=null,this._SRID=null,0===arguments.length)oe.constructor_.call(this,new ne,0);else if(1===arguments.length){if(x(arguments[0],q)){let t=arguments[0];oe.constructor_.call(this,new ne,0,t)}else if(arguments[0]instanceof ne){let t=arguments[0];oe.constructor_.call(this,t,0,oe.getDefaultCoordinateSequenceFactory())}}else if(2===arguments.length){let t=arguments[0],e=arguments[1];oe.constructor_.call(this,t,e,oe.getDefaultCoordinateSequenceFactory())}else if(3===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2];this._precisionModel=t,this._coordinateSequenceFactory=i,this._SRID=e}},oe.serialVersionUID=-0x5ea75f2051eeb400;const he={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/};class le{constructor(t){this.geometryFactory=t||new oe,this.precisionModel=this.geometryFactory.getPrecisionModel()}read(t){var e,i,r;t=t.replace(/[\n\r]/g," ");var n=he.typeStr.exec(t);if(-1!==t.search("EMPTY")&&((n=he.emptyTypeStr.exec(t))[2]=void 0),n&&(i=n[1].toLowerCase(),r=n[2],ce[i]&&(e=ce[i].call(this,r))),void 0===e)throw new Error("Could not parse WKT "+t);return e}write(t){return this.extractGeometry(t)}extractGeometry(t){var e=t.getGeometryType().toLowerCase();if(!ue[e])return null;var i=e.toUpperCase();return t.isEmpty()?i+" EMPTY":i+"("+ue[e].call(this,t)+")"}}const ue={coordinate(t){return this.precisionModel.makePrecise(t),t.x+" "+t.y},point(t){return ue.coordinate.call(this,t._coordinates._coordinates[0])},multipoint(t){var e=[];for(let i=0,r=t._geometries.length;i<r;++i)e.push("("+ue.point.call(this,t._geometries[i])+")");return e.join(",")},linestring(t){var e=[];for(let i=0,r=t._points._coordinates.length;i<r;++i)e.push(ue.coordinate.call(this,t._points._coordinates[i]));return e.join(",")},linearring(t){var e=[];for(let i=0,r=t._points._coordinates.length;i<r;++i)e.push(ue.coordinate.call(this,t._points._coordinates[i]));return e.join(",")},multilinestring(t){var e=[];for(let i=0,r=t._geometries.length;i<r;++i)e.push("("+ue.linestring.call(this,t._geometries[i])+")");return e.join(",")},polygon(t){var e=[];e.push("("+ue.linestring.call(this,t._shell)+")");for(let i=0,r=t._holes.length;i<r;++i)e.push("("+ue.linestring.call(this,t._holes[i])+")");return e.join(",")},multipolygon(t){var e=[];for(let i=0,r=t._geometries.length;i<r;++i)e.push("("+ue.polygon.call(this,t._geometries[i])+")");return e.join(",")},geometrycollection(t){var e=[];for(let i=0,r=t._geometries.length;i<r;++i)e.push(this.extractGeometry(t._geometries[i]));return e.join(",")}},ce={coord(t){var e=t.trim().split(he.spaces),i=new y(Number.parseFloat(e[0]),Number.parseFloat(e[1]));return this.precisionModel.makePrecise(i),i},point(t){return void 0===t?this.geometryFactory.createPoint():this.geometryFactory.createPoint(ce.coord.call(this,t))},multipoint(t){if(void 0===t)return this.geometryFactory.createMultiPoint();var e,i=t.trim().split(","),r=[];for(let t=0,n=i.length;t<n;++t)e=i[t].replace(he.trimParens,"$1"),r.push(ce.point.call(this,e));return this.geometryFactory.createMultiPoint(r)},linestring(t){if(void 0===t)return this.geometryFactory.createLineString();var e=t.trim().split(","),i=[];for(let t=0,r=e.length;t<r;++t)i.push(ce.coord.call(this,e[t]));return this.geometryFactory.createLineString(i)},linearring(t){if(void 0===t)return this.geometryFactory.createLinearRing();var e=t.trim().split(","),i=[];for(let t=0,r=e.length;t<r;++t)i.push(ce.coord.call(this,e[t]));return this.geometryFactory.createLinearRing(i)},multilinestring(t){if(void 0===t)return this.geometryFactory.createMultiLineString();var e,i=t.trim().split(he.parenComma),r=[];for(let t=0,n=i.length;t<n;++t)e=i[t].replace(he.trimParens,"$1"),r.push(ce.linestring.call(this,e));return this.geometryFactory.createMultiLineString(r)},polygon(t){if(void 0===t)return this.geometryFactory.createPolygon();var e,i,r,n,s=t.trim().split(he.parenComma),o=[];for(let t=0,a=s.length;t<a;++t)e=s[t].replace(he.trimParens,"$1"),i=ce.linestring.call(this,e),r=this.geometryFactory.createLinearRing(i._points),0===t?n=r:o.push(r);return this.geometryFactory.createPolygon(n,o)},multipolygon(t){if(void 0===t)return this.geometryFactory.createMultiPolygon();var e,i=t.trim().split(he.doubleParenComma),r=[];for(let t=0,n=i.length;t<n;++t)e=i[t].replace(he.trimParens,"$1"),r.push(ce.polygon.call(this,e));return this.geometryFactory.createMultiPolygon(r)},geometrycollection(t){if(void 0===t)return this.geometryFactory.createGeometryCollection();var e=(t=t.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),i=[];for(let t=0,r=e.length;t<r;++t)i.push(this.read(e[t]));return this.geometryFactory.createGeometryCollection(i)}};class de{constructor(t){this.parser=new le(t)}write(t){return this.parser.write(t)}static toLineString(t,e){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"}}class pe{constructor(){pe.constructor_.apply(this,arguments)}static computeEdgeDistance(t,e,i){var r=Math.abs(i.x-e.x),n=Math.abs(i.y-e.y),s=-1;if(t.equals(e))s=0;else if(t.equals(i))s=r>n?r:n;else{var o=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y);0!==(s=r>n?o:a)||t.equals(e)||(s=Math.max(o,a))}return m.isTrue(!(0===s&&!t.equals(e)),"Bad distance calculation"),s}static nonRobustComputeEdgeDistance(t,e,i){var r=t.x-e.x,n=t.y-e.y,s=Math.sqrt(r*r+n*n);return m.isTrue(!(0===s&&!t.equals(e)),"Invalid distance calculation"),s}getIndexAlongSegment(t,e){return this.computeIntLineIndex(),this._intLineIndex[t][e]}getTopologySummary(){var t=new Mt;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()}computeIntersection(t,e,i,r){this._inputLines[0][0]=t,this._inputLines[0][1]=e,this._inputLines[1][0]=i,this._inputLines[1][1]=r,this._result=this.computeIntersect(t,e,i,r)}getIntersectionNum(){return this._result}computeIntLineIndex(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map(()=>Array(2)),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){let t=arguments[0];this.getEdgeDistance(t,0)>this.getEdgeDistance(t,1)?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}}isProper(){return this.hasIntersection()&&this._isProper}setPrecisionModel(t){this._precisionModel=t}isInteriorIntersection(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){let e=arguments[0];for(var t=0;t<this._result;t++)if(!this._intPt[t].equals2D(this._inputLines[e][0])&&!this._intPt[t].equals2D(this._inputLines[e][1]))return!0;return!1}}getIntersection(t){return this._intPt[t]}isEndPoint(){return this.hasIntersection()&&!this._isProper}hasIntersection(){return this._result!==pe.NO_INTERSECTION}getEdgeDistance(t,e){return pe.computeEdgeDistance(this._intPt[e],this._inputLines[t][0],this._inputLines[t][1])}isCollinear(){return this._result===pe.COLLINEAR_INTERSECTION}toString(){return de.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+de.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()}getEndpoint(t,e){return this._inputLines[t][e]}isIntersection(t){for(var e=0;e<this._result;e++)if(this._intPt[e].equals2D(t))return!0;return!1}getIntersectionAlongSegment(t,e){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][e]]}getClass(){return pe}get interfaces_(){return[]}}pe.constructor_=function(){this._result=null,this._inputLines=Array(2).fill().map(()=>Array(2)),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new y,this._intPt[1]=new y,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},pe.DONT_INTERSECT=0,pe.DO_INTERSECT=1,pe.COLLINEAR=2,pe.NO_INTERSECTION=0,pe.POINT_INTERSECTION=1,pe.COLLINEAR_INTERSECTION=2;class ge extends pe{constructor(){super(),ge.constructor_.apply(this,arguments)}static nearestEndpoint(t,e,i,r){var n=t,s=z.pointToSegment(t,i,r),o=z.pointToSegment(e,i,r);return o<s&&(s=o,n=e),(o=z.pointToSegment(i,t,e))<s&&(s=o,n=i),(o=z.pointToSegment(r,t,e))<s&&(s=o,n=r),n}isInSegmentEnvelopes(t){var e=new P(this._inputLines[0][0],this._inputLines[0][1]),i=new P(this._inputLines[1][0],this._inputLines[1][1]);return e.contains(t)&&i.contains(t)}computeIntersection(){if(3!==arguments.length)return super.computeIntersection.apply(this,arguments);{let t=arguments[0],e=arguments[1],i=arguments[2];if(this._isProper=!1,P.intersects(e,i,t)&&0===k.index(e,i,t)&&0===k.index(i,e,t))return this._isProper=!0,(t.equals(e)||t.equals(i))&&(this._isProper=!1),this._result=pe.POINT_INTERSECTION,null;this._result=pe.NO_INTERSECTION}}normalizeToMinimum(t,e,i,r,n){n.x=this.smallestInAbsValue(t.x,e.x,i.x,r.x),n.y=this.smallestInAbsValue(t.y,e.y,i.y,r.y),t.x-=n.x,t.y-=n.y,e.x-=n.x,e.y-=n.y,i.x-=n.x,i.y-=n.y,r.x-=n.x,r.y-=n.y}safeHCoordinateIntersection(t,e,i,r){var n=null;try{n=U.intersection(t,e,i,r)}catch(s){if(!(s instanceof A))throw s;n=ge.nearestEndpoint(t,e,i,r)}return n}intersection(t,e,i,r){var n=this.intersectionWithNormalization(t,e,i,r);return this.isInSegmentEnvelopes(n)||(n=new y(ge.nearestEndpoint(t,e,i,r))),null!==this._precisionModel&&this._precisionModel.makePrecise(n),n}smallestInAbsValue(t,e,i,r){var n=t,s=Math.abs(n);return Math.abs(e)<s&&(n=e,s=Math.abs(e)),Math.abs(i)<s&&(n=i,s=Math.abs(i)),Math.abs(r)<s&&(n=r),n}checkDD(t,e,i,r,n){var s=B.intersection(t,e,i,r),o=this.isInSegmentEnvelopes(s);G.out.println("DD in env = "+o+"  --------------------- "+s),n.distance(s)>1e-4&&G.out.println("Distance = "+n.distance(s))}intersectionWithNormalization(t,e,i,r){var n=new y(t),s=new y(e),o=new y(i),a=new y(r),h=new y;this.normalizeToEnvCentre(n,s,o,a,h);var l=this.safeHCoordinateIntersection(n,s,o,a);return l.x+=h.x,l.y+=h.y,l}computeCollinearIntersection(t,e,i,r){var n=P.intersects(t,e,i),s=P.intersects(t,e,r),o=P.intersects(i,r,t),a=P.intersects(i,r,e);return n&&s?(this._intPt[0]=i,this._intPt[1]=r,pe.COLLINEAR_INTERSECTION):o&&a?(this._intPt[0]=t,this._intPt[1]=e,pe.COLLINEAR_INTERSECTION):n&&o?(this._intPt[0]=i,this._intPt[1]=t,!i.equals(t)||s||a?pe.COLLINEAR_INTERSECTION:pe.POINT_INTERSECTION):n&&a?(this._intPt[0]=i,this._intPt[1]=e,!i.equals(e)||s||o?pe.COLLINEAR_INTERSECTION:pe.POINT_INTERSECTION):s&&o?(this._intPt[0]=r,this._intPt[1]=t,!r.equals(t)||n||a?pe.COLLINEAR_INTERSECTION:pe.POINT_INTERSECTION):s&&a?(this._intPt[0]=r,this._intPt[1]=e,!r.equals(e)||n||o?pe.COLLINEAR_INTERSECTION:pe.POINT_INTERSECTION):pe.NO_INTERSECTION}normalizeToEnvCentre(t,e,i,r,n){var s=t.x<e.x?t.x:e.x,o=t.y<e.y?t.y:e.y,a=t.x>e.x?t.x:e.x,h=t.y>e.y?t.y:e.y,l=i.x<r.x?i.x:r.x,u=i.y<r.y?i.y:r.y,c=i.x>r.x?i.x:r.x,d=i.y>r.y?i.y:r.y,p=((s>l?s:l)+(a<c?a:c))/2,g=((o>u?o:u)+(h<d?h:d))/2;n.x=p,n.y=g,t.x-=n.x,t.y-=n.y,e.x-=n.x,e.y-=n.y,i.x-=n.x,i.y-=n.y,r.x-=n.x,r.y-=n.y}computeIntersect(t,e,i,r){if(this._isProper=!1,!P.intersects(t,e,i,r))return pe.NO_INTERSECTION;var n=k.index(t,e,i),s=k.index(t,e,r);if(n>0&&s>0||n<0&&s<0)return pe.NO_INTERSECTION;var o=k.index(i,r,t),a=k.index(i,r,e);return o>0&&a>0||o<0&&a<0?pe.NO_INTERSECTION:0===n&&0===s&&0===o&&0===a?this.computeCollinearIntersection(t,e,i,r):(0===n||0===s||0===o||0===a?(this._isProper=!1,t.equals2D(i)||t.equals2D(r)?this._intPt[0]=t:e.equals2D(i)||e.equals2D(r)?this._intPt[0]=e:0===n?this._intPt[0]=new y(i):0===s?this._intPt[0]=new y(r):0===o?this._intPt[0]=new y(t):0===a&&(this._intPt[0]=new y(e))):(this._isProper=!0,this._intPt[0]=this.intersection(t,e,i,r)),pe.POINT_INTERSECTION)}getClass(){return ge}get interfaces_(){return[]}}ge.constructor_=function(){};class fe{constructor(){fe.constructor_.apply(this,arguments)}static midPoint(t,e){return new y((t.x+e.x)/2,(t.y+e.y)/2)}minX(){return Math.min(this.p0.x,this.p1.x)}orientationIndex(){if(arguments[0]instanceof fe){let i=arguments[0];var t=k.index(this.p0,this.p1,i.p0),e=k.index(this.p0,this.p1,i.p1);return t>=0&&e>=0?Math.max(t,e):t<=0&&e<=0?Math.max(t,e):0}if(arguments[0]instanceof y){let t=arguments[0];return k.index(this.p0,this.p1,t)}}toGeometry(t){return t.createLineString([this.p0,this.p1])}isVertical(){return this.p0.x===this.p1.x}equals(t){if(!(t instanceof fe))return!1;var e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)}intersection(t){var e=new ge;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null}project(){if(arguments[0]instanceof y){let i=arguments[0];if(i.equals(this.p0)||i.equals(this.p1))return new y(i);var t=this.projectionFactor(i),e=new y;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e}if(arguments[0]instanceof fe){let t=arguments[0];var i=this.projectionFactor(t.p0),r=this.projectionFactor(t.p1);if(i>=1&&r>=1)return null;if(i<=0&&r<=0)return null;var n=this.project(t.p0);i<0&&(n=this.p0),i>1&&(n=this.p1);var s=this.project(t.p1);return r<0&&(s=this.p0),r>1&&(s=this.p1),new fe(n,s)}}normalize(){this.p1.compareTo(this.p0)<0&&this.reverse()}angle(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)}getCoordinate(t){return 0===t?this.p0:this.p1}distancePerpendicular(t){return z.pointToLinePerpendicular(t,this.p0,this.p1)}minY(){return Math.min(this.p0.y,this.p1.y)}midPoint(){return fe.midPoint(this.p0,this.p1)}projectionFactor(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,i=this.p1.y-this.p0.y,r=e*e+i*i;return r<=0?n.NaN:((t.x-this.p0.x)*e+(t.y-this.p0.y)*i)/r}closestPoints(t){var e=this.intersection(t);if(null!==e)return[e,e];var i=new Array(2).fill(null),r=n.MAX_VALUE,s=null,o=this.closestPoint(t.p0);r=o.distance(t.p0),i[0]=o,i[1]=t.p0;var a=this.closestPoint(t.p1);(s=a.distance(t.p1))<r&&(r=s,i[0]=a,i[1]=t.p1);var h=t.closestPoint(this.p0);(s=h.distance(this.p0))<r&&(r=s,i[0]=this.p0,i[1]=h);var l=t.closestPoint(this.p1);return(s=l.distance(this.p1))<r&&(r=s,i[0]=this.p1,i[1]=l),i}closestPoint(t){var e=this.projectionFactor(t);return e>0&&e<1?this.project(t):this.p0.distance(t)<this.p1.distance(t)?this.p0:this.p1}maxX(){return Math.max(this.p0.x,this.p1.x)}getLength(){return this.p0.distance(this.p1)}compareTo(t){var e=t,i=this.p0.compareTo(e.p0);return 0!==i?i:this.p1.compareTo(e.p1)}reverse(){var t=this.p0;this.p0=this.p1,this.p1=t}equalsTopo(t){return this.p0.equals(t.p0)&&this.p1.equals(t.p1)||this.p0.equals(t.p1)&&this.p1.equals(t.p0)}lineIntersection(t){try{return U.intersection(this.p0,this.p1,t.p0,t.p1)}catch(t){if(!(t instanceof A))throw t}return null}maxY(){return Math.max(this.p0.y,this.p1.y)}pointAlongOffset(t,e){var i=this.p0.x+t*(this.p1.x-this.p0.x),r=this.p0.y+t*(this.p1.y-this.p0.y),n=this.p1.x-this.p0.x,s=this.p1.y-this.p0.y,o=Math.sqrt(n*n+s*s),a=0,h=0;if(0!==e){if(o<=0)throw new IllegalStateException("Cannot compute offset from zero-length line segment");a=e*n/o,h=e*s/o}return new y(i-h,r+a)}setCoordinates(){if(1===arguments.length){let t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this.p0.x=t.x,this.p0.y=t.y,this.p1.x=e.x,this.p1.y=e.y}}segmentFraction(t){var e=this.projectionFactor(t);return e<0?e=0:(e>1||n.isNaN(e))&&(e=1),e}toString(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"}isHorizontal(){return this.p0.y===this.p1.y}distance(){if(arguments[0]instanceof fe){let t=arguments[0];return z.segmentToSegment(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof y){let t=arguments[0];return z.pointToSegment(t,this.p0,this.p1)}}pointAlong(t){var e=new y;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e}hashCode(){var t=java.lang.Double.doubleToLongBits(this.p0.x);t^=31*java.lang.Double.doubleToLongBits(this.p0.y);var e=Math.trunc(t)^Math.trunc(t>>32),i=java.lang.Double.doubleToLongBits(this.p1.x);return i^=31*java.lang.Double.doubleToLongBits(this.p1.y),e^Math.trunc(i)^Math.trunc(i>>32)}getClass(){return fe}get interfaces_(){return[c,g]}}fe.constructor_=function(){if(this.p0=null,this.p1=null,0===arguments.length)fe.constructor_.call(this,new y,new y);else if(1===arguments.length){let t=arguments[0];fe.constructor_.call(this,t.p0,t.p1)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this.p0=t,this.p1=e}else if(4===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2],r=arguments[3];fe.constructor_.call(this,new y(t,e),new y(i,r))}},fe.serialVersionUID=0x2d2172135f411c00;class _e{constructor(){_e.constructor_.apply(this,arguments)}static toLocationSymbol(t){switch(t){case _e.EXTERIOR:return"e";case _e.BOUNDARY:return"b";case _e.INTERIOR:return"i";case _e.NONE:return"-"}throw new i("Unknown location value: "+t)}getClass(){return _e}get interfaces_(){return[]}}_e.constructor_=function(){},_e.INTERIOR=0,_e.BOUNDARY=1,_e.EXTERIOR=2,_e.NONE=-1;class me{constructor(){me.constructor_.apply(this,arguments)}static matches(){if(Number.isInteger(arguments[0])&&"string"==typeof arguments[1]){let t=arguments[0],e=arguments[1];return e===xt.SYM_DONTCARE||e===xt.SYM_TRUE&&(t>=0||t===xt.TRUE)||e===xt.SYM_FALSE&&t===xt.FALSE||e===xt.SYM_P&&t===xt.P||e===xt.SYM_L&&t===xt.L||e===xt.SYM_A&&t===xt.A}if("string"==typeof arguments[0]&&"string"==typeof arguments[1]){let t=arguments[0],e=arguments[1];return new me(t).matches(e)}}static isTrue(t){return t>=0||t===xt.TRUE}isIntersects(){return!this.isDisjoint()}isCovers(){return(me.isTrue(this._matrix[_e.INTERIOR][_e.INTERIOR])||me.isTrue(this._matrix[_e.INTERIOR][_e.BOUNDARY])||me.isTrue(this._matrix[_e.BOUNDARY][_e.INTERIOR])||me.isTrue(this._matrix[_e.BOUNDARY][_e.BOUNDARY]))&&this._matrix[_e.EXTERIOR][_e.INTERIOR]===xt.FALSE&&this._matrix[_e.EXTERIOR][_e.BOUNDARY]===xt.FALSE}isCoveredBy(){return(me.isTrue(this._matrix[_e.INTERIOR][_e.INTERIOR])||me.isTrue(this._matrix[_e.INTERIOR][_e.BOUNDARY])||me.isTrue(this._matrix[_e.BOUNDARY][_e.INTERIOR])||me.isTrue(this._matrix[_e.BOUNDARY][_e.BOUNDARY]))&&this._matrix[_e.INTERIOR][_e.EXTERIOR]===xt.FALSE&&this._matrix[_e.BOUNDARY][_e.EXTERIOR]===xt.FALSE}set(){if(1===arguments.length){let r=arguments[0];for(var t=0;t<r.length;t++){var e=Math.trunc(t/3),i=t%3;this._matrix[e][i]=xt.toDimensionValue(r.charAt(t))}}else if(3===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2];this._matrix[t][e]=i}}isContains(){return me.isTrue(this._matrix[_e.INTERIOR][_e.INTERIOR])&&this._matrix[_e.EXTERIOR][_e.INTERIOR]===xt.FALSE&&this._matrix[_e.EXTERIOR][_e.BOUNDARY]===xt.FALSE}setAtLeast(){if(1===arguments.length){let r=arguments[0];for(var t=0;t<r.length;t++){var e=Math.trunc(t/3),i=t%3;this.setAtLeast(e,i,xt.toDimensionValue(r.charAt(t)))}}else if(3===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2];this._matrix[t][e]<i&&(this._matrix[t][e]=i)}}setAtLeastIfValid(t,e,i){t>=0&&e>=0&&this.setAtLeast(t,e,i)}isWithin(){return me.isTrue(this._matrix[_e.INTERIOR][_e.INTERIOR])&&this._matrix[_e.INTERIOR][_e.EXTERIOR]===xt.FALSE&&this._matrix[_e.BOUNDARY][_e.EXTERIOR]===xt.FALSE}isTouches(t,e){return t>e?this.isTouches(e,t):(t===xt.A&&e===xt.A||t===xt.L&&e===xt.L||t===xt.L&&e===xt.A||t===xt.P&&e===xt.A||t===xt.P&&e===xt.L)&&this._matrix[_e.INTERIOR][_e.INTERIOR]===xt.FALSE&&(me.isTrue(this._matrix[_e.INTERIOR][_e.BOUNDARY])||me.isTrue(this._matrix[_e.BOUNDARY][_e.INTERIOR])||me.isTrue(this._matrix[_e.BOUNDARY][_e.BOUNDARY]))}isOverlaps(t,e){return t===xt.P&&e===xt.P||t===xt.A&&e===xt.A?me.isTrue(this._matrix[_e.INTERIOR][_e.INTERIOR])&&me.isTrue(this._matrix[_e.INTERIOR][_e.EXTERIOR])&&me.isTrue(this._matrix[_e.EXTERIOR][_e.INTERIOR]):t===xt.L&&e===xt.L&&1===this._matrix[_e.INTERIOR][_e.INTERIOR]&&me.isTrue(this._matrix[_e.INTERIOR][_e.EXTERIOR])&&me.isTrue(this._matrix[_e.EXTERIOR][_e.INTERIOR])}isEquals(t,e){return t===e&&me.isTrue(this._matrix[_e.INTERIOR][_e.INTERIOR])&&this._matrix[_e.INTERIOR][_e.EXTERIOR]===xt.FALSE&&this._matrix[_e.BOUNDARY][_e.EXTERIOR]===xt.FALSE&&this._matrix[_e.EXTERIOR][_e.INTERIOR]===xt.FALSE&&this._matrix[_e.EXTERIOR][_e.BOUNDARY]===xt.FALSE}toString(){for(var t=new Mt("123456789"),e=0;e<3;e++)for(var i=0;i<3;i++)t.setCharAt(3*e+i,xt.toDimensionSymbol(this._matrix[e][i]));return t.toString()}setAll(t){for(var e=0;e<3;e++)for(var i=0;i<3;i++)this._matrix[e][i]=t}get(t,e){return this._matrix[t][e]}transpose(){var t=this._matrix[1][0];return this._matrix[1][0]=this._matrix[0][1],this._matrix[0][1]=t,t=this._matrix[2][0],this._matrix[2][0]=this._matrix[0][2],this._matrix[0][2]=t,t=this._matrix[2][1],this._matrix[2][1]=this._matrix[1][2],this._matrix[1][2]=t,this}matches(t){if(9!==t.length)throw new i("Should be length 9: "+t);for(var e=0;e<3;e++)for(var r=0;r<3;r++)if(!me.matches(this._matrix[e][r],t.charAt(3*e+r)))return!1;return!0}add(t){for(var e=0;e<3;e++)for(var i=0;i<3;i++)this.setAtLeast(e,i,t.get(e,i))}isDisjoint(){return this._matrix[_e.INTERIOR][_e.INTERIOR]===xt.FALSE&&this._matrix[_e.INTERIOR][_e.BOUNDARY]===xt.FALSE&&this._matrix[_e.BOUNDARY][_e.INTERIOR]===xt.FALSE&&this._matrix[_e.BOUNDARY][_e.BOUNDARY]===xt.FALSE}isCrosses(t,e){return t===xt.P&&e===xt.L||t===xt.P&&e===xt.A||t===xt.L&&e===xt.A?me.isTrue(this._matrix[_e.INTERIOR][_e.INTERIOR])&&me.isTrue(this._matrix[_e.INTERIOR][_e.EXTERIOR]):t===xt.L&&e===xt.P||t===xt.A&&e===xt.P||t===xt.A&&e===xt.L?me.isTrue(this._matrix[_e.INTERIOR][_e.INTERIOR])&&me.isTrue(this._matrix[_e.EXTERIOR][_e.INTERIOR]):t===xt.L&&e===xt.L&&0===this._matrix[_e.INTERIOR][_e.INTERIOR]}getClass(){return me}get interfaces_(){return[d]}}me.constructor_=function(){if(this._matrix=null,0===arguments.length)this._matrix=Array(3).fill().map(()=>Array(3)),this.setAll(xt.FALSE);else if(1===arguments.length)if("string"==typeof arguments[0]){let t=arguments[0];me.constructor_.call(this),this.set(t)}else if(arguments[0]instanceof me){let t=arguments[0];me.constructor_.call(this),this._matrix[_e.INTERIOR][_e.INTERIOR]=t._matrix[_e.INTERIOR][_e.INTERIOR],this._matrix[_e.INTERIOR][_e.BOUNDARY]=t._matrix[_e.INTERIOR][_e.BOUNDARY],this._matrix[_e.INTERIOR][_e.EXTERIOR]=t._matrix[_e.INTERIOR][_e.EXTERIOR],this._matrix[_e.BOUNDARY][_e.INTERIOR]=t._matrix[_e.BOUNDARY][_e.INTERIOR],this._matrix[_e.BOUNDARY][_e.BOUNDARY]=t._matrix[_e.BOUNDARY][_e.BOUNDARY],this._matrix[_e.BOUNDARY][_e.EXTERIOR]=t._matrix[_e.BOUNDARY][_e.EXTERIOR],this._matrix[_e.EXTERIOR][_e.INTERIOR]=t._matrix[_e.EXTERIOR][_e.INTERIOR],this._matrix[_e.EXTERIOR][_e.BOUNDARY]=t._matrix[_e.EXTERIOR][_e.BOUNDARY],this._matrix[_e.EXTERIOR][_e.EXTERIOR]=t._matrix[_e.EXTERIOR][_e.EXTERIOR]}};class ye{constructor(){ye.constructor_.apply(this,arguments)}static toDegrees(t){return 180*t/Math.PI}static normalize(t){for(;t>Math.PI;)t-=ye.PI_TIMES_2;for(;t<=-Math.PI;)t+=ye.PI_TIMES_2;return t}static angle(){if(1===arguments.length){let t=arguments[0];return Math.atan2(t.y,t.x)}if(2===arguments.length){let i=arguments[0],r=arguments[1];var t=r.x-i.x,e=r.y-i.y;return Math.atan2(e,t)}}static isAcute(t,e,i){var r=t.x-e.x,n=t.y-e.y;return r*(i.x-e.x)+n*(i.y-e.y)>0}static isObtuse(t,e,i){var r=t.x-e.x,n=t.y-e.y;return r*(i.x-e.x)+n*(i.y-e.y)<0}static interiorAngle(t,e,i){var r=ye.angle(e,t),n=ye.angle(e,i);return Math.abs(n-r)}static normalizePositive(t){if(t<0){for(;t<0;)t+=ye.PI_TIMES_2;t>=ye.PI_TIMES_2&&(t=0)}else{for(;t>=ye.PI_TIMES_2;)t-=ye.PI_TIMES_2;t<0&&(t=0)}return t}static angleBetween(t,e,i){var r=ye.angle(e,t),n=ye.angle(e,i);return ye.diff(r,n)}static diff(t,e){var i=null;return(i=t<e?e-t:t-e)>Math.PI&&(i=2*Math.PI-i),i}static toRadians(t){return t*Math.PI/180}static getTurn(t,e){var i=Math.sin(e-t);return i>0?ye.COUNTERCLOCKWISE:i<0?ye.CLOCKWISE:ye.NONE}static angleBetweenOriented(t,e,i){var r=ye.angle(e,t),n=ye.angle(e,i)-r;return n<=-Math.PI?n+ye.PI_TIMES_2:n>Math.PI?n-ye.PI_TIMES_2:n}getClass(){return ye}get interfaces_(){return[]}}ye.constructor_=function(){},ye.PI_TIMES_2=2*Math.PI,ye.PI_OVER_2=Math.PI/2,ye.PI_OVER_4=Math.PI/4,ye.COUNTERCLOCKWISE=k.COUNTERCLOCKWISE,ye.CLOCKWISE=k.CLOCKWISE,ye.NONE=k.COLLINEAR;class ve{constructor(){ve.constructor_.apply(this,arguments)}static area(t,e,i){return Math.abs(((i.x-t.x)*(e.y-t.y)-(e.x-t.x)*(i.y-t.y))/2)}static signedArea(t,e,i){return((i.x-t.x)*(e.y-t.y)-(e.x-t.x)*(i.y-t.y))/2}static det(t,e,i,r){return t*r-e*i}static interpolateZ(t,e,i,r){var n=e.x,s=e.y,o=i.x-n,a=r.x-n,h=i.y-s,l=r.y-s,u=o*l-a*h,c=t.x-n,d=t.y-s,p=(l*c-a*d)/u,g=(-h*c+o*d)/u;return e.z+p*(i.z-e.z)+g*(r.z-e.z)}static longestSideLength(t,e,i){var r=t.distance(e),n=e.distance(i),s=i.distance(t),o=r;return n>o&&(o=n),s>o&&(o=s),o}static isAcute(t,e,i){return!!ye.isAcute(t,e,i)&&!!ye.isAcute(e,i,t)&&!!ye.isAcute(i,t,e)}static circumcentre(t,e,i){var r=i.x,n=i.y,s=t.x-r,o=t.y-n,a=e.x-r,h=e.y-n,l=2*ve.det(s,o,a,h),u=ve.det(o,s*s+o*o,h,a*a+h*h),c=ve.det(s,s*s+o*o,a,a*a+h*h);return new y(r-u/l,n+c/l)}static perpendicularBisector(t,e){var i=e.x-t.x,r=e.y-t.y,n=new U(t.x+i/2,t.y+r/2,1),s=new U(t.x-r+i/2,t.y+i+r/2,1);return new U(n,s)}static angleBisector(t,e,i){var r=e.distance(t),n=r/(r+e.distance(i)),s=i.x-t.x,o=i.y-t.y;return new y(t.x+n*s,t.y+n*o)}static area3D(t,e,i){var r=e.x-t.x,n=e.y-t.y,s=e.z-t.z,o=i.x-t.x,a=i.y-t.y,h=i.z-t.z,l=n*h-s*a,u=s*o-r*h,c=r*a-n*o,d=l*l+u*u+c*c;return Math.sqrt(d)/2}static centroid(t,e,i){var r=(t.x+e.x+i.x)/3,n=(t.y+e.y+i.y)/3;return new y(r,n)}static inCentre(t,e,i){var r=e.distance(i),n=t.distance(i),s=t.distance(e),o=r+n+s,a=(r*t.x+n*e.x+s*i.x)/o,h=(r*t.y+n*e.y+s*i.y)/o;return new y(a,h)}area(){return ve.area(this.p0,this.p1,this.p2)}signedArea(){return ve.signedArea(this.p0,this.p1,this.p2)}interpolateZ(t){if(null===t)throw new i("Supplied point is null.");return ve.interpolateZ(t,this.p0,this.p1,this.p2)}longestSideLength(){return ve.longestSideLength(this.p0,this.p1,this.p2)}isAcute(){return ve.isAcute(this.p0,this.p1,this.p2)}circumcentre(){return ve.circumcentre(this.p0,this.p1,this.p2)}area3D(){return ve.area3D(this.p0,this.p1,this.p2)}centroid(){return ve.centroid(this.p0,this.p1,this.p2)}inCentre(){return ve.inCentre(this.p0,this.p1,this.p2)}getClass(){return ve}get interfaces_(){return[]}}ve.constructor_=function(){this.p0=null,this.p1=null,this.p2=null;let t=arguments[0],e=arguments[1],i=arguments[2];this.p0=t,this.p1=e,this.p2=i};var xe=Object.freeze({Coordinate:y,CoordinateList:O,Envelope:P,LineSegment:fe,GeometryFactory:oe,Geometry:V,Point:kt,LineString:Ft,LinearRing:Xt,Polygon:Yt,GeometryCollection:bt,MultiPoint:zt,MultiLineString:It,MultiPolygon:qt,Dimension:xt,IntersectionMatrix:me,PrecisionModel:ne,Location:_e,Triangle:ve});class Ee{constructor(){Ee.constructor_.apply(this,arguments)}getCoordinates(){return this._pt}getCoordinate(t){return this._pt[t]}setMinimum(){if(1===arguments.length){let t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){let e=arguments[0],i=arguments[1];if(this._isNull)return this.initialize(e,i),null;var t=e.distance(i);t<this._distance&&this.initialize(e,i,t)}}initialize(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){let t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=i,this._isNull=!1}}toString(){return de.toLineString(this._pt[0],this._pt[1])}getDistance(){return this._distance}setMaximum(){if(1===arguments.length){let t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){let e=arguments[0],i=arguments[1];if(this._isNull)return this.initialize(e,i),null;var t=e.distance(i);t>this._distance&&this.initialize(e,i,t)}}getClass(){return Ee}get interfaces_(){return[]}}Ee.constructor_=function(){this._pt=[new y,new y],this._distance=n.NaN,this._isNull=!0};class we{constructor(){we.constructor_.apply(this,arguments)}static computeDistance(){if(arguments[2]instanceof Ee&&arguments[0]instanceof Ft&&arguments[1]instanceof y){let n=arguments[0],s=arguments[1],o=arguments[2];for(var t=new fe,e=n.getCoordinates(),i=0;i<e.length-1;i++){t.setCoordinates(e[i],e[i+1]);var r=t.closestPoint(s);o.setMinimum(r,s)}}else if(arguments[2]instanceof Ee&&arguments[0]instanceof Yt&&arguments[1]instanceof y){let t=arguments[0],e=arguments[1],r=arguments[2];for(we.computeDistance(t.getExteriorRing(),e,r),i=0;i<t.getNumInteriorRing();i++)we.computeDistance(t.getInteriorRingN(i),e,r)}else if(arguments[2]instanceof Ee&&arguments[0]instanceof V&&arguments[1]instanceof y){let t=arguments[0],e=arguments[1],r=arguments[2];if(t instanceof Ft)we.computeDistance(t,e,r);else if(t instanceof Yt)we.computeDistance(t,e,r);else if(t instanceof bt){var n=t;for(i=0;i<n.getNumGeometries();i++){var s=n.getGeometryN(i);we.computeDistance(s,e,r)}}else r.setMinimum(t.getCoordinate(),e)}else if(arguments[2]instanceof Ee&&arguments[0]instanceof fe&&arguments[1]instanceof y){let t=arguments[0],e=arguments[1],i=arguments[2];r=t.closestPoint(e),i.setMinimum(r,e)}}getClass(){return we}get interfaces_(){return[]}}we.constructor_=function(){};class be{constructor(){be.constructor_.apply(this,arguments)}static distance(){if(2===arguments.length){let e=arguments[0],i=arguments[1];return(t=new be(e,i)).distance()}if(3===arguments.length){let e=arguments[0],i=arguments[1],r=arguments[2];var t;return(t=new be(e,i)).setDensifyFraction(r),t.distance()}}getCoordinates(){return this._ptDist.getCoordinates()}setDensifyFraction(t){if(t>1||t<=0)throw new i("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=t}compute(t,e){this.computeOrientedDistance(t,e,this._ptDist),this.computeOrientedDistance(e,t,this._ptDist)}distance(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()}computeOrientedDistance(t,e,i){var r=new Ie(e);if(t.apply(r),i.setMaximum(r.getMaxPointDistance()),this._densifyFrac>0){var n=new Te(e,this._densifyFrac);t.apply(n),i.setMaximum(n.getMaxPointDistance())}}orientedDistance(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()}getClass(){return be}get interfaces_(){return[]}}class Ie{constructor(){Ie.constructor_.apply(this,arguments)}filter(t){this._minPtDist.initialize(),we.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}getMaxPointDistance(){return this._maxPtDist}getClass(){return Ie}get interfaces_(){return[j]}}Ie.constructor_=function(){this._maxPtDist=new Ee,this._minPtDist=new Ee,this._euclideanDist=new we,this._geom=null;let t=arguments[0];this._geom=t};class Te{constructor(){Te.constructor_.apply(this,arguments)}filter(t,e){if(0===e)return null;for(var i=t.getCoordinate(e-1),r=t.getCoordinate(e),n=(r.x-i.x)/this._numSubSegs,s=(r.y-i.y)/this._numSubSegs,o=0;o<this._numSubSegs;o++){var a=i.x+o*n,h=i.y+o*s,l=new y(a,h);this._minPtDist.initialize(),we.computeDistance(this._geom,l,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}}isDone(){return!1}isGeometryChanged(){return!1}getMaxPointDistance(){return this._maxPtDist}getClass(){return Te}get interfaces_(){return[wt]}}Te.constructor_=function(){this._maxPtDist=new Ee,this._minPtDist=new Ee,this._geom=null,this._numSubSegs=0;let t=arguments[0],e=arguments[1];this._geom=t,this._numSubSegs=Math.trunc(Math.round(1/e))},be.MaxPointDistanceFilter=Ie,be.MaxDensifiedByFractionDistanceFilter=Te,be.constructor_=function(){this._g0=null,this._g1=null,this._ptDist=new Ee,this._densifyFrac=0;let t=arguments[0],e=arguments[1];this._g0=t,this._g1=e};var Se=Object.freeze({DiscreteHausdorffDistance:be,DistanceToPoint:we,PointPairDistance:Ee});class Ce{constructor(){Ce.constructor_.apply(this,arguments)}visitItem(t){}getClass(){return Ce}get interfaces_(){return[]}}Ce.constructor_=function(){};class Ne{constructor(){Ne.constructor_.apply(this,arguments)}locate(t){}getClass(){return Ne}get interfaces_(){return[]}}Ne.constructor_=function(){};class Oe{constructor(){Oe.constructor_.apply(this,arguments)}getMin(){return this._min}intersects(t,e){return!(this._min>e||this._max<t)}getMax(){return this._max}toString(){return de.toLineString(new y(this._min,0),new y(this._max,0))}getClass(){return Oe}get interfaces_(){return[]}}class Pe{constructor(){Pe.constructor_.apply(this,arguments)}compare(t,e){var i=t,r=e,n=(i._min+i._max)/2,s=(r._min+r._max)/2;return n<s?-1:n>s?1:0}getClass(){return Pe}get interfaces_(){return[p]}}Pe.constructor_=function(){},Oe.NodeComparator=Pe,Oe.constructor_=function(){this._min=n.POSITIVE_INFINITY,this._max=n.NEGATIVE_INFINITY};class Le extends Oe{constructor(){super(),Le.constructor_.apply(this,arguments)}query(t,e,i){if(!this.intersects(t,e))return null;i.visitItem(this._item)}getClass(){return Le}get interfaces_(){return[]}}Le.constructor_=function(){this._item=null;let t=arguments[0],e=arguments[1],i=arguments[2];this._min=t,this._max=e,this._item=i};const Ae={reverseOrder:function(){return{compare:(t,e)=>e.compareTo(t)}},min:function(t){return Ae.sort(t),t.get(0)},sort:function(t,e){const i=t.toArray();e?vt.sort(i,e):vt.sort(i);const r=t.iterator();for(let t=0,e=i.length;t<e;t++)r.next(),r.set(i[t])},singletonList:function(t){const e=new C;return e.add(t),e}};class Re extends Oe{constructor(){super(),Re.constructor_.apply(this,arguments)}buildExtent(t,e){this._min=Math.min(t._min,e._min),this._max=Math.max(t._max,e._max)}query(t,e,i){if(!this.intersects(t,e))return null;null!==this._node1&&this._node1.query(t,e,i),null!==this._node2&&this._node2.query(t,e,i)}getClass(){return Re}get interfaces_(){return[]}}Re.constructor_=function(){this._node1=null,this._node2=null;let t=arguments[0],e=arguments[1];this._node1=t,this._node2=e,this.buildExtent(this._node1,this._node2)};class Me{constructor(){Me.constructor_.apply(this,arguments)}buildTree(){Ae.sort(this._leaves,new Oe.NodeComparator);for(var t=this._leaves,e=null,i=new C;;){if(this.buildLevel(t,i),1===i.size())return i.get(0);e=t,t=i,i=e}}insert(t,e,i){if(null!==this._root)throw new IllegalStateException("Index cannot be added to once it has been queried");this._leaves.add(new Le(t,e,i))}query(t,e,i){this.init(),this._root.query(t,e,i)}buildRoot(){if(null!==this._root)return null;this._root=this.buildTree()}printNode(t){G.out.println(de.toLineString(new y(t._min,this._level),new y(t._max,this._level)))}init(){if(null!==this._root)return null;this.buildRoot()}buildLevel(t,e){this._level++,e.clear();for(var i=0;i<t.size();i+=2){var r=t.get(i);if(null===(i+1<t.size()?t.get(i):null))e.add(r);else{var n=new Re(t.get(i),t.get(i+1));e.add(n)}}}getClass(){return Me}get interfaces_(){return[]}}Me.constructor_=function(){this._leaves=new C,this._root=null,this._level=0};class De{constructor(){De.constructor_.apply(this,arguments)}static getGeometry(){if(1===arguments.length){let t=arguments[0];return t.getFactory().buildGeometry(De.getLines(t))}if(2===arguments.length){let t=arguments[0],e=arguments[1];return t.getFactory().buildGeometry(De.getLines(t,e))}}static getLines(){if(1===arguments.length){let t=arguments[0];return De.getLines(t,!1)}if(2===arguments.length){if(x(arguments[0],w)&&x(arguments[1],w)){let i=arguments[0],r=arguments[1];for(var t=i.iterator();t.hasNext();){var e=t.next();De.getLines(e,r)}return r}if(arguments[0]instanceof V&&"boolean"==typeof arguments[1]){let t=arguments[0],e=arguments[1];var i=new C;return t.apply(new De(i,e)),i}if(arguments[0]instanceof V&&x(arguments[1],w)){let t=arguments[0],e=arguments[1];return t instanceof Ft?e.add(t):t.apply(new De(e)),e}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&x(arguments[0],w)&&x(arguments[1],w)){let i=arguments[0],r=arguments[1],n=arguments[2];for(t=i.iterator();t.hasNext();)e=t.next(),De.getLines(e,r,n);return r}if("boolean"==typeof arguments[2]&&arguments[0]instanceof V&&x(arguments[1],w)){let t=arguments[0],e=arguments[1],i=arguments[2];return t.apply(new De(e,i)),e}}}filter(t){if(this._isForcedToLineString&&t instanceof Xt){var e=t.getFactory().createLineString(t.getCoordinateSequence());return this._lines.add(e),null}t instanceof Ft&&this._lines.add(t)}setForceToLineString(t){this._isForcedToLineString=t}getClass(){return De}get interfaces_(){return[H]}}De.constructor_=function(){if(this._lines=null,this._isForcedToLineString=!1,1===arguments.length){let t=arguments[0];this._lines=t}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this._lines=t,this._isForcedToLineString=e}};class Fe{constructor(){Fe.constructor_.apply(this,arguments)}visitItem(t){this._items.add(t)}getItems(){return this._items}getClass(){return Fe}get interfaces_(){return[Ce]}}Fe.constructor_=function(){this._items=new C};class Be{constructor(){Be.constructor_.apply(this,arguments)}static locatePointInRing(){if(arguments[0]instanceof y&&x(arguments[1],X)){let n=arguments[0],s=arguments[1];for(var t=new Be(n),e=new y,i=new y,r=1;r<s.size();r++)if(s.getCoordinate(r,e),s.getCoordinate(r-1,i),t.countSegment(e,i),t.isOnSegment())return t.getLocation();return t.getLocation()}if(arguments[0]instanceof y&&arguments[1]instanceof Array){let n=arguments[0],s=arguments[1];for(t=new Be(n),r=1;r<s.length;r++)if(e=s[r],i=s[r-1],t.countSegment(e,i),t.isOnSegment())return t.getLocation();return t.getLocation()}}countSegment(t,e){if(t.x<this._p.x&&e.x<this._p.x)return null;if(this._p.x===e.x&&this._p.y===e.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&e.y===this._p.y){var i=t.x,r=e.x;return i>r&&(i=e.x,r=t.x),this._p.x>=i&&this._p.x<=r&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&e.y<=this._p.y||e.y>this._p.y&&t.y<=this._p.y){var n=k.index(t,e,this._p);if(n===k.COLLINEAR)return this._isPointOnSegment=!0,null;e.y<t.y&&(n=-n),n===k.LEFT&&this._crossingCount++}}isPointInPolygon(){return this.getLocation()!==_e.EXTERIOR}getLocation(){return this._isPointOnSegment?_e.BOUNDARY:this._crossingCount%2==1?_e.INTERIOR:_e.EXTERIOR}isOnSegment(){return this._isPointOnSegment}getClass(){return Be}get interfaces_(){return[]}}Be.constructor_=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;let t=arguments[0];this._p=t};class ke{constructor(){ke.constructor_.apply(this,arguments)}locate(t){var e=new Be(t),i=new Ge(e);return this._index.query(t.y,t.y,i),e.getLocation()}getClass(){return ke}get interfaces_(){return[Ne]}}class Ge{constructor(){Ge.constructor_.apply(this,arguments)}visitItem(t){var e=t;this._counter.countSegment(e.getCoordinate(0),e.getCoordinate(1))}getClass(){return Ge}get interfaces_(){return[Ce]}}Ge.constructor_=function(){this._counter=null;let t=arguments[0];this._counter=t};class Ue{constructor(){Ue.constructor_.apply(this,arguments)}init(t){for(var e=De.getLines(t).iterator();e.hasNext();){var i=e.next().getCoordinates();this.addLine(i)}}addLine(t){for(var e=1;e<t.length;e++){var i=new fe(t[e-1],t[e]),r=Math.min(i.p0.y,i.p1.y),n=Math.max(i.p0.y,i.p1.y);this._index.insert(r,n,i)}}query(){if(2===arguments.length){let e=arguments[0],i=arguments[1];var t=new Fe;return this._index.query(e,i,t),t.getItems()}if(3===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2];this._index.query(t,e,i)}}getClass(){return Ue}get interfaces_(){return[]}}Ue.constructor_=function(){this._index=new Me;let t=arguments[0];this.init(t)},ke.SegmentVisitor=Ge,ke.IntervalIndexedGeometry=Ue,ke.constructor_=function(){this._index=null;let t=arguments[0];if(!(x(t,Ut)||t instanceof Xt))throw new i("Argument must be Polygonal or LinearRing");this._index=new Ue(t)};class Ye{constructor(){Ye.constructor_.apply(this,arguments)}static isOnLine(){if(arguments[0]instanceof y&&x(arguments[1],X)){let s=arguments[0],o=arguments[1];for(var t=new ge,e=new y,i=new y,r=o.size(),n=1;n<r;n++)if(o.getCoordinate(n-1,e),o.getCoordinate(n,i),t.computeIntersection(s,e,i),t.hasIntersection())return!0;return!1}if(arguments[0]instanceof y&&arguments[1]instanceof Array){let r=arguments[0],s=arguments[1];for(t=new ge,n=1;n<s.length;n++)if(e=s[n-1],i=s[n],t.computeIntersection(r,e,i),t.hasIntersection())return!0;return!1}}static locateInRing(t,e){return Be.locatePointInRing(t,e)}static isInRing(t,e){return Ye.locateInRing(t,e)!==_e.EXTERIOR}getClass(){return Ye}get interfaces_(){return[]}}Ye.constructor_=function(){};class ze{constructor(){ze.constructor_.apply(this,arguments)}static isAtomic(t){return!(t instanceof bt)}next(){if(this._atStart)return this._atStart=!1,ze.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new T;var t=this._parent.getGeometryN(this._index++);return t instanceof bt?(this._subcollectionIterator=new ze(t),this._subcollectionIterator.next()):t}remove(){throw new UnsupportedOperationException(this.getClass().getName())}hasNext(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)}getClass(){return ze}get interfaces_(){return[E]}}ze.constructor_=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;let t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()};class Xe{constructor(){Xe.constructor_.apply(this,arguments)}static locatePointInPolygon(t,e){if(e.isEmpty())return _e.EXTERIOR;var i=e.getExteriorRing(),r=Xe.locatePointInRing(t,i);if(r!==_e.INTERIOR)return r;for(var n=0;n<e.getNumInteriorRing();n++){var s=e.getInteriorRingN(n),o=Xe.locatePointInRing(t,s);if(o===_e.BOUNDARY)return _e.BOUNDARY;if(o===_e.INTERIOR)return _e.EXTERIOR}return _e.INTERIOR}static locatePointInRing(t,e){return e.getEnvelopeInternal().intersects(t)?Ye.locateInRing(t,e.getCoordinates()):_e.EXTERIOR}static containsPointInPolygon(t,e){return _e.EXTERIOR!==Xe.locatePointInPolygon(t,e)}static locateInGeometry(t,e){if(e instanceof Yt)return Xe.locatePointInPolygon(t,e);if(e instanceof bt)for(var i=new ze(e);i.hasNext();){var r=i.next();if(r!==e){var n=Xe.locateInGeometry(t,r);if(n!==_e.EXTERIOR)return n}}return _e.EXTERIOR}static locate(t,e){return e.isEmpty()?_e.EXTERIOR:Xe.locateInGeometry(t,e)}locate(t){return Xe.locate(t,this._geom)}getClass(){return Xe}get interfaces_(){return[Ne]}}Xe.constructor_=function(){this._geom=null;let t=arguments[0];this._geom=t};var qe=Object.freeze({IndexedPointInAreaLocator:ke,PointOnGeometryLocator:Ne,SimplePointInAreaLocator:Xe});class He{constructor(){He.constructor_.apply(this,arguments)}measure(t,e){}getClass(){return He}get interfaces_(){return[]}}He.constructor_=function(){};class Ve{constructor(){Ve.constructor_.apply(this,arguments)}measure(t,e){return t.intersection(e).getArea()/t.union(e).getArea()}getClass(){return Ve}get interfaces_(){return[He]}}Ve.constructor_=function(){};class je{constructor(){je.constructor_.apply(this,arguments)}static diagonalSize(t){if(t.isNull())return 0;var e=t.getWidth(),i=t.getHeight();return Math.sqrt(e*e+i*i)}measure(t,e){var i=be.distance(t,e,je.DENSIFY_FRACTION),r=new P(t.getEnvelopeInternal());return r.expandToInclude(e.getEnvelopeInternal()),1-i/je.diagonalSize(r)}getClass(){return je}get interfaces_(){return[He]}}je.constructor_=function(){},je.DENSIFY_FRACTION=.25;class We{constructor(){We.constructor_.apply(this,arguments)}static combine(t,e){return Math.min(t,e)}getClass(){return We}get interfaces_(){return[]}}We.constructor_=function(){};var Ke=Object.freeze({AreaSimilarityMeasure:Ve,HausdorffSimilarityMeasure:je,SimilarityMeasure:He,SimilarityMeasureCombiner:We});class Ze{constructor(){Ze.constructor_.apply(this,arguments)}static area2(t,e,i){return(e.x-t.x)*(i.y-t.y)-(i.x-t.x)*(e.y-t.y)}static centroid3(t,e,i,r){return r.x=t.x+e.x+i.x,r.y=t.y+e.y+i.y,null}static getCentroid(t){return new Ze(t).getCentroid()}setAreaBasePoint(t){this._areaBasePt=t}addPoint(t){this._ptCount+=1,this._ptCentSum.x+=t.x,this._ptCentSum.y+=t.y}addLineSegments(t){for(var e=0,i=0;i<t.length-1;i++){var r=t[i].distance(t[i+1]);if(0!==r){e+=r;var n=(t[i].x+t[i+1].x)/2;this._lineCentSum.x+=r*n;var s=(t[i].y+t[i+1].y)/2;this._lineCentSum.y+=r*s}}this._totalLength+=e,0===e&&t.length>0&&this.addPoint(t[0])}addHole(t){for(var e=k.isCCW(t),i=0;i<t.length-1;i++)this.addTriangle(this._areaBasePt,t[i],t[i+1],e);this.addLineSegments(t)}getCentroid(){var t=new y;if(Math.abs(this._areasum2)>0)t.x=this._cg3.x/3/this._areasum2,t.y=this._cg3.y/3/this._areasum2;else if(this._totalLength>0)t.x=this._lineCentSum.x/this._totalLength,t.y=this._lineCentSum.y/this._totalLength;else{if(!(this._ptCount>0))return null;t.x=this._ptCentSum.x/this._ptCount,t.y=this._ptCentSum.y/this._ptCount}return t}addShell(t){t.length>0&&this.setAreaBasePoint(t[0]);for(var e=!k.isCCW(t),i=0;i<t.length-1;i++)this.addTriangle(this._areaBasePt,t[i],t[i+1],e);this.addLineSegments(t)}addTriangle(t,e,i,r){var n=r?1:-1;Ze.centroid3(t,e,i,this._triangleCent3);var s=Ze.area2(t,e,i);this._cg3.x+=n*s*this._triangleCent3.x,this._cg3.y+=n*s*this._triangleCent3.y,this._areasum2+=n*s}add(){if(arguments[0]instanceof Yt){let e=arguments[0];this.addShell(e.getExteriorRing().getCoordinates());for(var t=0;t<e.getNumInteriorRing();t++)this.addHole(e.getInteriorRingN(t).getCoordinates())}else if(arguments[0]instanceof V){let r=arguments[0];if(r.isEmpty())return null;if(r instanceof kt)this.addPoint(r.getCoordinate());else if(r instanceof Ft)this.addLineSegments(r.getCoordinates());else if(r instanceof Yt){var e=r;this.add(e)}else if(r instanceof bt){var i=r;for(t=0;t<i.getNumGeometries();t++)this.add(i.getGeometryN(t))}}}getClass(){return Ze}get interfaces_(){return[]}}function Je(t){this.message=t||""}function Qe(){this.array_=[]}Ze.constructor_=function(){this._areaBasePt=null,this._triangleCent3=new y,this._areasum2=0,this._cg3=new y,this._lineCentSum=new y,this._totalLength=0,this._ptCount=0,this._ptCentSum=new y;let t=arguments[0];this._areaBasePt=null,this.add(t)},Je.prototype=new Error,Je.prototype.name="EmptyStackException",Qe.prototype=new I,Qe.prototype.add=function(t){return this.array_.push(t),!0},Qe.prototype.get=function(t){if(t<0||t>=this.size())throw new IndexOutOfBoundsException;return this.array_[t]},Qe.prototype.push=function(t){return this.array_.push(t),t},Qe.prototype.pop=function(t){if(0===this.array_.length)throw new Je;return this.array_.pop()},Qe.prototype.peek=function(){if(0===this.array_.length)throw new Je;return this.array_[this.array_.length-1]},Qe.prototype.empty=function(){return 0===this.array_.length},Qe.prototype.isEmpty=function(){return this.empty()},Qe.prototype.search=function(t){return this.array_.indexOf(t)},Qe.prototype.size=function(){return this.array_.length},Qe.prototype.toArray=function(){for(var t=[],e=0,i=this.array_.length;e<i;e++)t.push(this.array_[e]);return t};class $e{constructor(){$e.constructor_.apply(this,arguments)}static filterCoordinates(t){for(var e=new $e,i=0;i<t.length;i++)e.filter(t[i]);return e.getCoordinates()}filter(t){this.treeSet.contains(t)||(this.list.add(t),this.treeSet.add(t))}getCoordinates(){var t=new Array(this.list.size()).fill(null);return this.list.toArray(t)}getClass(){return $e}get interfaces_(){return[j]}}$e.constructor_=function(){this.treeSet=new _t,this.list=new C};class ti{constructor(){ti.constructor_.apply(this,arguments)}static extractCoordinates(t){var e=new $e;return t.apply(e),e.getCoordinates()}preSort(t){for(var e=null,i=1;i<t.length;i++)(t[i].y<t[0].y||t[i].y===t[0].y&&t[i].x<t[0].x)&&(e=t[0],t[0]=t[i],t[i]=e);return vt.sort(t,1,t.length,new ei(t[0])),t}computeOctRing(t){var e=this.computeOctPts(t),i=new O;return i.add(e,!1),i.size()<3?null:(i.closeRing(),i.toCoordinateArray())}lineOrPolygon(t){if(3===(t=this.cleanRing(t)).length)return this._geomFactory.createLineString([t[0],t[1]]);var e=this._geomFactory.createLinearRing(t);return this._geomFactory.createPolygon(e)}cleanRing(t){m.equals(t[0],t[t.length-1]);for(var e=new C,i=null,r=0;r<=t.length-2;r++){var n=t[r],s=t[r+1];n.equals(s)||null!==i&&this.isBetween(i,n,s)||(e.add(n),i=n)}e.add(t[t.length-1]);var o=new Array(e.size()).fill(null);return e.toArray(o)}isBetween(t,e,i){if(0!==k.index(t,e,i))return!1;if(t.x!==i.x){if(t.x<=e.x&&e.x<=i.x)return!0;if(i.x<=e.x&&e.x<=t.x)return!0}if(t.y!==i.y){if(t.y<=e.y&&e.y<=i.y)return!0;if(i.y<=e.y&&e.y<=t.y)return!0}return!1}reduce(t){var e=this.computeOctRing(t);if(null===e)return t;for(var i=new _t,r=0;r<e.length;r++)i.add(e[r]);for(r=0;r<t.length;r++)Ye.isInRing(t[r],e)||i.add(t[r]);var n=$.toCoordinateArray(i);return n.length<3?this.padArray3(n):n}getConvexHull(){if(0===this._inputPts.length)return this._geomFactory.createGeometryCollection();if(1===this._inputPts.length)return this._geomFactory.createPoint(this._inputPts[0]);if(2===this._inputPts.length)return this._geomFactory.createLineString(this._inputPts);var t=this._inputPts;this._inputPts.length>50&&(t=this.reduce(this._inputPts));var e=this.preSort(t),i=this.grahamScan(e),r=this.toCoordinateArray(i);return this.lineOrPolygon(r)}padArray3(t){for(var e=new Array(3).fill(null),i=0;i<e.length;i++)i<t.length?e[i]=t[i]:e[i]=t[0];return e}computeOctPts(t){for(var e=new Array(8).fill(null),i=0;i<e.length;i++)e[i]=t[0];for(var r=1;r<t.length;r++)t[r].x<e[0].x&&(e[0]=t[r]),t[r].x-t[r].y<e[1].x-e[1].y&&(e[1]=t[r]),t[r].y>e[2].y&&(e[2]=t[r]),t[r].x+t[r].y>e[3].x+e[3].y&&(e[3]=t[r]),t[r].x>e[4].x&&(e[4]=t[r]),t[r].x-t[r].y>e[5].x-e[5].y&&(e[5]=t[r]),t[r].y<e[6].y&&(e[6]=t[r]),t[r].x+t[r].y<e[7].x+e[7].y&&(e[7]=t[r]);return e}toCoordinateArray(t){for(var e=new Array(t.size()).fill(null),i=0;i<t.size();i++){var r=t.get(i);e[i]=r}return e}grahamScan(t){var e=null,i=new Qe;i.push(t[0]),i.push(t[1]),i.push(t[2]);for(var r=3;r<t.length;r++){for(e=i.pop();!i.empty()&&k.index(i.peek(),e,t[r])>0;)e=i.pop();i.push(e),i.push(t[r])}return i.push(t[0]),i}getClass(){return ti}get interfaces_(){return[]}}class ei{constructor(){ei.constructor_.apply(this,arguments)}static polarCompare(t,e,i){var r=e.x-t.x,n=e.y-t.y,s=i.x-t.x,o=i.y-t.y,a=k.index(t,e,i);if(a===k.COUNTERCLOCKWISE)return 1;if(a===k.CLOCKWISE)return-1;var h=r*r+n*n,l=s*s+o*o;return h<l?-1:h>l?1:0}compare(t,e){var i=t,r=e;return ei.polarCompare(this._origin,i,r)}getClass(){return ei}get interfaces_(){return[p]}}ei.constructor_=function(){this._origin=null;let t=arguments[0];this._origin=t},ti.RadialComparator=ei,ti.constructor_=function(){if(this._geomFactory=null,this._inputPts=null,1===arguments.length){let t=arguments[0];ti.constructor_.call(this,ti.extractCoordinates(t),t.getFactory())}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this._inputPts=$e.filterCoordinates(t),this._geomFactory=e}};class ii{constructor(){ii.constructor_.apply(this,arguments)}static centre(t){return new y(ii.avg(t.getMinX(),t.getMaxX()),ii.avg(t.getMinY(),t.getMaxY()))}static avg(t,e){return(t+e)/2}addPolygon(t){if(t.isEmpty())return null;var e=null,i=null,r=this.horizontalBisector(t);if(0===r.getLength())i=0,e=r.getCoordinate();else{var n=r.intersection(t),s=this.widestGeometry(n);i=s.getEnvelopeInternal().getWidth(),e=ii.centre(s.getEnvelopeInternal())}(null===this._interiorPoint||i>this._maxWidth)&&(this._interiorPoint=e,this._maxWidth=i)}getInteriorPoint(){return this._interiorPoint}widestGeometry(){if(arguments[0]instanceof bt){let i=arguments[0];if(i.isEmpty())return i;for(var t=i.getGeometryN(0),e=1;e<i.getNumGeometries();e++)i.getGeometryN(e).getEnvelopeInternal().getWidth()>t.getEnvelopeInternal().getWidth()&&(t=i.getGeometryN(e));return t}if(arguments[0]instanceof V){let t=arguments[0];return t instanceof bt?this.widestGeometry(t):t}}horizontalBisector(t){var e=t.getEnvelopeInternal(),i=ri.getBisectorY(t);return this._factory.createLineString([new y(e.getMinX(),i),new y(e.getMaxX(),i)])}add(t){if(t instanceof Yt)this.addPolygon(t);else if(t instanceof bt)for(var e=t,i=0;i<e.getNumGeometries();i++)this.add(e.getGeometryN(i))}getClass(){return ii}get interfaces_(){return[]}}class ri{constructor(){ri.constructor_.apply(this,arguments)}static getBisectorY(t){return new ri(t).getBisectorY()}updateInterval(t){t<=this._centreY?t>this._loY&&(this._loY=t):t>this._centreY&&t<this._hiY&&(this._hiY=t)}getBisectorY(){this.process(this._poly.getExteriorRing());for(var t=0;t<this._poly.getNumInteriorRing();t++)this.process(this._poly.getInteriorRingN(t));return ii.avg(this._hiY,this._loY)}process(t){for(var e=t.getCoordinateSequence(),i=0;i<e.size();i++){var r=e.getY(i);this.updateInterval(r)}}getClass(){return ri}get interfaces_(){return[]}}ri.constructor_=function(){this._poly=null,this._centreY=null,this._hiY=n.MAX_VALUE,this._loY=-n.MAX_VALUE;let t=arguments[0];this._poly=t,this._hiY=t.getEnvelopeInternal().getMaxY(),this._loY=t.getEnvelopeInternal().getMinY(),this._centreY=ii.avg(this._loY,this._hiY)},ii.SafeBisectorFinder=ri,ii.constructor_=function(){this._factory=null,this._interiorPoint=null,this._maxWidth=0;let t=arguments[0];this._factory=t.getFactory(),this.add(t)};class ni{constructor(){ni.constructor_.apply(this,arguments)}addEndpoints(){if(arguments[0]instanceof V){let i=arguments[0];if(i instanceof Ft)this.addEndpoints(i.getCoordinates());else if(i instanceof bt)for(var t=i,e=0;e<t.getNumGeometries();e++)this.addEndpoints(t.getGeometryN(e))}else if(arguments[0]instanceof Array){let t=arguments[0];this.add(t[0]),this.add(t[t.length-1])}}getInteriorPoint(){return this._interiorPoint}addInterior(){if(arguments[0]instanceof V){let i=arguments[0];if(i instanceof Ft)this.addInterior(i.getCoordinates());else if(i instanceof bt)for(var t=i,e=0;e<t.getNumGeometries();e++)this.addInterior(t.getGeometryN(e))}else if(arguments[0]instanceof Array){let t=arguments[0];for(e=1;e<t.length-1;e++)this.add(t[e])}}add(t){var e=t.distance(this._centroid);e<this._minDistance&&(this._interiorPoint=new y(t),this._minDistance=e)}getClass(){return ni}get interfaces_(){return[]}}ni.constructor_=function(){this._centroid=null,this._minDistance=n.MAX_VALUE,this._interiorPoint=null;let t=arguments[0];this._centroid=t.getCentroid().getCoordinate(),this.addInterior(t),null===this._interiorPoint&&this.addEndpoints(t)};class si{constructor(){si.constructor_.apply(this,arguments)}getInteriorPoint(){return this._interiorPoint}add(){if(arguments[0]instanceof V){let i=arguments[0];if(i instanceof kt)this.add(i.getCoordinate());else if(i instanceof bt)for(var t=i,e=0;e<t.getNumGeometries();e++)this.add(t.getGeometryN(e))}else if(arguments[0]instanceof y){let t=arguments[0];var i=t.distance(this._centroid);i<this._minDistance&&(this._interiorPoint=new y(t),this._minDistance=i)}}getClass(){return si}get interfaces_(){return[]}}si.constructor_=function(){this._centroid=null,this._minDistance=n.MAX_VALUE,this._interiorPoint=null;let t=arguments[0];this._centroid=t.getCentroid().getCoordinate(),this.add(t)};class oi{constructor(){oi.constructor_.apply(this,arguments)}locateInPolygonRing(t,e){return e.getEnvelopeInternal().intersects(t)?Ye.locateInRing(t,e.getCoordinates()):_e.EXTERIOR}intersects(t,e){return this.locate(t,e)!==_e.EXTERIOR}updateLocationInfo(t){t===_e.INTERIOR&&(this._isIn=!0),t===_e.BOUNDARY&&this._numBoundaries++}computeLocation(t,e){if(e instanceof kt&&this.updateLocationInfo(this.locateOnPoint(t,e)),e instanceof Ft)this.updateLocationInfo(this.locateOnLineString(t,e));else if(e instanceof Yt)this.updateLocationInfo(this.locateInPolygon(t,e));else if(e instanceof It)for(var i=e,r=0;r<i.getNumGeometries();r++){var n=i.getGeometryN(r);this.updateLocationInfo(this.locateOnLineString(t,n))}else if(e instanceof qt){var s=e;for(r=0;r<s.getNumGeometries();r++){var o=s.getGeometryN(r);this.updateLocationInfo(this.locateInPolygon(t,o))}}else if(e instanceof bt)for(var a=new ze(e);a.hasNext();){var h=a.next();h!==e&&this.computeLocation(t,h)}}locateOnPoint(t,e){return e.getCoordinate().equals2D(t)?_e.INTERIOR:_e.EXTERIOR}locateOnLineString(t,e){if(!e.getEnvelopeInternal().intersects(t))return _e.EXTERIOR;var i=e.getCoordinateSequence();return e.isClosed()||!t.equals(i.getCoordinate(0))&&!t.equals(i.getCoordinate(i.size()-1))?Ye.isOnLine(t,i)?_e.INTERIOR:_e.EXTERIOR:_e.BOUNDARY}locateInPolygon(t,e){if(e.isEmpty())return _e.EXTERIOR;var i=e.getExteriorRing(),r=this.locateInPolygonRing(t,i);if(r===_e.EXTERIOR)return _e.EXTERIOR;if(r===_e.BOUNDARY)return _e.BOUNDARY;for(var n=0;n<e.getNumInteriorRing();n++){var s=e.getInteriorRingN(n),o=this.locateInPolygonRing(t,s);if(o===_e.INTERIOR)return _e.EXTERIOR;if(o===_e.BOUNDARY)return _e.BOUNDARY}return _e.INTERIOR}locate(t,e){return e.isEmpty()?_e.EXTERIOR:e instanceof Ft?this.locateOnLineString(t,e):e instanceof Yt?this.locateInPolygon(t,e):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(t,e),this._boundaryRule.isInBoundary(this._numBoundaries)?_e.BOUNDARY:this._numBoundaries>0||this._isIn?_e.INTERIOR:_e.EXTERIOR)}getClass(){return oi}get interfaces_(){return[]}}oi.constructor_=function(){if(this._boundaryRule=W.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0===arguments.length);else if(1===arguments.length){let t=arguments[0];if(null===t)throw new i("Rule must be non-null");this._boundaryRule=t}};class ai{constructor(){ai.constructor_.apply(this,arguments)}static pointWitMinAngleWithX(t,e){for(var i=n.MAX_VALUE,r=null,s=0;s<t.length;s++){var o=t[s];if(o!==e){var a=o.x-e.x,h=o.y-e.y;h<0&&(h=-h);var l=h/Math.sqrt(a*a+h*h);l<i&&(i=l,r=o)}}return r}static lowestPoint(t){for(var e=t[0],i=1;i<t.length;i++)t[i].y<e.y&&(e=t[i]);return e}static pointWithMinAngleWithSegment(t,e,i){for(var r=n.MAX_VALUE,s=null,o=0;o<t.length;o++){var a=t[o];if(a!==e&&a!==i){var h=ye.angleBetween(e,a,i);h<r&&(r=h,s=a)}}return s}getRadius(){return this.compute(),this._radius}getDiameter(){switch(this.compute(),this._extremalPts.length){case 0:return this._input.getFactory().createLineString();case 1:return this._input.getFactory().createPoint(this._centre)}var t=this._extremalPts[0],e=this._extremalPts[1];return this._input.getFactory().createLineString([t,e])}getExtremalPoints(){return this.compute(),this._extremalPts}computeCirclePoints(){if(this._input.isEmpty())return this._extremalPts=new Array(0).fill(null),null;if(1===this._input.getNumPoints()){var t=this._input.getCoordinates();return this._extremalPts=[new y(t[0])],null}var e=this._input.convexHull().getCoordinates();if(t=e,e[0].equals2D(e[e.length-1])&&(t=new Array(e.length-1).fill(null),$.copyDeep(e,0,t,0,e.length-1)),t.length<=2)return this._extremalPts=$.copyDeep(t),null;for(var i=ai.lowestPoint(t),r=ai.pointWitMinAngleWithX(t,i),n=0;n<t.length;n++){var s=ai.pointWithMinAngleWithSegment(t,i,r);if(ye.isObtuse(i,s,r))return this._extremalPts=[new y(i),new y(r)],null;if(ye.isObtuse(s,i,r))i=s;else{if(!ye.isObtuse(s,r,i))return this._extremalPts=[new y(i),new y(r),new y(s)],null;r=s}}m.shouldNeverReachHere("Logic failure in Minimum Bounding Circle algorithm!")}compute(){if(null!==this._extremalPts)return null;this.computeCirclePoints(),this.computeCentre(),null!==this._centre&&(this._radius=this._centre.distance(this._extremalPts[0]))}getFarthestPoints(){switch(this.compute(),this._extremalPts.length){case 0:return this._input.getFactory().createLineString();case 1:return this._input.getFactory().createPoint(this._centre)}var t=this._extremalPts[0],e=this._extremalPts[this._extremalPts.length-1];return this._input.getFactory().createLineString([t,e])}getCircle(){if(this.compute(),null===this._centre)return this._input.getFactory().createPolygon();var t=this._input.getFactory().createPoint(this._centre);return 0===this._radius?t:t.buffer(this._radius)}getCentre(){return this.compute(),this._centre}computeCentre(){switch(this._extremalPts.length){case 0:this._centre=null;break;case 1:this._centre=this._extremalPts[0];break;case 2:this._centre=new y((this._extremalPts[0].x+this._extremalPts[1].x)/2,(this._extremalPts[0].y+this._extremalPts[1].y)/2);break;case 3:this._centre=ve.circumcentre(this._extremalPts[0],this._extremalPts[1],this._extremalPts[2])}}getClass(){return ai}get interfaces_(){return[]}}ai.constructor_=function(){this._input=null,this._extremalPts=null,this._centre=null,this._radius=0;let t=arguments[0];this._input=t};class hi{constructor(){hi.constructor_.apply(this,arguments)}static nextIndex(t,e){return++e>=t.length&&(e=0),e}static computeC(t,e,i){return t*i.y-e*i.x}static getMinimumDiameter(t){return new hi(t).getDiameter()}static getMinimumRectangle(t){return new hi(t).getMinimumRectangle()}static computeSegmentForLine(t,e,i){var r=null,n=null;return Math.abs(e)>Math.abs(t)?(r=new y(0,i/e),n=new y(1,i/e-t/e)):(r=new y(i/t,0),n=new y(i/t-e/t,1)),new fe(r,n)}getWidthCoordinate(){return this.computeMinimumDiameter(),this._minWidthPt}getSupportingSegment(){return this.computeMinimumDiameter(),this._inputGeom.getFactory().createLineString([this._minBaseSeg.p0,this._minBaseSeg.p1])}getDiameter(){if(this.computeMinimumDiameter(),null===this._minWidthPt)return this._inputGeom.getFactory().createLineString();var t=this._minBaseSeg.project(this._minWidthPt);return this._inputGeom.getFactory().createLineString([t,this._minWidthPt])}computeWidthConvex(t){this._convexHullPts=t instanceof Yt?t.getExteriorRing().getCoordinates():t.getCoordinates(),0===this._convexHullPts.length?(this._minWidth=0,this._minWidthPt=null,this._minBaseSeg=null):1===this._convexHullPts.length?(this._minWidth=0,this._minWidthPt=this._convexHullPts[0],this._minBaseSeg.p0=this._convexHullPts[0],this._minBaseSeg.p1=this._convexHullPts[0]):2===this._convexHullPts.length||3===this._convexHullPts.length?(this._minWidth=0,this._minWidthPt=this._convexHullPts[0],this._minBaseSeg.p0=this._convexHullPts[0],this._minBaseSeg.p1=this._convexHullPts[1]):this.computeConvexRingMinDiameter(this._convexHullPts)}computeConvexRingMinDiameter(t){this._minWidth=n.MAX_VALUE;for(var e=1,i=new fe,r=0;r<t.length-1;r++)i.p0=t[r],i.p1=t[r+1],e=this.findMaxPerpDistance(t,i,e)}computeMinimumDiameter(){if(null!==this._minWidthPt)return null;if(this._isConvex)this.computeWidthConvex(this._inputGeom);else{var t=new ti(this._inputGeom).getConvexHull();this.computeWidthConvex(t)}}getLength(){return this.computeMinimumDiameter(),this._minWidth}findMaxPerpDistance(t,e,i){for(var r=e.distancePerpendicular(t[i]),n=r,s=i,o=s;n>=r;)r=n,s=o,o=hi.nextIndex(t,s),n=e.distancePerpendicular(t[o]);return r<this._minWidth&&(this._minPtIndex=s,this._minWidth=r,this._minWidthPt=t[this._minPtIndex],this._minBaseSeg=new fe(e)),s}getMinimumRectangle(){if(this.computeMinimumDiameter(),0===this._minWidth)return this._minBaseSeg.p0.equals2D(this._minBaseSeg.p1)?this._inputGeom.getFactory().createPoint(this._minBaseSeg.p0):this._minBaseSeg.toGeometry(this._inputGeom.getFactory());for(var t=this._minBaseSeg.p1.x-this._minBaseSeg.p0.x,e=this._minBaseSeg.p1.y-this._minBaseSeg.p0.y,i=n.MAX_VALUE,r=-n.MAX_VALUE,s=n.MAX_VALUE,o=-n.MAX_VALUE,a=0;a<this._convexHullPts.length;a++){var h=hi.computeC(t,e,this._convexHullPts[a]);h>r&&(r=h),h<i&&(i=h);var l=hi.computeC(-e,t,this._convexHullPts[a]);l>o&&(o=l),l<s&&(s=l)}var u=hi.computeSegmentForLine(-t,-e,o),c=hi.computeSegmentForLine(-t,-e,s),d=hi.computeSegmentForLine(-e,t,r),p=hi.computeSegmentForLine(-e,t,i),g=d.lineIntersection(u),f=p.lineIntersection(u),_=p.lineIntersection(c),m=d.lineIntersection(c),y=this._inputGeom.getFactory().createLinearRing([g,f,_,m,g]);return this._inputGeom.getFactory().createPolygon(y)}getClass(){return hi}get interfaces_(){return[]}}hi.constructor_=function(){if(this._inputGeom=null,this._isConvex=null,this._convexHullPts=null,this._minBaseSeg=new fe,this._minWidthPt=null,this._minPtIndex=null,this._minWidth=0,1===arguments.length){let t=arguments[0];hi.constructor_.call(this,t,!1)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this._inputGeom=t,this._isConvex=e}};var li=Object.freeze({distance:Se,locate:qe,match:Ke,Angle:ye,Area:Gt,Centroid:Ze,ConvexHull:ti,Distance:z,InteriorPointArea:ii,InteriorPointLine:ni,InteriorPointPoint:si,Length:Ct,Orientation:k,PointLocation:Ye,PointLocator:oi,RobustLineIntersector:ge,MinimumBoundingCircle:ai,MinimumDiameter:hi});class ui{constructor(){ui.constructor_.apply(this,arguments)}transformPoint(t,e){return this._factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))}transformPolygon(t,e){var i=!0,r=this.transformLinearRing(t.getExteriorRing(),t);null!==r&&r instanceof Xt&&!r.isEmpty()||(i=!1);for(var n=new C,s=0;s<t.getNumInteriorRing();s++){var o=this.transformLinearRing(t.getInteriorRingN(s),t);null===o||o.isEmpty()||(o instanceof Xt||(i=!1),n.add(o))}if(i)return this._factory.createPolygon(r,n.toArray([]));var a=new C;return null!==r&&a.add(r),a.addAll(n),this._factory.buildGeometry(a)}createCoordinateSequence(t){return this._factory.getCoordinateSequenceFactory().create(t)}getInputGeometry(){return this._inputGeom}transformMultiLineString(t,e){for(var i=new C,r=0;r<t.getNumGeometries();r++){var n=this.transformLineString(t.getGeometryN(r),t);null!==n&&(n.isEmpty()||i.add(n))}return this._factory.buildGeometry(i)}transformCoordinates(t,e){return this.copy(t)}transformLineString(t,e){return this._factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))}transformMultiPoint(t,e){for(var i=new C,r=0;r<t.getNumGeometries();r++){var n=this.transformPoint(t.getGeometryN(r),t);null!==n&&(n.isEmpty()||i.add(n))}return this._factory.buildGeometry(i)}transformMultiPolygon(t,e){for(var i=new C,r=0;r<t.getNumGeometries();r++){var n=this.transformPolygon(t.getGeometryN(r),t);null!==n&&(n.isEmpty()||i.add(n))}return this._factory.buildGeometry(i)}copy(t){return t.copy()}transformGeometryCollection(t,e){for(var i=new C,r=0;r<t.getNumGeometries();r++){var n=this.transform(t.getGeometryN(r));null!==n&&(this._pruneEmptyGeometry&&n.isEmpty()||i.add(n))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(oe.toGeometryArray(i)):this._factory.buildGeometry(i)}transform(t){if(this._inputGeom=t,this._factory=t.getFactory(),t instanceof kt)return this.transformPoint(t,null);if(t instanceof zt)return this.transformMultiPoint(t,null);if(t instanceof Xt)return this.transformLinearRing(t,null);if(t instanceof Ft)return this.transformLineString(t,null);if(t instanceof It)return this.transformMultiLineString(t,null);if(t instanceof Yt)return this.transformPolygon(t,null);if(t instanceof qt)return this.transformMultiPolygon(t,null);if(t instanceof bt)return this.transformGeometryCollection(t,null);throw new i("Unknown Geometry subtype: "+t.getClass().getName())}transformLinearRing(t,e){var i=this.transformCoordinates(t.getCoordinateSequence(),t);if(null===i)return this._factory.createLinearRing(null);var r=i.size();return r>0&&r<4&&!this._preserveType?this._factory.createLineString(i):this._factory.createLinearRing(i)}getClass(){return ui}get interfaces_(){return[]}}ui.constructor_=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};class ci{constructor(){ci.constructor_.apply(this,arguments)}static densifyPoints(t,e,i){for(var r=new fe,n=new O,s=0;s<t.length-1;s++){r.p0=t[s],r.p1=t[s+1],n.add(r.p0,!1);var o=r.getLength(),a=Math.trunc(o/e)+1;if(a>1)for(var h=o/a,l=1;l<a;l++){var u=l*h/o,c=r.pointAlong(u);i.makePrecise(c),n.add(c,!1)}}return n.add(t[t.length-1],!1),n.toCoordinateArray()}static densify(t,e){var i=new ci(t);return i.setDistanceTolerance(e),i.getResultGeometry()}getResultGeometry(){return new di(this._distanceTolerance).transform(this._inputGeom)}setDistanceTolerance(t){if(t<=0)throw new i("Tolerance must be positive");this._distanceTolerance=t}getClass(){return ci}get interfaces_(){return[]}}class di extends ui{constructor(){super(),di.constructor_.apply(this,arguments)}transformMultiPolygon(t,e){var i=super.transformMultiPolygon.call(this,t,e);return this.createValidArea(i)}transformPolygon(t,e){var i=super.transformPolygon.call(this,t,e);return e instanceof qt?i:this.createValidArea(i)}transformCoordinates(t,e){var i=t.toCoordinateArray(),r=ci.densifyPoints(i,this.distanceTolerance,e.getPrecisionModel());return e instanceof Ft&&1===r.length&&(r=new Array(0).fill(null)),this._factory.getCoordinateSequenceFactory().create(r)}createValidArea(t){return t.buffer(0)}getClass(){return di}get interfaces_(){return[]}}di.constructor_=function(){this.distanceTolerance=null;let t=arguments[0];this.distanceTolerance=t},ci.DensifyTransformer=di,ci.constructor_=function(){this._inputGeom=null,this._distanceTolerance=null;let t=arguments[0];this._inputGeom=t};var pi=Object.freeze({Densifier:ci});class gi{constructor(){gi.constructor_.apply(this,arguments)}static isNorthern(t){return t===gi.NE||t===gi.NW}static isOpposite(t,e){return t!==e&&2==(t-e+4)%4}static commonHalfPlane(t,e){if(t===e)return t;if(2==(t-e+4)%4)return-1;var i=t<e?t:e;return 0===i&&3===(t>e?t:e)?3:i}static isInHalfPlane(t,e){return e===gi.SE?t===gi.SE||t===gi.SW:t===e||t===e+1}static quadrant(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){let t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new i("Cannot compute the quadrant for point ( "+t+", "+e+" )");return t>=0?e>=0?gi.NE:gi.SE:e>=0?gi.NW:gi.SW}if(arguments[0]instanceof y&&arguments[1]instanceof y){let t=arguments[0],e=arguments[1];if(e.x===t.x&&e.y===t.y)throw new i("Cannot compute the quadrant for two identical points "+t);return e.x>=t.x?e.y>=t.y?gi.NE:gi.SE:e.y>=t.y?gi.NW:gi.SW}}getClass(){return gi}get interfaces_(){return[]}}gi.constructor_=function(){},gi.NE=0,gi.NW=1,gi.SW=2,gi.SE=3;class fi{constructor(){fi.constructor_.apply(this,arguments)}static init(t,e){if(null!==t._sym||null!==e._sym||null!==t._next||null!==e._next)throw new IllegalStateException("Edges are already initialized");return t.init(e),t}static create(t,e){var i=new fi(t),r=new fi(e);return i.init(r),i}find(t){var e=this;do{if(null===e)return null;if(e.dest().equals2D(t))return e;e=e.oNext()}while(e!==this);return null}dest(){return this._sym._orig}oNext(){return this._sym._next}insert(t){if(this.oNext()===this)return this.insertAfter(t),null;var e=this.compareTo(t),i=this;do{var r=i.oNext();if(r.compareTo(t)!==e||r===this)return i.insertAfter(t),null;i=r}while(i!==this);m.shouldNeverReachHere()}insertAfter(t){m.equals(this._orig,t.orig());var e=this.oNext();this._sym.setNext(t),t.sym().setNext(e)}degree(){var t=0,e=this;do{t++,e=e.oNext()}while(e!==this);return t}equals(){if(2===arguments.length&&arguments[1]instanceof y&&arguments[0]instanceof y){let t=arguments[0],e=arguments[1];return this._orig.equals2D(t)&&this._sym._orig.equals(e)}}deltaY(){return this._sym._orig.y-this._orig.y}sym(){return this._sym}prev(){return this._sym.next()._sym}compareAngularDirection(t){var e=this.deltaX(),i=this.deltaY(),r=t.deltaX(),n=t.deltaY();if(e===r&&i===n)return 0;var s=gi.quadrant(e,i),o=gi.quadrant(r,n);return s>o?1:s<o?-1:k.index(t._orig,t.dest(),this.dest())}prevNode(){for(var t=this;2===t.degree();)if((t=t.prev())===this)return null;return t}compareTo(t){var e=t;return this.compareAngularDirection(e)}next(){return this._next}setSym(t){this._sym=t}orig(){return this._orig}toString(){return"HE("+this._orig.x+" "+this._orig.y+", "+this._sym._orig.x+" "+this._sym._orig.y+")"}setNext(t){this._next=t}init(t){this.setSym(t),t.setSym(this),this.setNext(t),t.setNext(this)}deltaX(){return this._sym._orig.x-this._orig.x}getClass(){return fi}get interfaces_(){return[]}}fi.constructor_=function(){this._orig=null,this._sym=null,this._next=null;let t=arguments[0];this._orig=t};class _i extends fi{constructor(){super(),_i.constructor_.apply(this,arguments)}static setMarkBoth(t,e){t.setMark(e),t.sym().setMark(e)}static isMarked(t){return t.isMarked()}static setMark(t,e){t.setMark(e)}static markBoth(t){t.mark(),t.sym().mark()}static mark(t){t.mark()}mark(){this._isMarked=!0}setMark(t){this._isMarked=t}isMarked(){return this._isMarked}getClass(){return _i}get interfaces_(){return[]}}_i.constructor_=function(){this._isMarked=!1;let t=arguments[0];fi.constructor_.call(this,t)};class mi{constructor(){mi.constructor_.apply(this,arguments)}static isValidEdge(t,e){return 0!==e.compareTo(t)}insert(t,e,i){var r=this.create(t,e);null!==i?i.insert(r):this._vertexMap.put(t,r);var n=this._vertexMap.get(e);return null!==n?n.insert(r.sym()):this._vertexMap.put(e,r.sym()),r}create(t,e){var i=this.createEdge(t),r=this.createEdge(e);return fi.init(i,r),i}createEdge(t){return new fi(t)}addEdge(t,e){if(!mi.isValidEdge(t,e))return null;var i=this._vertexMap.get(t),r=null;return null!==i&&(r=i.find(e)),null!==r?r:this.insert(t,e,i)}getVertexEdges(){return this._vertexMap.values()}findEdge(t,e){var i=this._vertexMap.get(t);return null===i?null:i.find(e)}getClass(){return mi}get interfaces_(){return[]}}mi.constructor_=function(){this._vertexMap=new re};class yi extends _i{constructor(){super(),yi.constructor_.apply(this,arguments)}setStart(){this._isStart=!0}isStart(){return this._isStart}getClass(){return yi}get interfaces_(){return[]}}yi.constructor_=function(){this._isStart=!1;let t=arguments[0];_i.constructor_.call(this,t)};class vi extends mi{constructor(){super(),vi.constructor_.apply(this,arguments)}createEdge(t){return new yi(t)}getClass(){return vi}get interfaces_(){return[]}}vi.constructor_=function(){};class xi{constructor(){xi.constructor_.apply(this,arguments)}static dissolve(t){var e=new xi;return e.add(t),e.getResult()}addLine(t){this._lines.add(this._factory.createLineString(t.toCoordinateArray()))}updateRingStartEdge(t){return t.isStart()||(t=t.sym()).isStart()?null===this._ringStartEdge?(this._ringStartEdge=t,null):void(t.orig().compareTo(this._ringStartEdge.orig())<0&&(this._ringStartEdge=t)):null}getResult(){return null===this._result&&this.computeResult(),this._result}process(t){var e=t.prevNode();null===e&&(e=t),this.stackEdges(e),this.buildLines()}buildRing(t){var e=new O,i=t;for(e.add(i.orig().copy(),!1);2===i.sym().degree();){var r=i.next();if(r===t)break;e.add(r.orig().copy(),!1),i=r}e.add(i.dest().copy(),!1),this.addLine(e)}buildLine(t){var e=new O,i=t;for(this._ringStartEdge=null,_i.markBoth(i),e.add(i.orig().copy(),!1);2===i.sym().degree();){this.updateRingStartEdge(i);var r=i.next();if(r===t)return this.buildRing(this._ringStartEdge),null;e.add(r.orig().copy(),!1),i=r,_i.markBoth(i)}e.add(i.dest().clone(),!1),this.stackEdges(i.sym()),this.addLine(e)}stackEdges(t){var e=t;do{_i.isMarked(e)||this._nodeEdgeStack.add(e),e=e.oNext()}while(e!==t)}computeResult(){for(var t=this._graph.getVertexEdges().iterator();t.hasNext();){var e=t.next();_i.isMarked(e)||this.process(e)}this._result=this._factory.buildGeometry(this._lines)}buildLines(){for(;!this._nodeEdgeStack.empty();){var t=this._nodeEdgeStack.pop();_i.isMarked(t)||this.buildLine(t)}}add(){if(arguments[0]instanceof V)arguments[0].apply(new class{get interfaces_(){return[H]}filter(t){t instanceof Ft&&this.add(t)}});else if(x(arguments[0],w))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.add(e)}else if(arguments[0]instanceof Ft){let e=arguments[0];null===this._factory&&(this._factory=e.getFactory());var i=e.getCoordinateSequence(),r=!1;for(t=1;t<i.size();t++){var n=this._graph.addEdge(i.getCoordinate(t-1),i.getCoordinate(t));null!==n&&(r||(n.setStart(),r=!0))}}}getClass(){return xi}get interfaces_(){return[]}}xi.constructor_=function(){this._result=null,this._factory=null,this._graph=null,this._lines=new C,this._nodeEdgeStack=new Qe,this._ringStartEdge=null,this._graph=new vi};var Ei=Object.freeze({LineDissolver:xi});class wi{constructor(){wi.constructor_.apply(this,arguments)}static opposite(t){return t===wi.LEFT?wi.RIGHT:t===wi.RIGHT?wi.LEFT:t}getClass(){return wi}get interfaces_(){return[]}}wi.constructor_=function(){},wi.ON=0,wi.LEFT=1,wi.RIGHT=2;class bi{constructor(){bi.constructor_.apply(this,arguments)}computeIntersections(t,e){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,e)}getClass(){return bi}get interfaces_(){return[]}}bi.constructor_=function(){this.mce=null,this.chainIndex=null;let t=arguments[0],e=arguments[1];this.mce=t,this.chainIndex=e};class Ii{constructor(){Ii.constructor_.apply(this,arguments)}isDelete(){return this._eventType===Ii.DELETE}setDeleteEventIndex(t){this._deleteEventIndex=t}getObject(){return this._obj}compareTo(t){var e=t;return this._xValue<e._xValue?-1:this._xValue>e._xValue?1:this._eventType<e._eventType?-1:this._eventType>e._eventType?1:0}getInsertEvent(){return this._insertEvent}isInsert(){return this._eventType===Ii.INSERT}isSameLabel(t){return null!==this._label&&this._label===t._label}getDeleteEventIndex(){return this._deleteEventIndex}getClass(){return Ii}get interfaces_(){return[c]}}Ii.constructor_=function(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){let t=arguments[0],e=arguments[1];this._eventType=Ii.DELETE,this._xValue=t,this._insertEvent=e}else if(3===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2];this._eventType=Ii.INSERT,this._label=t,this._xValue=e,this._obj=i}},Ii.INSERT=1,Ii.DELETE=2;class Ti{constructor(){Ti.constructor_.apply(this,arguments)}getClass(){return Ti}get interfaces_(){return[]}}Ti.constructor_=function(){};class Si{constructor(){Si.constructor_.apply(this,arguments)}static isAdjacentSegments(t,e){return 1===Math.abs(t-e)}isTrivialIntersection(t,e,i,r){if(t===i&&1===this._li.getIntersectionNum()){if(Si.isAdjacentSegments(e,r))return!0;if(t.isClosed()){var n=t.getNumPoints()-1;if(0===e&&r===n||0===r&&e===n)return!0}}return!1}getProperIntersectionPoint(){return this._properIntersectionPoint}setIsDoneIfProperInt(t){this._isDoneWhenProperInt=t}hasProperInteriorIntersection(){return this._hasProperInterior}isBoundaryPointInternal(t,e){for(var i=e.iterator();i.hasNext();){var r=i.next().getCoordinate();if(t.isIntersection(r))return!0}return!1}hasProperIntersection(){return this._hasProper}hasIntersection(){return this._hasIntersection}isDone(){return this._isDone}isBoundaryPoint(t,e){return!(null===e||!this.isBoundaryPointInternal(t,e[0])&&!this.isBoundaryPointInternal(t,e[1]))}setBoundaryNodes(t,e){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=t,this._bdyNodes[1]=e}addIntersections(t,e,i,r){if(t===i&&e===r)return null;this.numTests++;var n=t.getCoordinates()[e],s=t.getCoordinates()[e+1],o=i.getCoordinates()[r],a=i.getCoordinates()[r+1];this._li.computeIntersection(n,s,o,a),this._li.hasIntersection()&&(this._recordIsolated&&(t.setIsolated(!1),i.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(t,e,i,r)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(t.addIntersections(this._li,e,0),i.addIntersections(this._li,r,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))}getClass(){return Si}get interfaces_(){return[]}}Si.constructor_=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;let t=arguments[0],e=arguments[1],i=arguments[2];this._li=t,this._includeProper=e,this._recordIsolated=i};class Ci extends Ti{constructor(){super(),Ci.constructor_.apply(this,arguments)}prepareEvents(){Ae.sort(this.events);for(var t=0;t<this.events.size();t++){var e=this.events.get(t);e.isDelete()&&e.getInsertEvent().setDeleteEventIndex(t)}}computeIntersections(){if(1===arguments.length){let i=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var t=0;t<this.events.size();t++){var e=this.events.get(t);if(e.isInsert()&&this.processOverlaps(t,e.getDeleteEventIndex(),e,i),i.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof Si&&x(arguments[0],I)&&x(arguments[1],I)){let t=arguments[0],e=arguments[1],i=arguments[2];this.addEdges(t,t),this.addEdges(e,e),this.computeIntersections(i)}else if("boolean"==typeof arguments[2]&&x(arguments[0],I)&&arguments[1]instanceof Si){let t=arguments[0],e=arguments[1];arguments[2]?this.addEdges(t,null):this.addEdges(t),this.computeIntersections(e)}}addEdge(t,e){for(var i=t.getMonotoneChainEdge(),r=i.getStartIndexes(),n=0;n<r.length-1;n++){var s=new bi(i,n),o=new Ii(e,i.getMinX(n),s);this.events.add(o),this.events.add(new Ii(i.getMaxX(n),o))}}processOverlaps(t,e,i,r){for(var n=i.getObject(),s=t;s<e;s++){var o=this.events.get(s);if(o.isInsert()){var a=o.getObject();i.isSameLabel(o)||(n.computeIntersections(a,r),this.nOverlaps++)}}}addEdges(){if(1===arguments.length)for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.addEdge(e,e)}else if(2===arguments.length){let i=arguments[0],r=arguments[1];for(t=i.iterator();t.hasNext();)e=t.next(),this.addEdge(e,r)}}getClass(){return Ci}get interfaces_(){return[]}}Ci.constructor_=function(){this.events=new C,this.nOverlaps=null};class Ni{constructor(){Ni.constructor_.apply(this,arguments)}setAllLocations(t){for(var e=0;e<this.location.length;e++)this.location[e]=t}isNull(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==_e.NONE)return!1;return!0}setAllLocationsIfNull(t){for(var e=0;e<this.location.length;e++)this.location[e]===_e.NONE&&(this.location[e]=t)}isLine(){return 1===this.location.length}merge(t){if(t.location.length>this.location.length){var e=new Array(3).fill(null);e[wi.ON]=this.location[wi.ON],e[wi.LEFT]=_e.NONE,e[wi.RIGHT]=_e.NONE,this.location=e}for(var i=0;i<this.location.length;i++)this.location[i]===_e.NONE&&i<t.location.length&&(this.location[i]=t.location[i])}getLocations(){return this.location}flip(){if(this.location.length<=1)return null;var t=this.location[wi.LEFT];this.location[wi.LEFT]=this.location[wi.RIGHT],this.location[wi.RIGHT]=t}toString(){var t=new R;return this.location.length>1&&t.append(_e.toLocationSymbol(this.location[wi.LEFT])),t.append(_e.toLocationSymbol(this.location[wi.ON])),this.location.length>1&&t.append(_e.toLocationSymbol(this.location[wi.RIGHT])),t.toString()}setLocations(t,e,i){this.location[wi.ON]=t,this.location[wi.LEFT]=e,this.location[wi.RIGHT]=i}get(t){return t<this.location.length?this.location[t]:_e.NONE}isArea(){return this.location.length>1}isAnyNull(){for(var t=0;t<this.location.length;t++)if(this.location[t]===_e.NONE)return!0;return!1}setLocation(){if(1===arguments.length){let t=arguments[0];this.setLocation(wi.ON,t)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this.location[t]=e}}init(t){this.location=new Array(t).fill(null),this.setAllLocations(_e.NONE)}isEqualOnSide(t,e){return this.location[e]===t.location[e]}allPositionsEqual(t){for(var e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0}getClass(){return Ni}get interfaces_(){return[]}}Ni.constructor_=function(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array){let t=arguments[0];this.init(t.length)}else if(Number.isInteger(arguments[0])){let t=arguments[0];this.init(1),this.location[wi.ON]=t}else if(arguments[0]instanceof Ni){let e=arguments[0];if(this.init(e.location.length),null!==e)for(var t=0;t<this.location.length;t++)this.location[t]=e.location[t]}}else if(3===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2];this.init(3),this.location[wi.ON]=t,this.location[wi.LEFT]=e,this.location[wi.RIGHT]=i}};class Oi{constructor(){Oi.constructor_.apply(this,arguments)}static toLineLabel(t){for(var e=new Oi(_e.NONE),i=0;i<2;i++)e.setLocation(i,t.getLocation(i));return e}getGeometryCount(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t}setAllLocations(t,e){this.elt[t].setAllLocations(e)}isNull(t){return this.elt[t].isNull()}setAllLocationsIfNull(){if(1===arguments.length){let t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this.elt[t].setAllLocationsIfNull(e)}}isLine(t){return this.elt[t].isLine()}merge(t){for(var e=0;e<2;e++)null===this.elt[e]&&null!==t.elt[e]?this.elt[e]=new Ni(t.elt[e]):this.elt[e].merge(t.elt[e])}flip(){this.elt[0].flip(),this.elt[1].flip()}getLocation(){if(1===arguments.length){let t=arguments[0];return this.elt[t].get(wi.ON)}if(2===arguments.length){let t=arguments[0],e=arguments[1];return this.elt[t].get(e)}}toString(){var t=new R;return null!==this.elt[0]&&(t.append("A:"),t.append(this.elt[0].toString())),null!==this.elt[1]&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()}isArea(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length){let t=arguments[0];return this.elt[t].isArea()}}isAnyNull(t){return this.elt[t].isAnyNull()}setLocation(){if(2===arguments.length){let t=arguments[0],e=arguments[1];this.elt[t].setLocation(wi.ON,e)}else if(3===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2];this.elt[t].setLocation(e,i)}}isEqualOnSide(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)}allPositionsEqual(t,e){return this.elt[t].allPositionsEqual(e)}toLine(t){this.elt[t].isArea()&&(this.elt[t]=new Ni(this.elt[t].location[0]))}getClass(){return Oi}get interfaces_(){return[]}}Oi.constructor_=function(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){let t=arguments[0];this.elt[0]=new Ni(t),this.elt[1]=new Ni(t)}else if(arguments[0]instanceof Oi){let t=arguments[0];this.elt[0]=new Ni(t.elt[0]),this.elt[1]=new Ni(t.elt[1])}}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this.elt[0]=new Ni(_e.NONE),this.elt[1]=new Ni(_e.NONE),this.elt[t].setLocation(e)}else if(3===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2];this.elt[0]=new Ni(t,e,i),this.elt[1]=new Ni(t,e,i)}else if(4===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2],r=arguments[3];this.elt[0]=new Ni(_e.NONE,_e.NONE,_e.NONE),this.elt[1]=new Ni(_e.NONE,_e.NONE,_e.NONE),this.elt[t].setLocations(e,i,r)}};class Pi{constructor(){Pi.constructor_.apply(this,arguments)}getSegmentIndex(){return this.segmentIndex}getCoordinate(){return this.coord}print(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)}compareTo(t){var e=t;return this.compare(e.segmentIndex,e.dist)}isEndPoint(t){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===t}toString(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist}getDistance(){return this.dist}compare(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0}getClass(){return Pi}get interfaces_(){return[c]}}Pi.constructor_=function(){this.coord=null,this.segmentIndex=null,this.dist=null;let t=arguments[0],e=arguments[1],i=arguments[2];this.coord=new y(t),this.segmentIndex=e,this.dist=i};class Li{constructor(){Li.constructor_.apply(this,arguments)}print(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)}iterator(){return this._nodeMap.values().iterator()}addSplitEdges(t){this.addEndpoints();for(var e=this.iterator(),i=e.next();e.hasNext();){var r=e.next(),n=this.createSplitEdge(i,r);t.add(n),i=r}}addEndpoints(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)}createSplitEdge(t,e){var i=e.segmentIndex-t.segmentIndex+2,r=this.edge.pts[e.segmentIndex],n=e.dist>0||!e.coord.equals2D(r);n||i--;var s=new Array(i).fill(null),o=0;s[o++]=new y(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)s[o++]=this.edge.pts[a];return n&&(s[o]=e.coord),new Fi(s,new Oi(this.edge._label))}add(t,e,i){var r=new Pi(t,e,i),n=this._nodeMap.get(r);return null!==n?n:(this._nodeMap.put(r,r),r)}isIntersection(t){for(var e=this.iterator();e.hasNext();)if(e.next().coord.equals(t))return!0;return!1}getClass(){return Li}get interfaces_(){return[]}}Li.constructor_=function(){this._nodeMap=new pt,this.edge=null;let t=arguments[0];this.edge=t};class Ai{constructor(){Ai.constructor_.apply(this,arguments)}static toIntArray(t){for(var e=new Array(t.size()).fill(null),i=0;i<e.length;i++)e[i]=t.get(i).intValue();return e}getChainStartIndices(t){var e=0,i=new C;i.add(new M(e));do{var r=this.findChainEnd(t,e);i.add(new M(r)),e=r}while(e<t.length-1);return Ai.toIntArray(i)}findChainEnd(t,e){for(var i=gi.quadrant(t[e],t[e+1]),r=e+1;r<t.length&&gi.quadrant(t[r-1],t[r])===i;)r++;return r-1}getClass(){return Ai}get interfaces_(){return[]}}Ai.constructor_=function(){};class Ri{constructor(){Ri.constructor_.apply(this,arguments)}getCoordinates(){return this.pts}getMaxX(t){var e=this.pts[this.startIndex[t]].x,i=this.pts[this.startIndex[t+1]].x;return e>i?e:i}getMinX(t){var e=this.pts[this.startIndex[t]].x,i=this.pts[this.startIndex[t+1]].x;return e<i?e:i}computeIntersectsForChain(){if(4===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2],r=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[i],e.startIndex[i+1],r)}else if(6===arguments.length){let i=arguments[0],r=arguments[1],n=arguments[2],s=arguments[3],o=arguments[4],a=arguments[5];if(r-i==1&&o-s==1)return a.addIntersections(this.e,i,n.e,s),null;if(!this.overlaps(i,r,n,s,o))return null;var t=Math.trunc((i+r)/2),e=Math.trunc((s+o)/2);i<t&&(s<e&&this.computeIntersectsForChain(i,t,n,s,e,a),e<o&&this.computeIntersectsForChain(i,t,n,e,o,a)),t<r&&(s<e&&this.computeIntersectsForChain(t,r,n,s,e,a),e<o&&this.computeIntersectsForChain(t,r,n,e,o,a))}}overlaps(t,e,i,r,n){return P.intersects(this.pts[t],this.pts[e],i.pts[r],i.pts[n])}getStartIndexes(){return this.startIndex}computeIntersects(t,e){for(var i=0;i<this.startIndex.length-1;i++)for(var r=0;r<t.startIndex.length-1;r++)this.computeIntersectsForChain(i,t,r,e)}getClass(){return Ri}get interfaces_(){return[]}}Ri.constructor_=function(){this.e=null,this.pts=null,this.startIndex=null;let t=arguments[0];this.e=t,this.pts=t.getCoordinates();var e=new Ai;this.startIndex=e.getChainStartIndices(this.pts)};class Mi{constructor(){Mi.constructor_.apply(this,arguments)}static depthAtLocation(t){return t===_e.EXTERIOR?0:t===_e.INTERIOR?1:Mi.NULL_VALUE}getDepth(t,e){return this._depth[t][e]}setDepth(t,e,i){this._depth[t][e]=i}isNull(){if(0===arguments.length){for(var t=0;t<2;t++)for(var e=0;e<3;e++)if(this._depth[t][e]!==Mi.NULL_VALUE)return!1;return!0}if(1===arguments.length){let t=arguments[0];return this._depth[t][1]===Mi.NULL_VALUE}if(2===arguments.length){let t=arguments[0],e=arguments[1];return this._depth[t][e]===Mi.NULL_VALUE}}normalize(){for(var t=0;t<2;t++)if(!this.isNull(t)){var e=this._depth[t][1];this._depth[t][2]<e&&(e=this._depth[t][2]),e<0&&(e=0);for(var i=1;i<3;i++){var r=0;this._depth[t][i]>e&&(r=1),this._depth[t][i]=r}}}getDelta(t){return this._depth[t][wi.RIGHT]-this._depth[t][wi.LEFT]}getLocation(t,e){return this._depth[t][e]<=0?_e.EXTERIOR:_e.INTERIOR}toString(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]}add(){if(1===arguments.length){let r=arguments[0];for(var t=0;t<2;t++)for(var e=1;e<3;e++){var i=r.getLocation(t,e);i!==_e.EXTERIOR&&i!==_e.INTERIOR||(this.isNull(t,e)?this._depth[t][e]=Mi.depthAtLocation(i):this._depth[t][e]+=Mi.depthAtLocation(i))}}else if(3===arguments.length){let t=arguments[0],e=arguments[1];arguments[2]===_e.INTERIOR&&this._depth[t][e]++}}getClass(){return Mi}get interfaces_(){return[]}}Mi.constructor_=function(){this._depth=Array(2).fill().map(()=>Array(3));for(var t=0;t<2;t++)for(var e=0;e<3;e++)this._depth[t][e]=Mi.NULL_VALUE},Mi.NULL_VALUE=-1;class Di{constructor(){Di.constructor_.apply(this,arguments)}setVisited(t){this._isVisited=t}setInResult(t){this._isInResult=t}isCovered(){return this._isCovered}isCoveredSet(){return this._isCoveredSet}setLabel(t){this._label=t}getLabel(){return this._label}setCovered(t){this._isCovered=t,this._isCoveredSet=!0}updateIM(t){m.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)}isInResult(){return this._isInResult}isVisited(){return this._isVisited}getClass(){return Di}get interfaces_(){return[]}}Di.constructor_=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0===arguments.length);else if(1===arguments.length){let t=arguments[0];this._label=t}};class Fi extends Di{constructor(){super(),Fi.constructor_.apply(this,arguments)}static updateIM(){if(!(2===arguments.length&&arguments[1]instanceof me&&arguments[0]instanceof Oi))return super.updateIM.apply(this,arguments);{let t=arguments[0],e=arguments[1];e.setAtLeastIfValid(t.getLocation(0,wi.ON),t.getLocation(1,wi.ON),1),t.isArea()&&(e.setAtLeastIfValid(t.getLocation(0,wi.LEFT),t.getLocation(1,wi.LEFT),2),e.setAtLeastIfValid(t.getLocation(0,wi.RIGHT),t.getLocation(1,wi.RIGHT),2))}}getDepth(){return this._depth}getCollapsedEdge(){var t=new Array(2).fill(null);return t[0]=this.pts[0],t[1]=this.pts[1],new Fi(t,Oi.toLineLabel(this._label))}isIsolated(){return this._isIsolated}getCoordinates(){return this.pts}setIsolated(t){this._isIsolated=t}setName(t){this._name=t}equals(t){if(!(t instanceof Fi))return!1;var e=t;if(this.pts.length!==e.pts.length)return!1;for(var i=!0,r=!0,n=this.pts.length,s=0;s<this.pts.length;s++)if(this.pts[s].equals2D(e.pts[s])||(i=!1),this.pts[s].equals2D(e.pts[--n])||(r=!1),!i&&!r)return!1;return!0}getCoordinate(){if(0===arguments.length)return this.pts.length>0?this.pts[0]:null;if(1===arguments.length){let t=arguments[0];return this.pts[t]}}print(t){t.print("edge "+this._name+": "),t.print("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.print(","),t.print(this.pts[e].x+" "+this.pts[e].y);t.print(")  "+this._label+" "+this._depthDelta)}computeIM(t){Fi.updateIM(this._label,t)}isCollapsed(){return!!this._label.isArea()&&3===this.pts.length&&!!this.pts[0].equals(this.pts[2])}isClosed(){return this.pts[0].equals(this.pts[this.pts.length-1])}getMaximumSegmentIndex(){return this.pts.length-1}getDepthDelta(){return this._depthDelta}getNumPoints(){return this.pts.length}printReverse(t){t.print("edge "+this._name+": ");for(var e=this.pts.length-1;e>=0;e--)t.print(this.pts[e]+" ");t.println("")}getMonotoneChainEdge(){return null===this._mce&&(this._mce=new Ri(this)),this._mce}getEnvelope(){if(null===this._env){this._env=new P;for(var t=0;t<this.pts.length;t++)this._env.expandToInclude(this.pts[t])}return this._env}addIntersection(t,e,i,r){var n=new y(t.getIntersection(r)),s=e,o=t.getEdgeDistance(i,r),a=s+1;if(a<this.pts.length){var h=this.pts[a];n.equals2D(h)&&(s=a,o=0)}this.eiList.add(n,s,o)}toString(){var t=new Mt;t.append("edge "+this._name+": "),t.append("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.append(","),t.append(this.pts[e].x+" "+this.pts[e].y);return t.append(")  "+this._label+" "+this._depthDelta),t.toString()}isPointwiseEqual(t){if(this.pts.length!==t.pts.length)return!1;for(var e=0;e<this.pts.length;e++)if(!this.pts[e].equals2D(t.pts[e]))return!1;return!0}setDepthDelta(t){this._depthDelta=t}getEdgeIntersectionList(){return this.eiList}addIntersections(t,e,i){for(var r=0;r<t.getIntersectionNum();r++)this.addIntersection(t,e,i,r)}getClass(){return Fi}get interfaces_(){return[]}}Fi.constructor_=function(){if(this.pts=null,this._env=null,this.eiList=new Li(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new Mi,this._depthDelta=0,1===arguments.length){let t=arguments[0];Fi.constructor_.call(this,t,null)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this.pts=t,this._label=e}};class Bi extends Di{constructor(){super(),Bi.constructor_.apply(this,arguments)}isIncidentEdgeInResult(){for(var t=this.getEdges().getEdges().iterator();t.hasNext();)if(t.next().getEdge().isInResult())return!0;return!1}isIsolated(){return 1===this._label.getGeometryCount()}getCoordinate(){return this._coord}print(t){t.println("node "+this._coord+" lbl: "+this._label)}computeIM(t){}computeMergedLocation(t,e){var i=_e.NONE;if(i=this._label.getLocation(e),!t.isNull(e)){var r=t.getLocation(e);i!==_e.BOUNDARY&&(i=r)}return i}setLabel(){if(2!==arguments.length||!Number.isInteger(arguments[1])||!Number.isInteger(arguments[0]))return super.setLabel.apply(this,arguments);{let t=arguments[0],e=arguments[1];null===this._label?this._label=new Oi(t,e):this._label.setLocation(t,e)}}getEdges(){return this._edges}mergeLabel(){if(arguments[0]instanceof Bi){let t=arguments[0];this.mergeLabel(t._label)}else if(arguments[0]instanceof Oi){let i=arguments[0];for(var t=0;t<2;t++){var e=this.computeMergedLocation(i,t);this._label.getLocation(t)===_e.NONE&&this._label.setLocation(t,e)}}}add(t){this._edges.insert(t),t.setNode(this)}setLabelBoundary(t){if(null===this._label)return null;var e=_e.NONE;null!==this._label&&(e=this._label.getLocation(t));var i=null;switch(e){case _e.BOUNDARY:i=_e.INTERIOR;break;case _e.INTERIOR:default:i=_e.BOUNDARY}this._label.setLocation(t,i)}getClass(){return Bi}get interfaces_(){return[]}}Bi.constructor_=function(){this._coord=null,this._edges=null;let t=arguments[0],e=arguments[1];this._coord=t,this._edges=e,this._label=new Oi(0,_e.NONE)};class ki{constructor(){ki.constructor_.apply(this,arguments)}find(t){return this.nodeMap.get(t)}addNode(){if(arguments[0]instanceof y){let e=arguments[0];return null===(t=this.nodeMap.get(e))&&(t=this.nodeFact.createNode(e),this.nodeMap.put(e,t)),t}if(arguments[0]instanceof Bi){let e=arguments[0];var t;return null===(t=this.nodeMap.get(e.getCoordinate()))?(this.nodeMap.put(e.getCoordinate(),e),e):(t.mergeLabel(e),t)}}print(t){for(var e=this.iterator();e.hasNext();)e.next().print(t)}iterator(){return this.nodeMap.values().iterator()}values(){return this.nodeMap.values()}getBoundaryNodes(t){for(var e=new C,i=this.iterator();i.hasNext();){var r=i.next();r.getLabel().getLocation(t)===_e.BOUNDARY&&e.add(r)}return e}add(t){var e=t.getCoordinate();this.addNode(e).add(t)}getClass(){return ki}get interfaces_(){return[]}}ki.constructor_=function(){this.nodeMap=new pt,this.nodeFact=null;let t=arguments[0];this.nodeFact=t};class Gi{constructor(){Gi.constructor_.apply(this,arguments)}compareDirection(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:k.index(t._p0,t._p1,this._p1)}getDy(){return this._dy}getCoordinate(){return this._p0}setNode(t){this._node=t}print(t){var e=Math.atan2(this._dy,this._dx),i=this.getClass().getName(),r=i.lastIndexOf("."),n=i.substring(r+1);t.print("  "+n+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label)}compareTo(t){var e=t;return this.compareDirection(e)}getDirectedCoordinate(){return this._p1}getDx(){return this._dx}getLabel(){return this._label}getEdge(){return this._edge}getQuadrant(){return this._quadrant}getNode(){return this._node}toString(){var t=Math.atan2(this._dy,this._dx),e=this.getClass().getName(),i=e.lastIndexOf(".");return"  "+e.substring(i+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label}computeLabel(t){}init(t,e){this._p0=t,this._p1=e,this._dx=e.x-t.x,this._dy=e.y-t.y,this._quadrant=gi.quadrant(this._dx,this._dy),m.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")}getClass(){return Gi}get interfaces_(){return[c]}}Gi.constructor_=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length){let t=arguments[0];this._edge=t}else if(3===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2];Gi.constructor_.call(this,t,e,i,null)}else if(4===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2],r=arguments[3];Gi.constructor_.call(this,t),this.init(e,i),this._label=r}};class Ui extends f{constructor(){if(1===arguments.length){let t=arguments[0];super(t),f.call(this,t)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];super(Ui.msgWithCoord(t,e)),this.name="TopologyException",this.pt=new y(e)}}getCoordinate(){return this.pt}get interfaces_(){return[]}getClass(){return Ui}static msgWithCoord(t,e){return null!==e?t+" [ "+e+" ]":t}}class Yi extends Gi{constructor(){super(),Yi.constructor_.apply(this,arguments)}static depthFactor(t,e){return t===_e.EXTERIOR&&e===_e.INTERIOR?1:t===_e.INTERIOR&&e===_e.EXTERIOR?-1:0}getNextMin(){return this._nextMin}getDepth(t){return this._depth[t]}setVisited(t){this._isVisited=t}computeDirectedLabel(){this._label=new Oi(this._edge.getLabel()),this._isForward||this._label.flip()}getNext(){return this._next}setDepth(t,e){if(-999!==this._depth[t]&&this._depth[t]!==e)throw new Ui("assigned depths do not match",this.getCoordinate());this._depth[t]=e}isInteriorAreaEdge(){for(var t=!0,e=0;e<2;e++)this._label.isArea(e)&&this._label.getLocation(e,wi.LEFT)===_e.INTERIOR&&this._label.getLocation(e,wi.RIGHT)===_e.INTERIOR||(t=!1);return t}setNextMin(t){this._nextMin=t}print(t){super.print.call(this,t),t.print(" "+this._depth[wi.LEFT]+"/"+this._depth[wi.RIGHT]),t.print(" ("+this.getDepthDelta()+")"),this._isInResult&&t.print(" inResult")}setMinEdgeRing(t){this._minEdgeRing=t}isLineEdge(){var t=this._label.isLine(0)||this._label.isLine(1),e=!this._label.isArea(0)||this._label.allPositionsEqual(0,_e.EXTERIOR),i=!this._label.isArea(1)||this._label.allPositionsEqual(1,_e.EXTERIOR);return t&&e&&i}setEdgeRing(t){this._edgeRing=t}getMinEdgeRing(){return this._minEdgeRing}getDepthDelta(){var t=this._edge.getDepthDelta();return this._isForward||(t=-t),t}setInResult(t){this._isInResult=t}getSym(){return this._sym}isForward(){return this._isForward}getEdge(){return this._edge}printEdge(t){this.print(t),t.print(" "),this._isForward?this._edge.print(t):this._edge.printReverse(t)}setSym(t){this._sym=t}setVisitedEdge(t){this.setVisited(t),this._sym.setVisited(t)}setEdgeDepths(t,e){var i=this.getEdge().getDepthDelta();this._isForward||(i=-i);var r=1;t===wi.LEFT&&(r=-1);var n=wi.opposite(t),s=e+i*r;this.setDepth(t,e),this.setDepth(n,s)}getEdgeRing(){return this._edgeRing}isInResult(){return this._isInResult}setNext(t){this._next=t}isVisited(){return this._isVisited}getClass(){return Yi}get interfaces_(){return[]}}Yi.constructor_=function(){this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999];let t=arguments[0],e=arguments[1];if(Gi.constructor_.call(this,t),this._isForward=e,e)this.init(t.getCoordinate(0),t.getCoordinate(1));else{var i=t.getNumPoints()-1;this.init(t.getCoordinate(i),t.getCoordinate(i-1))}this.computeDirectedLabel()};class zi{constructor(){zi.constructor_.apply(this,arguments)}createNode(t){return new Bi(t,null)}getClass(){return zi}get interfaces_(){return[]}}zi.constructor_=function(){};class Xi{constructor(){Xi.constructor_.apply(this,arguments)}static linkResultDirectedEdges(t){for(var e=t.iterator();e.hasNext();)e.next().getEdges().linkResultDirectedEdges()}printEdges(t){t.println("Edges:");for(var e=0;e<this._edges.size();e++){t.println("edge "+e+":");var i=this._edges.get(e);i.print(t),i.eiList.print(t)}}find(t){return this._nodes.find(t)}addNode(){if(arguments[0]instanceof Bi){let t=arguments[0];return this._nodes.addNode(t)}if(arguments[0]instanceof y){let t=arguments[0];return this._nodes.addNode(t)}}getNodeIterator(){return this._nodes.iterator()}linkResultDirectedEdges(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkResultDirectedEdges()}debugPrintln(t){G.out.println(t)}isBoundaryNode(t,e){var i=this._nodes.find(e);if(null===i)return!1;var r=i.getLabel();return null!==r&&r.getLocation(t)===_e.BOUNDARY}linkAllDirectedEdges(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkAllDirectedEdges()}matchInSameDirection(t,e,i,r){return!!t.equals(i)&&k.index(t,e,r)===k.COLLINEAR&&gi.quadrant(t,e)===gi.quadrant(i,r)}getEdgeEnds(){return this._edgeEndList}debugPrint(t){G.out.print(t)}getEdgeIterator(){return this._edges.iterator()}findEdgeInSameDirection(t,e){for(var i=0;i<this._edges.size();i++){var r=this._edges.get(i),n=r.getCoordinates();if(this.matchInSameDirection(t,e,n[0],n[1]))return r;if(this.matchInSameDirection(t,e,n[n.length-1],n[n.length-2]))return r}return null}insertEdge(t){this._edges.add(t)}findEdgeEnd(t){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var i=e.next();if(i.getEdge()===t)return i}return null}addEdges(t){for(var e=t.iterator();e.hasNext();){var i=e.next();this._edges.add(i);var r=new Yi(i,!0),n=new Yi(i,!1);r.setSym(n),n.setSym(r),this.add(r),this.add(n)}}add(t){this._nodes.add(t),this._edgeEndList.add(t)}getNodes(){return this._nodes.values()}findEdge(t,e){for(var i=0;i<this._edges.size();i++){var r=this._edges.get(i),n=r.getCoordinates();if(t.equals(n[0])&&e.equals(n[1]))return r}return null}getClass(){return Xi}get interfaces_(){return[]}}Xi.constructor_=function(){if(this._edges=new C,this._nodes=null,this._edgeEndList=new C,0===arguments.length)this._nodes=new ki(new zi);else if(1===arguments.length){let t=arguments[0];this._nodes=new ki(t)}};class qi extends Xi{constructor(){super(),qi.constructor_.apply(this,arguments)}static determineBoundary(t,e){return t.isInBoundary(e)?_e.BOUNDARY:_e.INTERIOR}insertBoundaryPoint(t,e){var i=this._nodes.addNode(e).getLabel(),r=1;_e.NONE,i.getLocation(t,wi.ON)===_e.BOUNDARY&&r++;var n=qi.determineBoundary(this._boundaryNodeRule,r);i.setLocation(t,n)}computeSelfNodes(){if(2===arguments.length){let t=arguments[0],e=arguments[1];return this.computeSelfNodes(t,e,!1)}if(3===arguments.length){let n=arguments[0],s=arguments[1],o=arguments[2];var t=new Si(n,!0,!1);t.setIsDoneIfProperInt(o);var e=this.createEdgeSetIntersector(),i=this._parentGeom instanceof Xt||this._parentGeom instanceof Yt||this._parentGeom instanceof qt,r=s||!i;return e.computeIntersections(this._edges,t,r),this.addSelfIntersectionNodes(this._argIndex),t}}computeSplitEdges(t){for(var e=this._edges.iterator();e.hasNext();)e.next().eiList.addSplitEdges(t)}computeEdgeIntersections(t,e,i){var r=new Si(e,i,!0);return r.setBoundaryNodes(this.getBoundaryNodes(),t.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,t._edges,r),r}getGeometry(){return this._parentGeom}getBoundaryNodeRule(){return this._boundaryNodeRule}hasTooFewPoints(){return this._hasTooFewPoints}addPoint(){if(arguments[0]instanceof kt){var t=arguments[0].getCoordinate();this.insertPoint(this._argIndex,t,_e.INTERIOR)}else if(arguments[0]instanceof y){let t=arguments[0];this.insertPoint(this._argIndex,t,_e.INTERIOR)}}addPolygon(t){this.addPolygonRing(t.getExteriorRing(),_e.EXTERIOR,_e.INTERIOR);for(var e=0;e<t.getNumInteriorRing();e++){var i=t.getInteriorRingN(e);this.addPolygonRing(i,_e.INTERIOR,_e.EXTERIOR)}}addEdge(t){this.insertEdge(t);var e=t.getCoordinates();this.insertPoint(this._argIndex,e[0],_e.BOUNDARY),this.insertPoint(this._argIndex,e[e.length-1],_e.BOUNDARY)}addLineString(t){var e=$.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=e[0],null;var i=new Fi(e,new Oi(this._argIndex,_e.INTERIOR));this._lineEdgeMap.put(t,i),this.insertEdge(i),m.isTrue(e.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,e[0]),this.insertBoundaryPoint(this._argIndex,e[e.length-1])}getInvalidPoint(){return this._invalidPoint}getBoundaryPoints(){for(var t=this.getBoundaryNodes(),e=new Array(t.size()).fill(null),i=0,r=t.iterator();r.hasNext();){var n=r.next();e[i++]=n.getCoordinate().copy()}return e}getBoundaryNodes(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes}addSelfIntersectionNode(t,e,i){if(this.isBoundaryNode(t,e))return null;i===_e.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(t,e):this.insertPoint(t,e,i)}addPolygonRing(t,e,i){if(t.isEmpty())return null;var r=$.removeRepeatedPoints(t.getCoordinates());if(r.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=r[0],null;var n=e,s=i;k.isCCW(r)&&(n=i,s=e);var o=new Fi(r,new Oi(this._argIndex,_e.BOUNDARY,n,s));this._lineEdgeMap.put(t,o),this.insertEdge(o),this.insertPoint(this._argIndex,r[0],_e.BOUNDARY)}insertPoint(t,e,i){var r=this._nodes.addNode(e),n=r.getLabel();null===n?r._label=new Oi(t,i):n.setLocation(t,i)}createEdgeSetIntersector(){return new Ci}addSelfIntersectionNodes(t){for(var e=this._edges.iterator();e.hasNext();)for(var i=e.next(),r=i.getLabel().getLocation(t),n=i.eiList.iterator();n.hasNext();){var s=n.next();this.addSelfIntersectionNode(t,s.coord,r)}}add(){if(!(1===arguments.length&&arguments[0]instanceof V))return super.add.apply(this,arguments);{let t=arguments[0];if(t.isEmpty())return null;if(t instanceof qt&&(this._useBoundaryDeterminationRule=!1),t instanceof Yt)this.addPolygon(t);else if(t instanceof Ft)this.addLineString(t);else if(t instanceof kt)this.addPoint(t);else if(t instanceof zt)this.addCollection(t);else if(t instanceof It)this.addCollection(t);else if(t instanceof qt)this.addCollection(t);else{if(!(t instanceof bt))throw new UnsupportedOperationException(t.getClass().getName());this.addCollection(t)}}}addCollection(t){for(var e=0;e<t.getNumGeometries();e++){var i=t.getGeometryN(e);this.add(i)}}locate(t){return x(this._parentGeom,Ut)&&this._parentGeom.getNumGeometries()>50?(null===this._areaPtLocator&&(this._areaPtLocator=new ke(this._parentGeom)),this._areaPtLocator.locate(t)):this._ptLocator.locate(t,this._parentGeom)}findEdge(){if(1===arguments.length&&arguments[0]instanceof Ft){let t=arguments[0];return this._lineEdgeMap.get(t)}return super.findEdge.apply(this,arguments)}getClass(){return qi}get interfaces_(){return[]}}qi.constructor_=function(){if(this._parentGeom=null,this._lineEdgeMap=new re,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new oi,2===arguments.length){let t=arguments[0],e=arguments[1];qi.constructor_.call(this,t,e,W.OGC_SFS_BOUNDARY_RULE)}else if(3===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2];this._argIndex=t,this._parentGeom=e,this._boundaryNodeRule=i,null!==e&&this.add(e)}};var Hi=Object.freeze({GeometryGraph:qi});class Vi{constructor(){Vi.constructor_.apply(this,arguments)}visit(t){}getClass(){return Vi}get interfaces_(){return[]}}Vi.constructor_=function(){};class ji{constructor(){ji.constructor_.apply(this,arguments)}isRepeated(){return this._count>1}getRight(){return this._right}getCoordinate(){return this._p}setLeft(t){this._left=t}getX(){return this._p.x}getData(){return this._data}getCount(){return this._count}getLeft(){return this._left}getY(){return this._p.y}increment(){this._count=this._count+1}setRight(t){this._right=t}getClass(){return ji}get interfaces_(){return[]}}ji.constructor_=function(){if(this._p=null,this._data=null,this._left=null,this._right=null,this._count=null,2===arguments.length){let t=arguments[0],e=arguments[1];this._p=new y(t),this._left=null,this._right=null,this._count=1,this._data=e}else if(3===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2];this._p=new y(t,e),this._left=null,this._right=null,this._count=1,this._data=i}};class Wi{constructor(){Wi.constructor_.apply(this,arguments)}static toCoordinates(){if(1===arguments.length){let t=arguments[0];return Wi.toCoordinates(t,!1)}if(2===arguments.length){let s=arguments[0],o=arguments[1];for(var t=new O,e=s.iterator();e.hasNext();)for(var i=e.next(),r=o?i.getCount():1,n=0;n<r;n++)t.add(i.getCoordinate(),!0);return t.toCoordinateArray()}}insert(){if(1===arguments.length){let t=arguments[0];return this.insert(t,null)}if(2===arguments.length){let e=arguments[0],i=arguments[1];if(null===this._root)return this._root=new ji(e,i),this._root;if(this._tolerance>0){var t=this.findBestMatchNode(e);if(null!==t)return t.increment(),t}return this.insertExact(e,i)}}query(){if(1===arguments.length){let e=arguments[0];var t=new C;return this.query(e,t),t}if(2===arguments.length)if(arguments[0]instanceof P&&x(arguments[1],I)){let t=arguments[0],e=arguments[1];this.queryNode(this._root,t,!0,new class{get interfaces_(){return[Vi]}visit(t){e.add(t)}})}else if(arguments[0]instanceof P&&x(arguments[1],Vi)){let t=arguments[0],e=arguments[1];this.queryNode(this._root,t,!0,e)}}queryNode(t,e,i,r){if(null===t)return null;var n=null,s=null,o=null;i?(n=e.getMinX(),s=e.getMaxX(),o=t.getX()):(n=e.getMinY(),s=e.getMaxY(),o=t.getY());var a=o<=s;n<o&&this.queryNode(t.getLeft(),e,!i,r),e.contains(t.getCoordinate())&&r.visit(t),a&&this.queryNode(t.getRight(),e,!i,r)}findBestMatchNode(t){var e=new Ki(t,this._tolerance);return this.query(e.queryEnvelope(),e),e.getNode()}isEmpty(){return null===this._root}insertExact(t,e){for(var i=this._root,r=this._root,n=!0,s=!0;null!==i;){if(null!==i&&t.distance(i.getCoordinate())<=this._tolerance)return i.increment(),i;s=n?t.x<i.getX():t.y<i.getY(),r=i,i=s?i.getLeft():i.getRight(),n=!n}this._numberOfNodes=this._numberOfNodes+1;var o=new ji(t,e);return s?r.setLeft(o):r.setRight(o),o}getClass(){return Wi}get interfaces_(){return[]}}class Ki{constructor(){Ki.constructor_.apply(this,arguments)}visit(t){var e=this._p.distance(t.getCoordinate());if(!(e<=this._tolerance))return null;var i=!1;(null===this._matchNode||e<this._matchDist||null!==this._matchNode&&e===this._matchDist&&t.getCoordinate().compareTo(this._matchNode.getCoordinate())<1)&&(i=!0),i&&(this._matchNode=t,this._matchDist=e)}queryEnvelope(){var t=new P(this._p);return t.expandBy(this._tolerance),t}getNode(){return this._matchNode}getClass(){return Ki}get interfaces_(){return[Vi]}}Ki.constructor_=function(){this._tolerance=null,this._matchNode=null,this._matchDist=0,this._p=null;let t=arguments[0],e=arguments[1];this._p=t,this._tolerance=e},Wi.BestMatchVisitor=Ki,Wi.constructor_=function(){if(this._root=null,this._numberOfNodes=null,this._tolerance=null,0===arguments.length)Wi.constructor_.call(this,0);else if(1===arguments.length){let t=arguments[0];this._tolerance=t}};var Zi=Object.freeze({KdTree:Wi});class Ji{constructor(){Ji.constructor_.apply(this,arguments)}static getSubnodeIndex(t,e,i){var r=-1;return t.getMinX()>=e&&(t.getMinY()>=i&&(r=3),t.getMaxY()<=i&&(r=1)),t.getMaxX()<=e&&(t.getMinY()>=i&&(r=2),t.getMaxY()<=i&&(r=0)),r}hasChildren(){for(var t=0;t<4;t++)if(null!==this._subnode[t])return!0;return!1}isPrunable(){return!(this.hasChildren()||this.hasItems())}addAllItems(t){t.addAll(this._items);for(var e=0;e<4;e++)null!==this._subnode[e]&&this._subnode[e].addAllItems(t);return t}getNodeCount(){for(var t=0,e=0;e<4;e++)null!==this._subnode[e]&&(t+=this._subnode[e].size());return t+1}size(){for(var t=0,e=0;e<4;e++)null!==this._subnode[e]&&(t+=this._subnode[e].size());return t+this._items.size()}addAllItemsFromOverlapping(t,e){if(!this.isSearchMatch(t))return null;e.addAll(this._items);for(var i=0;i<4;i++)null!==this._subnode[i]&&this._subnode[i].addAllItemsFromOverlapping(t,e)}visitItems(t,e){for(var i=this._items.iterator();i.hasNext();)e.visitItem(i.next())}hasItems(){return!this._items.isEmpty()}remove(t,e){if(!this.isSearchMatch(t))return!1;for(var i=!1,r=0;r<4;r++)if(null!==this._subnode[r]&&(i=this._subnode[r].remove(t,e))){this._subnode[r].isPrunable()&&(this._subnode[r]=null);break}return i||(i=this._items.remove(e))}visit(t,e){if(!this.isSearchMatch(t))return null;this.visitItems(t,e);for(var i=0;i<4;i++)null!==this._subnode[i]&&this._subnode[i].visit(t,e)}getItems(){return this._items}depth(){for(var t=0,e=0;e<4;e++)if(null!==this._subnode[e]){var i=this._subnode[e].depth();i>t&&(t=i)}return t+1}isEmpty(){var t=!0;if(this._items.isEmpty()){for(var e=0;e<4;e++)if(null!==this._subnode[e]&&!this._subnode[e].isEmpty()){t=!1;break}}else t=!1;return t}add(t){this._items.add(t)}getClass(){return Ji}get interfaces_(){return[g]}}function Qi(){}Ji.constructor_=function(){this._items=new C,this._subnode=new Array(4).fill(null)},Qi.exponent=function(t){return function(t,e){var i,r,n,s,o=11;if(s||(i=e<0||1/e<0,isFinite(e)||(s={d:32752,c:0,b:0,a:0},i&&(s.d+=32768),r=Math.pow(2,o)-1,n=0)),!s){for(r=1023,n=Math.abs(e);n>=2;)r++,n/=2;for(;n<1&&r>0;)r--,n*=2;r<=0&&(n/=2)}return r}(0,t)-1023},Qi.powerOf2=function(t){return Math.pow(2,t)};class $i{constructor(){$i.constructor_.apply(this,arguments)}static computeQuadLevel(t){var e=t.getWidth(),i=t.getHeight(),r=e>i?e:i;return Qi.exponent(r)+1}getLevel(){return this._level}computeKey(){if(1===arguments.length){let t=arguments[0];for(this._level=$i.computeQuadLevel(t),this._env=new P,this.computeKey(this._level,t);!this._env.contains(t);)this._level+=1,this.computeKey(this._level,t)}else if(2===arguments.length){let e=arguments[0],i=arguments[1];var t=Qi.powerOf2(e);this._pt.x=Math.floor(i.getMinX()/t)*t,this._pt.y=Math.floor(i.getMinY()/t)*t,this._env.init(this._pt.x,this._pt.x+t,this._pt.y,this._pt.y+t)}}getEnvelope(){return this._env}getCentre(){return new y((this._env.getMinX()+this._env.getMaxX())/2,(this._env.getMinY()+this._env.getMaxY())/2)}getPoint(){return this._pt}getClass(){return $i}get interfaces_(){return[]}}$i.constructor_=function(){this._pt=new y,this._level=0,this._env=null;let t=arguments[0];this.computeKey(t)};class tr extends Ji{constructor(){super(),tr.constructor_.apply(this,arguments)}static createNode(t){var e=new $i(t);return new tr(e.getEnvelope(),e.getLevel())}static createExpanded(t,e){var i=new P(e);null!==t&&i.expandToInclude(t._env);var r=tr.createNode(i);return null!==t&&r.insertNode(t),r}find(t){var e=Ji.getSubnodeIndex(t,this._centrex,this._centrey);return-1===e?this:null!==this._subnode[e]?this._subnode[e].find(t):this}isSearchMatch(t){return null!==t&&this._env.intersects(t)}getSubnode(t){return null===this._subnode[t]&&(this._subnode[t]=this.createSubnode(t)),this._subnode[t]}getEnvelope(){return this._env}getNode(t){var e=Ji.getSubnodeIndex(t,this._centrex,this._centrey);return-1!==e?this.getSubnode(e).getNode(t):this}createSubnode(t){var e=0,i=0,r=0,n=0;switch(t){case 0:e=this._env.getMinX(),i=this._centrex,r=this._env.getMinY(),n=this._centrey;break;case 1:e=this._centrex,i=this._env.getMaxX(),r=this._env.getMinY(),n=this._centrey;break;case 2:e=this._env.getMinX(),i=this._centrex,r=this._centrey,n=this._env.getMaxY();break;case 3:e=this._centrex,i=this._env.getMaxX(),r=this._centrey,n=this._env.getMaxY()}var s=new P(e,i,r,n);return new tr(s,this._level-1)}insertNode(t){m.isTrue(null===this._env||this._env.contains(t._env));var e=Ji.getSubnodeIndex(t._env,this._centrex,this._centrey);if(t._level===this._level-1)this._subnode[e]=t;else{var i=this.createSubnode(e);i.insertNode(t),this._subnode[e]=i}}getClass(){return tr}get interfaces_(){return[]}}tr.constructor_=function(){this._env=null,this._centrex=null,this._centrey=null,this._level=null;let t=arguments[0],e=arguments[1];this._env=t,this._level=e,this._centrex=(t.getMinX()+t.getMaxX())/2,this._centrey=(t.getMinY()+t.getMaxY())/2};class er{constructor(){er.constructor_.apply(this,arguments)}static isZeroWidth(t,e){var i=e-t;if(0===i)return!0;var r=i/Math.max(Math.abs(t),Math.abs(e));return Qi.exponent(r)<=er.MIN_BINARY_EXPONENT}getClass(){return er}get interfaces_(){return[]}}er.constructor_=function(){},er.MIN_BINARY_EXPONENT=-50;class ir extends Ji{constructor(){super(),ir.constructor_.apply(this,arguments)}insert(t,e){var i=Ji.getSubnodeIndex(t,ir.origin.x,ir.origin.y);if(-1===i)return this.add(e),null;var r=this._subnode[i];if(null===r||!r.getEnvelope().contains(t)){var n=tr.createExpanded(r,t);this._subnode[i]=n}this.insertContained(this._subnode[i],t,e)}isSearchMatch(t){return!0}insertContained(t,e,i){m.isTrue(t.getEnvelope().contains(e));var r=er.isZeroWidth(e.getMinX(),e.getMaxX()),n=er.isZeroWidth(e.getMinY(),e.getMaxY());(r||n?t.find(e):t.getNode(e)).add(i)}getClass(){return ir}get interfaces_(){return[]}}ir.constructor_=function(){},ir.origin=new y(0,0);class rr{constructor(){rr.constructor_.apply(this,arguments)}insert(t,e){}remove(t,e){}query(){}getClass(){return rr}get interfaces_(){return[]}}rr.constructor_=function(){};class nr{constructor(){nr.constructor_.apply(this,arguments)}static ensureExtent(t,e){var i=t.getMinX(),r=t.getMaxX(),n=t.getMinY(),s=t.getMaxY();return i!==r&&n!==s?t:(i===r&&(r=(i-=e/2)+e/2),n===s&&(s=(n-=e/2)+e/2),new P(i,r,n,s))}size(){return null!==this._root?this._root.size():0}insert(t,e){this.collectStats(t);var i=nr.ensureExtent(t,this._minExtent);this._root.insert(i,e)}query(){if(1===arguments.length){let e=arguments[0];var t=new Fe;return this.query(e,t),t.getItems()}if(2===arguments.length){let t=arguments[0],e=arguments[1];this._root.visit(t,e)}}queryAll(){var t=new C;return this._root.addAllItems(t),t}remove(t,e){var i=nr.ensureExtent(t,this._minExtent);return this._root.remove(i,e)}collectStats(t){var e=t.getWidth();e<this._minExtent&&e>0&&(this._minExtent=e);var i=t.getHeight();i<this._minExtent&&i>0&&(this._minExtent=i)}depth(){return null!==this._root?this._root.depth():0}isEmpty(){return null===this._root||this._root.isEmpty()}getClass(){return nr}get interfaces_(){return[rr,g]}}nr.constructor_=function(){this._root=null,this._minExtent=1,this._root=new ir},nr.serialVersionUID=-0x678b60c967a25400;var sr=Object.freeze({Quadtree:nr});class or{constructor(){or.constructor_.apply(this,arguments)}getBounds(){}getClass(){return or}get interfaces_(){return[]}}or.constructor_=function(){};class ar{constructor(){ar.constructor_.apply(this,arguments)}getItem(){return this._item}getBounds(){return this._bounds}getClass(){return ar}get interfaces_(){return[or,g]}}ar.constructor_=function(){this._bounds=null,this._item=null;let t=arguments[0],e=arguments[1];this._bounds=t,this._item=e};class hr{constructor(){hr.constructor_.apply(this,arguments)}poll(){if(this.isEmpty())return null;var t=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),t}size(){return this._size}reorder(t){for(var e=null,i=this._items.get(t);2*t<=this._size&&((e=2*t)!==this._size&&this._items.get(e+1).compareTo(this._items.get(e))<0&&e++,this._items.get(e).compareTo(i)<0);t=e)this._items.set(t,this._items.get(e));this._items.set(t,i)}clear(){this._size=0,this._items.clear()}peek(){return this.isEmpty()?null:this._items.get(1)}isEmpty(){return 0===this._size}add(t){this._items.add(null),this._size+=1;var e=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(e/2)))<0;e/=2)this._items.set(e,this._items.get(Math.trunc(e/2)));this._items.set(e,t)}getClass(){return hr}get interfaces_(){return[]}}hr.constructor_=function(){this._size=null,this._items=null,this._size=0,this._items=new C,this._items.add(null)};class lr{constructor(){lr.constructor_.apply(this,arguments)}getLevel(){return this._level}size(){return this._childBoundables.size()}getChildBoundables(){return this._childBoundables}addChildBoundable(t){m.isTrue(null===this._bounds),this._childBoundables.add(t)}isEmpty(){return this._childBoundables.isEmpty()}getBounds(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds}getClass(){return lr}get interfaces_(){return[or,g]}}lr.constructor_=function(){if(this._childBoundables=new C,this._bounds=null,this._level=null,0===arguments.length);else if(1===arguments.length){let t=arguments[0];this._level=t}},lr.serialVersionUID=0x5a1e55ec41369800;class ur{constructor(){ur.constructor_.apply(this,arguments)}static area(t){return t.getBounds().getArea()}static isComposite(t){return t instanceof lr}expandToQueue(t,e){var r=ur.isComposite(this._boundable1),n=ur.isComposite(this._boundable2);if(r&&n)return ur.area(this._boundable1)>ur.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,t,e),null):(this.expand(this._boundable2,this._boundable1,t,e),null);if(r)return this.expand(this._boundable1,this._boundable2,t,e),null;if(n)return this.expand(this._boundable2,this._boundable1,t,e),null;throw new i("neither boundable is composite")}isLeaves(){return!(ur.isComposite(this._boundable1)||ur.isComposite(this._boundable2))}compareTo(t){var e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0}expand(t,e,i,r){for(var n=t.getChildBoundables().iterator();n.hasNext();){var s=n.next(),o=new ur(s,e,this._itemDistance);o.getDistance()<r&&i.add(o)}}getBoundable(t){return 0===t?this._boundable1:this._boundable2}getDistance(){return this._distance}distance(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())}getClass(){return ur}get interfaces_(){return[c]}}ur.constructor_=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;let t=arguments[0],e=arguments[1],i=arguments[2];this._boundable1=t,this._boundable2=e,this._itemDistance=i,this._distance=this.distance()};class cr{constructor(){cr.constructor_.apply(this,arguments)}static compareDoubles(t,e){return t>e?1:t<e?-1:0}queryInternal(){if(x(arguments[2],Ce)&&arguments[0]instanceof Object&&arguments[1]instanceof lr){let r=arguments[0],n=arguments[1],s=arguments[2];for(var t=n.getChildBoundables(),e=0;e<t.size();e++){var i=t.get(e);this.getIntersectsOp().intersects(i.getBounds(),r)&&(i instanceof lr?this.queryInternal(r,i,s):i instanceof ar?s.visitItem(i.getItem()):m.shouldNeverReachHere())}}else if(x(arguments[2],I)&&arguments[0]instanceof Object&&arguments[1]instanceof lr){let r=arguments[0],n=arguments[1],s=arguments[2];for(t=n.getChildBoundables(),e=0;e<t.size();e++)i=t.get(e),this.getIntersectsOp().intersects(i.getBounds(),r)&&(i instanceof lr?this.queryInternal(r,i,s):i instanceof ar?s.add(i.getItem()):m.shouldNeverReachHere())}}getNodeCapacity(){return this._nodeCapacity}lastNode(t){return t.get(t.size()-1)}size(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var i=e.next();i instanceof lr?t+=this.size(i):i instanceof ar&&(t+=1)}return t}}removeItem(t,e){for(var i=null,r=t.getChildBoundables().iterator();r.hasNext();){var n=r.next();n instanceof ar&&n.getItem()===e&&(i=n)}return null!==i&&(t.getChildBoundables().remove(i),!0)}itemsTree(){if(0===arguments.length){this.build();var t=this.itemsTree(this._root);return null===t?new C:t}if(1===arguments.length){let t=arguments[0];for(var e=new C,i=t.getChildBoundables().iterator();i.hasNext();){var r=i.next();if(r instanceof lr){var n=this.itemsTree(r);null!==n&&e.add(n)}else r instanceof ar?e.add(r.getItem()):m.shouldNeverReachHere()}return e.size()<=0?null:e}}insert(t,e){m.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new ar(t,e))}boundablesAtLevel(){if(1===arguments.length){let e=arguments[0];var t=new C;return this.boundablesAtLevel(e,this._root,t),t}if(3===arguments.length){let t=arguments[0],r=arguments[1],n=arguments[2];if(m.isTrue(t>-2),r.getLevel()===t)return n.add(r),null;for(var e=r.getChildBoundables().iterator();e.hasNext();){var i=e.next();i instanceof lr?this.boundablesAtLevel(t,i,n):(m.isTrue(i instanceof ar),-1===t&&n.add(i))}return null}}query(){if(1===arguments.length){let e=arguments[0];this.build();var t=new C;return this.isEmpty()?t:(this.getIntersectsOp().intersects(this._root.getBounds(),e)&&this.queryInternal(e,this._root,t),t)}if(2===arguments.length){let t=arguments[0],e=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.queryInternal(t,this._root,e)}}build(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0}getRoot(){return this.build(),this._root}remove(){if(2===arguments.length){let t=arguments[0],e=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.remove(t,this._root,e)}if(3===arguments.length){let n=arguments[0],s=arguments[1],o=arguments[2];var t=this.removeItem(s,o);if(t)return!0;for(var e=null,i=s.getChildBoundables().iterator();i.hasNext();){var r=i.next();if(this.getIntersectsOp().intersects(r.getBounds(),n)&&r instanceof lr&&(t=this.remove(n,r,o))){e=r;break}}return null!==e&&e.getChildBoundables().isEmpty()&&s.getChildBoundables().remove(e),t}}createHigherLevels(t,e){m.isTrue(!t.isEmpty());var i=this.createParentBoundables(t,e+1);return 1===i.size()?i.get(0):this.createHigherLevels(i,e+1)}depth(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var i=e.next();if(i instanceof lr){var r=this.depth(i);r>t&&(t=r)}}return t+1}}createParentBoundables(t,e){m.isTrue(!t.isEmpty());var i=new C;i.add(this.createNode(e));var r=new C(t);Ae.sort(r,this.getComparator());for(var n=r.iterator();n.hasNext();){var s=n.next();this.lastNode(i).getChildBoundables().size()===this.getNodeCapacity()&&i.add(this.createNode(e)),this.lastNode(i).addChildBoundable(s)}return i}isEmpty(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()}getClass(){return cr}get interfaces_(){return[g]}}cr.IntersectsOp=function(){},cr.constructor_=function(){if(this._root=null,this._built=!1,this._itemBoundables=new C,this._nodeCapacity=null,0===arguments.length)cr.constructor_.call(this,cr.DEFAULT_NODE_CAPACITY);else if(1===arguments.length){let t=arguments[0];m.isTrue(t>1,"Node capacity must be greater than 1"),this._nodeCapacity=t}},cr.serialVersionUID=-0x35ef64c82d4c5400,cr.DEFAULT_NODE_CAPACITY=10;class dr{constructor(){dr.constructor_.apply(this,arguments)}distance(t,e){}getClass(){return dr}get interfaces_(){return[]}}dr.constructor_=function(){};class pr extends cr{constructor(){super(),pr.constructor_.apply(this,arguments)}static centreX(t){return pr.avg(t.getMinX(),t.getMaxX())}static avg(t,e){return(t+e)/2}static getItems(t){for(var e=new Array(t.size()).fill(null),i=0;!t.isEmpty();){var r=t.poll();e[i]=r.getBoundable(0).getItem(),i++}return e}static centreY(t){return pr.avg(t.getMinY(),t.getMaxY())}createParentBoundablesFromVerticalSlices(t,e){m.isTrue(t.length>0);for(var i=new C,r=0;r<t.length;r++)i.addAll(this.createParentBoundablesFromVerticalSlice(t[r],e));return i}createNode(t){return new gr(t)}size(){return 0===arguments.length?super.size.call(this):super.size.apply(this,arguments)}insert(){if(!(2===arguments.length&&arguments[1]instanceof Object&&arguments[0]instanceof P))return super.insert.apply(this,arguments);{let t=arguments[0],e=arguments[1];if(t.isNull())return null;super.insert.call(this,t,e)}}getIntersectsOp(){return pr.intersectsOp}verticalSlices(t,e){for(var i=Math.trunc(Math.ceil(t.size()/e)),r=new Array(e).fill(null),n=t.iterator(),s=0;s<e;s++){r[s]=new C;for(var o=0;n.hasNext()&&o<i;){var a=n.next();r[s].add(a),o++}}return r}query(){if(1===arguments.length){let t=arguments[0];return super.query.call(this,t)}if(2===arguments.length){let t=arguments[0],e=arguments[1];super.query.call(this,t,e)}}getComparator(){return pr.yComparator}createParentBoundablesFromVerticalSlice(t,e){return super.createParentBoundables.call(this,t,e)}remove(){if(2===arguments.length&&arguments[1]instanceof Object&&arguments[0]instanceof P){let t=arguments[0],e=arguments[1];return super.remove.call(this,t,e)}return super.remove.apply(this,arguments)}depth(){return 0===arguments.length?super.depth.call(this):super.depth.apply(this,arguments)}createParentBoundables(t,e){m.isTrue(!t.isEmpty());var i=Math.trunc(Math.ceil(t.size()/this.getNodeCapacity())),r=new C(t);Ae.sort(r,pr.xComparator);var n=this.verticalSlices(r,Math.trunc(Math.ceil(Math.sqrt(i))));return this.createParentBoundablesFromVerticalSlices(n,e)}nearestNeighbour(){if(1===arguments.length){if(x(arguments[0],dr)){let e=arguments[0];var t=new ur(this.getRoot(),this.getRoot(),e);return this.nearestNeighbour(t)}if(arguments[0]instanceof ur){let t=arguments[0];return this.nearestNeighbour(t,n.POSITIVE_INFINITY)}}else if(2===arguments.length){if(arguments[0]instanceof pr&&x(arguments[1],dr)){let e=arguments[0],i=arguments[1];return t=new ur(this.getRoot(),e.getRoot(),i),this.nearestNeighbour(t)}if(arguments[0]instanceof ur&&"number"==typeof arguments[1]){let t=arguments[0];var e=arguments[1],i=null;for((s=new hr).add(t);!s.isEmpty()&&e>0&&!((h=(a=s.poll()).getDistance())>=e);)a.isLeaves()?(e=h,i=a):a.expandToQueue(s,e);return[i.getBoundable(0).getItem(),i.getBoundable(1).getItem()]}if(arguments[0]instanceof ur&&Number.isInteger(arguments[1])){let t=arguments[0],e=arguments[1];return this.nearestNeighbour(t,n.POSITIVE_INFINITY,e)}}else if(3===arguments.length){if(x(arguments[2],dr)&&arguments[0]instanceof P&&arguments[1]instanceof Object){let e=arguments[0],i=arguments[1],n=arguments[2];var r=new ar(e,i);return t=new ur(this.getRoot(),r,n),this.nearestNeighbour(t)[0]}if(Number.isInteger(arguments[2])&&arguments[0]instanceof ur&&"number"==typeof arguments[1]){let t=arguments[0],i=arguments[1],r=arguments[2];var s;e=i,(s=new hr).add(t);for(var o=new hr;!s.isEmpty()&&e>=0;){var a,h;if((h=(a=s.poll()).getDistance())>=e)break;a.isLeaves()?o.size()<r?o.add(a):(o.peek().getDistance()>h&&(o.poll(),o.add(a)),e=o.peek().getDistance()):a.expandToQueue(s,e)}return pr.getItems(o)}}else if(4===arguments.length){let e=arguments[0],i=arguments[1],n=arguments[2],s=arguments[3];return r=new ar(e,i),t=new ur(this.getRoot(),r,n),this.nearestNeighbour(t,s)}}getClass(){return pr}get interfaces_(){return[rr,g]}}class gr extends lr{constructor(){super(),gr.constructor_.apply(this,arguments)}computeBounds(){for(var t=null,e=this.getChildBoundables().iterator();e.hasNext();){var i=e.next();null===t?t=new P(i.getBounds()):t.expandToInclude(i.getBounds())}return t}getClass(){return gr}get interfaces_(){return[]}}gr.constructor_=function(){let t=arguments[0];lr.constructor_.call(this,t)},pr.STRtreeNode=gr,pr.constructor_=function(){if(0===arguments.length)pr.constructor_.call(this,pr.DEFAULT_NODE_CAPACITY);else if(1===arguments.length){let t=arguments[0];cr.constructor_.call(this,t)}},pr.serialVersionUID=0x39920f7d5f261e0,pr.xComparator=new class{get interfaces_(){return[p]}compare(t,e){return cr.compareDoubles(pr.centreX(t.getBounds()),pr.centreX(e.getBounds()))}},pr.yComparator=new class{get interfaces_(){return[p]}compare(t,e){return cr.compareDoubles(pr.centreY(t.getBounds()),pr.centreY(e.getBounds()))}},pr.intersectsOp=new class{get interfaces_(){return[IntersectsOp]}intersects(t,e){return t.intersects(e)}},pr.DEFAULT_NODE_CAPACITY=10;var fr=Object.freeze({STRtree:pr}),_r=Object.freeze({kdtree:Zi,quadtree:sr,strtree:fr});const mr=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"];class yr{constructor(t){this.geometryFactory=t||new oe}read(t){let e;const i=(e="string"==typeof t?JSON.parse(t):t).type;if(!vr[i])throw new Error("Unknown GeoJSON type: "+e.type);return-1!==mr.indexOf(i)?vr[i].call(this,e.coordinates):"GeometryCollection"===i?vr[i].call(this,e.geometries):vr[i].call(this,e)}write(t){const e=t.getGeometryType();if(!xr[e])throw new Error("Geometry is not supported");return xr[e].call(this,t)}}const vr={Feature:function(t){const e={};for(let i in t)e[i]=t[i];if(t.geometry){const i=t.geometry.type;if(!vr[i])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=vr.bbox.call(this,t.bbox)),e},FeatureCollection:function(t){const e={};if(t.features){e.features=[];for(let i=0;i<t.features.length;++i)e.features.push(this.read(t.features[i]))}return t.bbox&&(e.bbox=this.parse.bbox.call(this,t.bbox)),e},coordinates:function(t){const e=[];for(let i=0;i<t.length;++i){const r=t[i];e.push(new y(r[0],r[1]))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new y(t[0],t[1]),new y(t[2],t[1]),new y(t[2],t[3]),new y(t[0],t[3]),new y(t[0],t[1])])},Point:function(t){const e=new y(t[0],t[1]);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){const e=[];for(let i=0;i<t.length;++i)e.push(vr.Point.call(this,t[i]));return this.geometryFactory.createMultiPoint(e)},LineString:function(t){const e=vr.coordinates.call(this,t);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){const e=[];for(let i=0;i<t.length;++i)e.push(vr.LineString.call(this,t[i]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(t){const e=vr.coordinates.call(this,t[0]),i=this.geometryFactory.createLinearRing(e),r=[];for(let e=1;e<t.length;++e){var n=t[e],s=vr.coordinates.call(this,n),o=this.geometryFactory.createLinearRing(s);r.push(o)}return this.geometryFactory.createPolygon(i,r)},MultiPolygon:function(t){const e=[];for(let i=0;i<t.length;++i){const r=t[i];e.push(vr.Polygon.call(this,r))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(t){const e=[];for(let i=0;i<t.length;++i){const r=t[i];e.push(this.read(r))}return this.geometryFactory.createGeometryCollection(e)}},xr={coordinate:function(t){return[t.x,t.y]},Point:function(t){return{type:"Point",coordinates:xr.coordinate.call(this,t.getCoordinate())}},MultiPoint:function(t){const e=[];for(let i=0;i<t._geometries.length;++i){const r=t._geometries[i],n=xr.Point.call(this,r);e.push(n.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(t){const e=[],i=t.getCoordinates();for(let t=0;t<i.length;++t){const r=i[t];e.push(xr.coordinate.call(this,r))}return{type:"LineString",coordinates:e}},MultiLineString:function(t){const e=[];for(let i=0;i<t._geometries.length;++i){const r=t._geometries[i],n=xr.LineString.call(this,r);e.push(n.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(t){const e=[],i=xr.LineString.call(this,t._shell);e.push(i.coordinates);for(let i=0;i<t._holes.length;++i){const r=t._holes[i],n=xr.LineString.call(this,r);e.push(n.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(t){const e=[];for(let i=0;i<t._geometries.length;++i){const r=t._geometries[i],n=xr.Polygon.call(this,r);e.push(n.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(t){const e=[];for(let i=0;i<t._geometries.length;++i){const r=t._geometries[i],n=r.getGeometryType();e.push(xr[n].call(this,r))}return{type:"GeometryCollection",geometries:e}}};function Er(t){return[t.x,t.y]}var wr=Object.freeze({GeoJSONReader:class{constructor(t){this.parser=new yr(t||new oe)}read(t){return this.parser.read(t)}},GeoJSONWriter:class{constructor(){this.parser=new yr(this.geometryFactory)}write(t){return this.parser.write(t)}},OL3Parser:class{constructor(t,e){this.geometryFactory=t||new oe,this.ol=e||"undefined"!=typeof ol&&ol}inject(t,e,i,r,n,s,o,a){this.ol={geom:{Point:t,LineString:e,LinearRing:i,Polygon:r,MultiPoint:n,MultiLineString:s,MultiPolygon:o,GeometryCollection:a}}}read(t){const e=this.ol;return t instanceof e.geom.Point?this.convertFromPoint(t):t instanceof e.geom.LineString?this.convertFromLineString(t):t instanceof e.geom.LinearRing?this.convertFromLinearRing(t):t instanceof e.geom.Polygon?this.convertFromPolygon(t):t instanceof e.geom.MultiPoint?this.convertFromMultiPoint(t):t instanceof e.geom.MultiLineString?this.convertFromMultiLineString(t):t instanceof e.geom.MultiPolygon?this.convertFromMultiPolygon(t):t instanceof e.geom.GeometryCollection?this.convertFromCollection(t):void 0}convertFromPoint(t){const e=t.getCoordinates();return this.geometryFactory.createPoint(new y(e[0],e[1]))}convertFromLineString(t){return this.geometryFactory.createLineString(t.getCoordinates().map(function(t){return new y(t[0],t[1])}))}convertFromLinearRing(t){return this.geometryFactory.createLinearRing(t.getCoordinates().map(function(t){return new y(t[0],t[1])}))}convertFromPolygon(t){const e=t.getLinearRings();var i=null,r=[];for(let t=0;t<e.length;t++){const n=this.convertFromLinearRing(e[t]);0===t?i=n:r.push(n)}return this.geometryFactory.createPolygon(i,r)}convertFromMultiPoint(t){const e=t.getPoints().map(function(t){return this.convertFromPoint(t)},this);return this.geometryFactory.createMultiPoint(e)}convertFromMultiLineString(t){const e=t.getLineStrings().map(function(t){return this.convertFromLineString(t)},this);return this.geometryFactory.createMultiLineString(e)}convertFromMultiPolygon(t){const e=t.getPolygons().map(function(t){return this.convertFromPolygon(t)},this);return this.geometryFactory.createMultiPolygon(e)}convertFromCollection(t){const e=t.getGeometries().map(function(t){return this.read(t)},this);return this.geometryFactory.createGeometryCollection(e)}write(t){return"Point"===t.getGeometryType()?this.convertToPoint(t.getCoordinate()):"LineString"===t.getGeometryType()?this.convertToLineString(t):"LinearRing"===t.getGeometryType()?this.convertToLinearRing(t):"Polygon"===t.getGeometryType()?this.convertToPolygon(t):"MultiPoint"===t.getGeometryType()?this.convertToMultiPoint(t):"MultiLineString"===t.getGeometryType()?this.convertToMultiLineString(t):"MultiPolygon"===t.getGeometryType()?this.convertToMultiPolygon(t):"GeometryCollection"===t.getGeometryType()?this.convertToCollection(t):void 0}convertToPoint(t){return new this.ol.geom.Point([t.x,t.y])}convertToLineString(t){var e=t._points._coordinates.map(Er);return new this.ol.geom.LineString(e)}convertToLinearRing(t){var e=t._points._coordinates.map(Er);return new this.ol.geom.LinearRing(e)}convertToPolygon(t){var e=[t._shell._points._coordinates.map(Er)];for(let i=0;i<t._holes.length;i++)e.push(t._holes[i]._points._coordinates.map(Er));return new this.ol.geom.Polygon(e)}convertToMultiPoint(t){return new this.ol.geom.MultiPoint(t.getCoordinates().map(Er))}convertToMultiLineString(t){var e=[];for(let i=0;i<t._geometries.length;i++)e.push(this.convertToLineString(t._geometries[i]).getCoordinates());return new this.ol.geom.MultiLineString(e)}convertToMultiPolygon(t){var e=[];for(let i=0;i<t._geometries.length;i++)e.push(this.convertToPolygon(t._geometries[i]).getCoordinates());return new this.ol.geom.MultiPolygon(e)}convertToCollection(t){var e=[];for(let r=0;r<t._geometries.length;r++){var i=t._geometries[r];e.push(this.write(i))}return new this.ol.geom.GeometryCollection(e)}},WKTReader:class{constructor(t){this.parser=new le(t||new oe)}read(t){return this.parser.read(t)}},WKTWriter:de});class br{constructor(){br.constructor_.apply(this,arguments)}static relativeSign(t,e){return t<e?-1:t>e?1:0}static compare(t,e,i){if(e.equals2D(i))return 0;var r=br.relativeSign(e.x,i.x),n=br.relativeSign(e.y,i.y);switch(t){case 0:return br.compareValue(r,n);case 1:return br.compareValue(n,r);case 2:return br.compareValue(n,-r);case 3:return br.compareValue(-r,n);case 4:return br.compareValue(-r,-n);case 5:return br.compareValue(-n,-r);case 6:return br.compareValue(-n,r);case 7:return br.compareValue(r,-n)}return m.shouldNeverReachHere("invalid octant value"),0}static compareValue(t,e){return t<0?-1:t>0?1:e<0?-1:e>0?1:0}getClass(){return br}get interfaces_(){return[]}}br.constructor_=function(){};class Ir{constructor(){Ir.constructor_.apply(this,arguments)}getCoordinate(){return this.coord}print(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)}compareTo(t){var e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:br.compare(this._segmentOctant,this.coord,e.coord)}isEndPoint(t){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===t}isInterior(){return this._isInterior}getClass(){return Ir}get interfaces_(){return[c]}}Ir.constructor_=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;let t=arguments[0],e=arguments[1],i=arguments[2],r=arguments[3];this._segString=t,this.coord=new y(e),this.segmentIndex=i,this._segmentOctant=r,this._isInterior=!e.equals2D(t.getCoordinate(i))};class Tr{constructor(){Tr.constructor_.apply(this,arguments)}getSplitCoordinates(){var t=new O;this.addEndpoints();for(var e=this.iterator(),i=e.next();e.hasNext();){var r=e.next();this.addEdgeCoordinates(i,r,t),i=r}return t.toCoordinateArray()}addCollapsedNodes(){var t=new C;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(var e=t.iterator();e.hasNext();){var i=e.next().intValue();this.add(this._edge.getCoordinate(i),i)}}print(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)}findCollapsesFromExistingVertices(t){for(var e=0;e<this._edge.size()-2;e++){var i=this._edge.getCoordinate(e),r=(this._edge.getCoordinate(e+1),this._edge.getCoordinate(e+2));i.equals2D(r)&&t.add(new M(e+1))}}addEdgeCoordinates(t,e,i){e.segmentIndex,t.segmentIndex;var r=this._edge.getCoordinate(e.segmentIndex),n=e.isInterior()||!e.coord.equals2D(r);i.add(new y(t.coord),!1);for(var s=t.segmentIndex+1;s<=e.segmentIndex;s++)i.add(this._edge.getCoordinate(s));n&&i.add(new y(e.coord))}iterator(){return this._nodeMap.values().iterator()}addSplitEdges(t){this.addEndpoints(),this.addCollapsedNodes();for(var e=this.iterator(),i=e.next();e.hasNext();){var r=e.next(),n=this.createSplitEdge(i,r);t.add(n),i=r}}findCollapseIndex(t,e,i){if(!t.coord.equals2D(e.coord))return!1;var r=e.segmentIndex-t.segmentIndex;return e.isInterior()||r--,1===r&&(i[0]=t.segmentIndex+1,!0)}findCollapsesFromInsertedNodes(t){for(var e=new Array(1).fill(null),i=this.iterator(),r=i.next();i.hasNext();){var n=i.next();this.findCollapseIndex(r,n,e)&&t.add(new M(e[0])),r=n}}getEdge(){return this._edge}addEndpoints(){var t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)}createSplitEdge(t,e){var i=e.segmentIndex-t.segmentIndex+2,r=this._edge.getCoordinate(e.segmentIndex),n=e.isInterior()||!e.coord.equals2D(r);n||i--;var s=new Array(i).fill(null),o=0;s[o++]=new y(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)s[o++]=this._edge.getCoordinate(a);return n&&(s[o]=new y(e.coord)),new Or(s,this._edge.getData())}add(t,e){var i=new Ir(this._edge,t,e,this._edge.getSegmentOctant(e)),r=this._nodeMap.get(i);return null!==r?(m.isTrue(r.coord.equals2D(t),"Found equal nodes with different coordinates"),r):(this._nodeMap.put(i,i),i)}checkSplitEdgesCorrectness(t){var e=this._edge.getCoordinates(),i=t.get(0).getCoordinate(0);if(!i.equals2D(e[0]))throw new f("bad split edge start point at "+i);var r=t.get(t.size()-1).getCoordinates(),n=r[r.length-1];if(!n.equals2D(e[e.length-1]))throw new f("bad split edge end point at "+n)}getClass(){return Tr}get interfaces_(){return[]}}Tr.constructor_=function(){this._nodeMap=new pt,this._edge=null;let t=arguments[0];this._edge=t};class Sr{constructor(){Sr.constructor_.apply(this,arguments)}static octant(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){let r=arguments[0],n=arguments[1];if(0===r&&0===n)throw new i("Cannot compute the octant for point ( "+r+", "+n+" )");var t=Math.abs(r),e=Math.abs(n);return r>=0?n>=0?t>=e?0:1:t>=e?7:6:n>=0?t>=e?3:2:t>=e?4:5}if(arguments[0]instanceof y&&arguments[1]instanceof y){let t=arguments[0],e=arguments[1];var r=e.x-t.x,n=e.y-t.y;if(0===r&&0===n)throw new i("Cannot compute the octant for two identical points "+t);return Sr.octant(r,n)}}getClass(){return Sr}get interfaces_(){return[]}}Sr.constructor_=function(){};class Cr{constructor(){Cr.constructor_.apply(this,arguments)}getCoordinates(){}size(){}getCoordinate(t){}isClosed(){}setData(t){}getData(){}getClass(){return Cr}get interfaces_(){return[]}}Cr.constructor_=function(){};class Nr{constructor(){Nr.constructor_.apply(this,arguments)}addIntersection(t,e){}getClass(){return Nr}get interfaces_(){return[Cr]}}Nr.constructor_=function(){};class Or{constructor(){Or.constructor_.apply(this,arguments)}static getNodedSubstrings(){if(1===arguments.length){let e=arguments[0];var t=new C;return Or.getNodedSubstrings(e,t),t}if(2===arguments.length){let t=arguments[0],i=arguments[1];for(var e=t.iterator();e.hasNext();)e.next().getNodeList().addSplitEdges(i)}}getCoordinates(){return this._pts}size(){return this._pts.length}getCoordinate(t){return this._pts[t]}isClosed(){return this._pts[0].equals(this._pts[this._pts.length-1])}getSegmentOctant(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))}setData(t){this._data=t}safeOctant(t,e){return t.equals2D(e)?0:Sr.octant(t,e)}getData(){return this._data}addIntersection(){if(2===arguments.length){let t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(4===arguments.length){let e=arguments[0],i=arguments[1],r=arguments[3];var t=new y(e.getIntersection(r));this.addIntersection(t,i)}}toString(){return de.toLineString(new Zt(this._pts))}getNodeList(){return this._nodeList}addIntersectionNode(t,e){var i=e,r=i+1;if(r<this._pts.length){var n=this._pts[r];t.equals2D(n)&&(i=r)}return this._nodeList.add(t,i)}addIntersections(t,e,i){for(var r=0;r<t.getIntersectionNum();r++)this.addIntersection(t,e,i,r)}getClass(){return Or}get interfaces_(){return[Nr]}}Or.constructor_=function(){this._nodeList=new Tr(this),this._pts=null,this._data=null;let t=arguments[0],e=arguments[1];this._pts=t,this._data=e};class Pr{constructor(){Pr.constructor_.apply(this,arguments)}overlap(){if(2===arguments.length);else if(4===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2],r=arguments[3];t.getLineSegment(e,this._overlapSeg1),i.getLineSegment(r,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}getClass(){return Pr}get interfaces_(){return[]}}Pr.constructor_=function(){this._overlapSeg1=new fe,this._overlapSeg2=new fe};class Lr{constructor(){Lr.constructor_.apply(this,arguments)}getLineSegment(t,e){e.p0=this._pts[t],e.p1=this._pts[t+1]}computeSelect(t,e,i,r){var n=this._pts[e],s=this._pts[i];if(i-e==1)return r.select(this,e),null;if(!t.intersects(n,s))return null;var o=Math.trunc((e+i)/2);e<o&&this.computeSelect(t,e,o,r),o<i&&this.computeSelect(t,o,i,r)}getCoordinates(){for(var t=new Array(this._end-this._start+1).fill(null),e=0,i=this._start;i<=this._end;i++)t[e++]=this._pts[i];return t}computeOverlaps(){if(2===arguments.length){let t=arguments[0],e=arguments[1];this.computeOverlaps(this._start,this._end,t,t._start,t._end,e)}else if(6===arguments.length){let i=arguments[0],r=arguments[1],n=arguments[2],s=arguments[3],o=arguments[4],a=arguments[5];if(r-i==1&&o-s==1)return a.overlap(this,i,n,s),null;if(!this.overlaps(i,r,n,s,o))return null;var t=Math.trunc((i+r)/2),e=Math.trunc((s+o)/2);i<t&&(s<e&&this.computeOverlaps(i,t,n,s,e,a),e<o&&this.computeOverlaps(i,t,n,e,o,a)),t<r&&(s<e&&this.computeOverlaps(t,r,n,s,e,a),e<o&&this.computeOverlaps(t,r,n,e,o,a))}}setId(t){this._id=t}select(t,e){this.computeSelect(t,this._start,this._end,e)}getEnvelope(){if(null===this._env){var t=this._pts[this._start],e=this._pts[this._end];this._env=new P(t,e)}return this._env}overlaps(t,e,i,r,n){return P.intersects(this._pts[t],this._pts[e],i._pts[r],i._pts[n])}getEndIndex(){return this._end}getStartIndex(){return this._start}getContext(){return this._context}getId(){return this._id}getClass(){return Lr}get interfaces_(){return[]}}Lr.constructor_=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;let t=arguments[0],e=arguments[1],i=arguments[2],r=arguments[3];this._pts=t,this._start=e,this._end=i,this._context=r};class Ar{constructor(){Ar.constructor_.apply(this,arguments)}static getChainStartIndices(t){var e=0,i=new C;i.add(new M(e));do{var r=Ar.findChainEnd(t,e);i.add(new M(r)),e=r}while(e<t.length-1);return Ar.toIntArray(i)}static findChainEnd(t,e){for(var i=e;i<t.length-1&&t[i].equals2D(t[i+1]);)i++;if(i>=t.length-1)return t.length-1;for(var r=gi.quadrant(t[i],t[i+1]),n=e+1;n<t.length&&(t[n-1].equals2D(t[n])||gi.quadrant(t[n-1],t[n])===r);)n++;return n-1}static getChains(){if(1===arguments.length){let t=arguments[0];return Ar.getChains(t,null)}if(2===arguments.length){let n=arguments[0],s=arguments[1];for(var t=new C,e=Ar.getChainStartIndices(n),i=0;i<e.length-1;i++){var r=new Lr(n,e[i],e[i+1],s);t.add(r)}return t}}static toIntArray(t){for(var e=new Array(t.size()).fill(null),i=0;i<e.length;i++)e[i]=t.get(i).intValue();return e}getClass(){return Ar}get interfaces_(){return[]}}Ar.constructor_=function(){};class Rr{constructor(){Rr.constructor_.apply(this,arguments)}computeNodes(t){}getNodedSubstrings(){}getClass(){return Rr}get interfaces_(){return[]}}Rr.constructor_=function(){};class Mr{constructor(){Mr.constructor_.apply(this,arguments)}setSegmentIntersector(t){this._segInt=t}getClass(){return Mr}get interfaces_(){return[Rr]}}Mr.constructor_=function(){if(this._segInt=null,0===arguments.length);else if(1===arguments.length){let t=arguments[0];this.setSegmentIntersector(t)}};class Dr extends Mr{constructor(){super(),Dr.constructor_.apply(this,arguments)}getMonotoneChains(){return this._monoChains}getNodedSubstrings(){return Or.getNodedSubstrings(this._nodedSegStrings)}getIndex(){return this._index}add(t){for(var e=Ar.getChains(t.getCoordinates(),t).iterator();e.hasNext();){var i=e.next();i.setId(this._idCounter++),this._index.insert(i.getEnvelope(),i),this._monoChains.add(i)}}computeNodes(t){this._nodedSegStrings=t;for(var e=t.iterator();e.hasNext();)this.add(e.next());this.intersectChains()}intersectChains(){for(var t=new Fr(this._segInt),e=this._monoChains.iterator();e.hasNext();)for(var i=e.next(),r=this._index.query(i.getEnvelope()).iterator();r.hasNext();){var n=r.next();if(n.getId()>i.getId()&&(i.computeOverlaps(n,t),this._nOverlaps++),this._segInt.isDone())return null}}getClass(){return Dr}get interfaces_(){return[]}}class Fr extends Pr{constructor(){super(),Fr.constructor_.apply(this,arguments)}overlap(){if(4!==arguments.length)return super.overlap.apply(this,arguments);{let i=arguments[0],r=arguments[1],n=arguments[2],s=arguments[3];var t=i.getContext(),e=n.getContext();this._si.processIntersections(t,r,e,s)}}getClass(){return Fr}get interfaces_(){return[]}}Fr.constructor_=function(){this._si=null;let t=arguments[0];this._si=t},Dr.SegmentOverlapAction=Fr,Dr.constructor_=function(){if(this._monoChains=new C,this._index=new pr,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0,0===arguments.length);else if(1===arguments.length){let t=arguments[0];Mr.constructor_.call(this,t)}};class Br{constructor(){Br.constructor_.apply(this,arguments)}rescale(){if(x(arguments[0],w))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.rescale(e.getCoordinates())}else if(arguments[0]instanceof Array){let e=arguments[0];for(2===e.length&&(new y(e[0]),new y(e[1])),t=0;t<e.length;t++)e[t].x=e[t].x/this._scaleFactor+this._offsetX,e[t].y=e[t].y/this._scaleFactor+this._offsetY;2===e.length&&e[0].equals2D(e[1])&&G.out.println(e)}}scale(){if(x(arguments[0],w)){let r=arguments[0];for(var t=new C(r.size()),e=r.iterator();e.hasNext();){var i=e.next();t.add(new Or(this.scale(i.getCoordinates()),i.getData()))}return t}if(arguments[0]instanceof Array){let t=arguments[0];var r=new Array(t.length).fill(null);for(e=0;e<t.length;e++)r[e]=new y(Math.round((t[e].x-this._offsetX)*this._scaleFactor),Math.round((t[e].y-this._offsetY)*this._scaleFactor),t[e].z);return $.removeRepeatedPoints(r)}}isIntegerPrecision(){return 1===this._scaleFactor}getNodedSubstrings(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t}computeNodes(t){var e=t;this._isScaled&&(e=this.scale(t)),this._noder.computeNodes(e)}getClass(){return Br}get interfaces_(){return[Rr]}}Br.constructor_=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){let t=arguments[0],e=arguments[1];Br.constructor_.call(this,t,e,0,0)}else if(4===arguments.length){let t=arguments[0],e=arguments[1];this._noder=t,this._scaleFactor=e,this._isScaled=!this.isIntegerPrecision()}};var kr=Object.freeze({MCIndexNoder:Dr,ScaledNoder:Br,SegmentString:Cr});class Gr{constructor(){Gr.constructor_.apply(this,arguments)}static isSimple(){if(1===arguments.length){let t=arguments[0];return new Gr(t).isSimple()}if(2===arguments.length){let t=arguments[0],e=arguments[1];return new Gr(t,e).isSimple()}}isSimpleMultiPoint(t){if(t.isEmpty())return!0;for(var e=new _t,i=0;i<t.getNumGeometries();i++){var r=t.getGeometryN(i).getCoordinate();if(e.contains(r))return this._nonSimpleLocation=r,!1;e.add(r)}return!0}isSimplePolygonal(t){for(var e=De.getLines(t).iterator();e.hasNext();){var i=e.next();if(!this.isSimpleLinearGeometry(i))return!1}return!0}hasClosedEndpointIntersection(t){for(var e=new pt,i=t.getEdgeIterator();i.hasNext();){var r=i.next(),n=(r.getMaximumSegmentIndex(),r.isClosed()),s=r.getCoordinate(0);this.addEndpoint(e,s,n);var o=r.getCoordinate(r.getNumPoints()-1);this.addEndpoint(e,o,n)}for(i=e.values().iterator();i.hasNext();){var a=i.next();if(a.isClosed&&2!==a.degree)return this._nonSimpleLocation=a.getCoordinate(),!0}return!1}getNonSimpleLocation(){return this._nonSimpleLocation}isSimpleLinearGeometry(t){if(t.isEmpty())return!0;var e=new qi(0,t),i=new ge,r=e.computeSelfNodes(i,!0);return!(r.hasIntersection()&&(r.hasProperIntersection()?(this._nonSimpleLocation=r.getProperIntersectionPoint(),1):this.hasNonEndpointIntersection(e)||this._isClosedEndpointsInInterior&&this.hasClosedEndpointIntersection(e)))}hasNonEndpointIntersection(t){for(var e=t.getEdgeIterator();e.hasNext();)for(var i=e.next(),r=i.getMaximumSegmentIndex(),n=i.getEdgeIntersectionList().iterator();n.hasNext();){var s=n.next();if(!s.isEndPoint(r))return this._nonSimpleLocation=s.getCoordinate(),!0}return!1}addEndpoint(t,e,i){var r=t.get(e);null===r&&(r=new Ur(e),t.put(e,r)),r.addEndpoint(i)}computeSimple(t){return this._nonSimpleLocation=null,!!t.isEmpty()||(t instanceof Ft?this.isSimpleLinearGeometry(t):t instanceof It?this.isSimpleLinearGeometry(t):t instanceof zt?this.isSimpleMultiPoint(t):x(t,Ut)?this.isSimplePolygonal(t):!(t instanceof bt)||this.isSimpleGeometryCollection(t))}isSimple(){return this._nonSimpleLocation=null,this.computeSimple(this._inputGeom)}isSimpleGeometryCollection(t){for(var e=0;e<t.getNumGeometries();e++){var i=t.getGeometryN(e);if(!this.computeSimple(i))return!1}return!0}getClass(){return Gr}get interfaces_(){return[]}}class Ur{constructor(){Ur.constructor_.apply(this,arguments)}addEndpoint(t){this.degree++,this.isClosed|=t}getCoordinate(){return this.pt}getClass(){return Ur}get interfaces_(){return[]}}Ur.constructor_=function(){this.pt=null,this.isClosed=null,this.degree=null;let t=arguments[0];this.pt=t,this.isClosed=!1,this.degree=0},Gr.EndpointInfo=Ur,Gr.constructor_=function(){if(this._inputGeom=null,this._isClosedEndpointsInInterior=!0,this._nonSimpleLocation=null,1===arguments.length){let t=arguments[0];this._inputGeom=t}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this._inputGeom=t,this._isClosedEndpointsInInterior=!e.isInBoundary(2)}};class Yr{constructor(){Yr.constructor_.apply(this,arguments)}static bufferDistanceError(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)}getEndCapStyle(){return this._endCapStyle}isSingleSided(){return this._isSingleSided}setQuadrantSegments(t){this._quadrantSegments=t,0===this._quadrantSegments&&(this._joinStyle=Yr.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=Yr.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==Yr.JOIN_ROUND&&(this._quadrantSegments=Yr.DEFAULT_QUADRANT_SEGMENTS)}getJoinStyle(){return this._joinStyle}setJoinStyle(t){this._joinStyle=t}setSimplifyFactor(t){this._simplifyFactor=t<0?0:t}getSimplifyFactor(){return this._simplifyFactor}getQuadrantSegments(){return this._quadrantSegments}setEndCapStyle(t){this._endCapStyle=t}getMitreLimit(){return this._mitreLimit}setMitreLimit(t){this._mitreLimit=t}setSingleSided(t){this._isSingleSided=t}getClass(){return Yr}get interfaces_(){return[]}}Yr.constructor_=function(){if(this._quadrantSegments=Yr.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=Yr.CAP_ROUND,this._joinStyle=Yr.JOIN_ROUND,this._mitreLimit=Yr.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=Yr.DEFAULT_SIMPLIFY_FACTOR,0===arguments.length);else if(1===arguments.length){let t=arguments[0];this.setQuadrantSegments(t)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this.setQuadrantSegments(t),this.setEndCapStyle(e)}else if(4===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2],r=arguments[3];this.setQuadrantSegments(t),this.setEndCapStyle(e),this.setJoinStyle(i),this.setMitreLimit(r)}},Yr.CAP_ROUND=1,Yr.CAP_FLAT=2,Yr.CAP_SQUARE=3,Yr.JOIN_ROUND=1,Yr.JOIN_MITRE=2,Yr.JOIN_BEVEL=3,Yr.DEFAULT_QUADRANT_SEGMENTS=8,Yr.DEFAULT_MITRE_LIMIT=5,Yr.DEFAULT_SIMPLIFY_FACTOR=.01;class zr{constructor(){zr.constructor_.apply(this,arguments)}getCoordinate(){return this._minCoord}getRightmostSide(t,e){var i=this.getRightmostSideOfSegment(t,e);return i<0&&(i=this.getRightmostSideOfSegment(t,e-1)),i<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),i}findRightmostEdgeAtVertex(){var t=this._minDe.getEdge().getCoordinates();m.isTrue(this._minIndex>0&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge");var e=t[this._minIndex-1],i=t[this._minIndex+1],r=k.index(this._minCoord,i,e),n=!1;e.y<this._minCoord.y&&i.y<this._minCoord.y&&r===k.COUNTERCLOCKWISE?n=!0:e.y>this._minCoord.y&&i.y>this._minCoord.y&&r===k.CLOCKWISE&&(n=!0),n&&(this._minIndex=this._minIndex-1)}getRightmostSideOfSegment(t,e){var i=t.getEdge().getCoordinates();if(e<0||e+1>=i.length)return-1;if(i[e].y===i[e+1].y)return-1;var r=wi.LEFT;return i[e].y<i[e+1].y&&(r=wi.RIGHT),r}getEdge(){return this._orientedDe}checkForRightmostCoordinate(t){for(var e=t.getEdge().getCoordinates(),i=0;i<e.length-1;i++)(null===this._minCoord||e[i].x>this._minCoord.x)&&(this._minDe=t,this._minIndex=i,this._minCoord=e[i])}findRightmostEdgeAtNode(){var t=this._minDe.getNode().getEdges();this._minDe=t.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)}findEdge(t){for(var e=t.iterator();e.hasNext();){var i=e.next();i.isForward()&&this.checkForRightmostCoordinate(i)}m.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===wi.LEFT&&(this._orientedDe=this._minDe.getSym())}getClass(){return zr}get interfaces_(){return[]}}function Xr(){this.array_=[]}zr.constructor_=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null},Xr.prototype.addLast=function(t){this.array_.push(t)},Xr.prototype.removeFirst=function(){return this.array_.shift()},Xr.prototype.isEmpty=function(){return 0===this.array_.length};class qr{constructor(){qr.constructor_.apply(this,arguments)}clearVisitedEdges(){for(var t=this._dirEdgeList.iterator();t.hasNext();)t.next().setVisited(!1)}getRightmostCoordinate(){return this._rightMostCoord}computeNodeDepth(t){for(var e=null,i=t.getEdges().iterator();i.hasNext();)if((r=i.next()).isVisited()||r.getSym().isVisited()){e=r;break}if(null===e)throw new Ui("unable to find edge to compute depths at "+t.getCoordinate());for(t.getEdges().computeDepths(e),i=t.getEdges().iterator();i.hasNext();){var r;(r=i.next()).setVisited(!0),this.copySymDepths(r)}}computeDepth(t){this.clearVisitedEdges();var e=this._finder.getEdge();e.getNode(),e.getLabel(),e.setEdgeDepths(wi.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)}create(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()}findResultEdges(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var e=t.next();e.getDepth(wi.RIGHT)>=1&&e.getDepth(wi.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}}computeDepths(t){var e=new st,i=new Xr,r=t.getNode();for(i.addLast(r),e.add(r),t.setVisited(!0);!i.isEmpty();){var n=i.removeFirst();e.add(n),this.computeNodeDepth(n);for(var s=n.getEdges().iterator();s.hasNext();){var o=s.next().getSym();if(!o.isVisited()){var a=o.getNode();e.contains(a)||(i.addLast(a),e.add(a))}}}}compareTo(t){var e=t;return this._rightMostCoord.x<e._rightMostCoord.x?-1:this._rightMostCoord.x>e._rightMostCoord.x?1:0}getEnvelope(){if(null===this._env){for(var t=new P,e=this._dirEdgeList.iterator();e.hasNext();)for(var i=e.next().getEdge().getCoordinates(),r=0;r<i.length-1;r++)t.expandToInclude(i[r]);this._env=t}return this._env}addReachable(t){var e=new Qe;for(e.add(t);!e.empty();){var i=e.pop();this.add(i,e)}}copySymDepths(t){var e=t.getSym();e.setDepth(wi.LEFT,t.getDepth(wi.RIGHT)),e.setDepth(wi.RIGHT,t.getDepth(wi.LEFT))}add(t,e){t.setVisited(!0),this._nodes.add(t);for(var i=t.getEdges().iterator();i.hasNext();){var r=i.next();this._dirEdgeList.add(r);var n=r.getSym().getNode();n.isVisited()||e.push(n)}}getNodes(){return this._nodes}getDirectedEdges(){return this._dirEdgeList}getClass(){return qr}get interfaces_(){return[c]}}qr.constructor_=function(){this._finder=null,this._dirEdgeList=new C,this._nodes=new C,this._rightMostCoord=null,this._env=null,this._finder=new zr};class Hr{constructor(){Hr.constructor_.apply(this,arguments)}computeRing(){if(null!==this._ring)return null;for(var t=new Array(this._pts.size()).fill(null),e=0;e<this._pts.size();e++)t[e]=this._pts.get(e);this._ring=this._geometryFactory.createLinearRing(t),this._isHole=k.isCCW(this._ring.getCoordinates())}isIsolated(){return 1===this._label.getGeometryCount()}computePoints(t){this._startDe=t;var e=t,i=!0;do{if(null===e)throw new Ui("Found null DirectedEdge");if(e.getEdgeRing()===this)throw new Ui("Directed Edge visited twice during ring-building at "+e.getCoordinate());this._edges.add(e);var r=e.getLabel();m.isTrue(r.isArea()),this.mergeLabel(r),this.addPoints(e.getEdge(),e.isForward(),i),i=!1,this.setEdgeRing(e,this),e=this.getNext(e)}while(e!==this._startDe)}getLinearRing(){return this._ring}getCoordinate(t){return this._pts.get(t)}computeMaxNodeDegree(){this._maxNodeDegree=0;var t=this._startDe;do{var e=t.getNode().getEdges().getOutgoingDegree(this);e>this._maxNodeDegree&&(this._maxNodeDegree=e),t=this.getNext(t)}while(t!==this._startDe);this._maxNodeDegree*=2}addPoints(t,e,i){var r=t.getCoordinates();if(e){var n=1;i&&(n=0);for(var s=n;s<r.length;s++)this._pts.add(r[s])}else for(n=r.length-2,i&&(n=r.length-1),s=n;s>=0;s--)this._pts.add(r[s])}isHole(){return this._isHole}setInResult(){var t=this._startDe;do{t.getEdge().setInResult(!0),t=t.getNext()}while(t!==this._startDe)}containsPoint(t){var e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(t))return!1;if(!Ye.isInRing(t,e.getCoordinates()))return!1;for(var i=this._holes.iterator();i.hasNext();)if(i.next().containsPoint(t))return!1;return!0}addHole(t){this._holes.add(t)}isShell(){return null===this._shell}getLabel(){return this._label}getEdges(){return this._edges}getMaxNodeDegree(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree}getShell(){return this._shell}mergeLabel(){if(1===arguments.length){let t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(2===arguments.length){let e=arguments[0],i=arguments[1];var t=e.getLocation(i,wi.RIGHT);if(t===_e.NONE)return null;if(this._label.getLocation(i)===_e.NONE)return this._label.setLocation(i,t),null}}setShell(t){this._shell=t,null!==t&&t.addHole(this)}toPolygon(t){for(var e=new Array(this._holes.size()).fill(null),i=0;i<this._holes.size();i++)e[i]=this._holes.get(i).getLinearRing();return t.createPolygon(this.getLinearRing(),e)}getClass(){return Hr}get interfaces_(){return[]}}Hr.constructor_=function(){if(this._startDe=null,this._maxNodeDegree=-1,this._edges=new C,this._pts=new C,this._label=new Oi(_e.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new C,this._geometryFactory=null,0===arguments.length);else if(2===arguments.length){let t=arguments[0],e=arguments[1];this._geometryFactory=e,this.computePoints(t),this.computeRing()}};class Vr extends Hr{constructor(){super(),Vr.constructor_.apply(this,arguments)}setEdgeRing(t,e){t.setMinEdgeRing(e)}getNext(t){return t.getNextMin()}getClass(){return Vr}get interfaces_(){return[]}}Vr.constructor_=function(){let t=arguments[0],e=arguments[1];Hr.constructor_.call(this,t,e)};class jr extends Hr{constructor(){super(),jr.constructor_.apply(this,arguments)}buildMinimalRings(){var t=new C,e=this._startDe;do{if(null===e.getMinEdgeRing()){var i=new Vr(e,this._geometryFactory);t.add(i)}e=e.getNext()}while(e!==this._startDe);return t}setEdgeRing(t,e){t.setEdgeRing(e)}linkDirectedEdgesForMinimalEdgeRings(){var t=this._startDe;do{t.getNode().getEdges().linkMinimalDirectedEdges(this),t=t.getNext()}while(t!==this._startDe)}getNext(t){return t.getNext()}getClass(){return jr}get interfaces_(){return[]}}jr.constructor_=function(){let t=arguments[0],e=arguments[1];Hr.constructor_.call(this,t,e)};class Wr{constructor(){Wr.constructor_.apply(this,arguments)}sortShellsAndHoles(t,e,i){for(var r=t.iterator();r.hasNext();){var n=r.next();n.isHole()?i.add(n):e.add(n)}}computePolygons(t){for(var e=new C,i=t.iterator();i.hasNext();){var r=i.next().toPolygon(this._geometryFactory);e.add(r)}return e}placeFreeHoles(t,e){for(var i=e.iterator();i.hasNext();){var r=i.next();if(null===r.getShell()){var n=this.findEdgeRingContaining(r,t);if(null===n)throw new Ui("unable to assign hole to a shell",r.getCoordinate(0));r.setShell(n)}}}buildMinimalEdgeRings(t,e,i){for(var r=new C,n=t.iterator();n.hasNext();){var s=n.next();if(s.getMaxNodeDegree()>2){s.linkDirectedEdgesForMinimalEdgeRings();var o=s.buildMinimalRings(),a=this.findShell(o);null!==a?(this.placePolygonHoles(a,o),e.add(a)):i.addAll(o)}else r.add(s)}return r}containsPoint(t){for(var e=this._shellList.iterator();e.hasNext();)if(e.next().containsPoint(t))return!0;return!1}buildMaximalEdgeRings(t){for(var e=new C,i=t.iterator();i.hasNext();){var r=i.next();if(r.isInResult()&&r.getLabel().isArea()&&null===r.getEdgeRing()){var n=new jr(r,this._geometryFactory);e.add(n),n.setInResult()}}return e}placePolygonHoles(t,e){for(var i=e.iterator();i.hasNext();){var r=i.next();r.isHole()&&r.setShell(t)}}getPolygons(){return this.computePolygons(this._shellList)}findEdgeRingContaining(t,e){for(var i=t.getLinearRing(),r=i.getEnvelopeInternal(),n=i.getCoordinateN(0),s=null,o=null,a=e.iterator();a.hasNext();){var h=a.next(),l=h.getLinearRing(),u=l.getEnvelopeInternal();null!==s&&(o=s.getLinearRing().getEnvelopeInternal());var c=!1;u.contains(r)&&Ye.isInRing(n,l.getCoordinates())&&(c=!0),c&&(null===s||o.contains(u))&&(s=h)}return s}findShell(t){for(var e=0,i=null,r=t.iterator();r.hasNext();){var n=r.next();n.isHole()||(i=n,e++)}return m.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),i}add(){if(1===arguments.length){let t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(2===arguments.length){let r=arguments[0],n=arguments[1];Xi.linkResultDirectedEdges(n);var t=this.buildMaximalEdgeRings(r),e=new C,i=this.buildMinimalEdgeRings(t,this._shellList,e);this.sortShellsAndHoles(i,this._shellList,e),this.placeFreeHoles(this._shellList,e)}}getClass(){return Wr}get interfaces_(){return[]}}Wr.constructor_=function(){this._geometryFactory=null,this._shellList=new C;let t=arguments[0];this._geometryFactory=t};class Kr{constructor(){Kr.constructor_.apply(this,arguments)}static simplify(t,e){return new Kr(t).simplify(e)}isDeletable(t,e,i,r){var n=this._inputLine[t],s=this._inputLine[e],o=this._inputLine[i];return!!this.isConcave(n,s,o)&&!!this.isShallow(n,s,o,r)&&this.isShallowSampled(n,s,t,i,r)}deleteShallowConcavities(){for(var t=1,e=(this._inputLine.length,this.findNextNonDeletedIndex(t)),i=this.findNextNonDeletedIndex(e),r=!1;i<this._inputLine.length;){var n=!1;this.isDeletable(t,e,i,this._distanceTol)&&(this._isDeleted[e]=Kr.DELETE,n=!0,r=!0),t=n?i:e,e=this.findNextNonDeletedIndex(t),i=this.findNextNonDeletedIndex(e)}return r}isShallowConcavity(t,e,i,r){return k.index(t,e,i)===this._angleOrientation&&z.pointToSegment(e,t,i)<r}isShallowSampled(t,e,i,r,n){var s=Math.trunc((r-i)/Kr.NUM_PTS_TO_CHECK);s<=0&&(s=1);for(var o=i;o<r;o+=s)if(!this.isShallow(t,e,this._inputLine[o],n))return!1;return!0}isConcave(t,e,i){return k.index(t,e,i)===this._angleOrientation}simplify(t){this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=k.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var e=!1;do{e=this.deleteShallowConcavities()}while(e);return this.collapseLine()}findNextNonDeletedIndex(t){for(var e=t+1;e<this._inputLine.length&&this._isDeleted[e]===Kr.DELETE;)e++;return e}isShallow(t,e,i,r){return z.pointToSegment(e,t,i)<r}collapseLine(){for(var t=new O,e=0;e<this._inputLine.length;e++)this._isDeleted[e]!==Kr.DELETE&&t.add(this._inputLine[e]);return t.toCoordinateArray()}getClass(){return Kr}get interfaces_(){return[]}}Kr.constructor_=function(){this._inputLine=null,this._distanceTol=null,this._isDeleted=null,this._angleOrientation=k.COUNTERCLOCKWISE;let t=arguments[0];this._inputLine=t},Kr.INIT=0,Kr.DELETE=1,Kr.KEEP=1,Kr.NUM_PTS_TO_CHECK=10;class Zr{constructor(){Zr.constructor_.apply(this,arguments)}getCoordinates(){return this._ptList.toArray(Zr.COORDINATE_ARRAY_TYPE)}setPrecisionModel(t){this._precisionModel=t}addPt(t){var e=new y(t);if(this._precisionModel.makePrecise(e),this.isRedundant(e))return null;this._ptList.add(e)}reverse(){}addPts(t,e){if(e)for(var i=0;i<t.length;i++)this.addPt(t[i]);else for(i=t.length-1;i>=0;i--)this.addPt(t[i])}isRedundant(t){if(this._ptList.size()<1)return!1;var e=this._ptList.get(this._ptList.size()-1);return t.distance(e)<this._minimimVertexDistance}toString(){return(new oe).createLineString(this.getCoordinates()).toString()}closeRing(){if(this._ptList.size()<1)return null;var t=new y(this._ptList.get(0)),e=this._ptList.get(this._ptList.size()-1);if(this._ptList.size()>=2&&this._ptList.get(this._ptList.size()-2),t.equals(e))return null;this._ptList.add(t)}setMinimumVertexDistance(t){this._minimimVertexDistance=t}getClass(){return Zr}get interfaces_(){return[]}}Zr.constructor_=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new C},Zr.COORDINATE_ARRAY_TYPE=new Array(0).fill(null);class Jr{constructor(){Jr.constructor_.apply(this,arguments)}addNextSegment(t,e){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var i=k.index(this._s0,this._s1,this._s2),r=i===k.CLOCKWISE&&this._side===wi.LEFT||i===k.COUNTERCLOCKWISE&&this._side===wi.RIGHT;0===i?this.addCollinear(e):r?this.addOutsideTurn(i,e):this.addInsideTurn(i,e)}addLineEndCap(t,e){var i=new fe(t,e),r=new fe;this.computeOffsetSegment(i,wi.LEFT,this._distance,r);var n=new fe;this.computeOffsetSegment(i,wi.RIGHT,this._distance,n);var s=e.x-t.x,o=e.y-t.y,a=Math.atan2(o,s);switch(this._bufParams.getEndCapStyle()){case Yr.CAP_ROUND:this._segList.addPt(r.p1),this.addDirectedFillet(e,a+Math.PI/2,a-Math.PI/2,k.CLOCKWISE,this._distance),this._segList.addPt(n.p1);break;case Yr.CAP_FLAT:this._segList.addPt(r.p1),this._segList.addPt(n.p1);break;case Yr.CAP_SQUARE:var h=new y;h.x=Math.abs(this._distance)*Math.cos(a),h.y=Math.abs(this._distance)*Math.sin(a);var l=new y(r.p1.x+h.x,r.p1.y+h.y),u=new y(n.p1.x+h.x,n.p1.y+h.y);this._segList.addPt(l),this._segList.addPt(u)}}getCoordinates(){return this._segList.getCoordinates()}addMitreJoin(t,e,i,r){var n=!0,s=null;try{s=U.intersection(e.p0,e.p1,i.p0,i.p1),(r<=0?1:s.distance(t)/Math.abs(r))>this._bufParams.getMitreLimit()&&(n=!1)}catch(t){if(!(t instanceof A))throw t;s=new y(0,0),n=!1}n?this._segList.addPt(s):this.addLimitedMitreJoin(e,i,r,this._bufParams.getMitreLimit())}addOutsideTurn(t,e){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*Jr.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===Yr.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===Yr.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(e&&this._segList.addPt(this._offset0.p1),this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))}createSquare(t){this._segList.addPt(new y(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new y(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new y(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new y(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()}addSegments(t,e){this._segList.addPts(t,e)}addFirstSegment(){this._segList.addPt(this._offset1.p0)}addCornerFillet(t,e,i,r,n){var s=e.x-t.x,o=e.y-t.y,a=Math.atan2(o,s),h=i.x-t.x,l=i.y-t.y,u=Math.atan2(l,h);r===k.CLOCKWISE?a<=u&&(a+=2*Math.PI):a>=u&&(a-=2*Math.PI),this._segList.addPt(e),this.addDirectedFillet(t,a,u,r,n),this._segList.addPt(i)}addLastSegment(){this._segList.addPt(this._offset1.p1)}initSideSegments(t,e,i){this._s1=t,this._s2=e,this._side=i,this._seg1.setCoordinates(t,e),this.computeOffsetSegment(this._seg1,i,this._distance,this._offset1)}addLimitedMitreJoin(t,e,i,r){var n=this._seg0.p1,s=ye.angle(n,this._seg0.p0),o=(ye.angle(n,this._seg1.p1),ye.angleBetweenOriented(this._seg0.p0,n,this._seg1.p1)/2),a=ye.normalize(s+o),h=ye.normalize(a+Math.PI),l=r*i,u=i-l*Math.abs(Math.sin(o)),c=n.x+l*Math.cos(h),d=n.y+l*Math.sin(h),p=new y(c,d),g=new fe(n,p),f=g.pointAlongOffset(1,u),_=g.pointAlongOffset(1,-u);this._side===wi.LEFT?(this._segList.addPt(f),this._segList.addPt(_)):(this._segList.addPt(_),this._segList.addPt(f))}addDirectedFillet(t,e,i,r,n){var s,o=r===k.CLOCKWISE?-1:1,a=Math.abs(e-i),h=Math.trunc(a/this._filletAngleQuantum+.5);if(h<1)return null;s=a/h;for(var l=0,u=new y;l<a;){var c=e+o*l;u.x=t.x+n*Math.cos(c),u.y=t.y+n*Math.sin(c),this._segList.addPt(u),l+=s}}computeOffsetSegment(t,e,i,r){var n=e===wi.LEFT?1:-1,s=t.p1.x-t.p0.x,o=t.p1.y-t.p0.y,a=Math.sqrt(s*s+o*o),h=n*i*s/a,l=n*i*o/a;r.p0.x=t.p0.x-l,r.p0.y=t.p0.y+h,r.p1.x=t.p1.x-l,r.p1.y=t.p1.y+h}addInsideTurn(t,e){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*Jr.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var i=new y((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(i);var r=new y((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(r)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}}createCircle(t){var e=new y(t.x+this._distance,t.y);this._segList.addPt(e),this.addDirectedFillet(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()}addBevelJoin(t,e){this._segList.addPt(t.p1),this._segList.addPt(e.p0)}init(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new Zr,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*Jr.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)}addCollinear(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===Yr.JOIN_BEVEL||this._bufParams.getJoinStyle()===Yr.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,k.CLOCKWISE,this._distance))}closeRing(){this._segList.closeRing()}hasNarrowConcaveAngle(){return this._hasNarrowConcaveAngle}getClass(){return Jr}get interfaces_(){return[]}}Jr.constructor_=function(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new fe,this._seg1=new fe,this._offset0=new fe,this._offset1=new fe,this._side=0,this._hasNarrowConcaveAngle=!1;let t=arguments[0],e=arguments[1],i=arguments[2];this._precisionModel=t,this._bufParams=e,this._li=new ge,this._filletAngleQuantum=Math.PI/2/e.getQuadrantSegments(),e.getQuadrantSegments()>=8&&e.getJoinStyle()===Yr.JOIN_ROUND&&(this._closingSegLengthFactor=Jr.MAX_CLOSING_SEG_LEN_FACTOR),this.init(i)},Jr.OFFSET_SEGMENT_SEPARATION_FACTOR=.001,Jr.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=.001,Jr.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1e-6,Jr.MAX_CLOSING_SEG_LEN_FACTOR=80;class Qr{constructor(){Qr.constructor_.apply(this,arguments)}static copyCoordinates(t){for(var e=new Array(t.length).fill(null),i=0;i<e.length;i++)e[i]=new y(t[i]);return e}getOffsetCurve(t,e){if(this._distance=e,0===e)return null;var i=e<0,r=Math.abs(e),n=this.getSegGen(r);t.length<=1?this.computePointCurve(t[0],n):this.computeOffsetCurve(t,i,n);var s=n.getCoordinates();return i&&$.reverse(s),s}computeSingleSidedBufferCurve(t,e,i){var r=this.simplifyTolerance(this._distance);if(e){i.addSegments(t,!0);var n=Kr.simplify(t,-r),s=n.length-1;i.initSideSegments(n[s],n[s-1],wi.LEFT),i.addFirstSegment();for(var o=s-2;o>=0;o--)i.addNextSegment(n[o],!0)}else{i.addSegments(t,!1);var a=Kr.simplify(t,r),h=a.length-1;for(i.initSideSegments(a[0],a[1],wi.LEFT),i.addFirstSegment(),o=2;o<=h;o++)i.addNextSegment(a[o],!0)}i.addLastSegment(),i.closeRing()}computeRingBufferCurve(t,e,i){var r=this.simplifyTolerance(this._distance);e===wi.RIGHT&&(r=-r);var n=Kr.simplify(t,r),s=n.length-1;i.initSideSegments(n[s-1],n[0],e);for(var o=1;o<=s;o++){var a=1!==o;i.addNextSegment(n[o],a)}i.closeRing()}computeLineBufferCurve(t,e){var i=this.simplifyTolerance(this._distance),r=Kr.simplify(t,i),n=r.length-1;e.initSideSegments(r[0],r[1],wi.LEFT);for(var s=2;s<=n;s++)e.addNextSegment(r[s],!0);e.addLastSegment(),e.addLineEndCap(r[n-1],r[n]);var o=Kr.simplify(t,-i),a=o.length-1;for(e.initSideSegments(o[a],o[a-1],wi.LEFT),s=a-2;s>=0;s--)e.addNextSegment(o[s],!0);e.addLastSegment(),e.addLineEndCap(o[1],o[0]),e.closeRing()}computePointCurve(t,e){switch(this._bufParams.getEndCapStyle()){case Yr.CAP_ROUND:e.createCircle(t);break;case Yr.CAP_SQUARE:e.createSquare(t)}}getLineCurve(t,e){if(this._distance=e,e<0&&!this._bufParams.isSingleSided())return null;if(0===e)return null;var i=Math.abs(e),r=this.getSegGen(i);if(t.length<=1)this.computePointCurve(t[0],r);else if(this._bufParams.isSingleSided()){var n=e<0;this.computeSingleSidedBufferCurve(t,n,r)}else this.computeLineBufferCurve(t,r);return r.getCoordinates()}getBufferParameters(){return this._bufParams}simplifyTolerance(t){return t*this._bufParams.getSimplifyFactor()}getRingCurve(t,e,i){if(this._distance=i,t.length<=2)return this.getLineCurve(t,i);if(0===i)return Qr.copyCoordinates(t);var r=this.getSegGen(i);return this.computeRingBufferCurve(t,e,r),r.getCoordinates()}computeOffsetCurve(t,e,i){var r=this.simplifyTolerance(this._distance);if(e){var n=Kr.simplify(t,-r),s=n.length-1;i.initSideSegments(n[s],n[s-1],wi.LEFT),i.addFirstSegment();for(var o=s-2;o>=0;o--)i.addNextSegment(n[o],!0)}else{var a=Kr.simplify(t,r),h=a.length-1;for(i.initSideSegments(a[0],a[1],wi.LEFT),i.addFirstSegment(),o=2;o<=h;o++)i.addNextSegment(a[o],!0)}i.addLastSegment()}getSegGen(t){return new Jr(this._precisionModel,this._bufParams,t)}getClass(){return Qr}get interfaces_(){return[]}}Qr.constructor_=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;let t=arguments[0],e=arguments[1];this._precisionModel=t,this._bufParams=e};class $r{constructor(){$r.constructor_.apply(this,arguments)}findStabbedSegments(){if(1===arguments.length){let n=arguments[0];for(var t=new C,e=this._subgraphs.iterator();e.hasNext();){var i=e.next(),r=i.getEnvelope();n.y<r.getMinY()||n.y>r.getMaxY()||this.findStabbedSegments(n,i.getDirectedEdges(),t)}return t}if(3===arguments.length)if(x(arguments[2],I)&&arguments[0]instanceof y&&arguments[1]instanceof Yi){let t=arguments[0],i=arguments[1],r=arguments[2];var n=i.getEdge().getCoordinates();for(e=0;e<n.length-1;e++)if(this._seg.p0=n[e],this._seg.p1=n[e+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<t.x||this._seg.isHorizontal()||t.y<this._seg.p0.y||t.y>this._seg.p1.y||k.index(this._seg.p0,this._seg.p1,t)===k.RIGHT)){var s=i.getDepth(wi.LEFT);this._seg.p0.equals(n[e])||(s=i.getDepth(wi.RIGHT));var o=new tn(this._seg,s);r.add(o)}}else if(x(arguments[2],I)&&arguments[0]instanceof y&&x(arguments[1],I)){let t=arguments[0],i=arguments[1],r=arguments[2];for(e=i.iterator();e.hasNext();){var a=e.next();a.isForward()&&this.findStabbedSegments(t,a,r)}}}getDepth(t){var e=this.findStabbedSegments(t);return 0===e.size()?0:Ae.min(e)._leftDepth}getClass(){return $r}get interfaces_(){return[]}}class tn{constructor(){tn.constructor_.apply(this,arguments)}compareTo(t){var e=t;if(this._upwardSeg.minX()>=e._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=e._upwardSeg.minX())return-1;var i=this._upwardSeg.orientationIndex(e._upwardSeg);return 0!==i?i:0!=(i=-1*e._upwardSeg.orientationIndex(this._upwardSeg))?i:this._upwardSeg.compareTo(e._upwardSeg)}compareX(t,e){var i=t.p0.compareTo(e.p0);return 0!==i?i:t.p1.compareTo(e.p1)}toString(){return this._upwardSeg.toString()}getClass(){return tn}get interfaces_(){return[c]}}tn.constructor_=function(){this._upwardSeg=null,this._leftDepth=null;let t=arguments[0],e=arguments[1];this._upwardSeg=new fe(t),this._leftDepth=e},$r.DepthSegment=tn,$r.constructor_=function(){this._subgraphs=null,this._seg=new fe;let t=arguments[0];this._subgraphs=t};class en{constructor(){en.constructor_.apply(this,arguments)}addPoint(t){if(this._distance<=0)return null;var e=t.getCoordinates(),i=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(i,_e.EXTERIOR,_e.INTERIOR)}addPolygon(t){var e=this._distance,i=wi.LEFT;this._distance<0&&(e=-this._distance,i=wi.RIGHT);var r=t.getExteriorRing(),n=$.removeRepeatedPoints(r.getCoordinates());if(this._distance<0&&this.isErodedCompletely(r,this._distance))return null;if(this._distance<=0&&n.length<3)return null;this.addPolygonRing(n,e,i,_e.EXTERIOR,_e.INTERIOR);for(var s=0;s<t.getNumInteriorRing();s++){var o=t.getInteriorRingN(s),a=$.removeRepeatedPoints(o.getCoordinates());this._distance>0&&this.isErodedCompletely(o,-this._distance)||this.addPolygonRing(a,e,wi.opposite(i),_e.INTERIOR,_e.EXTERIOR)}}isTriangleErodedCompletely(t,e){var i=new ve(t[0],t[1],t[2]),r=i.inCentre();return z.pointToSegment(r,i.p0,i.p1)<Math.abs(e)}addLineString(t){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var e=$.removeRepeatedPoints(t.getCoordinates()),i=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(i,_e.EXTERIOR,_e.INTERIOR)}addCurve(t,e,i){if(null===t||t.length<2)return null;var r=new Or(t,new Oi(0,_e.BOUNDARY,e,i));this._curveList.add(r)}getCurves(){return this.add(this._inputGeom),this._curveList}addPolygonRing(t,e,i,r,n){if(0===e&&t.length<Xt.MINIMUM_VALID_SIZE)return null;var s=r,o=n;t.length>=Xt.MINIMUM_VALID_SIZE&&k.isCCW(t)&&(s=n,o=r,i=wi.opposite(i));var a=this._curveBuilder.getRingCurve(t,i,e);this.addCurve(a,s,o)}add(t){if(t.isEmpty())return null;if(t instanceof Yt)this.addPolygon(t);else if(t instanceof Ft)this.addLineString(t);else if(t instanceof kt)this.addPoint(t);else if(t instanceof zt)this.addCollection(t);else if(t instanceof It)this.addCollection(t);else if(t instanceof qt)this.addCollection(t);else{if(!(t instanceof bt))throw new UnsupportedOperationException(t.getClass().getName());this.addCollection(t)}}isErodedCompletely(t,e){var i=t.getCoordinates();if(i.length<4)return e<0;if(4===i.length)return this.isTriangleErodedCompletely(i,e);var r=t.getEnvelopeInternal(),n=Math.min(r.getHeight(),r.getWidth());return e<0&&2*Math.abs(e)>n}addCollection(t){for(var e=0;e<t.getNumGeometries();e++){var i=t.getGeometryN(e);this.add(i)}}getClass(){return en}get interfaces_(){return[]}}en.constructor_=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new C;let t=arguments[0],e=arguments[1],i=arguments[2];this._inputGeom=t,this._distance=e,this._curveBuilder=i};class rn{constructor(){rn.constructor_.apply(this,arguments)}getNextCW(t){this.getEdges();var e=this._edgeList.indexOf(t),i=e-1;return 0===e&&(i=this._edgeList.size()-1),this._edgeList.get(i)}propagateSideLabels(t){for(var e=_e.NONE,i=this.iterator();i.hasNext();)(s=(n=i.next()).getLabel()).isArea(t)&&s.getLocation(t,wi.LEFT)!==_e.NONE&&(e=s.getLocation(t,wi.LEFT));if(e===_e.NONE)return null;var r=e;for(i=this.iterator();i.hasNext();){var n,s;if((s=(n=i.next()).getLabel()).getLocation(t,wi.ON)===_e.NONE&&s.setLocation(t,wi.ON,r),s.isArea(t)){var o=s.getLocation(t,wi.LEFT),a=s.getLocation(t,wi.RIGHT);if(a!==_e.NONE){if(a!==r)throw new Ui("side location conflict",n.getCoordinate());o===_e.NONE&&m.shouldNeverReachHere("found single null side (at "+n.getCoordinate()+")"),r=o}else m.isTrue(s.getLocation(t,wi.LEFT)===_e.NONE,"found single null side"),s.setLocation(t,wi.RIGHT,r),s.setLocation(t,wi.LEFT,r)}}}getCoordinate(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null}print(t){G.out.println("EdgeEndStar:   "+this.getCoordinate());for(var e=this.iterator();e.hasNext();)e.next().print(t)}isAreaLabelsConsistent(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)}checkAreaLabelsConsistent(t){var e=this.getEdges();if(e.size()<=0)return!0;var i=e.size()-1,r=e.get(i).getLabel().getLocation(t,wi.LEFT);m.isTrue(r!==_e.NONE,"Found unlabelled area edge");for(var n=r,s=this.iterator();s.hasNext();){var o=s.next().getLabel();m.isTrue(o.isArea(t),"Found non-area edge");var a=o.getLocation(t,wi.LEFT),h=o.getLocation(t,wi.RIGHT);if(a===h)return!1;if(h!==n)return!1;n=a}return!0}findIndex(t){this.iterator();for(var e=0;e<this._edgeList.size();e++)if(this._edgeList.get(e)===t)return e;return-1}iterator(){return this.getEdges().iterator()}getEdges(){return null===this._edgeList&&(this._edgeList=new C(this._edgeMap.values())),this._edgeList}getLocation(t,e,i){return this._ptInAreaLocation[t]===_e.NONE&&(this._ptInAreaLocation[t]=Xe.locate(e,i[t].getGeometry())),this._ptInAreaLocation[t]}toString(){var t=new R;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append("\n");for(var e=this.iterator();e.hasNext();){var i=e.next();t.append(i),t.append("\n")}return t.toString()}computeEdgeEndLabels(t){for(var e=this.iterator();e.hasNext();)e.next().computeLabel(t)}computeLabelling(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var e=[!1,!1],i=this.iterator();i.hasNext();)for(var r=(s=i.next()).getLabel(),n=0;n<2;n++)r.isLine(n)&&r.getLocation(n)===_e.BOUNDARY&&(e[n]=!0);for(i=this.iterator();i.hasNext();){var s;for(r=(s=i.next()).getLabel(),n=0;n<2;n++)if(r.isAnyNull(n)){var o=_e.NONE;if(e[n])o=_e.EXTERIOR;else{var a=s.getCoordinate();o=this.getLocation(n,a,t)}r.setAllLocationsIfNull(n,o)}}}getDegree(){return this._edgeMap.size()}insertEdgeEnd(t,e){this._edgeMap.put(t,e),this._edgeList=null}getClass(){return rn}get interfaces_(){return[]}}rn.constructor_=function(){this._edgeMap=new pt,this._edgeList=null,this._ptInAreaLocation=[_e.NONE,_e.NONE]};class nn extends rn{constructor(){super(),nn.constructor_.apply(this,arguments)}linkResultDirectedEdges(){this.getResultAreaEdges();for(var t=null,e=null,i=this._SCANNING_FOR_INCOMING,r=0;r<this._resultAreaEdgeList.size();r++){var n=this._resultAreaEdgeList.get(r),s=n.getSym();if(n.getLabel().isArea())switch(null===t&&n.isInResult()&&(t=n),i){case this._SCANNING_FOR_INCOMING:if(!s.isInResult())continue;e=s,i=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!n.isInResult())continue;e.setNext(n),i=this._SCANNING_FOR_INCOMING}}if(i===this._LINKING_TO_OUTGOING){if(null===t)throw new Ui("no outgoing dirEdge found",this.getCoordinate());m.isTrue(t.isInResult(),"unable to link last incoming dirEdge"),e.setNext(t)}}insert(t){var e=t;this.insertEdgeEnd(e,e)}getRightmostEdge(){var t=this.getEdges(),e=t.size();if(e<1)return null;var i=t.get(0);if(1===e)return i;var r=t.get(e-1),n=i.getQuadrant(),s=r.getQuadrant();return gi.isNorthern(n)&&gi.isNorthern(s)?i:gi.isNorthern(n)||gi.isNorthern(s)?0!==i.getDy()?i:0!==r.getDy()?r:(m.shouldNeverReachHere("found two horizontal edges incident on node"),null):r}print(t){G.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){var i=e.next();t.print("out "),i.print(t),t.println(),t.print("in "),i.getSym().print(t),t.println()}}getResultAreaEdges(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new C;for(var t=this.iterator();t.hasNext();){var e=t.next();(e.isInResult()||e.getSym().isInResult())&&this._resultAreaEdgeList.add(e)}return this._resultAreaEdgeList}updateLabelling(t){for(var e=this.iterator();e.hasNext();){var i=e.next().getLabel();i.setAllLocationsIfNull(0,t.getLocation(0)),i.setAllLocationsIfNull(1,t.getLocation(1))}}linkAllDirectedEdges(){this.getEdges();for(var t=null,e=null,i=this._edgeList.size()-1;i>=0;i--){var r=this._edgeList.get(i),n=r.getSym();null===e&&(e=n),null!==t&&n.setNext(t),t=r}e.setNext(t)}computeDepths(){if(1===arguments.length){let n=arguments[0];var t=this.findIndex(n),e=(n.getLabel(),n.getDepth(wi.LEFT)),i=n.getDepth(wi.RIGHT),r=this.computeDepths(t+1,this._edgeList.size(),e);if(this.computeDepths(0,t,r)!==i)throw new Ui("depth mismatch at "+n.getCoordinate())}else if(3===arguments.length){let t=arguments[0],e=arguments[1];for(var n=arguments[2],s=t;s<e;s++){var o=this._edgeList.get(s);o.getLabel(),o.setEdgeDepths(wi.RIGHT,n),n=o.getDepth(wi.LEFT)}return n}}mergeSymLabels(){for(var t=this.iterator();t.hasNext();){var e=t.next();e.getLabel().merge(e.getSym().getLabel())}}linkMinimalDirectedEdges(t){for(var e=null,i=null,r=this._SCANNING_FOR_INCOMING,n=this._resultAreaEdgeList.size()-1;n>=0;n--){var s=this._resultAreaEdgeList.get(n),o=s.getSym();switch(null===e&&s.getEdgeRing()===t&&(e=s),r){case this._SCANNING_FOR_INCOMING:if(o.getEdgeRing()!==t)continue;i=o,r=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(s.getEdgeRing()!==t)continue;i.setNextMin(s),r=this._SCANNING_FOR_INCOMING}}r===this._LINKING_TO_OUTGOING&&(m.isTrue(null!==e,"found null for first outgoing dirEdge"),m.isTrue(e.getEdgeRing()===t,"unable to link last incoming dirEdge"),i.setNextMin(e))}getOutgoingDegree(){if(0===arguments.length){for(var t=0,e=this.iterator();e.hasNext();)e.next().isInResult()&&t++;return t}if(1===arguments.length){let i=arguments[0];for(t=0,e=this.iterator();e.hasNext();)e.next().getEdgeRing()===i&&t++;return t}}getLabel(){return this._label}findCoveredLineEdges(){for(var t=_e.NONE,e=this.iterator();e.hasNext();){var i=(n=e.next()).getSym();if(!n.isLineEdge()){if(n.isInResult()){t=_e.INTERIOR;break}if(i.isInResult()){t=_e.EXTERIOR;break}}}if(t===_e.NONE)return null;var r=t;for(e=this.iterator();e.hasNext();){var n;i=(n=e.next()).getSym(),n.isLineEdge()?n.getEdge().setCovered(r===_e.INTERIOR):(n.isInResult()&&(r=_e.EXTERIOR),i.isInResult()&&(r=_e.INTERIOR))}}computeLabelling(t){super.computeLabelling.call(this,t),this._label=new Oi(_e.NONE);for(var e=this.iterator();e.hasNext();)for(var i=e.next().getEdge().getLabel(),r=0;r<2;r++){var n=i.getLocation(r);n!==_e.INTERIOR&&n!==_e.BOUNDARY||this._label.setLocation(r,_e.INTERIOR)}}getClass(){return nn}get interfaces_(){return[]}}nn.constructor_=function(){this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2};class sn extends zi{constructor(){super(),sn.constructor_.apply(this,arguments)}createNode(t){return new Bi(t,new nn)}getClass(){return sn}get interfaces_(){return[]}}sn.constructor_=function(){};class on{constructor(){on.constructor_.apply(this,arguments)}static orientation(t){return 1===$.increasingDirection(t)}static compareOriented(t,e,i,r){for(var n=e?1:-1,s=r?1:-1,o=e?t.length:-1,a=r?i.length:-1,h=e?0:t.length-1,l=r?0:i.length-1;;){var u=t[h].compareTo(i[l]);if(0!==u)return u;var c=(h+=n)===o,d=(l+=s)===a;if(c&&!d)return-1;if(!c&&d)return 1;if(c&&d)return 0}}compareTo(t){var e=t;return on.compareOriented(this._pts,this._orientation,e._pts,e._orientation)}getClass(){return on}get interfaces_(){return[c]}}on.constructor_=function(){this._pts=null,this._orientation=null;let t=arguments[0];this._pts=t,this._orientation=on.orientation(t)};class an{constructor(){an.constructor_.apply(this,arguments)}print(t){t.print("MULTILINESTRING ( ");for(var e=0;e<this._edges.size();e++){var i=this._edges.get(e);e>0&&t.print(","),t.print("(");for(var r=i.getCoordinates(),n=0;n<r.length;n++)n>0&&t.print(","),t.print(r[n].x+" "+r[n].y);t.println(")")}t.print(")  ")}addAll(t){for(var e=t.iterator();e.hasNext();)this.add(e.next())}findEdgeIndex(t){for(var e=0;e<this._edges.size();e++)if(this._edges.get(e).equals(t))return e;return-1}iterator(){return this._edges.iterator()}getEdges(){return this._edges}get(t){return this._edges.get(t)}findEqualEdge(t){var e=new on(t.getCoordinates());return this._ocaMap.get(e)}add(t){this._edges.add(t);var e=new on(t.getCoordinates());this._ocaMap.put(e,t)}getClass(){return an}get interfaces_(){return[]}}an.constructor_=function(){this._edges=new C,this._ocaMap=new pt};class hn{constructor(){hn.constructor_.apply(this,arguments)}processIntersections(t,e,i,r){}isDone(){}getClass(){return hn}get interfaces_(){return[]}}hn.constructor_=function(){};class ln{constructor(){ln.constructor_.apply(this,arguments)}static isAdjacentSegments(t,e){return 1===Math.abs(t-e)}isTrivialIntersection(t,e,i,r){if(t===i&&1===this._li.getIntersectionNum()){if(ln.isAdjacentSegments(e,r))return!0;if(t.isClosed()){var n=t.size()-1;if(0===e&&r===n||0===r&&e===n)return!0}}return!1}getProperIntersectionPoint(){return this._properIntersectionPoint}hasProperInteriorIntersection(){return this._hasProperInterior}getLineIntersector(){return this._li}hasProperIntersection(){return this._hasProper}processIntersections(t,e,i,r){if(t===i&&e===r)return null;this.numTests++;var n=t.getCoordinates()[e],s=t.getCoordinates()[e+1],o=i.getCoordinates()[r],a=i.getCoordinates()[r+1];this._li.computeIntersection(n,s,o,a),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,e,i,r)||(this._hasIntersection=!0,t.addIntersections(this._li,e,0),i.addIntersections(this._li,r,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))}hasIntersection(){return this._hasIntersection}isDone(){return!1}hasInteriorIntersection(){return this._hasInterior}getClass(){return ln}get interfaces_(){return[hn]}}ln.constructor_=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;let t=arguments[0];this._li=t};class un{constructor(){un.constructor_.apply(this,arguments)}static depthDelta(t){var e=t.getLocation(0,wi.LEFT),i=t.getLocation(0,wi.RIGHT);return e===_e.INTERIOR&&i===_e.EXTERIOR?1:e===_e.EXTERIOR&&i===_e.INTERIOR?-1:0}static convertSegStrings(t){for(var e=new oe,i=new C;t.hasNext();){var r=t.next(),n=e.createLineString(r.getCoordinates());i.add(n)}return e.buildGeometry(i)}setWorkingPrecisionModel(t){this._workingPrecisionModel=t}insertUniqueEdge(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var i=e.getLabel(),r=t.getLabel();e.isPointwiseEqual(t)||(r=new Oi(t.getLabel())).flip(),i.merge(r);var n=un.depthDelta(r),s=e.getDepthDelta()+n;e.setDepthDelta(s)}else this._edgeList.add(t),t.setDepthDelta(un.depthDelta(t.getLabel()))}buildSubgraphs(t,e){for(var i=new C,r=t.iterator();r.hasNext();){var n=r.next(),s=n.getRightmostCoordinate(),o=new $r(i).getDepth(s);n.computeDepth(o),n.findResultEdges(),i.add(n),e.add(n.getDirectedEdges(),n.getNodes())}}createSubgraphs(t){for(var e=new C,i=t.getNodes().iterator();i.hasNext();){var r=i.next();if(!r.isVisited()){var n=new qr;n.create(r),e.add(n)}}return Ae.sort(e,Ae.reverseOrder()),e}createEmptyResultGeometry(){return this._geomFact.createPolygon()}getNoder(t){if(null!==this._workingNoder)return this._workingNoder;var e=new Dr,i=new ge;return i.setPrecisionModel(t),e.setSegmentIntersector(new ln(i)),e}buffer(t,e){var i=this._workingPrecisionModel;null===i&&(i=t.getPrecisionModel()),this._geomFact=t.getFactory();var r=new Qr(i,this._bufParams),n=new en(t,e,r).getCurves();if(n.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(n,i),this._graph=new Xi(new sn),this._graph.addEdges(this._edgeList.getEdges());var s=this.createSubgraphs(this._graph),o=new Wr(this._geomFact);this.buildSubgraphs(s,o);var a=o.getPolygons();return a.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(a)}computeNodedEdges(t,e){var i=this.getNoder(e);i.computeNodes(t);for(var r=i.getNodedSubstrings().iterator();r.hasNext();){var n=r.next(),s=n.getCoordinates();if(2!==s.length||!s[0].equals2D(s[1])){var o=n.getData(),a=new Fi(n.getCoordinates(),new Oi(o));this.insertUniqueEdge(a)}}}setNoder(t){this._workingNoder=t}getClass(){return un}get interfaces_(){return[]}}un.constructor_=function(){this._bufParams=null,this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new an;let t=arguments[0];this._bufParams=t};class cn{constructor(){cn.constructor_.apply(this,arguments)}checkEndPtVertexIntersections(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next().getCoordinates();this.checkEndPtVertexIntersections(e[0],this._segStrings),this.checkEndPtVertexIntersections(e[e.length-1],this._segStrings)}else if(2===arguments.length){let r=arguments[0];for(t=arguments[1].iterator();t.hasNext();){e=t.next().getCoordinates();for(var i=1;i<e.length-1;i++)if(e[i].equals(r))throw new f("found endpt/interior pt intersection at index "+i+" :pt "+r)}}}checkInteriorIntersections(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();)for(var e=t.next(),i=this._segStrings.iterator();i.hasNext();){var r=i.next();this.checkInteriorIntersections(e,r)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];for(var n=t.getCoordinates(),s=e.getCoordinates(),o=0;o<n.length-1;o++)for(var a=0;a<s.length-1;a++)this.checkInteriorIntersections(t,o,e,a)}else if(4===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2],r=arguments[3];if(t===i&&e===r)return null;var h=t.getCoordinates()[e],l=t.getCoordinates()[e+1],u=i.getCoordinates()[r],c=i.getCoordinates()[r+1];if(this._li.computeIntersection(h,l,u,c),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,h,l)||this.hasInteriorIntersection(this._li,u,c)))throw new f("found non-noded intersection at "+h+"-"+l+" and "+u+"-"+c)}}checkValid(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()}checkCollapses(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next();this.checkCollapses(e)}else if(1===arguments.length){var i=arguments[0].getCoordinates();for(t=0;t<i.length-2;t++)this.checkCollapse(i[t],i[t+1],i[t+2])}}hasInteriorIntersection(t,e,i){for(var r=0;r<t.getIntersectionNum();r++){var n=t.getIntersection(r);if(!n.equals(e)&&!n.equals(i))return!0}return!1}checkCollapse(t,e,i){if(t.equals(i))throw new f("found non-noded collapse at "+cn.fact.createLineString([t,e,i]))}getClass(){return cn}get interfaces_(){return[]}}cn.constructor_=function(){this._li=new ge,this._segStrings=null;let t=arguments[0];this._segStrings=t},cn.fact=new oe;class dn{constructor(){dn.constructor_.apply(this,arguments)}intersectsScaled(t,e){var i=Math.min(t.x,e.x),r=Math.max(t.x,e.x),n=Math.min(t.y,e.y),s=Math.max(t.y,e.y),o=this._maxx<i||this._minx>r||this._maxy<n||this._miny>s;if(o)return!1;var a=this.intersectsToleranceSquare(t,e);return m.isTrue(!(o&&a),"Found bad envelope test"),a}initCorners(t){this._minx=t.x-.5,this._maxx=t.x+.5,this._miny=t.y-.5,this._maxy=t.y+.5,this._corner[0]=new y(this._maxx,this._maxy),this._corner[1]=new y(this._minx,this._maxy),this._corner[2]=new y(this._minx,this._miny),this._corner[3]=new y(this._maxx,this._miny)}intersects(t,e){return 1===this._scaleFactor?this.intersectsScaled(t,e):(this.copyScaled(t,this._p0Scaled),this.copyScaled(e,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))}scale(t){return Math.round(t*this._scaleFactor)}getCoordinate(){return this._originalPt}copyScaled(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)}getSafeEnvelope(){if(null===this._safeEnv){var t=dn.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new P(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv}intersectsPixelClosure(t,e){return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.hasIntersection()))))}intersectsToleranceSquare(t,e){var i=!1,r=!1;return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.isProper()||(this._li.hasIntersection()&&(i=!0),this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.isProper()||(this._li.hasIntersection()&&(r=!0),this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.isProper()||i&&r||t.equals(this._pt)||e.equals(this._pt)))))}addSnappedNode(t,e){var i=t.getCoordinate(e),r=t.getCoordinate(e+1);return!!this.intersects(i,r)&&(t.addIntersection(this.getCoordinate(),e),!0)}getClass(){return dn}get interfaces_(){return[]}}dn.constructor_=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;let t=arguments[0],e=arguments[1],r=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=e,this._li=r,e<=0)throw new i("Scale factor must be non-zero");1!==e&&(this._pt=new y(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new y,this._p1Scaled=new y),this.initCorners(this._pt)},dn.SAFE_ENV_EXPANSION_FACTOR=.75;class pn{constructor(){pn.constructor_.apply(this,arguments)}select(){if(1===arguments.length);else if(2===arguments.length){let t=arguments[0],e=arguments[1];t.getLineSegment(e,this.selectedSegment),this.select(this.selectedSegment)}}getClass(){return pn}get interfaces_(){return[]}}pn.constructor_=function(){this.selectedSegment=new fe};class gn{constructor(){gn.constructor_.apply(this,arguments)}snap(){if(1===arguments.length){let t=arguments[0];return this.snap(t,null,-1)}if(3===arguments.length){let i=arguments[0],r=arguments[1],n=arguments[2];var t=i.getSafeEnvelope(),e=new fn(i,r,n);return this._index.query(t,new class{get interfaces_(){return[Ce]}visitItem(i){i.select(t,e)}}),e.isNodeAdded()}}getClass(){return gn}get interfaces_(){return[]}}class fn extends pn{constructor(){super(),fn.constructor_.apply(this,arguments)}isNodeAdded(){return this._isNodeAdded}select(){if(!(2===arguments.length&&Number.isInteger(arguments[1])&&arguments[0]instanceof Lr))return super.select.apply(this,arguments);{let e=arguments[0],i=arguments[1];var t=e.getContext();if(null!==this._parentEdge&&t===this._parentEdge&&i===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(t,i)}}getClass(){return fn}get interfaces_(){return[]}}fn.constructor_=function(){this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;let t=arguments[0],e=arguments[1],i=arguments[2];this._hotPixel=t,this._parentEdge=e,this._hotPixelVertexIndex=i},gn.HotPixelSnapAction=fn,gn.constructor_=function(){this._index=null;let t=arguments[0];this._index=t};class _n{constructor(){_n.constructor_.apply(this,arguments)}processIntersections(t,e,i,r){if(t===i&&e===r)return null;var n=t.getCoordinates()[e],s=t.getCoordinates()[e+1],o=i.getCoordinates()[r],a=i.getCoordinates()[r+1];if(this._li.computeIntersection(n,s,o,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var h=0;h<this._li.getIntersectionNum();h++)this._interiorIntersections.add(this._li.getIntersection(h));t.addIntersections(this._li,e,0),i.addIntersections(this._li,r,1)}}isDone(){return!1}getInteriorIntersections(){return this._interiorIntersections}getClass(){return _n}get interfaces_(){return[hn]}}_n.constructor_=function(){this._li=null,this._interiorIntersections=null;let t=arguments[0];this._li=t,this._interiorIntersections=new C};class mn{constructor(){mn.constructor_.apply(this,arguments)}checkCorrectness(t){var e=Or.getNodedSubstrings(t),i=new cn(e);try{i.checkValid()}catch(t){if(!(t instanceof L))throw t;t.printStackTrace()}}getNodedSubstrings(){return Or.getNodedSubstrings(this._nodedSegStrings)}snapRound(t,e){var i=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(i),this.computeVertexSnaps(t)}findInteriorIntersections(t,e){var i=new _n(e);return this._noder.setSegmentIntersector(i),this._noder.computeNodes(t),i.getInteriorIntersections()}computeVertexSnaps(){if(x(arguments[0],w))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.computeVertexSnaps(e)}else if(arguments[0]instanceof Or){let t=arguments[0];for(var i=t.getCoordinates(),r=0;r<i.length;r++){var n=new dn(i[r],this._scaleFactor,this._li);this._pointSnapper.snap(n,t,r)&&t.addIntersection(i[r],r)}}}computeNodes(t){this._nodedSegStrings=t,this._noder=new Dr,this._pointSnapper=new gn(this._noder.getIndex()),this.snapRound(t,this._li)}computeIntersectionSnaps(t){for(var e=t.iterator();e.hasNext();){var i=e.next(),r=new dn(i,this._scaleFactor,this._li);this._pointSnapper.snap(r)}}getClass(){return mn}get interfaces_(){return[Rr]}}mn.constructor_=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;let t=arguments[0];this._pm=t,this._li=new ge,this._li.setPrecisionModel(t),this._scaleFactor=t.getScale()};class yn{constructor(){yn.constructor_.apply(this,arguments)}static bufferOp(){if(2===arguments.length){let t=arguments[0],e=arguments[1];return new yn(t).getResultGeometry(e)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof V&&"number"==typeof arguments[1]){let e=arguments[0],i=arguments[1],r=arguments[2];return(t=new yn(e)).setQuadrantSegments(r),t.getResultGeometry(i)}if(arguments[2]instanceof Yr&&arguments[0]instanceof V&&"number"==typeof arguments[1]){let e=arguments[0],i=arguments[1],r=arguments[2];return(t=new yn(e,r)).getResultGeometry(i)}}else if(4===arguments.length){let e=arguments[0],i=arguments[1],r=arguments[2],n=arguments[3];var t;return(t=new yn(e)).setQuadrantSegments(r),t.setEndCapStyle(n),t.getResultGeometry(i)}}static precisionScaleFactor(t,e,i){var r=t.getEnvelopeInternal(),n=Y.max(Math.abs(r.getMaxX()),Math.abs(r.getMaxY()),Math.abs(r.getMinX()),Math.abs(r.getMinY()))+2*(e>0?e:0),s=i-Math.trunc(Math.log(n)/Math.log(10)+1);return Math.pow(10,s)}bufferFixedPrecision(t){var e=new Br(new mn(new ne(1)),t.getScale()),i=new un(this._bufParams);i.setWorkingPrecisionModel(t),i.setNoder(e),this._resultGeometry=i.buffer(this._argGeom,this._distance)}bufferReducedPrecision(){if(0===arguments.length){for(var t=yn.MAX_PRECISION_DIGITS;t>=0;t--){try{this.bufferReducedPrecision(t)}catch(t){if(!(t instanceof Ui))throw t;this._saveException=t}if(null!==this._resultGeometry)return null}throw this._saveException}if(1===arguments.length){let t=arguments[0];var e=yn.precisionScaleFactor(this._argGeom,this._distance,t),i=new ne(e);this.bufferFixedPrecision(i)}}computeGeometry(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===ne.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()}setQuadrantSegments(t){this._bufParams.setQuadrantSegments(t)}bufferOriginalPrecision(){try{var t=new un(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(t){if(!(t instanceof f))throw t;this._saveException=t}}getResultGeometry(t){return this._distance=t,this.computeGeometry(),this._resultGeometry}setEndCapStyle(t){this._bufParams.setEndCapStyle(t)}getClass(){return yn}get interfaces_(){return[]}}yn.constructor_=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new Yr,this._resultGeometry=null,this._saveException=null,1===arguments.length){let t=arguments[0];this._argGeom=t}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this._argGeom=t,this._bufParams=e}},yn.CAP_ROUND=Yr.CAP_ROUND,yn.CAP_BUTT=Yr.CAP_FLAT,yn.CAP_FLAT=Yr.CAP_FLAT,yn.CAP_SQUARE=Yr.CAP_SQUARE,yn.MAX_PRECISION_DIGITS=12;var vn=Object.freeze({BufferOp:yn,BufferParameters:Yr});class xn{constructor(){xn.constructor_.apply(this,arguments)}static getPolygons(){if(1===arguments.length){let t=arguments[0];return xn.getPolygons(t,new C)}if(2===arguments.length){let t=arguments[0],e=arguments[1];return t instanceof Yt?e.add(t):t instanceof bt&&t.apply(new xn(e)),e}}filter(t){t instanceof Yt&&this._comps.add(t)}getClass(){return xn}get interfaces_(){return[Et]}}xn.constructor_=function(){this._comps=null;let t=arguments[0];this._comps=t};class En{constructor(){En.constructor_.apply(this,arguments)}isInsideArea(){return this._segIndex===En.INSIDE_AREA}getCoordinate(){return this._pt}getGeometryComponent(){return this._component}getSegmentIndex(){return this._segIndex}getClass(){return En}get interfaces_(){return[]}}En.constructor_=function(){if(this._component=null,this._segIndex=null,this._pt=null,2===arguments.length){let t=arguments[0],e=arguments[1];En.constructor_.call(this,t,En.INSIDE_AREA,e)}else if(3===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2];this._component=t,this._segIndex=e,this._pt=i}},En.INSIDE_AREA=-1;class wn{constructor(){wn.constructor_.apply(this,arguments)}static getPoints(){if(1===arguments.length){let t=arguments[0];return t instanceof kt?Ae.singletonList(t):wn.getPoints(t,new C)}if(2===arguments.length){let t=arguments[0],e=arguments[1];return t instanceof kt?e.add(t):t instanceof bt&&t.apply(new wn(e)),e}}filter(t){t instanceof kt&&this._pts.add(t)}getClass(){return wn}get interfaces_(){return[Et]}}wn.constructor_=function(){this._pts=null;let t=arguments[0];this._pts=t};class bn{constructor(){bn.constructor_.apply(this,arguments)}static getLocations(t){var e=new C;return t.apply(new bn(e)),e}filter(t){(t instanceof kt||t instanceof Ft||t instanceof Yt)&&this._locations.add(new En(t,0,t.getCoordinate()))}getClass(){return bn}get interfaces_(){return[Et]}}bn.constructor_=function(){this._locations=null;let t=arguments[0];this._locations=t};class In{constructor(){In.constructor_.apply(this,arguments)}static distance(t,e){return new In(t,e).distance()}static isWithinDistance(t,e,i){return!(t.getEnvelopeInternal().distance(e.getEnvelopeInternal())>i)&&new In(t,e,i).distance()<=i}static nearestPoints(t,e){return new In(t,e).nearestPoints()}computeContainmentDistance(){if(0===arguments.length){var t=new Array(2).fill(null);if(this.computeContainmentDistance(0,t),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,t)}else if(2===arguments.length){let t=arguments[0],s=arguments[1];var e=this._geom[t];if(e.getDimension()<2)return null;var i=1-t,r=xn.getPolygons(e);if(r.size()>0){var n=bn.getLocations(this._geom[i]);if(this.computeContainmentDistance(n,r,s),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[i]=s[0],this._minDistanceLocation[t]=s[1],null}}else if(3===arguments.length)if(arguments[2]instanceof Array&&x(arguments[0],I)&&x(arguments[1],I)){let t=arguments[0],e=arguments[1],i=arguments[2];for(var s=0;s<t.size();s++)for(var o=t.get(s),a=0;a<e.size();a++)if(this.computeContainmentDistance(o,e.get(a),i),this._minDistance<=this._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof En&&arguments[1]instanceof Yt){let t=arguments[0],e=arguments[1],i=arguments[2];var h=t.getCoordinate();if(_e.EXTERIOR!==this._ptLocator.locate(h,e))return this._minDistance=0,i[0]=t,i[1]=new En(e,h),null}}computeMinDistanceLinesPoints(t,e,i){for(var r=0;r<t.size();r++)for(var n=t.get(r),s=0;s<e.size();s++){var o=e.get(s);if(this.computeMinDistance(n,o,i),this._minDistance<=this._terminateDistance)return null}}computeFacetDistance(){var t=new Array(2).fill(null),e=De.getLines(this._geom[0]),i=De.getLines(this._geom[1]),r=wn.getPoints(this._geom[0]),n=wn.getPoints(this._geom[1]);return this.computeMinDistanceLines(e,i,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(e,n,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(i,r,t),this.updateMinDistance(t,!0),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistancePoints(r,n,t),void this.updateMinDistance(t,!1))))}nearestLocations(){return this.computeMinDistance(),this._minDistanceLocation}updateMinDistance(t,e){if(null===t[0])return null;e?(this._minDistanceLocation[0]=t[1],this._minDistanceLocation[1]=t[0]):(this._minDistanceLocation[0]=t[0],this._minDistanceLocation[1]=t[1])}nearestPoints(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]}computeMinDistance(){if(0===arguments.length){if(null!==this._minDistanceLocation)return null;if(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance)return null;this.computeFacetDistance()}else if(3===arguments.length)if(arguments[2]instanceof Array&&arguments[0]instanceof Ft&&arguments[1]instanceof kt){let n=arguments[0],s=arguments[1],a=arguments[2];if(n.getEnvelopeInternal().distance(s.getEnvelopeInternal())>this._minDistance)return null;for(var t=n.getCoordinates(),e=s.getCoordinate(),i=0;i<t.length-1;i++){if((o=z.pointToSegment(e,t[i],t[i+1]))<this._minDistance){this._minDistance=o;var r=new fe(t[i],t[i+1]).closestPoint(e);a[0]=new En(n,i,r),a[1]=new En(s,0,e)}if(this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Ft&&arguments[1]instanceof Ft){let e=arguments[0],r=arguments[1],u=arguments[2];if(e.getEnvelopeInternal().distance(r.getEnvelopeInternal())>this._minDistance)return null;t=e.getCoordinates();var n=r.getCoordinates();for(i=0;i<t.length-1;i++)for(var s=0;s<n.length-1;s++){var o;if((o=z.segmentToSegment(t[i],t[i+1],n[s],n[s+1]))<this._minDistance){this._minDistance=o;var a=new fe(t[i],t[i+1]),h=new fe(n[s],n[s+1]),l=a.closestPoints(h);u[0]=new En(e,i,l[0]),u[1]=new En(r,s,l[1])}if(this._minDistance<=this._terminateDistance)return null}}}computeMinDistancePoints(t,e,i){for(var r=0;r<t.size();r++)for(var n=t.get(r),s=0;s<e.size();s++){var o=e.get(s),a=n.getCoordinate().distance(o.getCoordinate());if(a<this._minDistance&&(this._minDistance=a,i[0]=new En(n,0,n.getCoordinate()),i[1]=new En(o,0,o.getCoordinate())),this._minDistance<=this._terminateDistance)return null}}distance(){if(null===this._geom[0]||null===this._geom[1])throw new i("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)}computeMinDistanceLines(t,e,i){for(var r=0;r<t.size();r++)for(var n=t.get(r),s=0;s<e.size();s++){var o=e.get(s);if(this.computeMinDistance(n,o,i),this._minDistance<=this._terminateDistance)return null}}getClass(){return In}get interfaces_(){return[]}}In.constructor_=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new oi,this._minDistanceLocation=null,this._minDistance=n.MAX_VALUE,2===arguments.length){let t=arguments[0],e=arguments[1];In.constructor_.call(this,t,e,0)}else if(3===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=t,this._geom[1]=e,this._terminateDistance=i}};var Tn=Object.freeze({DistanceOp:In});class Sn{constructor(){Sn.constructor_.apply(this,arguments)}getCoordinates(){if(null===this._coordinates){for(var t=0,e=0,i=new O,r=this._directedEdges.iterator();r.hasNext();){var n=r.next();n.getEdgeDirection()?t++:e++,i.add(n.getEdge().getLine().getCoordinates(),!1,n.getEdgeDirection())}this._coordinates=i.toCoordinateArray(),e>t&&$.reverse(this._coordinates)}return this._coordinates}toLineString(){return this._factory.createLineString(this.getCoordinates())}add(t){this._directedEdges.add(t)}getClass(){return Sn}get interfaces_(){return[]}}Sn.constructor_=function(){this._factory=null,this._directedEdges=new C,this._coordinates=null;let t=arguments[0];this._factory=t};class Cn{constructor(){Cn.constructor_.apply(this,arguments)}static getComponentWithVisitedState(t,e){for(;t.hasNext();){var i=t.next();if(i.isVisited()===e)return i}return null}static setVisited(t,e){for(;t.hasNext();)t.next().setVisited(e)}static setMarked(t,e){for(;t.hasNext();)t.next().setMarked(e)}setVisited(t){this._isVisited=t}isMarked(){return this._isMarked}setData(t){this._data=t}getData(){return this._data}setMarked(t){this._isMarked=t}getContext(){return this._data}isVisited(){return this._isVisited}setContext(t){this._data=t}getClass(){return Cn}get interfaces_(){return[]}}Cn.constructor_=function(){this._isMarked=!1,this._isVisited=!1,this._data=null};class Nn extends Cn{constructor(){super(),Nn.constructor_.apply(this,arguments)}static toEdges(t){for(var e=new C,i=t.iterator();i.hasNext();)e.add(i.next()._parentEdge);return e}isRemoved(){return null===this._parentEdge}compareDirection(t){return this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:k.index(t._p0,t._p1,this._p1)}getCoordinate(){return this._from.getCoordinate()}print(t){var e=this.getClass().getName(),i=e.lastIndexOf("."),r=e.substring(i+1);t.print("  "+r+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+this._angle)}getDirectionPt(){return this._p1}getAngle(){return this._angle}compareTo(t){var e=t;return this.compareDirection(e)}getFromNode(){return this._from}getSym(){return this._sym}setEdge(t){this._parentEdge=t}remove(){this._sym=null,this._parentEdge=null}getEdge(){return this._parentEdge}getQuadrant(){return this._quadrant}setSym(t){this._sym=t}getToNode(){return this._to}getEdgeDirection(){return this._edgeDirection}getClass(){return Nn}get interfaces_(){return[c]}}Nn.constructor_=function(){if(this._parentEdge=null,this._from=null,this._to=null,this._p0=null,this._p1=null,this._sym=null,this._edgeDirection=null,this._quadrant=null,this._angle=null,0===arguments.length);else if(4===arguments.length){let i=arguments[0],r=arguments[1],n=arguments[2],s=arguments[3];this._from=i,this._to=r,this._edgeDirection=s,this._p0=i.getCoordinate(),this._p1=n;var t=this._p1.x-this._p0.x,e=this._p1.y-this._p0.y;this._quadrant=gi.quadrant(t,e),this._angle=Math.atan2(e,t)}};class On extends Nn{constructor(){super(),On.constructor_.apply(this,arguments)}getNext(){return 2!==this.getToNode().getDegree()?null:this.getToNode().getOutEdges().getEdges().get(0)===this.getSym()?this.getToNode().getOutEdges().getEdges().get(1):(m.isTrue(this.getToNode().getOutEdges().getEdges().get(1)===this.getSym()),this.getToNode().getOutEdges().getEdges().get(0))}getClass(){return On}get interfaces_(){return[]}}On.constructor_=function(){let t=arguments[0],e=arguments[1],i=arguments[2],r=arguments[3];Nn.constructor_.call(this,t,e,i,r)};class Pn extends Cn{constructor(){super(),Pn.constructor_.apply(this,arguments)}isRemoved(){return null===this._dirEdge}setDirectedEdges(t,e){this._dirEdge=[t,e],t.setEdge(this),e.setEdge(this),t.setSym(e),e.setSym(t),t.getFromNode().addOutEdge(t),e.getFromNode().addOutEdge(e)}getDirEdge(){if(Number.isInteger(arguments[0])){let t=arguments[0];return this._dirEdge[t]}if(arguments[0]instanceof An){let t=arguments[0];return this._dirEdge[0].getFromNode()===t?this._dirEdge[0]:this._dirEdge[1].getFromNode()===t?this._dirEdge[1]:null}}remove(){this._dirEdge=null}getOppositeNode(t){return this._dirEdge[0].getFromNode()===t?this._dirEdge[0].getToNode():this._dirEdge[1].getFromNode()===t?this._dirEdge[1].getToNode():null}getClass(){return Pn}get interfaces_(){return[]}}Pn.constructor_=function(){if(this._dirEdge=null,0===arguments.length);else if(2===arguments.length){let t=arguments[0],e=arguments[1];this.setDirectedEdges(t,e)}};class Ln{constructor(){Ln.constructor_.apply(this,arguments)}getNextEdge(t){var e=this.getIndex(t);return this._outEdges.get(this.getIndex(e+1))}getCoordinate(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null}iterator(){return this.sortEdges(),this._outEdges.iterator()}sortEdges(){this._sorted||(Ae.sort(this._outEdges),this._sorted=!0)}remove(t){this._outEdges.remove(t)}getEdges(){return this.sortEdges(),this._outEdges}getNextCWEdge(t){var e=this.getIndex(t);return this._outEdges.get(this.getIndex(e-1))}getIndex(){if(arguments[0]instanceof Pn){let e=arguments[0];this.sortEdges();for(var t=0;t<this._outEdges.size();t++)if(this._outEdges.get(t).getEdge()===e)return t;return-1}if(arguments[0]instanceof Nn){let e=arguments[0];for(this.sortEdges(),t=0;t<this._outEdges.size();t++)if(this._outEdges.get(t)===e)return t;return-1}if(Number.isInteger(arguments[0])){var e=arguments[0]%this._outEdges.size();return e<0&&(e+=this._outEdges.size()),e}}add(t){this._outEdges.add(t),this._sorted=!1}getDegree(){return this._outEdges.size()}getClass(){return Ln}get interfaces_(){return[]}}Ln.constructor_=function(){this._outEdges=new C,this._sorted=!1};class An extends Cn{constructor(){super(),An.constructor_.apply(this,arguments)}static getEdgesBetween(t,e){var i=new st(Nn.toEdges(t.getOutEdges().getEdges())),r=Nn.toEdges(e.getOutEdges().getEdges());return i.retainAll(r),i}isRemoved(){return null===this._pt}addOutEdge(t){this._deStar.add(t)}getCoordinate(){return this._pt}getOutEdges(){return this._deStar}remove(){if(0===arguments.length)this._pt=null;else if(1===arguments.length){let t=arguments[0];this._deStar.remove(t)}}getIndex(t){return this._deStar.getIndex(t)}getDegree(){return this._deStar.getDegree()}getClass(){return An}get interfaces_(){return[]}}An.constructor_=function(){if(this._pt=null,this._deStar=null,1===arguments.length){let t=arguments[0];An.constructor_.call(this,t,new Ln)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this._pt=t,this._deStar=e}};class Rn extends Pn{constructor(){super(),Rn.constructor_.apply(this,arguments)}getLine(){return this._line}getClass(){return Rn}get interfaces_(){return[]}}Rn.constructor_=function(){this._line=null;let t=arguments[0];this._line=t};class Mn{constructor(){Mn.constructor_.apply(this,arguments)}find(t){return this._nodeMap.get(t)}iterator(){return this._nodeMap.values().iterator()}remove(t){return this._nodeMap.remove(t)}values(){return this._nodeMap.values()}add(t){return this._nodeMap.put(t.getCoordinate(),t),t}getClass(){return Mn}get interfaces_(){return[]}}Mn.constructor_=function(){this._nodeMap=new pt};class Dn{constructor(){Dn.constructor_.apply(this,arguments)}findNodesOfDegree(t){for(var e=new C,i=this.nodeIterator();i.hasNext();){var r=i.next();r.getDegree()===t&&e.add(r)}return e}dirEdgeIterator(){return this._dirEdges.iterator()}edgeIterator(){return this._edges.iterator()}remove(){if(arguments[0]instanceof Pn){let t=arguments[0];this.remove(t.getDirEdge(0)),this.remove(t.getDirEdge(1)),this._edges.remove(t),t.remove()}else if(arguments[0]instanceof Nn){let t=arguments[0];null!==(e=t.getSym())&&e.setSym(null),t.getFromNode().remove(t),t.remove(),this._dirEdges.remove(t)}else if(arguments[0]instanceof An){let n=arguments[0];for(var t=n.getOutEdges().getEdges().iterator();t.hasNext();){var e,i=t.next();null!==(e=i.getSym())&&this.remove(e),this._dirEdges.remove(i);var r=i.getEdge();null!==r&&this._edges.remove(r)}this._nodeMap.remove(n.getCoordinate()),n.remove()}}findNode(t){return this._nodeMap.find(t)}getEdges(){return this._edges}nodeIterator(){return this._nodeMap.iterator()}contains(){if(arguments[0]instanceof Pn){let t=arguments[0];return this._edges.contains(t)}if(arguments[0]instanceof Nn){let t=arguments[0];return this._dirEdges.contains(t)}}add(){if(arguments[0]instanceof An){let t=arguments[0];this._nodeMap.add(t)}else if(arguments[0]instanceof Pn){let t=arguments[0];this._edges.add(t),this.add(t.getDirEdge(0)),this.add(t.getDirEdge(1))}else if(arguments[0]instanceof Nn){let t=arguments[0];this._dirEdges.add(t)}}getNodes(){return this._nodeMap.values()}getClass(){return Dn}get interfaces_(){return[]}}Dn.constructor_=function(){this._edges=new st,this._dirEdges=new st,this._nodeMap=new Mn};class Fn extends Dn{constructor(){super(),Fn.constructor_.apply(this,arguments)}addEdge(t){if(t.isEmpty())return null;var e=$.removeRepeatedPoints(t.getCoordinates());if(e.length<=1)return null;var i=e[0],r=e[e.length-1],n=this.getNode(i),s=this.getNode(r),o=new On(n,s,e[1],!0),a=new On(s,n,e[e.length-2],!1),h=new Rn(t);h.setDirectedEdges(o,a),this.add(h)}getNode(t){var e=this.findNode(t);return null===e&&(e=new An(t),this.add(e)),e}getClass(){return Fn}get interfaces_(){return[]}}Fn.constructor_=function(){};class Bn{constructor(){Bn.constructor_.apply(this,arguments)}buildEdgeStringsForUnprocessedNodes(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next();e.isMarked()||(m.isTrue(2===e.getDegree()),this.buildEdgeStringsStartingAt(e),e.setMarked(!0))}}buildEdgeStringsForNonDegree2Nodes(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next();2!==e.getDegree()&&(this.buildEdgeStringsStartingAt(e),e.setMarked(!0))}}buildEdgeStringsForObviousStartNodes(){this.buildEdgeStringsForNonDegree2Nodes()}getMergedLineStrings(){return this.merge(),this._mergedLineStrings}buildEdgeStringsStartingAt(t){for(var e=t.getOutEdges().iterator();e.hasNext();){var i=e.next();i.getEdge().isMarked()||this._edgeStrings.add(this.buildEdgeStringStartingWith(i))}}merge(){if(null!==this._mergedLineStrings)return null;Cn.setMarked(this._graph.nodeIterator(),!1),Cn.setMarked(this._graph.edgeIterator(),!1),this._edgeStrings=new C,this.buildEdgeStringsForObviousStartNodes(),this.buildEdgeStringsForIsolatedLoops(),this._mergedLineStrings=new C;for(var t=this._edgeStrings.iterator();t.hasNext();){var e=t.next();this._mergedLineStrings.add(e.toLineString())}}addLineString(t){null===this._factory&&(this._factory=t.getFactory()),this._graph.addEdge(t)}buildEdgeStringStartingWith(t){var e=new Sn(this._factory),i=t;do{e.add(i),i.getEdge().setMarked(!0),i=i.getNext()}while(null!==i&&i!==t);return e}add(){if(arguments[0]instanceof V){let i=arguments[0];for(var t=0;t<i.getNumGeometries();t++){var e=i.getGeometryN(t);e instanceof Ft&&this.addLineString(e)}}else if(x(arguments[0],w)){let e=arguments[0];for(this._mergedLineStrings=null,t=e.iterator();t.hasNext();){var i=t.next();this.add(i)}}}buildEdgeStringsForIsolatedLoops(){this.buildEdgeStringsForUnprocessedNodes()}getClass(){return Bn}get interfaces_(){return[]}}Bn.constructor_=function(){this._graph=new Fn,this._mergedLineStrings=null,this._factory=null,this._edgeStrings=null};var kn=Object.freeze({LineMerger:Bn});class Gn{constructor(){Gn.constructor_.apply(this,arguments)}static isClosed(t){return!(t.length<=1)&&t[0].equals2D(t[t.length-1])}snapVertices(t,e){for(var i=this._isClosed?t.size()-1:t.size(),r=0;r<i;r++){var n=t.get(r),s=this.findSnapForVertex(n,e);null!==s&&(t.set(r,new y(s)),0===r&&this._isClosed&&t.set(t.size()-1,new y(s)))}}findSnapForVertex(t,e){for(var i=0;i<e.length;i++){if(t.equals2D(e[i]))return null;if(t.distance(e[i])<this._snapTolerance)return e[i]}return null}snapTo(t){var e=new O(this._srcPts);return this.snapVertices(e,t),this.snapSegments(e,t),e.toCoordinateArray()}snapSegments(t,e){if(0===e.length)return null;var i=e.length;e[0].equals2D(e[e.length-1])&&(i=e.length-1);for(var r=0;r<i;r++){var n=e[r],s=this.findSegmentIndexToSnap(n,t);s>=0&&t.add(s+1,new y(n),!1)}}findSegmentIndexToSnap(t,e){for(var i=n.MAX_VALUE,r=-1,s=0;s<e.size()-1;s++){if(this._seg.p0=e.get(s),this._seg.p1=e.get(s+1),this._seg.p0.equals2D(t)||this._seg.p1.equals2D(t)){if(this._allowSnappingToSourceVertices)continue;return-1}var o=this._seg.distance(t);o<this._snapTolerance&&o<i&&(i=o,r=s)}return r}setAllowSnappingToSourceVertices(t){this._allowSnappingToSourceVertices=t}getClass(){return Gn}get interfaces_(){return[]}}Gn.constructor_=function(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new fe,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof Ft&&"number"==typeof arguments[1]){let t=arguments[0],e=arguments[1];Gn.constructor_.call(this,t.getCoordinates(),e)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){let t=arguments[0],e=arguments[1];this._srcPts=t,this._isClosed=Gn.isClosed(t),this._snapTolerance=e}};class Un{constructor(){Un.constructor_.apply(this,arguments)}static snap(t,e,i){var r=new Array(2).fill(null),n=new Un(t);r[0]=n.snapTo(e,i);var s=new Un(e);return r[1]=s.snapTo(r[0],i),r}static computeOverlaySnapTolerance(){if(1===arguments.length){let r=arguments[0];var t=Un.computeSizeBasedSnapTolerance(r),e=r.getPrecisionModel();if(e.getType()===ne.FIXED){var i=1/e.getScale()*2/1.415;i>t&&(t=i)}return t}if(2===arguments.length){let t=arguments[0],e=arguments[1];return Math.min(Un.computeOverlaySnapTolerance(t),Un.computeOverlaySnapTolerance(e))}}static computeSizeBasedSnapTolerance(t){var e=t.getEnvelopeInternal();return Math.min(e.getHeight(),e.getWidth())*Un.SNAP_PRECISION_FACTOR}static snapToSelf(t,e,i){return new Un(t).snapToSelf(e,i)}snapTo(t,e){var i=this.extractTargetCoordinates(t);return new Yn(e,i).transform(this._srcGeom)}snapToSelf(t,e){var i=this.extractTargetCoordinates(this._srcGeom),r=new Yn(t,i,!0).transform(this._srcGeom),n=r;return e&&x(n,Ut)&&(n=r.buffer(0)),n}computeSnapTolerance(t){return this.computeMinimumSegmentLength(t)/10}extractTargetCoordinates(t){for(var e=new _t,i=t.getCoordinates(),r=0;r<i.length;r++)e.add(i[r]);return e.toArray(new Array(0).fill(null))}computeMinimumSegmentLength(t){for(var e=n.MAX_VALUE,i=0;i<t.length-1;i++){var r=t[i].distance(t[i+1]);r<e&&(e=r)}return e}getClass(){return Un}get interfaces_(){return[]}}Un.constructor_=function(){this._srcGeom=null;let t=arguments[0];this._srcGeom=t},Un.SNAP_PRECISION_FACTOR=1e-9;class Yn extends ui{constructor(){super(),Yn.constructor_.apply(this,arguments)}snapLine(t,e){var i=new Gn(t,this._snapTolerance);return i.setAllowSnappingToSourceVertices(this._isSelfSnap),i.snapTo(e)}transformCoordinates(t,e){var i=t.toCoordinateArray(),r=this.snapLine(i,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(r)}getClass(){return Yn}get interfaces_(){return[]}}Yn.constructor_=function(){if(this._snapTolerance=null,this._snapPts=null,this._isSelfSnap=!1,2===arguments.length){let t=arguments[0],e=arguments[1];this._snapTolerance=t,this._snapPts=e}else if(3===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2];this._snapTolerance=t,this._snapPts=e,this._isSelfSnap=i}};var zn=Object.freeze({GeometrySnapper:Un,LineStringSnapper:Gn});class Xn{constructor(){Xn.constructor_.apply(this,arguments)}getCoordinates(){return this._pts}size(){return this._pts.length}getCoordinate(t){return this._pts[t]}isClosed(){return this._pts[0].equals(this._pts[this._pts.length-1])}getSegmentOctant(t){return t===this._pts.length-1?-1:Sr.octant(this.getCoordinate(t),this.getCoordinate(t+1))}setData(t){this._data=t}getData(){return this._data}toString(){return de.toLineString(new Zt(this._pts))}getClass(){return Xn}get interfaces_(){return[Cr]}}Xn.constructor_=function(){this._pts=null,this._data=null;let t=arguments[0],e=arguments[1];this._pts=t,this._data=e};class qn{constructor(){qn.constructor_.apply(this,arguments)}static createAllIntersectionsFinder(t){var e=new qn(t);return e.setFindAllIntersections(!0),e}static createAnyIntersectionFinder(t){return new qn(t)}static createIntersectionCounter(t){var e=new qn(t);return e.setFindAllIntersections(!0),e.setKeepIntersections(!1),e}getInteriorIntersection(){return this._interiorIntersection}setCheckEndSegmentsOnly(t){this._isCheckEndSegmentsOnly=t}getIntersectionSegments(){return this._intSegments}count(){return this._intersectionCount}getIntersections(){return this._intersections}setFindAllIntersections(t){this._findAllIntersections=t}setKeepIntersections(t){this._keepIntersections=t}processIntersections(t,e,i,r){if(!this._findAllIntersections&&this.hasIntersection())return null;if(t===i&&e===r)return null;if(this._isCheckEndSegmentsOnly&&!this.isEndSegment(t,e)&&!this.isEndSegment(i,r))return null;var n=t.getCoordinates()[e],s=t.getCoordinates()[e+1],o=i.getCoordinates()[r],a=i.getCoordinates()[r+1];this._li.computeIntersection(n,s,o,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=n,this._intSegments[1]=s,this._intSegments[2]=o,this._intSegments[3]=a,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)}isEndSegment(t,e){return 0===e||e>=t.size()-2}hasIntersection(){return null!==this._interiorIntersection}isDone(){return!this._findAllIntersections&&null!==this._interiorIntersection}getClass(){return qn}get interfaces_(){return[hn]}}qn.constructor_=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new C,this._intersectionCount=0,this._keepIntersections=!0;let t=arguments[0];this._li=t,this._interiorIntersection=null};class Hn{constructor(){Hn.constructor_.apply(this,arguments)}static computeIntersections(t){var e=new Hn(t);return e.setFindAllIntersections(!0),e.isValid(),e.getIntersections()}execute(){if(null!==this._segInt)return null;this.checkInteriorIntersections()}getIntersections(){return this._segInt.getIntersections()}isValid(){return this.execute(),this._isValid}setFindAllIntersections(t){this._findAllIntersections=t}checkInteriorIntersections(){this._isValid=!0,this._segInt=new qn(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var t=new Dr;if(t.setSegmentIntersector(this._segInt),t.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null}checkValid(){if(this.execute(),!this._isValid)throw new Ui(this.getErrorMessage(),this._segInt.getInteriorIntersection())}getErrorMessage(){if(this._isValid)return"no intersections found";var t=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+de.toLineString(t[0],t[1])+" and "+de.toLineString(t[2],t[3])}getClass(){return Hn}get interfaces_(){return[]}}Hn.constructor_=function(){this._li=new ge,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;let t=arguments[0];this._segStrings=t};class Vn{constructor(){Vn.constructor_.apply(this,arguments)}static toSegmentStrings(t){for(var e=new C,i=t.iterator();i.hasNext();){var r=i.next();e.add(new Xn(r.getCoordinates(),r))}return e}static checkValid(t){new Vn(t).checkValid()}checkValid(){this._nv.checkValid()}getClass(){return Vn}get interfaces_(){return[]}}Vn.constructor_=function(){this._nv=null;let t=arguments[0];this._nv=new Hn(Vn.toSegmentStrings(t))};class jn{constructor(){jn.constructor_.apply(this,arguments)}static map(t,e){return new jn(e).map(t)}map(t){for(var e=new C,i=0;i<t.getNumGeometries();i++){var r=this._mapOp.map(t.getGeometryN(i));r.isEmpty()||e.add(r)}return t.getFactory().createGeometryCollection(oe.toGeometryArray(e))}getClass(){return jn}get interfaces_(){return[]}}jn.constructor_=function(){this._mapOp=null;let t=arguments[0];this._mapOp=t};class Wn{constructor(){Wn.constructor_.apply(this,arguments)}map(t){}getClass(){return Wn}get interfaces_(){return[]}}Wn.constructor_=function(){};class Kn{constructor(){Kn.constructor_.apply(this,arguments)}collectLines(t){for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var i=e.next();this.collectLineEdge(i,t,this._lineEdgesList),this.collectBoundaryTouchEdge(i,t,this._lineEdgesList)}}labelIsolatedLine(t,e){var i=this._ptLocator.locate(t.getCoordinate(),this._op.getArgGeometry(e));t.getLabel().setLocation(e,i)}build(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this._resultLineList}collectLineEdge(t,e,i){var r=t.getLabel(),n=t.getEdge();t.isLineEdge()&&(t.isVisited()||!ns.isResultOfOp(r,e)||n.isCovered()||(i.add(n),t.setVisitedEdge(!0)))}findCoveredLineEdges(){for(var t=this._op.getGraph().getNodes().iterator();t.hasNext();)t.next().getEdges().findCoveredLineEdges();for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var i=e.next(),r=i.getEdge();if(i.isLineEdge()&&!r.isCoveredSet()){var n=this._op.isCoveredByA(i.getCoordinate());r.setCovered(n)}}}labelIsolatedLines(t){for(var e=t.iterator();e.hasNext();){var i=e.next(),r=i.getLabel();i.isIsolated()&&(r.isNull(0)?this.labelIsolatedLine(i,0):this.labelIsolatedLine(i,1))}}buildLines(t){for(var e=this._lineEdgesList.iterator();e.hasNext();){var i=e.next(),r=(i.getLabel(),this._geometryFactory.createLineString(i.getCoordinates()));this._resultLineList.add(r),i.setInResult(!0)}}collectBoundaryTouchEdge(t,e,i){var r=t.getLabel();return t.isLineEdge()?null:t.isVisited()?null:t.isInteriorAreaEdge()?null:t.getEdge().isInResult()?null:(m.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),void(ns.isResultOfOp(r,e)&&e===ns.INTERSECTION&&(i.add(t.getEdge()),t.setVisitedEdge(!0))))}getClass(){return Kn}get interfaces_(){return[]}}Kn.constructor_=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new C,this._resultLineList=new C;let t=arguments[0],e=arguments[1],i=arguments[2];this._op=t,this._geometryFactory=e,this._ptLocator=i};class Zn{constructor(){Zn.constructor_.apply(this,arguments)}filterCoveredNodeToPoint(t){var e=t.getCoordinate();if(!this._op.isCoveredByLA(e)){var i=this._geometryFactory.createPoint(e);this._resultPointList.add(i)}}extractNonCoveredResultNodes(t){for(var e=this._op.getGraph().getNodes().iterator();e.hasNext();){var i=e.next();if(!(i.isInResult()||i.isIncidentEdgeInResult()||0!==i.getEdges().getDegree()&&t!==ns.INTERSECTION)){var r=i.getLabel();ns.isResultOfOp(r,t)&&this.filterCoveredNodeToPoint(i)}}}build(t){return this.extractNonCoveredResultNodes(t),this._resultPointList}getClass(){return Zn}get interfaces_(){return[]}}Zn.constructor_=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new C;let t=arguments[0],e=arguments[1];this._op=t,this._geometryFactory=e};class Jn{constructor(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=new r,this._commonSignExp=null}getCommon(){return n.longBitsToDouble(this._commonBits)}add(t){var e=n.doubleToLongBits(t);return this._isFirst?(this._commonBits=e,this._commonSignExp=Jn.signExpBits(this._commonBits),this._isFirst=!1,null):Jn.signExpBits(e)!==this._commonSignExp?(this._commonBits.high=0,this._commonBits.low=0,null):(this._commonMantissaBitsCount=Jn.numCommonMostSigMantissaBits(this._commonBits,e),void(this._commonBits=Jn.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))))}toString(){if(1===arguments.length){let s=arguments[0];var t=n.longBitsToDouble(s),e="0000000000000000000000000000000000000000000000000000000000000000"+r.toBinaryString(s),i=e.substring(e.length-64);return i.substring(0,1)+"  "+i.substring(1,12)+"(exp) "+i.substring(12)+" [ "+t+" ]"}}getClass(){return Jn}get interfaces_(){return[]}static getBit(t,e){var i=1<<e%32;return e<32?0!=(t.low&i)?1:0:0!=(t.high&i)?1:0}static signExpBits(t){return t.high>>>20}static zeroLowerBits(t,e){var i="low";if(e>32&&(t.low=0,e%=32,i="high"),e>0){var r=e<32?~((1<<e)-1):0;t[i]&=r}return t}static numCommonMostSigMantissaBits(t,e){for(var i=0,r=52;r>=0;r--){if(Jn.getBit(t,r)!==Jn.getBit(e,r))return i;i++}return 52}}class Qn{constructor(){Qn.constructor_.apply(this,arguments)}addCommonBits(t){var e=new ts(this._commonCoord);t.apply(e),t.geometryChanged()}removeCommonBits(t){if(0===this._commonCoord.x&&0===this._commonCoord.y)return t;var e=new y(this._commonCoord);e.x=-e.x,e.y=-e.y;var i=new ts(e);return t.apply(i),t.geometryChanged(),t}getCommonCoordinate(){return this._commonCoord}add(t){t.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()}getClass(){return Qn}get interfaces_(){return[]}}class $n{constructor(){$n.constructor_.apply(this,arguments)}filter(t){this._commonBitsX.add(t.x),this._commonBitsY.add(t.y)}getCommonCoordinate(){return new y(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())}getClass(){return $n}get interfaces_(){return[j]}}$n.constructor_=function(){this._commonBitsX=new Jn,this._commonBitsY=new Jn};class ts{constructor(){ts.constructor_.apply(this,arguments)}filter(t,e){var i=t.getOrdinate(e,0)+this.trans.x,r=t.getOrdinate(e,1)+this.trans.y;t.setOrdinate(e,0,i),t.setOrdinate(e,1,r)}isDone(){return!1}isGeometryChanged(){return!0}getClass(){return ts}get interfaces_(){return[wt]}}ts.constructor_=function(){this.trans=null;let t=arguments[0];this.trans=t},Qn.CommonCoordinateFilter=$n,Qn.Translater=ts,Qn.constructor_=function(){this._commonCoord=null,this._ccFilter=new $n};class es{constructor(){es.constructor_.apply(this,arguments)}static overlayOp(t,e,i){return new es(t,e).getResultGeometry(i)}static union(t,e){return es.overlayOp(t,e,ns.UNION)}static intersection(t,e){return es.overlayOp(t,e,ns.INTERSECTION)}static symDifference(t,e){return es.overlayOp(t,e,ns.SYMDIFFERENCE)}static difference(t,e){return es.overlayOp(t,e,ns.DIFFERENCE)}selfSnap(t){return new Un(t).snapTo(t,this._snapTolerance)}removeCommonBits(t){this._cbr=new Qn,this._cbr.add(t[0]),this._cbr.add(t[1]);var e=new Array(2).fill(null);return e[0]=this._cbr.removeCommonBits(t[0].copy()),e[1]=this._cbr.removeCommonBits(t[1].copy()),e}prepareResult(t){return this._cbr.addCommonBits(t),t}getResultGeometry(t){var e=this.snap(this._geom),i=ns.overlayOp(e[0],e[1],t);return this.prepareResult(i)}checkValid(t){t.isValid()||G.out.println("Snapped geometry is invalid")}computeSnapTolerance(){this._snapTolerance=Un.computeOverlaySnapTolerance(this._geom[0],this._geom[1])}snap(t){var e=this.removeCommonBits(t);return Un.snap(e[0],e[1],this._snapTolerance)}getClass(){return es}get interfaces_(){return[]}}es.constructor_=function(){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null;let t=arguments[0],e=arguments[1];this._geom[0]=t,this._geom[1]=e,this.computeSnapTolerance()};class is{constructor(){is.constructor_.apply(this,arguments)}static overlayOp(t,e,i){return new is(t,e).getResultGeometry(i)}static union(t,e){return is.overlayOp(t,e,ns.UNION)}static intersection(t,e){return is.overlayOp(t,e,ns.INTERSECTION)}static symDifference(t,e){return is.overlayOp(t,e,ns.SYMDIFFERENCE)}static difference(t,e){return is.overlayOp(t,e,ns.DIFFERENCE)}getResultGeometry(t){var e=null,i=!1,r=null;try{e=ns.overlayOp(this._geom[0],this._geom[1],t),i=!0}catch(t){if(!(t instanceof f))throw t;r=t}if(!i)try{e=es.overlayOp(this._geom[0],this._geom[1],t)}catch(t){throw t instanceof f?r:t}return e}getClass(){return is}get interfaces_(){return[]}}is.constructor_=function(){this._geom=new Array(2).fill(null);let t=arguments[0],e=arguments[1];this._geom[0]=t,this._geom[1]=e};class rs{constructor(){rs.constructor_.apply(this,arguments)}getArgGeometry(t){return this._arg[t].getGeometry()}setComputationPrecision(t){this._resultPrecisionModel=t,this._li.setPrecisionModel(this._resultPrecisionModel)}getClass(){return rs}get interfaces_(){return[]}}rs.constructor_=function(){if(this._li=new ge,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){let t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new qi(0,t)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];rs.constructor_.call(this,t,e,W.OGC_SFS_BOUNDARY_RULE)}else if(3===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2];t.getPrecisionModel().compareTo(e.getPrecisionModel())>=0?this.setComputationPrecision(t.getPrecisionModel()):this.setComputationPrecision(e.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new qi(0,t,i),this._arg[1]=new qi(1,e,i)}};class ns extends rs{constructor(){super(),ns.constructor_.apply(this,arguments)}static overlayOp(t,e,i){return new ns(t,e).getResultGeometry(i)}static union(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return ns.createEmptyResult(ns.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}if(t.isGeometryCollection()||e.isGeometryCollection())throw new i("This method does not support GeometryCollection arguments");return is.overlayOp(t,e,ns.UNION)}static intersection(t,e){if(t.isEmpty()||e.isEmpty())return ns.createEmptyResult(ns.INTERSECTION,t,e,t.getFactory());if(t.isGeometryCollection()){var i=e;return jn.map(t,new class{get interfaces_(){return[Wn]}map(t){return ns.intersection(t,i)}})}return is.overlayOp(t,e,ns.INTERSECTION)}static symDifference(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return ns.createEmptyResult(ns.SYMDIFFERENCE,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}if(t.isGeometryCollection()||e.isGeometryCollection())throw new i("This method does not support GeometryCollection arguments");return is.overlayOp(t,e,ns.SYMDIFFERENCE)}static resultDimension(t,e,i){var r=e.getDimension(),n=i.getDimension(),s=-1;switch(t){case ns.INTERSECTION:s=Math.min(r,n);break;case ns.UNION:s=Math.max(r,n);break;case ns.DIFFERENCE:s=r;break;case ns.SYMDIFFERENCE:s=Math.max(r,n)}return s}static createEmptyResult(t,e,i,r){var n=null;switch(ns.resultDimension(t,e,i)){case-1:n=r.createGeometryCollection();break;case 0:n=r.createPoint();break;case 1:n=r.createLineString();break;case 2:n=r.createPolygon()}return n}static difference(t,e){if(t.isEmpty())return ns.createEmptyResult(ns.DIFFERENCE,t,e,t.getFactory());if(e.isEmpty())return t.copy();if(t.isGeometryCollection()||e.isGeometryCollection())throw new i("This method does not support GeometryCollection arguments");return is.overlayOp(t,e,ns.DIFFERENCE)}static isResultOfOp(){if(2===arguments.length){let i=arguments[0],r=arguments[1];var t=i.getLocation(0),e=i.getLocation(1);return ns.isResultOfOp(t,e,r)}if(3===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2];switch(t===_e.BOUNDARY&&(t=_e.INTERIOR),e===_e.BOUNDARY&&(e=_e.INTERIOR),i){case ns.INTERSECTION:return t===_e.INTERIOR&&e===_e.INTERIOR;case ns.UNION:return t===_e.INTERIOR||e===_e.INTERIOR;case ns.DIFFERENCE:return t===_e.INTERIOR&&e!==_e.INTERIOR;case ns.SYMDIFFERENCE:return t===_e.INTERIOR&&e!==_e.INTERIOR||t!==_e.INTERIOR&&e===_e.INTERIOR}return!1}}insertUniqueEdge(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var i=e.getLabel(),r=t.getLabel();e.isPointwiseEqual(t)||(r=new Oi(t.getLabel())).flip();var n=e.getDepth();n.isNull()&&n.add(i),n.add(r),i.merge(r)}else this._edgeList.add(t)}getGraph(){return this._graph}cancelDuplicateResultEdges(){for(var t=this._graph.getEdgeEnds().iterator();t.hasNext();){var e=t.next(),i=e.getSym();e.isInResult()&&i.isInResult()&&(e.setInResult(!1),i.setInResult(!1))}}isCoveredByLA(t){return!!this.isCovered(t,this._resultLineList)||!!this.isCovered(t,this._resultPolyList)}computeGeometry(t,e,i,r){var n=new C;return n.addAll(t),n.addAll(e),n.addAll(i),n.isEmpty()?ns.createEmptyResult(r,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(n)}mergeSymLabels(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().mergeSymLabels()}isCovered(t,e){for(var i=e.iterator();i.hasNext();){var r=i.next();if(this._ptLocator.locate(t,r)!==_e.EXTERIOR)return!0}return!1}replaceCollapsedEdges(){for(var t=new C,e=this._edgeList.iterator();e.hasNext();){var i=e.next();i.isCollapsed()&&(e.remove(),t.add(i.getCollapsedEdge()))}this._edgeList.addAll(t)}updateNodeLabelling(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),i=e.getEdges().getLabel();e.getLabel().merge(i)}}getResultGeometry(t){return this.computeOverlay(t),this._resultGeom}insertUniqueEdges(t){for(var e=t.iterator();e.hasNext();){var i=e.next();this.insertUniqueEdge(i)}}computeOverlay(t){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var e=new C;this._arg[0].computeSplitEdges(e),this._arg[1].computeSplitEdges(e),this.insertUniqueEdges(e),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),Vn.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(t),this.cancelDuplicateResultEdges();var i=new Wr(this._geomFact);i.add(this._graph),this._resultPolyList=i.getPolygons();var r=new Kn(this,this._geomFact,this._ptLocator);this._resultLineList=r.build(t);var n=new Zn(this,this._geomFact,this._ptLocator);this._resultPointList=n.build(t),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,t)}labelIncompleteNode(t,e){var i=this._ptLocator.locate(t.getCoordinate(),this._arg[e].getGeometry());t.getLabel().setLocation(e,i)}copyPoints(t){for(var e=this._arg[t].getNodeIterator();e.hasNext();){var i=e.next();this._graph.addNode(i.getCoordinate()).setLabel(t,i.getLabel().getLocation(t))}}findResultAreaEdges(t){for(var e=this._graph.getEdgeEnds().iterator();e.hasNext();){var i=e.next(),r=i.getLabel();r.isArea()&&!i.isInteriorAreaEdge()&&ns.isResultOfOp(r.getLocation(0,wi.RIGHT),r.getLocation(1,wi.RIGHT),t)&&i.setInResult(!0)}}computeLabelsFromDepths(){for(var t=this._edgeList.iterator();t.hasNext();){var e=t.next(),i=e.getLabel(),r=e.getDepth();if(!r.isNull()){r.normalize();for(var n=0;n<2;n++)i.isNull(n)||!i.isArea()||r.isNull(n)||(0===r.getDelta(n)?i.toLine(n):(m.isTrue(!r.isNull(n,wi.LEFT),"depth of LEFT side has not been initialized"),i.setLocation(n,wi.LEFT,r.getLocation(n,wi.LEFT)),m.isTrue(!r.isNull(n,wi.RIGHT),"depth of RIGHT side has not been initialized"),i.setLocation(n,wi.RIGHT,r.getLocation(n,wi.RIGHT))))}}}computeLabelling(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()}labelIncompleteNodes(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),i=e.getLabel();e.isIsolated()&&(i.isNull(0)?this.labelIncompleteNode(e,0):this.labelIncompleteNode(e,1)),e.getEdges().updateLabelling(i)}}isCoveredByA(t){return!!this.isCovered(t,this._resultPolyList)}getClass(){return ns}get interfaces_(){return[]}}ns.constructor_=function(){this._ptLocator=new oi,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new an,this._resultPolyList=new C,this._resultLineList=new C,this._resultPointList=new C;let t=arguments[0],e=arguments[1];rs.constructor_.call(this,t,e),this._graph=new Xi(new sn),this._geomFact=t.getFactory()},ns.INTERSECTION=1,ns.UNION=2,ns.DIFFERENCE=3,ns.SYMDIFFERENCE=4;var ss=Object.freeze({snap:zn,OverlayOp:ns});class os extends Nn{constructor(){super(),os.constructor_.apply(this,arguments)}getNext(){return this._next}isInRing(){return null!==this._edgeRing}setRing(t){this._edgeRing=t}setLabel(t){this._label=t}getLabel(){return this._label}setNext(t){this._next=t}getRing(){return this._edgeRing}getClass(){return os}get interfaces_(){return[]}}os.constructor_=function(){this._edgeRing=null,this._next=null,this._label=-1;let t=arguments[0],e=arguments[1],i=arguments[2],r=arguments[3];Nn.constructor_.call(this,t,e,i,r)};class as extends Pn{constructor(){super(),as.constructor_.apply(this,arguments)}getLine(){return this._line}getClass(){return as}get interfaces_(){return[]}}as.constructor_=function(){this._line=null;let t=arguments[0];this._line=t};class hs{constructor(){hs.constructor_.apply(this,arguments)}static findDirEdgesInRing(t){var e=t,i=new C;do{i.add(e),e=e.getNext(),m.isTrue(null!==e,"found null DE in ring"),m.isTrue(e===t||!e.isInRing(),"found DE already in ring")}while(e!==t);return i}static addEdge(t,e,i){if(e)for(var r=0;r<t.length;r++)i.add(t[r],!1);else for(r=t.length-1;r>=0;r--)i.add(t[r],!1)}static findEdgeRingContaining(t,e){for(var i=t.getRing(),r=i.getEnvelopeInternal(),n=i.getCoordinateN(0),s=null,o=null,a=e.iterator();a.hasNext();){var h=a.next(),l=h.getRing(),u=l.getEnvelopeInternal();if(!u.equals(r)&&u.contains(r)){n=$.ptNotInList(i.getCoordinates(),l.getCoordinates());var c=!1;Ye.isInRing(n,l.getCoordinates())&&(c=!0),c&&(null===s||o.contains(u))&&(o=(s=h).getRing().getEnvelopeInternal())}}return s}isIncluded(){return this._isIncluded}getCoordinates(){if(null===this._ringPts){for(var t=new O,e=this._deList.iterator();e.hasNext();){var i=e.next(),r=i.getEdge();hs.addEdge(r.getLine().getCoordinates(),i.getEdgeDirection(),t)}this._ringPts=t.toCoordinateArray()}return this._ringPts}isIncludedSet(){return this._isIncludedSet}isValid(){return this.getCoordinates(),!(this._ringPts.length<=3)&&(this.getRing(),this._ring.isValid())}build(t){var e=t;do{this.add(e),e.setRing(this),e=e.getNext(),m.isTrue(null!==e,"found null DE in ring"),m.isTrue(e===t||!e.isInRing(),"found DE already in ring")}while(e!==t)}isOuterHole(){return!!this._isHole&&!this.hasShell()}getPolygon(){var t=null;if(null!==this._holes){t=new Array(this._holes.size()).fill(null);for(var e=0;e<this._holes.size();e++)t[e]=this._holes.get(e)}return this._factory.createPolygon(this._ring,t)}isHole(){return this._isHole}isProcessed(){return this._isProcessed}addHole(){if(arguments[0]instanceof Xt){let t=arguments[0];null===this._holes&&(this._holes=new C),this._holes.add(t)}else if(arguments[0]instanceof hs){let e=arguments[0];e.setShell(this);var t=e.getRing();null===this._holes&&(this._holes=new C),this._holes.add(t)}}setIncluded(t){this._isIncluded=t,this._isIncludedSet=!0}getOuterHole(){if(this.isHole())return null;for(var t=0;t<this._deList.size();t++){var e=this._deList.get(t).getSym().getRing();if(e.isOuterHole())return e}return null}computeHole(){var t=this.getRing();this._isHole=k.isCCW(t.getCoordinates())}hasShell(){return null!==this._shell}isOuterShell(){return null!==this.getOuterHole()}getLineString(){return this.getCoordinates(),this._factory.createLineString(this._ringPts)}toString(){return de.toLineString(new Zt(this.getCoordinates()))}getShell(){return this.isHole()?this._shell:this}add(t){this._deList.add(t)}getRing(){if(null!==this._ring)return this._ring;this.getCoordinates(),this._ringPts.length<3&&G.out.println(this._ringPts);try{this._ring=this._factory.createLinearRing(this._ringPts)}catch(t){if(!(t instanceof L))throw t;G.out.println(this._ringPts)}return this._ring}updateIncluded(){if(this.isHole())return null;for(var t=0;t<this._deList.size();t++){var e=this._deList.get(t).getSym().getRing().getShell();if(null!==e&&e.isIncludedSet())return this.setIncluded(!e.isIncluded()),null}}setShell(t){this._shell=t}setProcessed(t){this._isProcessed=t}getClass(){return hs}get interfaces_(){return[]}}class ls{constructor(){ls.constructor_.apply(this,arguments)}compare(t,e){var i=e;return t.getRing().getEnvelope().compareTo(i.getRing().getEnvelope())}getClass(){return ls}get interfaces_(){return[p]}}ls.constructor_=function(){},hs.EnvelopeComparator=ls,hs.constructor_=function(){this._factory=null,this._deList=new C,this._lowestEdge=null,this._ring=null,this._ringPts=null,this._holes=null,this._shell=null,this._isHole=null,this._isProcessed=!1,this._isIncludedSet=!1,this._isIncluded=!1;let t=arguments[0];this._factory=t};class us extends Dn{constructor(){super(),us.constructor_.apply(this,arguments)}static findLabeledEdgeRings(t){for(var e=new C,i=1,r=t.iterator();r.hasNext();){var n=r.next();if(!(n.isMarked()||n.getLabel()>=0)){e.add(n);var s=hs.findDirEdgesInRing(n);us.label(s,i),i++}}return e}static getDegreeNonDeleted(t){for(var e=0,i=t.getOutEdges().getEdges().iterator();i.hasNext();)i.next().isMarked()||e++;return e}static deleteAllEdges(t){for(var e=t.getOutEdges().getEdges().iterator();e.hasNext();){var i=e.next();i.setMarked(!0);var r=i.getSym();null!==r&&r.setMarked(!0)}}static label(t,e){for(var i=t.iterator();i.hasNext();)i.next().setLabel(e)}static computeNextCWEdges(t){for(var e=null,i=null,r=t.getOutEdges().getEdges().iterator();r.hasNext();){var n=r.next();n.isMarked()||(null===e&&(e=n),null!==i&&i.getSym().setNext(n),i=n)}null!==i&&i.getSym().setNext(e)}static computeNextCCWEdges(t,e){for(var i=null,r=null,n=t.getOutEdges().getEdges(),s=n.size()-1;s>=0;s--){var o=n.get(s),a=o.getSym(),h=null;o.getLabel()===e&&(h=o);var l=null;a.getLabel()===e&&(l=a),null===h&&null===l||(null!==l&&(r=l),null!==h&&(null!==r&&(r.setNext(h),r=null),null===i&&(i=h)))}null!==r&&(m.isTrue(null!==i),r.setNext(i))}static getDegree(t,e){for(var i=0,r=t.getOutEdges().getEdges().iterator();r.hasNext();)r.next().getLabel()===e&&i++;return i}static findIntersectionNodes(t,e){var i=t,r=null;do{var n=i.getFromNode();us.getDegree(n,e)>1&&(null===r&&(r=new C),r.add(n)),i=i.getNext(),m.isTrue(null!==i,"found null DE in ring"),m.isTrue(i===t||!i.isInRing(),"found DE already in ring")}while(i!==t);return r}findEdgeRing(t){var e=new hs(this._factory);return e.build(t),e}computeDepthParity(){if(0===arguments.length)for(;;)return null}computeNextCWEdges(){for(var t=this.nodeIterator();t.hasNext();){var e=t.next();us.computeNextCWEdges(e)}}addEdge(t){if(t.isEmpty())return null;var e=$.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return null;var i=e[0],r=e[e.length-1],n=this.getNode(i),s=this.getNode(r),o=new os(n,s,e[1],!0),a=new os(s,n,e[e.length-2],!1),h=new as(t);h.setDirectedEdges(o,a),this.add(h)}deleteCutEdges(){this.computeNextCWEdges(),us.findLabeledEdgeRings(this._dirEdges);for(var t=new C,e=this._dirEdges.iterator();e.hasNext();){var i=e.next();if(!i.isMarked()){var r=i.getSym();if(i.getLabel()===r.getLabel()){i.setMarked(!0),r.setMarked(!0);var n=i.getEdge();t.add(n.getLine())}}}return t}getEdgeRings(){this.computeNextCWEdges(),us.label(this._dirEdges,-1);var t=us.findLabeledEdgeRings(this._dirEdges);this.convertMaximalToMinimalEdgeRings(t);for(var e=new C,i=this._dirEdges.iterator();i.hasNext();){var r=i.next();if(!r.isMarked()&&!r.isInRing()){var n=this.findEdgeRing(r);e.add(n)}}return e}getNode(t){var e=this.findNode(t);return null===e&&(e=new An(t),this.add(e)),e}convertMaximalToMinimalEdgeRings(t){for(var e=t.iterator();e.hasNext();){var i=e.next(),r=i.getLabel(),n=us.findIntersectionNodes(i,r);if(null!==n)for(var s=n.iterator();s.hasNext();){var o=s.next();us.computeNextCCWEdges(o,r)}}}deleteDangles(){for(var t=this.findNodesOfDegree(1),e=new st,i=new Qe,r=t.iterator();r.hasNext();)i.push(r.next());for(;!i.isEmpty();){var n=i.pop();for(us.deleteAllEdges(n),r=n.getOutEdges().getEdges().iterator();r.hasNext();){var s=r.next();s.setMarked(!0);var o=s.getSym();null!==o&&o.setMarked(!0);var a=s.getEdge();e.add(a.getLine());var h=s.getToNode();1===us.getDegreeNonDeleted(h)&&i.push(h)}}return e}getClass(){return us}get interfaces_(){return[]}}us.constructor_=function(){this._factory=null;let t=arguments[0];this._factory=t};class cs{constructor(){cs.constructor_.apply(this,arguments)}static findOuterShells(t){for(var e=t.iterator();e.hasNext();){var i=e.next(),r=i.getOuterHole();null===r||r.isProcessed()||(i.setIncluded(!0),r.setProcessed(!0))}}static extractPolygons(t,e){for(var i=new C,r=t.iterator();r.hasNext();){var n=r.next();(e||n.isIncluded())&&i.add(n.getPolygon())}return i}static assignHolesToShells(t,e){for(var i=t.iterator();i.hasNext();){var r=i.next();cs.assignHoleToShell(r,e)}}static assignHoleToShell(t,e){var i=hs.findEdgeRingContaining(t,e);null!==i&&i.addHole(t)}static findDisjointShells(t){cs.findOuterShells(t);var e=null;do{e=!1;for(var i=t.iterator();i.hasNext();){var r=i.next();r.isIncludedSet()||(r.updateIncluded(),r.isIncludedSet()||(e=!0))}}while(e)}getGeometry(){return null===this._geomFactory&&(this._geomFactory=new oe),this.polygonize(),this._extractOnlyPolygonal?this._geomFactory.buildGeometry(this._polyList):this._geomFactory.createGeometryCollection(oe.toGeometryArray(this._polyList))}getInvalidRingLines(){return this.polygonize(),this._invalidRingLines}findValidRings(t,e,i){for(var r=t.iterator();r.hasNext();){var n=r.next();n.isValid()?e.add(n):i.add(n.getLineString())}}polygonize(){if(null!==this._polyList)return null;if(this._polyList=new C,null===this._graph)return null;this._dangles=this._graph.deleteDangles(),this._cutEdges=this._graph.deleteCutEdges();var t=this._graph.getEdgeRings(),e=new C;this._invalidRingLines=new C,this._isCheckingRingsValid?this.findValidRings(t,e,this._invalidRingLines):e=t,this.findShellsAndHoles(e),cs.assignHolesToShells(this._holeList,this._shellList),Ae.sort(this._shellList,new hs.EnvelopeComparator);var i=!0;this._extractOnlyPolygonal&&(cs.findDisjointShells(this._shellList),i=!1),this._polyList=cs.extractPolygons(this._shellList,i)}getDangles(){return this.polygonize(),this._dangles}getCutEdges(){return this.polygonize(),this._cutEdges}getPolygons(){return this.polygonize(),this._polyList}add(){if(x(arguments[0],w))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.add(e)}else if(arguments[0]instanceof Ft){let t=arguments[0];this._geomFactory=t.getFactory(),null===this._graph&&(this._graph=new us(this._geomFactory)),this._graph.addEdge(t)}else arguments[0]instanceof V&&arguments[0].apply(this._lineStringAdder)}setCheckRingsValid(t){this._isCheckingRingsValid=t}findShellsAndHoles(t){this._holeList=new C,this._shellList=new C;for(var e=t.iterator();e.hasNext();){var i=e.next();i.computeHole(),i.isHole()?this._holeList.add(i):this._shellList.add(i)}}getClass(){return cs}get interfaces_(){return[]}}class ds{constructor(){ds.constructor_.apply(this,arguments)}filter(t){t instanceof Ft&&this.p.add(t)}getClass(){return ds}get interfaces_(){return[H]}}ds.constructor_=function(){this.p=null;let t=arguments[0];this.p=t},cs.LineStringAdder=ds,cs.constructor_=function(){if(this._lineStringAdder=new ds(this),this._graph=null,this._dangles=new C,this._cutEdges=new C,this._invalidRingLines=new C,this._holeList=null,this._shellList=null,this._polyList=null,this._isCheckingRingsValid=!0,this._extractOnlyPolygonal=null,this._geomFactory=null,0===arguments.length)cs.constructor_.call(this,!1);else if(1===arguments.length){let t=arguments[0];this._extractOnlyPolygonal=t}};var ps=Object.freeze({Polygonizer:cs});class gs{constructor(){gs.constructor_.apply(this,arguments)}createEdgeEndForNext(t,e,i,r){var n=i.segmentIndex+1;if(n>=t.getNumPoints()&&null===r)return null;var s=t.getCoordinate(n);null!==r&&r.segmentIndex===i.segmentIndex&&(s=r.coord);var o=new Gi(t,i.coord,s,new Oi(t.getLabel()));e.add(o)}createEdgeEndForPrev(t,e,i,r){var n=i.segmentIndex;if(0===i.dist){if(0===n)return null;n--}var s=t.getCoordinate(n);null!==r&&r.segmentIndex>=n&&(s=r.coord);var o=new Oi(t.getLabel());o.flip();var a=new Gi(t,i.coord,s,o);e.add(a)}computeEdgeEnds(){if(1===arguments.length){let r=arguments[0];for(var t=new C,e=r;e.hasNext();){var i=e.next();this.computeEdgeEnds(i,t)}return t}if(2===arguments.length){let t=arguments[0],e=arguments[1];var r=t.getEdgeIntersectionList();r.addEndpoints();var n=r.iterator(),s=null,o=null;if(!n.hasNext())return null;var a=n.next();do{s=o,o=a,a=null,n.hasNext()&&(a=n.next()),null!==o&&(this.createEdgeEndForPrev(t,e,o,s),this.createEdgeEndForNext(t,e,o,a))}while(null!==o)}}getClass(){return gs}get interfaces_(){return[]}}gs.constructor_=function(){};class fs extends Gi{constructor(){super(),fs.constructor_.apply(this,arguments)}insert(t){this._edgeEnds.add(t)}print(t){t.println("EdgeEndBundle--\x3e Label: "+this._label);for(var e=this.iterator();e.hasNext();)e.next().print(t),t.println()}iterator(){return this._edgeEnds.iterator()}getEdgeEnds(){return this._edgeEnds}computeLabelOn(t,e){for(var i=0,r=!1,n=this.iterator();n.hasNext();)(s=n.next().getLabel().getLocation(t))===_e.BOUNDARY&&i++,s===_e.INTERIOR&&(r=!0);var s=_e.NONE;r&&(s=_e.INTERIOR),i>0&&(s=qi.determineBoundary(e,i)),this._label.setLocation(t,s)}computeLabelSide(t,e){for(var i=this.iterator();i.hasNext();){var r=i.next();if(r.getLabel().isArea()){var n=r.getLabel().getLocation(t,e);if(n===_e.INTERIOR)return this._label.setLocation(t,e,_e.INTERIOR),null;n===_e.EXTERIOR&&this._label.setLocation(t,e,_e.EXTERIOR)}}}getLabel(){return this._label}computeLabelSides(t){this.computeLabelSide(t,wi.LEFT),this.computeLabelSide(t,wi.RIGHT)}updateIM(t){Fi.updateIM(this._label,t)}computeLabel(t){for(var e=!1,i=this.iterator();i.hasNext();)i.next().getLabel().isArea()&&(e=!0);this._label=e?new Oi(_e.NONE,_e.NONE,_e.NONE):new Oi(_e.NONE);for(var r=0;r<2;r++)this.computeLabelOn(r,t),e&&this.computeLabelSides(r)}getClass(){return fs}get interfaces_(){return[]}}fs.constructor_=function(){if(this._edgeEnds=new C,1===arguments.length){let t=arguments[0];fs.constructor_.call(this,null,t)}else if(2===arguments.length){let t=arguments[1];Gi.constructor_.call(this,t.getEdge(),t.getCoordinate(),t.getDirectedCoordinate(),new Oi(t.getLabel())),this.insert(t)}};class _s extends rn{constructor(){super(),_s.constructor_.apply(this,arguments)}updateIM(t){for(var e=this.iterator();e.hasNext();)e.next().updateIM(t)}insert(t){var e=this._edgeMap.get(t);null===e?(e=new fs(t),this.insertEdgeEnd(t,e)):e.insert(t)}getClass(){return _s}get interfaces_(){return[]}}_s.constructor_=function(){};class ms extends Bi{constructor(){super(),ms.constructor_.apply(this,arguments)}updateIMFromEdges(t){this._edges.updateIM(t)}computeIM(t){t.setAtLeastIfValid(this._label.getLocation(0),this._label.getLocation(1),0)}getClass(){return ms}get interfaces_(){return[]}}ms.constructor_=function(){let t=arguments[0],e=arguments[1];Bi.constructor_.call(this,t,e)};class ys extends zi{constructor(){super(),ys.constructor_.apply(this,arguments)}createNode(t){return new ms(t,new _s)}getClass(){return ys}get interfaces_(){return[]}}ys.constructor_=function(){};class vs{constructor(){vs.constructor_.apply(this,arguments)}insertEdgeEnds(t){for(var e=t.iterator();e.hasNext();){var i=e.next();this._nodes.add(i)}}computeProperIntersectionIM(t,e){var i=this._arg[0].getGeometry().getDimension(),r=this._arg[1].getGeometry().getDimension(),n=t.hasProperIntersection(),s=t.hasProperInteriorIntersection();2===i&&2===r?n&&e.setAtLeast("212101212"):2===i&&1===r?(n&&e.setAtLeast("FFF0FFFF2"),s&&e.setAtLeast("1FFFFF1FF")):1===i&&2===r?(n&&e.setAtLeast("F0FFFFFF2"),s&&e.setAtLeast("1F1FFFFFF")):1===i&&1===r&&s&&e.setAtLeast("0FFFFFFFF")}labelIsolatedEdges(t,e){for(var i=this._arg[t].getEdgeIterator();i.hasNext();){var r=i.next();r.isIsolated()&&(this.labelIsolatedEdge(r,e,this._arg[e].getGeometry()),this._isolatedEdges.add(r))}}labelIsolatedEdge(t,e,i){if(i.getDimension()>0){var r=this._ptLocator.locate(t.getCoordinate(),i);t.getLabel().setAllLocations(e,r)}else t.getLabel().setAllLocations(e,_e.EXTERIOR)}computeIM(){var t=new me;if(t.set(_e.EXTERIOR,_e.EXTERIOR,2),!this._arg[0].getGeometry().getEnvelopeInternal().intersects(this._arg[1].getGeometry().getEnvelopeInternal()))return this.computeDisjointIM(t),t;this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1);var e=this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!1);this.computeIntersectionNodes(0),this.computeIntersectionNodes(1),this.copyNodesAndLabels(0),this.copyNodesAndLabels(1),this.labelIsolatedNodes(),this.computeProperIntersectionIM(e,t);var i=new gs,r=i.computeEdgeEnds(this._arg[0].getEdgeIterator());this.insertEdgeEnds(r);var n=i.computeEdgeEnds(this._arg[1].getEdgeIterator());return this.insertEdgeEnds(n),this.labelNodeEdges(),this.labelIsolatedEdges(0,1),this.labelIsolatedEdges(1,0),this.updateIM(t),t}labelNodeEdges(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().computeLabelling(this._arg)}copyNodesAndLabels(t){for(var e=this._arg[t].getNodeIterator();e.hasNext();){var i=e.next();this._nodes.addNode(i.getCoordinate()).setLabel(t,i.getLabel().getLocation(t))}}labelIntersectionNodes(t){for(var e=this._arg[t].getEdgeIterator();e.hasNext();)for(var i=e.next(),r=i.getLabel().getLocation(t),n=i.getEdgeIntersectionList().iterator();n.hasNext();){var s=n.next(),o=this._nodes.find(s.coord);o.getLabel().isNull(t)&&(r===_e.BOUNDARY?o.setLabelBoundary(t):o.setLabel(t,_e.INTERIOR))}}labelIsolatedNode(t,e){var i=this._ptLocator.locate(t.getCoordinate(),this._arg[e].getGeometry());t.getLabel().setAllLocations(e,i)}computeIntersectionNodes(t){for(var e=this._arg[t].getEdgeIterator();e.hasNext();)for(var i=e.next(),r=i.getLabel().getLocation(t),n=i.getEdgeIntersectionList().iterator();n.hasNext();){var s=n.next(),o=this._nodes.addNode(s.coord);r===_e.BOUNDARY?o.setLabelBoundary(t):o.getLabel().isNull(t)&&o.setLabel(t,_e.INTERIOR)}}labelIsolatedNodes(){for(var t=this._nodes.iterator();t.hasNext();){var e=t.next(),i=e.getLabel();m.isTrue(i.getGeometryCount()>0,"node with empty label found"),e.isIsolated()&&(i.isNull(0)?this.labelIsolatedNode(e,0):this.labelIsolatedNode(e,1))}}updateIM(t){for(var e=this._isolatedEdges.iterator();e.hasNext();)e.next().updateIM(t);for(var i=this._nodes.iterator();i.hasNext();){var r=i.next();r.updateIM(t),r.updateIMFromEdges(t)}}computeDisjointIM(t){var e=this._arg[0].getGeometry();e.isEmpty()||(t.set(_e.INTERIOR,_e.EXTERIOR,e.getDimension()),t.set(_e.BOUNDARY,_e.EXTERIOR,e.getBoundaryDimension()));var i=this._arg[1].getGeometry();i.isEmpty()||(t.set(_e.EXTERIOR,_e.INTERIOR,i.getDimension()),t.set(_e.EXTERIOR,_e.BOUNDARY,i.getBoundaryDimension()))}getClass(){return vs}get interfaces_(){return[]}}vs.constructor_=function(){this._li=new ge,this._ptLocator=new oi,this._arg=null,this._nodes=new ki(new ys),this._im=null,this._isolatedEdges=new C,this._invalidPoint=null;let t=arguments[0];this._arg=t};class xs{constructor(){xs.constructor_.apply(this,arguments)}static contains(t,e){return new xs(t).contains(e)}isContainedInBoundary(t){if(t instanceof Yt)return!1;if(t instanceof kt)return this.isPointContainedInBoundary(t);if(t instanceof Ft)return this.isLineStringContainedInBoundary(t);for(var e=0;e<t.getNumGeometries();e++){var i=t.getGeometryN(e);if(!this.isContainedInBoundary(i))return!1}return!0}isLineSegmentContainedInBoundary(t,e){if(t.equals(e))return this.isPointContainedInBoundary(t);if(t.x===e.x){if(t.x===this._rectEnv.getMinX()||t.x===this._rectEnv.getMaxX())return!0}else if(t.y===e.y&&(t.y===this._rectEnv.getMinY()||t.y===this._rectEnv.getMaxY()))return!0;return!1}isLineStringContainedInBoundary(t){for(var e=t.getCoordinateSequence(),i=new y,r=new y,n=0;n<e.size()-1;n++)if(e.getCoordinate(n,i),e.getCoordinate(n+1,r),!this.isLineSegmentContainedInBoundary(i,r))return!1;return!0}isPointContainedInBoundary(){if(arguments[0]instanceof kt){let t=arguments[0];return this.isPointContainedInBoundary(t.getCoordinate())}if(arguments[0]instanceof y){let t=arguments[0];return t.x===this._rectEnv.getMinX()||t.x===this._rectEnv.getMaxX()||t.y===this._rectEnv.getMinY()||t.y===this._rectEnv.getMaxY()}}contains(t){return!!this._rectEnv.contains(t.getEnvelopeInternal())&&!this.isContainedInBoundary(t)}getClass(){return xs}get interfaces_(){return[]}}xs.constructor_=function(){this._rectEnv=null;let t=arguments[0];this._rectEnv=t.getEnvelopeInternal()};class Es{constructor(){Es.constructor_.apply(this,arguments)}intersects(t,e){var i=new P(t,e);if(!this._rectEnv.intersects(i))return!1;if(this._rectEnv.intersects(t))return!0;if(this._rectEnv.intersects(e))return!0;if(t.compareTo(e)>0){var r=t;t=e,e=r}var n=!1;return e.y>t.y&&(n=!0),n?this._li.computeIntersection(t,e,this._diagDown0,this._diagDown1):this._li.computeIntersection(t,e,this._diagUp0,this._diagUp1),!!this._li.hasIntersection()}getClass(){return Es}get interfaces_(){return[]}}Es.constructor_=function(){this._li=new ge,this._rectEnv=null,this._diagUp0=null,this._diagUp1=null,this._diagDown0=null,this._diagDown1=null;let t=arguments[0];this._rectEnv=t,this._diagUp0=new y(t.getMinX(),t.getMinY()),this._diagUp1=new y(t.getMaxX(),t.getMaxY()),this._diagDown0=new y(t.getMinX(),t.getMaxY()),this._diagDown1=new y(t.getMaxX(),t.getMinY())};class ws{constructor(){ws.constructor_.apply(this,arguments)}applyTo(t){for(var e=0;e<t.getNumGeometries()&&!this._isDone;e++){var i=t.getGeometryN(e);if(i instanceof bt)this.applyTo(i);else if(this.visit(i),this.isDone())return this._isDone=!0,null}}getClass(){return ws}get interfaces_(){return[]}}ws.constructor_=function(){this._isDone=!1};class bs{constructor(){bs.constructor_.apply(this,arguments)}static intersects(t,e){return new bs(t).intersects(e)}intersects(t){if(!this._rectEnv.intersects(t.getEnvelopeInternal()))return!1;var e=new Is(this._rectEnv);if(e.applyTo(t),e.intersects())return!0;var i=new Ts(this._rectangle);if(i.applyTo(t),i.containsPoint())return!0;var r=new Ss(this._rectangle);return r.applyTo(t),!!r.intersects()}getClass(){return bs}get interfaces_(){return[]}}bs.constructor_=function(){this._rectangle=null,this._rectEnv=null;let t=arguments[0];this._rectangle=t,this._rectEnv=t.getEnvelopeInternal()};class Is extends ws{constructor(){super(),Is.constructor_.apply(this,arguments)}isDone(){return!0===this._intersects}visit(t){var e=t.getEnvelopeInternal();return this._rectEnv.intersects(e)?this._rectEnv.contains(e)?(this._intersects=!0,null):e.getMinX()>=this._rectEnv.getMinX()&&e.getMaxX()<=this._rectEnv.getMaxX()?(this._intersects=!0,null):e.getMinY()>=this._rectEnv.getMinY()&&e.getMaxY()<=this._rectEnv.getMaxY()?(this._intersects=!0,null):void 0:null}intersects(){return this._intersects}getClass(){return Is}get interfaces_(){return[]}}Is.constructor_=function(){this._rectEnv=null,this._intersects=!1;let t=arguments[0];this._rectEnv=t};class Ts extends ws{constructor(){super(),Ts.constructor_.apply(this,arguments)}isDone(){return!0===this._containsPoint}visit(t){if(!(t instanceof Yt))return null;var e=t.getEnvelopeInternal();if(!this._rectEnv.intersects(e))return null;for(var i=new y,r=0;r<4;r++)if(this._rectSeq.getCoordinate(r,i),e.contains(i)&&Xe.containsPointInPolygon(i,t))return this._containsPoint=!0,null}containsPoint(){return this._containsPoint}getClass(){return Ts}get interfaces_(){return[]}}Ts.constructor_=function(){this._rectSeq=null,this._rectEnv=null,this._containsPoint=!1;let t=arguments[0];this._rectSeq=t.getExteriorRing().getCoordinateSequence(),this._rectEnv=t.getEnvelopeInternal()};class Ss extends ws{constructor(){super(),Ss.constructor_.apply(this,arguments)}intersects(){return this._hasIntersection}isDone(){return!0===this._hasIntersection}visit(t){var e=t.getEnvelopeInternal();if(!this._rectEnv.intersects(e))return null;var i=De.getLines(t);this.checkIntersectionWithLineStrings(i)}checkIntersectionWithLineStrings(t){for(var e=t.iterator();e.hasNext();){var i=e.next();if(this.checkIntersectionWithSegments(i),this._hasIntersection)return null}}checkIntersectionWithSegments(t){for(var e=t.getCoordinateSequence(),i=1;i<e.size();i++)if(e.getCoordinate(i-1,this._p0),e.getCoordinate(i,this._p1),this._rectIntersector.intersects(this._p0,this._p1))return this._hasIntersection=!0,null}getClass(){return Ss}get interfaces_(){return[]}}Ss.constructor_=function(){this._rectEnv=null,this._rectIntersector=null,this._hasIntersection=!1,this._p0=new y,this._p1=new y;let t=arguments[0];this._rectEnv=t.getEnvelopeInternal(),this._rectIntersector=new Es(this._rectEnv)};class Cs extends rs{constructor(){super(),Cs.constructor_.apply(this,arguments)}static covers(t,e){return!(2===e.getDimension()&&t.getDimension()<2)&&!(1===e.getDimension()&&t.getDimension()<1&&e.getLength()>0)&&!!t.getEnvelopeInternal().covers(e.getEnvelopeInternal())&&(!!t.isRectangle()||new Cs(t,e).getIntersectionMatrix().isCovers())}static intersects(t,e){if(!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal()))return!1;if(t.isRectangle())return bs.intersects(t,e);if(e.isRectangle())return bs.intersects(e,t);if(t.isGeometryCollection()||e.isGeometryCollection()){for(var i=0;i<t.getNumGeometries();i++)for(var r=0;r<e.getNumGeometries();r++)if(t.getGeometryN(i).intersects(e.getGeometryN(r)))return!0;return!1}return new Cs(t,e).getIntersectionMatrix().isIntersects()}static touches(t,e){return!!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal())&&new Cs(t,e).getIntersectionMatrix().isTouches(t.getDimension(),e.getDimension())}static relate(){if(2===arguments.length){let t=arguments[0],e=arguments[1];return new Cs(t,e).getIntersectionMatrix()}if(3===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2];return new Cs(t,e,i).getIntersectionMatrix()}}static overlaps(t,e){return!!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal())&&new Cs(t,e).getIntersectionMatrix().isOverlaps(t.getDimension(),e.getDimension())}static crosses(t,e){return!!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal())&&new Cs(t,e).getIntersectionMatrix().isCrosses(t.getDimension(),e.getDimension())}static contains(t,e){return!(2===e.getDimension()&&t.getDimension()<2)&&!(1===e.getDimension()&&t.getDimension()<1&&e.getLength()>0)&&!!t.getEnvelopeInternal().contains(e.getEnvelopeInternal())&&(t.isRectangle()?xs.contains(t,e):new Cs(t,e).getIntersectionMatrix().isContains())}getIntersectionMatrix(){return this._relate.computeIM()}getClass(){return Cs}get interfaces_(){return[]}}Cs.constructor_=function(){if(this._relate=null,2===arguments.length){let t=arguments[0],e=arguments[1];rs.constructor_.call(this,t,e),this._relate=new vs(this._arg)}else if(3===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2];rs.constructor_.call(this,t,e,i),this._relate=new vs(this._arg)}};var Ns=Object.freeze({RelateOp:Cs});class Os{constructor(){Os.constructor_.apply(this,arguments)}static combine(){if(1===arguments.length){let t=arguments[0];return new Os(t).combine()}if(2===arguments.length){let t=arguments[0],e=arguments[1];return new Os(Os.createList(t,e)).combine()}if(3===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2];return new Os(Os.createList(t,e,i)).combine()}}static extractFactory(t){return t.isEmpty()?null:t.iterator().next().getFactory()}static createList(){if(2===arguments.length){let e=arguments[0],i=arguments[1];return(t=new C).add(e),t.add(i),t}if(3===arguments.length){let e=arguments[0],i=arguments[1],r=arguments[2];var t;return(t=new C).add(e),t.add(i),t.add(r),t}}extractElements(t,e){if(null===t)return null;for(var i=0;i<t.getNumGeometries();i++){var r=t.getGeometryN(i);this._skipEmpty&&r.isEmpty()||e.add(r)}}combine(){for(var t=new C,e=this._inputGeoms.iterator();e.hasNext();){var i=e.next();this.extractElements(i,t)}return 0===t.size()?null!==this._geomFactory?this._geomFactory.createGeometryCollection():null:this._geomFactory.buildGeometry(t)}getClass(){return Os}get interfaces_(){return[]}}Os.constructor_=function(){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null;let t=arguments[0];this._geomFactory=Os.extractFactory(t),this._inputGeoms=t};class Ps{constructor(){Ps.constructor_.apply(this,arguments)}static union(t,e){return new Ps(t,e).union()}union(){for(var t=new oi,e=new _t,i=0;i<this._pointGeom.getNumGeometries();i++){var r=this._pointGeom.getGeometryN(i).getCoordinate();t.locate(r,this._otherGeom)===_e.EXTERIOR&&e.add(r)}if(0===e.size())return this._otherGeom;var n=null,s=$.toCoordinateArray(e);return n=1===s.length?this._geomFact.createPoint(s[0]):this._geomFact.createMultiPointFromCoords(s),Os.combine(n,this._otherGeom)}getClass(){return Ps}get interfaces_(){return[]}}Ps.constructor_=function(){this._pointGeom=null,this._otherGeom=null,this._geomFact=null;let t=arguments[0],e=arguments[1];this._pointGeom=t,this._otherGeom=e,this._geomFact=e.getFactory()};class Ls{constructor(){Ls.constructor_.apply(this,arguments)}static isOfType(t,e){return t.getGeometryType()===e||e===V.TYPENAME_LINESTRING&&t.getGeometryType()===V.TYPENAME_LINEARRING}static extract(){if(2===arguments.length){let t=arguments[0],e=arguments[1];return Ls.extract(t,e,new C)}if(3===arguments.length){if(x(arguments[2],I)&&arguments[0]instanceof V&&"string"==typeof arguments[1]){let t=arguments[0],e=arguments[1],i=arguments[2];return t.getGeometryType()===e?i.add(t):t instanceof bt&&t.apply(new Ls(e,i)),i}if(x(arguments[2],I)&&arguments[0]instanceof V&&arguments[1]instanceof Class){let t=arguments[0],e=arguments[1],i=arguments[2];return Ls.extract(t,Ls.toGeometryType(e),i)}}}filter(t){(null===this._geometryType||Ls.isOfType(t,this._geometryType))&&this._comps.add(t)}getClass(){return Ls}get interfaces_(){return[Et]}}Ls.constructor_=function(){this._geometryType=null,this._comps=null;let t=arguments[0],e=arguments[1];this._geometryType=t,this._comps=e};class As{constructor(){As.constructor_.apply(this,arguments)}static restrictToPolygons(t){if(x(t,Ut))return t;var e=xn.getPolygons(t);return 1===e.size()?e.get(0):t.getFactory().createMultiPolygon(oe.toPolygonArray(e))}static getGeometry(t,e){return e>=t.size()?null:t.get(e)}static union(t){return new As(t).union()}reduceToGeometries(t){for(var e=new C,i=t.iterator();i.hasNext();){var r=i.next(),n=null;x(r,I)?n=this.unionTree(r):r instanceof V&&(n=r),e.add(n)}return e}extractByEnvelope(t,e,i){for(var r=new C,n=0;n<e.getNumGeometries();n++){var s=e.getGeometryN(n);s.getEnvelopeInternal().intersects(t)?r.add(s):i.add(s)}return this._geomFactory.buildGeometry(r)}unionOptimized(t,e){var i=t.getEnvelopeInternal(),r=e.getEnvelopeInternal();if(!i.intersects(r))return Os.combine(t,e);if(t.getNumGeometries()<=1&&e.getNumGeometries()<=1)return this.unionActual(t,e);var n=i.intersection(r);return this.unionUsingEnvelopeIntersection(t,e,n)}union(){if(null===this._inputPolys)throw new IllegalStateException("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var t=new pr(As.STRTREE_NODE_CAPACITY),e=this._inputPolys.iterator();e.hasNext();){var i=e.next();t.insert(i.getEnvelopeInternal(),i)}this._inputPolys=null;var r=t.itemsTree();return this.unionTree(r)}binaryUnion(){if(1===arguments.length){let t=arguments[0];return this.binaryUnion(t,0,t.size())}if(3===arguments.length){let r=arguments[0],n=arguments[1],s=arguments[2];if(s-n<=1){var t=As.getGeometry(r,n);return this.unionSafe(t,null)}if(s-n==2)return this.unionSafe(As.getGeometry(r,n),As.getGeometry(r,n+1));var e=Math.trunc((s+n)/2),i=(t=this.binaryUnion(r,n,e),this.binaryUnion(r,e,s));return this.unionSafe(t,i)}}repeatedUnion(t){for(var e=null,i=t.iterator();i.hasNext();){var r=i.next();e=null===e?r.copy():e.union(r)}return e}unionSafe(t,e){return null===t&&null===e?null:null===t?e.copy():null===e?t.copy():this.unionOptimized(t,e)}unionActual(t,e){return As.restrictToPolygons(t.union(e))}unionTree(t){var e=this.reduceToGeometries(t);return this.binaryUnion(e)}unionUsingEnvelopeIntersection(t,e,i){var r=new C,n=this.extractByEnvelope(i,t,r),s=this.extractByEnvelope(i,e,r),o=this.unionActual(n,s);return r.add(o),Os.combine(r)}bufferUnion(){if(1===arguments.length){let t=arguments[0];return t.get(0).getFactory().buildGeometry(t).buffer(0)}if(2===arguments.length){let t=arguments[0],e=arguments[1];return t.getFactory().createGeometryCollection([t,e]).buffer(0)}}getClass(){return As}get interfaces_(){return[]}}As.constructor_=function(){this._inputPolys=null,this._geomFactory=null;let t=arguments[0];this._inputPolys=t,null===this._inputPolys&&(this._inputPolys=new C)},As.STRTREE_NODE_CAPACITY=4;class Rs{constructor(){Rs.constructor_.apply(this,arguments)}static union(){if(1===arguments.length){if(x(arguments[0],w)){let t=arguments[0];return new Rs(t).union()}if(arguments[0]instanceof V){let t=arguments[0];return new Rs(t).union()}}else if(2===arguments.length){let t=arguments[0],e=arguments[1];return new Rs(t,e).union()}}unionNoOpt(t){var e=this._geomFact.createPoint();return is.overlayOp(t,e,ns.UNION)}unionWithNull(t,e){return null===t&&null===e?null:null===e?t:null===t?e:t.union(e)}extract(){if(x(arguments[0],w))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.extract(e)}else if(arguments[0]instanceof V){let t=arguments[0];null===this._geomFact&&(this._geomFact=t.getFactory()),Ls.extract(t,V.TYPENAME_POLYGON,this._polygons),Ls.extract(t,V.TYPENAME_LINESTRING,this._lines),Ls.extract(t,V.TYPENAME_POINT,this._points)}}union(){if(null===this._geomFact)return null;var t=null;if(this._points.size()>0){var e=this._geomFact.buildGeometry(this._points);t=this.unionNoOpt(e)}var i=null;if(this._lines.size()>0){var r=this._geomFact.buildGeometry(this._lines);i=this.unionNoOpt(r)}var n=null;this._polygons.size()>0&&(n=As.union(this._polygons));var s=this.unionWithNull(i,n),o=null;return null===(o=null===t?s:null===s?t:Ps.union(t,s))?this._geomFact.createGeometryCollection():o}getClass(){return Rs}get interfaces_(){return[]}}Rs.constructor_=function(){if(this._polygons=new C,this._lines=new C,this._points=new C,this._geomFact=null,1===arguments.length){if(x(arguments[0],w)){let t=arguments[0];this.extract(t)}else if(arguments[0]instanceof V){let t=arguments[0];this.extract(t)}}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this._geomFact=e,this.extract(t)}};var Ms=Object.freeze({UnaryUnionOp:Rs});class Ds{constructor(){Ds.constructor_.apply(this,arguments)}static findDifferentPoint(t,e){for(var i=0;i<t.length;i++)if(!t[i].equals(e))return t[i];return null}visitInteriorRing(t,e){var i=t.getCoordinates(),r=i[0],n=Ds.findDifferentPoint(i,r),s=e.findEdgeInSameDirection(r,n),o=e.findEdgeEnd(s),a=null;o.getLabel().getLocation(0,wi.RIGHT)===_e.INTERIOR?a=o:o.getSym().getLabel().getLocation(0,wi.RIGHT)===_e.INTERIOR&&(a=o.getSym()),m.isTrue(null!==a,"unable to find dirEdge with Interior on RHS"),this.visitLinkedDirectedEdges(a)}visitShellInteriors(t,e){if(t instanceof Yt){var i=t;this.visitInteriorRing(i.getExteriorRing(),e)}if(t instanceof qt)for(var r=t,n=0;n<r.getNumGeometries();n++)i=r.getGeometryN(n),this.visitInteriorRing(i.getExteriorRing(),e)}getCoordinate(){return this._disconnectedRingcoord}setInteriorEdgesInResult(t){for(var e=t.getEdgeEnds().iterator();e.hasNext();){var i=e.next();i.getLabel().getLocation(0,wi.RIGHT)===_e.INTERIOR&&i.setInResult(!0)}}visitLinkedDirectedEdges(t){var e=t,i=t;do{m.isTrue(null!==i,"found null Directed Edge"),i.setVisited(!0),i=i.getNext()}while(i!==e)}buildEdgeRings(t){for(var e=new C,i=t.iterator();i.hasNext();){var r=i.next();if(r.isInResult()&&null===r.getEdgeRing()){var n=new jr(r,this._geometryFactory);n.linkDirectedEdgesForMinimalEdgeRings();var s=n.buildMinimalRings();e.addAll(s)}}return e}hasUnvisitedShellEdge(t){for(var e=0;e<t.size();e++){var i=t.get(e);if(!i.isHole()){var r=i.getEdges(),n=r.get(0);if(n.getLabel().getLocation(0,wi.RIGHT)===_e.INTERIOR)for(var s=0;s<r.size();s++)if(!(n=r.get(s)).isVisited())return this._disconnectedRingcoord=n.getCoordinate(),!0}}return!1}isInteriorsConnected(){var t=new C;this._geomGraph.computeSplitEdges(t);var e=new Xi(new sn);e.addEdges(t),this.setInteriorEdgesInResult(e),e.linkResultDirectedEdges();var i=this.buildEdgeRings(e.getEdgeEnds());return this.visitShellInteriors(this._geomGraph.getGeometry(),e),!this.hasUnvisitedShellEdge(i)}getClass(){return Ds}get interfaces_(){return[]}}Ds.constructor_=function(){this._geometryFactory=new oe,this._geomGraph=null,this._disconnectedRingcoord=null;let t=arguments[0];this._geomGraph=t};class Fs{constructor(){Fs.constructor_.apply(this,arguments)}insertEdgeEnds(t){for(var e=t.iterator();e.hasNext();){var i=e.next();this._nodes.add(i)}}getNodeIterator(){return this._nodes.iterator()}copyNodesAndLabels(t,e){for(var i=t.getNodeIterator();i.hasNext();){var r=i.next();this._nodes.addNode(r.getCoordinate()).setLabel(e,r.getLabel().getLocation(e))}}build(t){this.computeIntersectionNodes(t,0),this.copyNodesAndLabels(t,0);var e=(new gs).computeEdgeEnds(t.getEdgeIterator());this.insertEdgeEnds(e)}computeIntersectionNodes(t,e){for(var i=t.getEdgeIterator();i.hasNext();)for(var r=i.next(),n=r.getLabel().getLocation(e),s=r.getEdgeIntersectionList().iterator();s.hasNext();){var o=s.next(),a=this._nodes.addNode(o.coord);n===_e.BOUNDARY?a.setLabelBoundary(e):a.getLabel().isNull(e)&&a.setLabel(e,_e.INTERIOR)}}getClass(){return Fs}get interfaces_(){return[]}}Fs.constructor_=function(){this._nodes=new ki(new ys)};class Bs{constructor(){Bs.constructor_.apply(this,arguments)}isNodeEdgeAreaLabelsConsistent(){for(var t=this._nodeGraph.getNodeIterator();t.hasNext();){var e=t.next();if(!e.getEdges().isAreaLabelsConsistent(this._geomGraph))return this._invalidPoint=e.getCoordinate().copy(),!1}return!0}getInvalidPoint(){return this._invalidPoint}hasDuplicateRings(){for(var t=this._nodeGraph.getNodeIterator();t.hasNext();)for(var e=t.next().getEdges().iterator();e.hasNext();){var i=e.next();if(i.getEdgeEnds().size()>1)return this._invalidPoint=i.getEdge().getCoordinate(0),!0}return!1}isNodeConsistentArea(){var t=this._geomGraph.computeSelfNodes(this._li,!0,!0);return t.hasProperIntersection()?(this._invalidPoint=t.getProperIntersectionPoint(),!1):(this._nodeGraph.build(this._geomGraph),this.isNodeEdgeAreaLabelsConsistent())}getClass(){return Bs}get interfaces_(){return[]}}Bs.constructor_=function(){this._li=new ge,this._geomGraph=null,this._nodeGraph=new Fs,this._invalidPoint=null;let t=arguments[0];this._geomGraph=t};class ks{constructor(){ks.constructor_.apply(this,arguments)}buildIndex(){this._index=new pr;for(var t=0;t<this._rings.size();t++){var e=this._rings.get(t),i=e.getEnvelopeInternal();this._index.insert(i,e)}}getNestedPoint(){return this._nestedPt}isNonNested(){this.buildIndex();for(var t=0;t<this._rings.size();t++)for(var e=this._rings.get(t),i=e.getCoordinates(),r=this._index.query(e.getEnvelopeInternal()),n=0;n<r.size();n++){var s=r.get(n),o=s.getCoordinates();if(e!==s&&e.getEnvelopeInternal().intersects(s.getEnvelopeInternal())){var a=Us.findPtNotNode(i,s,this._graph);if(null!==a&&Ye.isInRing(a,o))return this._nestedPt=a,!1}}return!0}add(t){this._rings.add(t),this._totalEnv.expandToInclude(t.getEnvelopeInternal())}getClass(){return ks}get interfaces_(){return[]}}ks.constructor_=function(){this._graph=null,this._rings=new C,this._totalEnv=new P,this._index=null,this._nestedPt=null;let t=arguments[0];this._graph=t};class Gs{constructor(){Gs.constructor_.apply(this,arguments)}getErrorType(){return this._errorType}getMessage(){return Gs.errMsg[this._errorType]}getCoordinate(){return this._pt}toString(){var t="";return null!==this._pt&&(t=" at or near point "+this._pt),this.getMessage()+t}getClass(){return Gs}get interfaces_(){return[]}}Gs.constructor_=function(){if(this._errorType=null,this._pt=null,1===arguments.length){let t=arguments[0];Gs.constructor_.call(this,t,null)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this._errorType=t,null!==e&&(this._pt=e.copy())}},Gs.ERROR=0,Gs.REPEATED_POINT=1,Gs.HOLE_OUTSIDE_SHELL=2,Gs.NESTED_HOLES=3,Gs.DISCONNECTED_INTERIOR=4,Gs.SELF_INTERSECTION=5,Gs.RING_SELF_INTERSECTION=6,Gs.NESTED_SHELLS=7,Gs.DUPLICATE_RINGS=8,Gs.TOO_FEW_POINTS=9,Gs.INVALID_COORDINATE=10,Gs.RING_NOT_CLOSED=11,Gs.errMsg=["Topology Validation Error","Repeated Point","Hole lies outside shell","Holes are nested","Interior is disconnected","Self-intersection","Ring Self-intersection","Nested shells","Duplicate Rings","Too few distinct points in geometry component","Invalid Coordinate","Ring is not closed"];class Us{constructor(){Us.constructor_.apply(this,arguments)}static findPtNotNode(t,e,i){for(var r=i.findEdge(e).getEdgeIntersectionList(),n=0;n<t.length;n++){var s=t[n];if(!r.isIntersection(s))return s}return null}static isValid(){if(arguments[0]instanceof V){let t=arguments[0];return new Us(t).isValid()}if(arguments[0]instanceof y){let t=arguments[0];return!(n.isNaN(t.x)||n.isInfinite(t.x)||n.isNaN(t.y)||n.isInfinite(t.y))}}checkInvalidCoordinates(){if(arguments[0]instanceof Array){let e=arguments[0];for(var t=0;t<e.length;t++)if(!Us.isValid(e[t]))return this._validErr=new Gs(Gs.INVALID_COORDINATE,e[t]),null}else if(arguments[0]instanceof Yt){let e=arguments[0];if(this.checkInvalidCoordinates(e.getExteriorRing().getCoordinates()),null!==this._validErr)return null;for(t=0;t<e.getNumInteriorRing();t++)if(this.checkInvalidCoordinates(e.getInteriorRingN(t).getCoordinates()),null!==this._validErr)return null}}checkHolesNotNested(t,e){for(var i=new ks(e),r=0;r<t.getNumInteriorRing();r++){var n=t.getInteriorRingN(r);i.add(n)}i.isNonNested()||(this._validErr=new Gs(Gs.NESTED_HOLES,i.getNestedPoint()))}checkConsistentArea(t){var e=new Bs(t);if(!e.isNodeConsistentArea())return this._validErr=new Gs(Gs.SELF_INTERSECTION,e.getInvalidPoint()),null;e.hasDuplicateRings()&&(this._validErr=new Gs(Gs.DUPLICATE_RINGS,e.getInvalidPoint()))}isValid(){return this.checkValid(this._parentGeometry),null===this._validErr}checkShellInsideHole(t,e,i){var r=t.getCoordinates(),n=e.getCoordinates(),s=Us.findPtNotNode(r,e,i);if(null!==s&&!Ye.isInRing(s,n))return s;var o=Us.findPtNotNode(n,t,i);return null!==o?Ye.isInRing(o,r)?o:null:(m.shouldNeverReachHere("points in shell and hole appear to be equal"),null)}checkNoSelfIntersectingRings(t){for(var e=t.getEdgeIterator();e.hasNext();){var i=e.next();if(this.checkNoSelfIntersectingRing(i.getEdgeIntersectionList()),null!==this._validErr)return null}}checkConnectedInteriors(t){var e=new Ds(t);e.isInteriorsConnected()||(this._validErr=new Gs(Gs.DISCONNECTED_INTERIOR,e.getCoordinate()))}checkNoSelfIntersectingRing(t){for(var e=new _t,i=!0,r=t.iterator();r.hasNext();){var n=r.next();if(i)i=!1;else{if(e.contains(n.coord))return this._validErr=new Gs(Gs.RING_SELF_INTERSECTION,n.coord),null;e.add(n.coord)}}}checkHolesInShell(t,e){for(var i=t.getExteriorRing(),r=new ke(i),n=0;n<t.getNumInteriorRing();n++){var s=t.getInteriorRingN(n),o=Us.findPtNotNode(s.getCoordinates(),i,e);if(null===o)return null;if(_e.EXTERIOR===r.locate(o))return this._validErr=new Gs(Gs.HOLE_OUTSIDE_SHELL,o),null}}checkTooFewPoints(t){if(t.hasTooFewPoints())return this._validErr=new Gs(Gs.TOO_FEW_POINTS,t.getInvalidPoint()),null}getValidationError(){return this.checkValid(this._parentGeometry),this._validErr}checkValid(){if(arguments[0]instanceof kt){let t=arguments[0];this.checkInvalidCoordinates(t.getCoordinates())}else if(arguments[0]instanceof zt){let t=arguments[0];this.checkInvalidCoordinates(t.getCoordinates())}else if(arguments[0]instanceof Xt){let i=arguments[0];if(this.checkInvalidCoordinates(i.getCoordinates()),null!==this._validErr)return null;if(this.checkClosedRing(i),null!==this._validErr)return null;var t=new qi(0,i);if(this.checkTooFewPoints(t),null!==this._validErr)return null;var e=new ge;t.computeSelfNodes(e,!0,!0),this.checkNoSelfIntersectingRings(t)}else if(arguments[0]instanceof Ft){let e=arguments[0];if(this.checkInvalidCoordinates(e.getCoordinates()),null!==this._validErr)return null;t=new qi(0,e),this.checkTooFewPoints(t)}else if(arguments[0]instanceof Yt){let e=arguments[0];if(this.checkInvalidCoordinates(e),null!==this._validErr)return null;if(this.checkClosedRings(e),null!==this._validErr)return null;if(t=new qi(0,e),this.checkTooFewPoints(t),null!==this._validErr)return null;if(this.checkConsistentArea(t),null!==this._validErr)return null;if(!this._isSelfTouchingRingFormingHoleValid&&(this.checkNoSelfIntersectingRings(t),null!==this._validErr))return null;if(this.checkHolesInShell(e,t),null!==this._validErr)return null;if(this.checkHolesNotNested(e,t),null!==this._validErr)return null;this.checkConnectedInteriors(t)}else if(arguments[0]instanceof qt){let e=arguments[0];for(var i=0;i<e.getNumGeometries();i++){var r=e.getGeometryN(i);if(this.checkInvalidCoordinates(r),null!==this._validErr)return null;if(this.checkClosedRings(r),null!==this._validErr)return null}if(t=new qi(0,e),this.checkTooFewPoints(t),null!==this._validErr)return null;if(this.checkConsistentArea(t),null!==this._validErr)return null;if(!this._isSelfTouchingRingFormingHoleValid&&(this.checkNoSelfIntersectingRings(t),null!==this._validErr))return null;for(i=0;i<e.getNumGeometries();i++)if(r=e.getGeometryN(i),this.checkHolesInShell(r,t),null!==this._validErr)return null;for(i=0;i<e.getNumGeometries();i++)if(r=e.getGeometryN(i),this.checkHolesNotNested(r,t),null!==this._validErr)return null;if(this.checkShellsNotNested(e,t),null!==this._validErr)return null;this.checkConnectedInteriors(t)}else if(arguments[0]instanceof bt){let t=arguments[0];for(i=0;i<t.getNumGeometries();i++){var n=t.getGeometryN(i);if(this.checkValid(n),null!==this._validErr)return null}}else if(arguments[0]instanceof V){let t=arguments[0];if(this._validErr=null,t.isEmpty())return null;if(t instanceof kt)this.checkValid(t);else if(t instanceof zt)this.checkValid(t);else if(t instanceof Xt)this.checkValid(t);else if(t instanceof Ft)this.checkValid(t);else if(t instanceof Yt)this.checkValid(t);else if(t instanceof qt)this.checkValid(t);else{if(!(t instanceof bt))throw new UnsupportedOperationException(t.getClass().getName());this.checkValid(t)}}}setSelfTouchingRingFormingHoleValid(t){this._isSelfTouchingRingFormingHoleValid=t}checkShellNotNested(t,e,i){var r=t.getCoordinates(),n=e.getExteriorRing(),s=n.getCoordinates(),o=Us.findPtNotNode(r,n,i);if(null===o)return null;if(!Ye.isInRing(o,s))return null;if(e.getNumInteriorRing()<=0)return this._validErr=new Gs(Gs.NESTED_SHELLS,o),null;for(var a=null,h=0;h<e.getNumInteriorRing();h++){var l=e.getInteriorRingN(h);if(null===(a=this.checkShellInsideHole(t,l,i)))return null}this._validErr=new Gs(Gs.NESTED_SHELLS,a)}checkClosedRings(t){if(this.checkClosedRing(t.getExteriorRing()),null!==this._validErr)return null;for(var e=0;e<t.getNumInteriorRing();e++)if(this.checkClosedRing(t.getInteriorRingN(e)),null!==this._validErr)return null}checkClosedRing(t){if(!t.isClosed()){var e=null;t.getNumPoints()>=1&&(e=t.getCoordinateN(0)),this._validErr=new Gs(Gs.RING_NOT_CLOSED,e)}}checkShellsNotNested(t,e){for(var i=0;i<t.getNumGeometries();i++)for(var r=t.getGeometryN(i).getExteriorRing(),n=0;n<t.getNumGeometries();n++)if(i!==n){var s=t.getGeometryN(n);if(this.checkShellNotNested(r,s,e),null!==this._validErr)return null}}getClass(){return Us}get interfaces_(){return[]}}Us.constructor_=function(){this._parentGeometry=null,this._isSelfTouchingRingFormingHoleValid=!1,this._validErr=null;let t=arguments[0];this._parentGeometry=t};var Ys=Object.freeze({IsValidOp:Us,ConsistentAreaTester:Bs}),zs=Object.freeze({BoundaryOp:Tt,IsSimpleOp:Gr,buffer:vn,distance:Tn,linemerge:kn,overlay:ss,polygonize:ps,relate:Ns,union:Ms,valid:Ys});class Xs extends Ht.CoordinateOperation{constructor(){super(),Xs.constructor_.apply(this,arguments)}edit(){if(2===arguments.length&&arguments[1]instanceof V&&arguments[0]instanceof Array){let o=arguments[0],a=arguments[1];if(0===o.length)return null;for(var t=new Array(o.length).fill(null),e=0;e<o.length;e++){var i=new y(o[e]);this._targetPM.makePrecise(i),t[e]=i}var r=new O(t,!1).toCoordinateArray(),n=0;a instanceof Ft&&(n=2),a instanceof Xt&&(n=4);var s=t;return this._removeCollapsed&&(s=null),r.length<n?s:r}return super.edit.apply(this,arguments)}getClass(){return Xs}get interfaces_(){return[]}}Xs.constructor_=function(){this._targetPM=null,this._removeCollapsed=!0;let t=arguments[0],e=arguments[1];this._targetPM=t,this._removeCollapsed=e};class qs{constructor(){qs.constructor_.apply(this,arguments)}static reduce(t,e){return new qs(e).reduce(t)}static reducePointwise(t,e){var i=new qs(e);return i.setPointwise(!0),i.reduce(t)}fixPolygonalTopology(t){var e=t;this._changePrecisionModel||(e=this.changePM(t,this._targetPM));var i=yn.bufferOp(e,0),r=i;return this._changePrecisionModel||(r=t.getFactory().createGeometry(i)),r}reducePointwise(t){var e=null;if(this._changePrecisionModel){var i=this.createFactory(t.getFactory(),this._targetPM);e=new Ht(i)}else e=new Ht;var r=this._removeCollapsed;return t.getDimension()>=2&&(r=!0),e.edit(t,new Xs(this._targetPM,r))}changePM(t,e){return this.createEditor(t.getFactory(),e).edit(t,new Ht.NoOpGeometryOperation)}setRemoveCollapsedComponents(t){this._removeCollapsed=t}createFactory(t,e){return new oe(e,t.getSRID(),t.getCoordinateSequenceFactory())}setChangePrecisionModel(t){this._changePrecisionModel=t}reduce(t){var e=this.reducePointwise(t);return this._isPointwise?e:x(e,Ut)?Us.isValid(e)?e:this.fixPolygonalTopology(e):e}setPointwise(t){this._isPointwise=t}createEditor(t,e){if(t.getPrecisionModel()===e)return new Ht;var i=this.createFactory(t,e);return new Ht(i)}getClass(){return qs}get interfaces_(){return[]}}qs.constructor_=function(){this._targetPM=null,this._removeCollapsed=!0,this._changePrecisionModel=!1,this._isPointwise=!1;let t=arguments[0];this._targetPM=t};var Hs=Object.freeze({GeometryPrecisionReducer:qs});class Vs{constructor(){Vs.constructor_.apply(this,arguments)}static simplify(t,e){var i=new Vs(t);return i.setDistanceTolerance(e),i.simplify()}simplifySection(t,e){if(t+1===e)return null;this._seg.p0=this._pts[t],this._seg.p1=this._pts[e];for(var i=-1,r=t,n=t+1;n<e;n++){var s=this._seg.distance(this._pts[n]);s>i&&(i=s,r=n)}if(i<=this._distanceTolerance)for(n=t+1;n<e;n++)this._usePt[n]=!1;else this.simplifySection(t,r),this.simplifySection(r,e)}setDistanceTolerance(t){this._distanceTolerance=t}simplify(){this._usePt=new Array(this._pts.length).fill(null);for(var t=0;t<this._pts.length;t++)this._usePt[t]=!0;this.simplifySection(0,this._pts.length-1);var e=new O;for(t=0;t<this._pts.length;t++)this._usePt[t]&&e.add(new y(this._pts[t]));return e.toCoordinateArray()}getClass(){return Vs}get interfaces_(){return[]}}Vs.constructor_=function(){this._pts=null,this._usePt=null,this._distanceTolerance=null,this._seg=new fe;let t=arguments[0];this._pts=t};class js{constructor(){js.constructor_.apply(this,arguments)}static simplify(t,e){var i=new js(t);return i.setDistanceTolerance(e),i.getResultGeometry()}setEnsureValid(t){this._isEnsureValidTopology=t}getResultGeometry(){return this._inputGeom.isEmpty()?this._inputGeom.copy():new Ws(this._isEnsureValidTopology,this._distanceTolerance).transform(this._inputGeom)}setDistanceTolerance(t){if(t<0)throw new i("Tolerance must be non-negative");this._distanceTolerance=t}getClass(){return js}get interfaces_(){return[]}}class Ws extends ui{constructor(){super(),Ws.constructor_.apply(this,arguments)}transformPolygon(t,e){if(t.isEmpty())return null;var i=super.transformPolygon.call(this,t,e);return e instanceof qt?i:this.createValidArea(i)}createValidArea(t){return this._isEnsureValidTopology?t.buffer(0):t}transformCoordinates(t,e){var i=t.toCoordinateArray(),r=null;return r=0===i.length?new Array(0).fill(null):Vs.simplify(i,this._distanceTolerance),this._factory.getCoordinateSequenceFactory().create(r)}transformMultiPolygon(t,e){var i=super.transformMultiPolygon.call(this,t,e);return this.createValidArea(i)}transformLinearRing(t,e){var i=e instanceof Yt,r=super.transformLinearRing.call(this,t,e);return!i||r instanceof Xt?r:null}getClass(){return Ws}get interfaces_(){return[]}}Ws.constructor_=function(){this._isEnsureValidTopology=!0,this._distanceTolerance=null;let t=arguments[0],e=arguments[1];this._isEnsureValidTopology=t,this._distanceTolerance=e},js.DPTransformer=Ws,js.constructor_=function(){this._inputGeom=null,this._distanceTolerance=null,this._isEnsureValidTopology=!0;let t=arguments[0];this._inputGeom=t};class Ks extends fe{constructor(){super(),Ks.constructor_.apply(this,arguments)}getIndex(){return this._index}getParent(){return this._parent}getClass(){return Ks}get interfaces_(){return[]}}Ks.constructor_=function(){if(this._parent=null,this._index=null,2===arguments.length){let t=arguments[0],e=arguments[1];Ks.constructor_.call(this,t,e,null,-1)}else if(4===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2],r=arguments[3];fe.constructor_.call(this,t,e),this._parent=i,this._index=r}};class Zs{constructor(){Zs.constructor_.apply(this,arguments)}static extractCoordinates(t){for(var e=new Array(t.size()+1).fill(null),i=null,r=0;r<t.size();r++)i=t.get(r),e[r]=i.p0;return e[e.length-1]=i.p1,e}addToResult(t){this._resultSegs.add(t)}asLineString(){return this._parentLine.getFactory().createLineString(Zs.extractCoordinates(this._resultSegs))}getResultSize(){var t=this._resultSegs.size();return 0===t?0:t+1}getParent(){return this._parentLine}getSegment(t){return this._segs[t]}getParentCoordinates(){return this._parentLine.getCoordinates()}getMinimumSize(){return this._minimumSize}asLinearRing(){return this._parentLine.getFactory().createLinearRing(Zs.extractCoordinates(this._resultSegs))}getSegments(){return this._segs}init(){var t=this._parentLine.getCoordinates();this._segs=new Array(t.length-1).fill(null);for(var e=0;e<t.length-1;e++){var i=new Ks(t[e],t[e+1],this._parentLine,e);this._segs[e]=i}}getResultCoordinates(){return Zs.extractCoordinates(this._resultSegs)}getClass(){return Zs}get interfaces_(){return[]}}Zs.constructor_=function(){if(this._parentLine=null,this._segs=null,this._resultSegs=new C,this._minimumSize=null,1===arguments.length){let t=arguments[0];Zs.constructor_.call(this,t,2)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this._parentLine=t,this._minimumSize=e,this.init()}};class Js{constructor(){Js.constructor_.apply(this,arguments)}remove(t){this._index.remove(new P(t.p0,t.p1),t)}add(){if(arguments[0]instanceof Zs)for(var t=arguments[0].getSegments(),e=0;e<t.length;e++){var i=t[e];this.add(i)}else if(arguments[0]instanceof fe){let t=arguments[0];this._index.insert(new P(t.p0,t.p1),t)}}query(t){var e=new P(t.p0,t.p1),i=new Qs(t);return this._index.query(e,i),i.getItems()}getClass(){return Js}get interfaces_(){return[]}}Js.constructor_=function(){this._index=new nr};class Qs{constructor(){Qs.constructor_.apply(this,arguments)}visitItem(t){var e=t;P.intersects(e.p0,e.p1,this._querySeg.p0,this._querySeg.p1)&&this._items.add(t)}getItems(){return this._items}getClass(){return Qs}get interfaces_(){return[Ce]}}Qs.constructor_=function(){this._querySeg=null,this._items=new C;let t=arguments[0];this._querySeg=t};class $s{constructor(){$s.constructor_.apply(this,arguments)}static isInLineSection(t,e,i){if(i.getParent()!==t.getParent())return!1;var r=i.getIndex();return r>=e[0]&&r<e[1]}flatten(t,e){var i=this._linePts[t],r=this._linePts[e],n=new fe(i,r);return this.remove(this._line,t,e),this._outputIndex.add(n),n}hasBadIntersection(t,e,i){return!!this.hasBadOutputIntersection(i)||!!this.hasBadInputIntersection(t,e,i)}setDistanceTolerance(t){this._distanceTolerance=t}simplifySection(t,e,i){i+=1;var r=new Array(2).fill(null);if(t+1===e){var n=this._line.getSegment(t);return this._line.addToResult(n),null}var s=!0;this._line.getResultSize()<this._line.getMinimumSize()&&i+1<this._line.getMinimumSize()&&(s=!1);var o=new Array(1).fill(null),a=this.findFurthestPoint(this._linePts,t,e,o);o[0]>this._distanceTolerance&&(s=!1);var h=new fe;if(h.p0=this._linePts[t],h.p1=this._linePts[e],r[0]=t,r[1]=e,this.hasBadIntersection(this._line,r,h)&&(s=!1),s)return n=this.flatten(t,e),this._line.addToResult(n),null;this.simplifySection(t,a,i),this.simplifySection(a,e,i)}hasBadOutputIntersection(t){for(var e=this._outputIndex.query(t).iterator();e.hasNext();){var i=e.next();if(this.hasInteriorIntersection(i,t))return!0}return!1}findFurthestPoint(t,e,i,r){var n=new fe;n.p0=t[e],n.p1=t[i];for(var s=-1,o=e,a=e+1;a<i;a++){var h=t[a],l=n.distance(h);l>s&&(s=l,o=a)}return r[0]=s,o}simplify(t){this._line=t,this._linePts=t.getParentCoordinates(),this.simplifySection(0,this._linePts.length-1,0)}remove(t,e,i){for(var r=e;r<i;r++){var n=t.getSegment(r);this._inputIndex.remove(n)}}hasInteriorIntersection(t,e){return this._li.computeIntersection(t.p0,t.p1,e.p0,e.p1),this._li.isInteriorIntersection()}hasBadInputIntersection(t,e,i){for(var r=this._inputIndex.query(i).iterator();r.hasNext();){var n=r.next();if(this.hasInteriorIntersection(n,i)){if($s.isInLineSection(t,e,n))continue;return!0}}return!1}getClass(){return $s}get interfaces_(){return[]}}$s.constructor_=function(){this._li=new ge,this._inputIndex=new Js,this._outputIndex=new Js,this._line=null,this._linePts=null,this._distanceTolerance=0;let t=arguments[0],e=arguments[1];this._inputIndex=t,this._outputIndex=e};class to{constructor(){to.constructor_.apply(this,arguments)}setDistanceTolerance(t){this._distanceTolerance=t}simplify(t){for(var e=t.iterator();e.hasNext();)this._inputIndex.add(e.next());for(e=t.iterator();e.hasNext();){var i=new $s(this._inputIndex,this._outputIndex);i.setDistanceTolerance(this._distanceTolerance),i.simplify(e.next())}}getClass(){return to}get interfaces_(){return[]}}to.constructor_=function(){this._inputIndex=new Js,this._outputIndex=new Js,this._distanceTolerance=0};class eo{constructor(){eo.constructor_.apply(this,arguments)}static simplify(t,e){var i=new eo(t);return i.setDistanceTolerance(e),i.getResultGeometry()}getResultGeometry(){return this._inputGeom.isEmpty()?this._inputGeom.copy():(this._linestringMap=new re,this._inputGeom.apply(new ro(this)),this._lineSimplifier.simplify(this._linestringMap.values()),new io(this._linestringMap).transform(this._inputGeom))}setDistanceTolerance(t){if(t<0)throw new i("Tolerance must be non-negative");this._lineSimplifier.setDistanceTolerance(t)}getClass(){return eo}get interfaces_(){return[]}}class io extends ui{constructor(){super(),io.constructor_.apply(this,arguments)}transformCoordinates(t,e){if(0===t.size())return null;if(e instanceof Ft){var i=this._linestringMap.get(e);return this.createCoordinateSequence(i.getResultCoordinates())}return super.transformCoordinates.call(this,t,e)}getClass(){return io}get interfaces_(){return[]}}io.constructor_=function(){this._linestringMap=null;let t=arguments[0];this._linestringMap=t};class ro{constructor(){ro.constructor_.apply(this,arguments)}filter(t){if(t instanceof Ft){var e=t;if(e.isEmpty())return null;var i=e.isClosed()?4:2,r=new Zs(e,i);this.tps._linestringMap.put(e,r)}}getClass(){return ro}get interfaces_(){return[H]}}ro.constructor_=function(){this.tps=null;let t=arguments[0];this.tps=t},eo.LineStringTransformer=io,eo.LineStringMapBuilderFilter=ro,eo.constructor_=function(){this._inputGeom=null,this._lineSimplifier=new to,this._linestringMap=null;let t=arguments[0];this._inputGeom=t};class no{constructor(){no.constructor_.apply(this,arguments)}static simplify(t,e){return new no(t,e).simplify()}simplifyVertex(t){for(var e=t,i=e.getArea(),r=null;null!==e;){var n=e.getArea();n<i&&(i=n,r=e),e=e._next}return null!==r&&i<this._tolerance&&r.remove(),t.isLive()?i:-1}simplify(){var t=so.buildLine(this._pts),e=this._tolerance;do{e=this.simplifyVertex(t)}while(e<this._tolerance);var i=t.getCoordinates();return i.length<2?[i[0],new y(i[0])]:i}getClass(){return no}get interfaces_(){return[]}}class so{constructor(){so.constructor_.apply(this,arguments)}static buildLine(t){for(var e=null,i=null,r=0;r<t.length;r++){var n=new so(t[r]);null===e&&(e=n),n.setPrev(i),null!==i&&(i.setNext(n),i.updateArea()),i=n}return e}getCoordinates(){var t=new O,e=this;do{t.add(e._pt,!1),e=e._next}while(null!==e);return t.toCoordinateArray()}getArea(){return this._area}updateArea(){if(null===this._prev||null===this._next)return this._area=so.MAX_AREA,null;this._area=Math.abs(ve.area(this._prev._pt,this._pt,this._next._pt))}remove(){var t=this._prev,e=this._next,i=null;return null!==this._prev&&(this._prev.setNext(e),this._prev.updateArea(),i=this._prev),null!==this._next&&(this._next.setPrev(t),this._next.updateArea(),null===i&&(i=this._next)),this._isLive=!1,i}isLive(){return this._isLive}setPrev(t){this._prev=t}setNext(t){this._next=t}getClass(){return so}get interfaces_(){return[]}}so.constructor_=function(){this._pt=null,this._prev=null,this._next=null,this._area=so.MAX_AREA,this._isLive=!0;let t=arguments[0];this._pt=t},so.MAX_AREA=n.MAX_VALUE,no.VWVertex=so,no.constructor_=function(){this._pts=null,this._tolerance=null;let t=arguments[0],e=arguments[1];this._pts=t,this._tolerance=e*e};class oo{constructor(){oo.constructor_.apply(this,arguments)}static simplify(t,e){var i=new oo(t);return i.setDistanceTolerance(e),i.getResultGeometry()}setEnsureValid(t){this._isEnsureValidTopology=t}getResultGeometry(){return this._inputGeom.isEmpty()?this._inputGeom.copy():new ao(this._isEnsureValidTopology,this._distanceTolerance).transform(this._inputGeom)}setDistanceTolerance(t){if(t<0)throw new i("Tolerance must be non-negative");this._distanceTolerance=t}getClass(){return oo}get interfaces_(){return[]}}class ao extends ui{constructor(){super(),ao.constructor_.apply(this,arguments)}transformPolygon(t,e){if(t.isEmpty())return null;var i=super.transformPolygon.call(this,t,e);return e instanceof qt?i:this.createValidArea(i)}createValidArea(t){return this._isEnsureValidTopology?t.buffer(0):t}transformCoordinates(t,e){var i=t.toCoordinateArray(),r=null;return r=0===i.length?new Array(0).fill(null):no.simplify(i,this._distanceTolerance),this._factory.getCoordinateSequenceFactory().create(r)}transformMultiPolygon(t,e){var i=super.transformMultiPolygon.call(this,t,e);return this.createValidArea(i)}transformLinearRing(t,e){var i=e instanceof Yt,r=super.transformLinearRing.call(this,t,e);return!i||r instanceof Xt?r:null}getClass(){return ao}get interfaces_(){return[]}}ao.constructor_=function(){this._isEnsureValidTopology=!0,this._distanceTolerance=null;let t=arguments[0],e=arguments[1];this._isEnsureValidTopology=t,this._distanceTolerance=e},oo.VWTransformer=ao,oo.constructor_=function(){this._inputGeom=null,this._distanceTolerance=null,this._isEnsureValidTopology=!0;let t=arguments[0];this._inputGeom=t};var ho=Object.freeze({DouglasPeuckerSimplifier:js,TopologyPreservingSimplifier:eo,VWSimplifier:oo});class lo{constructor(){lo.constructor_.apply(this,arguments)}static pointAlongReverse(t,e){var i=new y;return i.x=t.p1.x-e*(t.p1.x-t.p0.x),i.y=t.p1.y-e*(t.p1.y-t.p0.y),i}splitAt(){if(1===arguments.length){let e=arguments[0];var t=this._minimumLen/this._segLen;if(e.distance(this._seg.p0)<this._minimumLen)return this._splitPt=this._seg.pointAlong(t),null;if(e.distance(this._seg.p1)<this._minimumLen)return this._splitPt=lo.pointAlongReverse(this._seg,t),null;this._splitPt=e}else if(2===arguments.length){let t=arguments[0],i=arguments[1];var e=this.getConstrainedLength(t)/this._segLen;i.equals2D(this._seg.p0)?this._splitPt=this._seg.pointAlong(e):this._splitPt=lo.pointAlongReverse(this._seg,e)}}setMinimumLength(t){this._minimumLen=t}getConstrainedLength(t){return t<this._minimumLen?this._minimumLen:t}getSplitPoint(){return this._splitPt}getClass(){return lo}get interfaces_(){return[]}}lo.constructor_=function(){this._seg=null,this._segLen=null,this._splitPt=null,this._minimumLen=0;let t=arguments[0];this._seg=t,this._segLen=t.getLength()};class uo{constructor(){uo.constructor_.apply(this,arguments)}findSplitPoint(t,e){}getClass(){return uo}get interfaces_(){return[]}}uo.constructor_=function(){};class co{constructor(){co.constructor_.apply(this,arguments)}static projectedSplitPoint(t,e){return t.getLineSegment().project(e)}findSplitPoint(t,e){var i=t.getLineSegment(),r=i.getLength()/2,n=new lo(i),s=co.projectedSplitPoint(t,e),o=2*s.distance(e)*.8;return o>r&&(o=r),n.setMinimumLength(o),n.splitAt(s),n.getSplitPoint()}getClass(){return co}get interfaces_(){return[uo]}}co.constructor_=function(){};class po{constructor(){po.constructor_.apply(this,arguments)}static triArea(t,e,i){return(e.x-t.x)*(i.y-t.y)-(e.y-t.y)*(i.x-t.x)}static isInCircleDDNormalized(t,e,i,r){var n=F.valueOf(t.x).selfSubtract(r.x),s=F.valueOf(t.y).selfSubtract(r.y),o=F.valueOf(e.x).selfSubtract(r.x),a=F.valueOf(e.y).selfSubtract(r.y),h=F.valueOf(i.x).selfSubtract(r.x),l=F.valueOf(i.y).selfSubtract(r.y),u=n.multiply(a).selfSubtract(o.multiply(s)),c=o.multiply(l).selfSubtract(h.multiply(a)),d=h.multiply(s).selfSubtract(n.multiply(l)),p=n.multiply(n).selfAdd(s.multiply(s)),g=o.multiply(o).selfAdd(a.multiply(a)),f=h.multiply(h).selfAdd(l.multiply(l));return p.selfMultiply(c).selfAdd(g.selfMultiply(d)).selfAdd(f.selfMultiply(u)).doubleValue()>0}static checkRobustInCircle(t,e,i,r){var n=po.isInCircleNonRobust(t,e,i,r),s=po.isInCircleDDSlow(t,e,i,r),o=po.isInCircleCC(t,e,i,r),a=ve.circumcentre(t,e,i);G.out.println("p radius diff a = "+Math.abs(r.distance(a)-t.distance(a))/t.distance(a)),n===s&&n===o||(G.out.println("inCircle robustness failure (double result = "+n+", DD result = "+s+", CC result = "+o+")"),G.out.println(de.toLineString(new Zt([t,e,i,r]))),G.out.println("Circumcentre = "+de.toPoint(a)+" radius = "+t.distance(a)),G.out.println("p radius diff a = "+Math.abs(r.distance(a)/t.distance(a)-1)),G.out.println("p radius diff b = "+Math.abs(r.distance(a)/e.distance(a)-1)),G.out.println("p radius diff c = "+Math.abs(r.distance(a)/i.distance(a)-1)),G.out.println())}static isInCircleDDFast(t,e,i,r){var n=F.sqr(t.x).selfAdd(F.sqr(t.y)).selfMultiply(po.triAreaDDFast(e,i,r)),s=F.sqr(e.x).selfAdd(F.sqr(e.y)).selfMultiply(po.triAreaDDFast(t,i,r)),o=F.sqr(i.x).selfAdd(F.sqr(i.y)).selfMultiply(po.triAreaDDFast(t,e,r)),a=F.sqr(r.x).selfAdd(F.sqr(r.y)).selfMultiply(po.triAreaDDFast(t,e,i));return n.selfSubtract(s).selfAdd(o).selfSubtract(a).doubleValue()>0}static isInCircleCC(t,e,i,r){var n=ve.circumcentre(t,e,i),s=t.distance(n);return r.distance(n)-s<=0}static isInCircleNormalized(t,e,i,r){var n=t.x-r.x,s=t.y-r.y,o=e.x-r.x,a=e.y-r.y,h=i.x-r.x,l=i.y-r.y;return(n*n+s*s)*(o*l-h*a)+(o*o+a*a)*(h*s-n*l)+(h*h+l*l)*(n*a-o*s)>0}static isInCircleDDSlow(t,e,i,r){var n=F.valueOf(r.x),s=F.valueOf(r.y),o=F.valueOf(t.x),a=F.valueOf(t.y),h=F.valueOf(e.x),l=F.valueOf(e.y),u=F.valueOf(i.x),c=F.valueOf(i.y),d=o.multiply(o).add(a.multiply(a)).multiply(po.triAreaDDSlow(h,l,u,c,n,s)),p=h.multiply(h).add(l.multiply(l)).multiply(po.triAreaDDSlow(o,a,u,c,n,s)),g=u.multiply(u).add(c.multiply(c)).multiply(po.triAreaDDSlow(o,a,h,l,n,s)),f=n.multiply(n).add(s.multiply(s)).multiply(po.triAreaDDSlow(o,a,h,l,u,c));return d.subtract(p).add(g).subtract(f).doubleValue()>0}static isInCircleNonRobust(t,e,i,r){return(t.x*t.x+t.y*t.y)*po.triArea(e,i,r)-(e.x*e.x+e.y*e.y)*po.triArea(t,i,r)+(i.x*i.x+i.y*i.y)*po.triArea(t,e,r)-(r.x*r.x+r.y*r.y)*po.triArea(t,e,i)>0}static isInCircleRobust(t,e,i,r){return po.isInCircleNormalized(t,e,i,r)}static triAreaDDSlow(t,e,i,r,n,s){return i.subtract(t).multiply(s.subtract(e)).subtract(r.subtract(e).multiply(n.subtract(t)))}static triAreaDDFast(t,e,i){var r=F.valueOf(e.x).selfSubtract(t.x).selfMultiply(F.valueOf(i.y).selfSubtract(t.y)),n=F.valueOf(e.y).selfSubtract(t.y).selfMultiply(F.valueOf(i.x).selfSubtract(t.x));return r.selfSubtract(n)}getClass(){return po}get interfaces_(){return[]}}po.constructor_=function(){};class go{constructor(){go.constructor_.apply(this,arguments)}static interpolateZ(){if(3===arguments.length){let r=arguments[0],n=arguments[1],s=arguments[2];var t=n.distance(s),e=r.distance(n),i=s.z-n.z;return n.z+i*(e/t)}if(4===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2],g=arguments[3];var r=e.x,n=e.y,s=i.x-r,o=g.x-r,a=i.y-n,h=g.y-n,l=s*h-o*a,u=t.x-r,c=t.y-n,d=(h*u-o*c)/l,p=(-a*u+s*c)/l;return e.z+d*(i.z-e.z)+p*(g.z-e.z)}}circleCenter(t,e){var i=new go(this.getX(),this.getY()),r=this.bisector(i,t),n=this.bisector(t,e),s=new U(r,n),o=null;try{o=new go(s.getX(),s.getY())}catch(r){if(!(r instanceof A))throw r;G.err.println("a: "+i+"  b: "+t+"  c: "+e),G.err.println(r)}return o}dot(t){return this._p.x*t.getX()+this._p.y*t.getY()}magn(){return Math.sqrt(this._p.x*this._p.x+this._p.y*this._p.y)}getZ(){return this._p.z}bisector(t,e){var i=e.getX()-t.getX(),r=e.getY()-t.getY(),n=new U(t.getX()+i/2,t.getY()+r/2,1),s=new U(t.getX()-r+i/2,t.getY()+i+r/2,1);return new U(n,s)}equals(){if(1===arguments.length){let t=arguments[0];return this._p.x===t.getX()&&this._p.y===t.getY()}if(2===arguments.length){let t=arguments[0],e=arguments[1];return this._p.distance(t.getCoordinate())<e}}getCoordinate(){return this._p}isInCircle(t,e,i){return po.isInCircleRobust(t._p,e._p,i._p,this._p)}interpolateZValue(t,e,i){var r=t.getX(),n=t.getY(),s=e.getX()-r,o=i.getX()-r,a=e.getY()-n,h=i.getY()-n,l=s*h-o*a,u=this.getX()-r,c=this.getY()-n,d=(h*u-o*c)/l,p=(-a*u+s*c)/l;return t.getZ()+d*(e.getZ()-t.getZ())+p*(i.getZ()-t.getZ())}midPoint(t){var e=(this._p.x+t.getX())/2,i=(this._p.y+t.getY())/2,r=(this._p.z+t.getZ())/2;return new go(e,i,r)}rightOf(t){return this.isCCW(t.dest(),t.orig())}isCCW(t,e){return(t._p.x-this._p.x)*(e._p.y-this._p.y)-(t._p.y-this._p.y)*(e._p.x-this._p.x)>0}getX(){return this._p.x}crossProduct(t){return this._p.x*t.getY()-this._p.y*t.getX()}setZ(t){this._p.z=t}times(t){return new go(t*this._p.x,t*this._p.y)}cross(){return new go(this._p.y,-this._p.x)}leftOf(t){return this.isCCW(t.orig(),t.dest())}toString(){return"POINT ("+this._p.x+" "+this._p.y+")"}sub(t){return new go(this._p.x-t.getX(),this._p.y-t.getY())}getY(){return this._p.y}classify(t,e){var i=e.sub(t),r=this.sub(t),n=i.crossProduct(r);return n>0?go.LEFT:n<0?go.RIGHT:i.getX()*r.getX()<0||i.getY()*r.getY()<0?go.BEHIND:i.magn()<r.magn()?go.BEYOND:t.equals(this)?go.ORIGIN:e.equals(this)?go.DESTINATION:go.BETWEEN}sum(t){return new go(this._p.x+t.getX(),this._p.y+t.getY())}distance(t,e){return Math.sqrt(Math.pow(e.getX()-t.getX(),2)+Math.pow(e.getY()-t.getY(),2))}circumRadiusRatio(t,e){var i=this.circleCenter(t,e),r=this.distance(i,t),n=this.distance(this,t),s=this.distance(t,e);return s<n&&(n=s),(s=this.distance(e,this))<n&&(n=s),r/n}getClass(){return go}get interfaces_(){return[]}}go.constructor_=function(){if(this._p=null,1===arguments.length){let t=arguments[0];this._p=new y(t)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];this._p=new y(t,e)}else if(3===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2];this._p=new y(t,e,i)}},go.LEFT=0,go.RIGHT=1,go.BEYOND=2,go.BEHIND=3,go.BETWEEN=4,go.ORIGIN=5,go.DESTINATION=6;class fo extends go{constructor(){super(),fo.constructor_.apply(this,arguments)}getConstraint(){return this._constraint}setOnConstraint(t){this._isOnConstraint=t}merge(t){t._isOnConstraint&&(this._isOnConstraint=!0,this._constraint=t._constraint)}isOnConstraint(){return this._isOnConstraint}setConstraint(t){this._isOnConstraint=!0,this._constraint=t}getClass(){return fo}get interfaces_(){return[]}}fo.constructor_=function(){this._isOnConstraint=null,this._constraint=null;let t=arguments[0];go.constructor_.call(this,t)};class _o{constructor(){_o.constructor_.apply(this,arguments)}static makeEdge(t,e){var i=new _o,r=new _o,n=new _o,s=new _o;i._rot=r,r._rot=n,n._rot=s,s._rot=i,i.setNext(i),r.setNext(s),n.setNext(n),s.setNext(r);var o=i;return o.setOrig(t),o.setDest(e),o}static swap(t){var e=t.oPrev(),i=t.sym().oPrev();_o.splice(t,e),_o.splice(t.sym(),i),_o.splice(t,e.lNext()),_o.splice(t.sym(),i.lNext()),t.setOrig(e.dest()),t.setDest(i.dest())}static splice(t,e){var i=t.oNext().rot(),r=e.oNext().rot(),n=e.oNext(),s=t.oNext(),o=r.oNext(),a=i.oNext();t.setNext(n),e.setNext(s),i.setNext(o),r.setNext(a)}static connect(t,e){var i=_o.makeEdge(t.dest(),e.orig());return _o.splice(i,t.lNext()),_o.splice(i.sym(),e),i}equalsNonOriented(t){return!!this.equalsOriented(t)||!!this.equalsOriented(t.sym())}toLineSegment(){return new fe(this._vertex.getCoordinate(),this.dest().getCoordinate())}dest(){return this.sym().orig()}oNext(){return this._next}equalsOriented(t){return!(!this.orig().getCoordinate().equals2D(t.orig().getCoordinate())||!this.dest().getCoordinate().equals2D(t.dest().getCoordinate()))}dNext(){return this.sym().oNext().sym()}lPrev(){return this._next.sym()}rPrev(){return this.sym().oNext()}rot(){return this._rot}oPrev(){return this._rot._next._rot}sym(){return this._rot._rot}setOrig(t){this._vertex=t}lNext(){return this.invRot().oNext().rot()}getLength(){return this.orig().getCoordinate().distance(this.dest().getCoordinate())}invRot(){return this._rot.sym()}setDest(t){this.sym().setOrig(t)}setData(t){this._data=t}getData(){return this._data}delete(){this._rot=null}orig(){return this._vertex}rNext(){return this._rot._next.invRot()}toString(){var t=this._vertex.getCoordinate(),e=this.dest().getCoordinate();return de.toLineString(t,e)}isLive(){return null!==this._rot}getPrimary(){return this.orig().getCoordinate().compareTo(this.dest().getCoordinate())<=0?this:this.sym()}dPrev(){return this.invRot().oNext().invRot()}setNext(t){this._next=t}getClass(){return _o}get interfaces_(){return[]}}_o.constructor_=function(){this._rot=null,this._vertex=null,this._next=null,this._data=null};class mo{constructor(){mo.constructor_.apply(this,arguments)}insertSite(t){var e=this._subdiv.locate(t);if(this._subdiv.isVertexOfEdge(e,t))return e;this._subdiv.isOnEdge(e,t.getCoordinate())&&(e=e.oPrev(),this._subdiv.delete(e.oNext()));var i=this._subdiv.makeEdge(e.orig(),t);_o.splice(i,e);var r=i;do{e=(i=this._subdiv.connect(e,i.sym())).oPrev()}while(e.lNext()!==r);for(;;){var n=e.oPrev();if(n.dest().rightOf(e)&&t.isInCircle(e.orig(),n.dest(),e.dest()))_o.swap(e),e=e.oPrev();else{if(e.oNext()===r)return i;e=e.oNext().lPrev()}}}insertSites(t){for(var e=t.iterator();e.hasNext();){var i=e.next();this.insertSite(i)}}getClass(){return mo}get interfaces_(){return[]}}mo.constructor_=function(){this._subdiv=null,this._isUsingTolerance=!1;let t=arguments[0];this._subdiv=t,this._isUsingTolerance=t.getTolerance()>0};class yo{constructor(){yo.constructor_.apply(this,arguments)}locate(t){}getClass(){return yo}get interfaces_(){return[]}}yo.constructor_=function(){};class vo{constructor(){vo.constructor_.apply(this,arguments)}init(){this._lastEdge=this.findEdge()}locate(t){this._lastEdge.isLive()||this.init();var e=this._subdiv.locateFromEdge(t,this._lastEdge);return this._lastEdge=e,e}findEdge(){return this._subdiv.getEdges().iterator().next()}getClass(){return vo}get interfaces_(){return[yo]}}vo.constructor_=function(){this._subdiv=null,this._lastEdge=null;let t=arguments[0];this._subdiv=t,this.init()};class xo extends f{constructor(){super(),xo.constructor_.apply(this,arguments)}static msgWithSpatial(t,e){return null!==e?t+" [ "+e+" ]":t}getSegment(){return this._seg}getClass(){return xo}get interfaces_(){return[]}}xo.constructor_=function(){if(this._seg=null,1===arguments.length){if("string"==typeof arguments[0]){let t=arguments[0];f.constructor_.call(this,t)}else if(arguments[0]instanceof fe){let t=arguments[0];f.constructor_.call(this,"Locate failed to converge (at edge: "+t+").  Possible causes include invalid Subdivision topology or very close sites"),this._seg=new fe(t)}}else if(2===arguments.length){let t=arguments[0],e=arguments[1];f.constructor_.call(this,xo.msgWithSpatial(t,e)),this._seg=new fe(e)}};class Eo{constructor(){Eo.constructor_.apply(this,arguments)}visit(t){}getClass(){return Eo}get interfaces_(){return[]}}Eo.constructor_=function(){};class wo{constructor(){wo.constructor_.apply(this,arguments)}static getTriangleEdges(t,e){if(e[0]=t,e[1]=e[0].lNext(),e[2]=e[1].lNext(),e[2].lNext()!==e[0])throw new i("Edges do not form a triangle")}getTriangleVertices(t){var e=new To;return this.visitTriangles(e,t),e.getTriangleVertices()}isFrameVertex(t){return!!t.equals(this._frameVertex[0])||!!t.equals(this._frameVertex[1])||!!t.equals(this._frameVertex[2])}isVertexOfEdge(t,e){return!(!e.equals(t.orig(),this._tolerance)&&!e.equals(t.dest(),this._tolerance))}connect(t,e){var i=_o.connect(t,e);return this._quadEdges.add(i),i}getVoronoiCellPolygon(t,e){var i=new C,r=t;do{var n=t.rot().orig().getCoordinate();i.add(n),t=t.oPrev()}while(t!==r);var s=new O;s.addAll(i,!1),s.closeRing(),s.size()<4&&(G.out.println(s),s.add(s.get(s.size()-1),!0));var o=s.toCoordinateArray(),a=e.createPolygon(e.createLinearRing(o)),h=r.orig();return a.setUserData(h.getCoordinate()),a}setLocator(t){this._locator=t}initSubdiv(){var t=this.makeEdge(this._frameVertex[0],this._frameVertex[1]),e=this.makeEdge(this._frameVertex[1],this._frameVertex[2]);_o.splice(t.sym(),e);var i=this.makeEdge(this._frameVertex[2],this._frameVertex[0]);return _o.splice(e.sym(),i),_o.splice(i.sym(),t),t}isFrameBorderEdge(t){var e=new Array(3).fill(null);wo.getTriangleEdges(t,e);var i=new Array(3).fill(null);wo.getTriangleEdges(t.sym(),i);var r=t.lNext().dest();if(this.isFrameVertex(r))return!0;var n=t.sym().lNext().dest();return!!this.isFrameVertex(n)}makeEdge(t,e){var i=_o.makeEdge(t,e);return this._quadEdges.add(i),i}visitTriangles(t,e){this._visitedKey++;var i=new Qe;i.push(this._startingEdge);for(var r=new st;!i.empty();){var n=i.pop();if(!r.contains(n)){var s=this.fetchTriangleToVisit(n,i,e,r);null!==s&&t.visit(s)}}}isFrameEdge(t){return!(!this.isFrameVertex(t.orig())&&!this.isFrameVertex(t.dest()))}isOnEdge(t,e){return this._seg.setCoordinates(t.orig().getCoordinate(),t.dest().getCoordinate()),this._seg.distance(e)<this._edgeCoincidenceTolerance}getEnvelope(){return new P(this._frameEnv)}createFrame(t){var e=t.getWidth(),i=t.getHeight(),r=0;r=e>i?10*e:10*i,this._frameVertex[0]=new go((t.getMaxX()+t.getMinX())/2,t.getMaxY()+r),this._frameVertex[1]=new go(t.getMinX()-r,t.getMinY()-r),this._frameVertex[2]=new go(t.getMaxX()+r,t.getMinY()-r),this._frameEnv=new P(this._frameVertex[0].getCoordinate(),this._frameVertex[1].getCoordinate()),this._frameEnv.expandToInclude(this._frameVertex[2].getCoordinate())}getTriangleCoordinates(t){var e=new So;return this.visitTriangles(e,t),e.getTriangles()}getVertices(t){for(var e=new st,i=this._quadEdges.iterator();i.hasNext();){var r=i.next(),n=r.orig();!t&&this.isFrameVertex(n)||e.add(n);var s=r.dest();!t&&this.isFrameVertex(s)||e.add(s)}return e}fetchTriangleToVisit(t,e,i,r){var n=t,s=0,o=!1;do{this._triEdges[s]=n,this.isFrameEdge(n)&&(o=!0);var a=n.sym();r.contains(a)||e.push(a),r.add(n),s++,n=n.lNext()}while(n!==t);return o&&!i?null:this._triEdges}getEdges(){if(0===arguments.length)return this._quadEdges;if(1===arguments.length){let s=arguments[0];for(var t=this.getPrimaryEdges(!1),e=new Array(t.size()).fill(null),i=0,r=t.iterator();r.hasNext();){var n=r.next();e[i++]=s.createLineString([n.orig().getCoordinate(),n.dest().getCoordinate()])}return s.createMultiLineString(e)}}getVertexUniqueEdges(t){for(var e=new C,i=new st,r=this._quadEdges.iterator();r.hasNext();){var n=r.next(),s=n.orig();i.contains(s)||(i.add(s),!t&&this.isFrameVertex(s)||e.add(n));var o=n.sym(),a=o.orig();i.contains(a)||(i.add(a),!t&&this.isFrameVertex(a)||e.add(o))}return e}getTriangleEdges(t){var e=new Io;return this.visitTriangles(e,t),e.getTriangleEdges()}getPrimaryEdges(t){this._visitedKey++;var e=new C,i=new Qe;i.push(this._startingEdge);for(var r=new st;!i.empty();){var n=i.pop();if(!r.contains(n)){var s=n.getPrimary();!t&&this.isFrameEdge(s)||e.add(s),i.push(n.oNext()),i.push(n.sym().oNext()),r.add(n),r.add(n.sym())}}return e}delete(t){_o.splice(t,t.oPrev()),_o.splice(t.sym(),t.sym().oPrev());var e=t.sym(),i=t.rot(),r=t.rot().sym();this._quadEdges.remove(t),this._quadEdges.remove(e),this._quadEdges.remove(i),this._quadEdges.remove(r),t.delete(),e.delete(),i.delete(),r.delete()}locateFromEdge(t,e){for(var i=0,r=this._quadEdges.size(),n=e;;){if(++i>r)throw new xo(n.toLineSegment());if(t.equals(n.orig())||t.equals(n.dest()))break;if(t.rightOf(n))n=n.sym();else if(t.rightOf(n.oNext())){if(t.rightOf(n.dPrev()))break;n=n.dPrev()}else n=n.oNext()}return n}getTolerance(){return this._tolerance}getVoronoiCellPolygons(t){this.visitTriangles(new bo,!0);for(var e=new C,i=this.getVertexUniqueEdges(!1).iterator();i.hasNext();){var r=i.next();e.add(this.getVoronoiCellPolygon(r,t))}return e}getVoronoiDiagram(t){var e=this.getVoronoiCellPolygons(t);return t.createGeometryCollection(oe.toGeometryArray(e))}getTriangles(t){for(var e=this.getTriangleCoordinates(!1),i=new Array(e.size()).fill(null),r=0,n=e.iterator();n.hasNext();){var s=n.next();i[r++]=t.createPolygon(t.createLinearRing(s))}return t.createGeometryCollection(i)}insertSite(t){var e=this.locate(t);if(t.equals(e.orig(),this._tolerance)||t.equals(e.dest(),this._tolerance))return e;var i=this.makeEdge(e.orig(),t);_o.splice(i,e);var r=i;do{e=(i=this.connect(e,i.sym())).oPrev()}while(e.lNext()!==r);return r}locate(){if(1===arguments.length){if(arguments[0]instanceof go){let t=arguments[0];return this._locator.locate(t)}if(arguments[0]instanceof y){let t=arguments[0];return this._locator.locate(new go(t))}}else if(2===arguments.length){let r=arguments[0],n=arguments[1];var t=this._locator.locate(new go(r));if(null===t)return null;var e=t;t.dest().getCoordinate().equals2D(r)&&(e=t.sym());var i=e;do{if(i.dest().getCoordinate().equals2D(n))return i;i=i.oNext()}while(i!==e);return null}}getClass(){return wo}get interfaces_(){return[]}}class bo{constructor(){bo.constructor_.apply(this,arguments)}visit(t){for(var e=t[0].orig().getCoordinate(),i=t[1].orig().getCoordinate(),r=t[2].orig().getCoordinate(),n=ve.circumcentre(e,i,r),s=new go(n),o=0;o<3;o++)t[o].rot().setOrig(s)}getClass(){return bo}get interfaces_(){return[Eo]}}bo.constructor_=function(){};class Io{constructor(){Io.constructor_.apply(this,arguments)}getTriangleEdges(){return this._triList}visit(t){this._triList.add(t)}getClass(){return Io}get interfaces_(){return[Eo]}}Io.constructor_=function(){this._triList=new C};class To{constructor(){To.constructor_.apply(this,arguments)}visit(t){this._triList.add([t[0].orig(),t[1].orig(),t[2].orig()])}getTriangleVertices(){return this._triList}getClass(){return To}get interfaces_(){return[Eo]}}To.constructor_=function(){this._triList=new C};class So{constructor(){So.constructor_.apply(this,arguments)}checkTriangleSize(t){t.length>=2?de.toLineString(t[0],t[1]):t.length>=1&&de.toPoint(t[0])}visit(t){this._coordList.clear();for(var e=0;e<3;e++){var i=t[e].orig();this._coordList.add(i.getCoordinate())}if(this._coordList.size()>0){this._coordList.closeRing();var r=this._coordList.toCoordinateArray();if(4!==r.length)return null;this._triCoords.add(r)}}getTriangles(){return this._triCoords}getClass(){return So}get interfaces_(){return[Eo]}}So.constructor_=function(){this._coordList=new O,this._triCoords=new C},wo.TriangleCircumcentreVisitor=bo,wo.TriangleEdgesListVisitor=Io,wo.TriangleVertexListVisitor=To,wo.TriangleCoordinatesVisitor=So,wo.constructor_=function(){this._visitedKey=0,this._quadEdges=new C,this._startingEdge=null,this._tolerance=null,this._edgeCoincidenceTolerance=null,this._frameVertex=new Array(3).fill(null),this._frameEnv=null,this._locator=null,this._seg=new fe,this._triEdges=new Array(3).fill(null);let t=arguments[0],e=arguments[1];this._tolerance=e,this._edgeCoincidenceTolerance=e/wo.EDGE_COINCIDENCE_TOL_FACTOR,this.createFrame(t),this._startingEdge=this.initSubdiv(),this._locator=new vo(this)},wo.EDGE_COINCIDENCE_TOL_FACTOR=1e3;class Co{constructor(){Co.constructor_.apply(this,arguments)}getLineSegment(){return this._ls}getEndZ(){return this._ls.getCoordinate(1).z}getStartZ(){return this._ls.getCoordinate(0).z}intersection(t){return this._ls.intersection(t.getLineSegment())}getStart(){return this._ls.getCoordinate(0)}getEnd(){return this._ls.getCoordinate(1)}getEndY(){return this._ls.getCoordinate(1).y}getStartX(){return this._ls.getCoordinate(0).x}equalsTopo(t){return this._ls.equalsTopo(t.getLineSegment())}getStartY(){return this._ls.getCoordinate(0).y}setData(t){this._data=t}getData(){return this._data}getEndX(){return this._ls.getCoordinate(1).x}toString(){return this._ls.toString()}getClass(){return Co}get interfaces_(){return[]}}Co.constructor_=function(){if(this._ls=null,this._data=null,2===arguments.length){let t=arguments[0],e=arguments[1];this._ls=new fe(t,e)}else if(3===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2];this._ls=new fe(t,e),this._data=i}else if(6===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2],r=arguments[3],n=arguments[4],s=arguments[5];Co.constructor_.call(this,new y(t,e,i),new y(r,n,s))}else if(7===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2],r=arguments[3],n=arguments[4],s=arguments[5],o=arguments[6];Co.constructor_.call(this,new y(t,e,i),new y(r,n,s),o)}};class No{constructor(){No.constructor_.apply(this,arguments)}static computeVertexEnvelope(t){for(var e=new P,i=t.iterator();i.hasNext();){var r=i.next();e.expandToInclude(r.getCoordinate())}return e}getInitialVertices(){return this._initialVertices}getKDT(){return this._kdt}enforceConstraints(){this.addConstraintVertices();var t=0,e=0;do{e=this.enforceGabriel(this._segments),t++}while(e>0&&t<No.MAX_SPLIT_ITER)}insertSites(t){for(var e=t.iterator();e.hasNext();){var i=e.next();this.insertSite(i)}}getVertexFactory(){return this._vertexFactory}getPointArray(){for(var t=new Array(this._initialVertices.size()+this._segVertices.size()).fill(null),e=0,i=this._initialVertices.iterator();i.hasNext();){var r=i.next();t[e++]=r.getCoordinate()}for(var n=this._segVertices.iterator();n.hasNext();)r=n.next(),t[e++]=r.getCoordinate();return t}setConstraints(t,e){this._segments=t,this._segVertices=e}computeConvexHull(){var t=new oe,e=this.getPointArray(),i=new ti(e,t);this._convexHull=i.getConvexHull()}addConstraintVertices(){this.computeConvexHull(),this.insertSites(this._segVertices)}findNonGabrielPoint(t){var e=t.getStart(),i=t.getEnd(),r=new y((e.x+i.x)/2,(e.y+i.y)/2),s=e.distance(r),o=new P(r);o.expandBy(s);for(var a=this._kdt.query(o),h=null,l=n.MAX_VALUE,u=a.iterator();u.hasNext();){var c=u.next().getCoordinate();if(!c.equals2D(e)&&!c.equals2D(i)){var d=r.distance(c);d<s&&(null===h||d<l)&&(h=c,l=d)}}return h}getConstraintSegments(){return this._segments}setSplitPointFinder(t){this._splitFinder=t}getConvexHull(){return this._convexHull}getTolerance(){return this._tolerance}enforceGabriel(t){for(var e=new C,i=0,r=new C,n=t.iterator();n.hasNext();){var s=n.next(),o=this.findNonGabrielPoint(s);if(null!==o){this._splitPt=this._splitFinder.findSplitPoint(s,o);var a=this.createVertex(this._splitPt,s);this.insertSite(a).getCoordinate().equals2D(this._splitPt);var h=new Co(s.getStartX(),s.getStartY(),s.getStartZ(),a.getX(),a.getY(),a.getZ(),s.getData()),l=new Co(a.getX(),a.getY(),a.getZ(),s.getEndX(),s.getEndY(),s.getEndZ(),s.getData());e.add(h),e.add(l),r.add(s),i+=1}}return t.removeAll(r),t.addAll(e),i}createVertex(){if(1===arguments.length){let e=arguments[0];var t=null;return t=null!==this._vertexFactory?this._vertexFactory.createVertex(e,null):new fo(e)}if(2===arguments.length){let e=arguments[0],i=arguments[1];return t=null,(t=null!==this._vertexFactory?this._vertexFactory.createVertex(e,i):new fo(e)).setOnConstraint(!0),t}}getSubdivision(){return this._subdiv}computeBoundingBox(){var t=No.computeVertexEnvelope(this._initialVertices),e=No.computeVertexEnvelope(this._segVertices),i=new P(t);i.expandToInclude(e);var r=.2*i.getWidth(),n=.2*i.getHeight(),s=Math.max(r,n);this._computeAreaEnv=new P(i),this._computeAreaEnv.expandBy(s)}setVertexFactory(t){this._vertexFactory=t}formInitialDelaunay(){this.computeBoundingBox(),this._subdiv=new wo(this._computeAreaEnv,this._tolerance),this._subdiv.setLocator(new vo(this._subdiv)),this._incDel=new mo(this._subdiv),this.insertSites(this._initialVertices)}insertSite(){if(arguments[0]instanceof fo){let i=arguments[0];var t=this._kdt.insert(i.getCoordinate(),i);if(t.isRepeated()){var e=t.getData();return e.merge(i),e}return this._incDel.insertSite(i),i}if(arguments[0]instanceof y){let t=arguments[0];this.insertSite(this.createVertex(t))}}getClass(){return No}get interfaces_(){return[]}}No.constructor_=function(){this._initialVertices=null,this._segVertices=null,this._segments=new C,this._subdiv=null,this._incDel=null,this._convexHull=null,this._splitFinder=new co,this._kdt=null,this._vertexFactory=null,this._computeAreaEnv=null,this._splitPt=null,this._tolerance=null;let t=arguments[0],e=arguments[1];this._initialVertices=new C(t),this._tolerance=e,this._kdt=new Wi(e)},No.MAX_SPLIT_ITER=99;class Oo{constructor(){Oo.constructor_.apply(this,arguments)}static extractUniqueCoordinates(t){if(null===t)return new O;var e=t.getCoordinates();return Oo.unique(e)}static envelope(t){for(var e=new P,i=t.iterator();i.hasNext();){var r=i.next();e.expandToInclude(r)}return e}static unique(t){var e=$.copyDeep(t);return vt.sort(e),new O(e,!1)}static toVertices(t){for(var e=new C,i=t.iterator();i.hasNext();){var r=i.next();e.add(new go(r))}return e}create(){if(null!==this._subdiv)return null;var t=Oo.envelope(this._siteCoords),e=Oo.toVertices(this._siteCoords);this._subdiv=new wo(t,this._tolerance),new mo(this._subdiv).insertSites(e)}setTolerance(t){this._tolerance=t}setSites(){if(arguments[0]instanceof V){let t=arguments[0];this._siteCoords=Oo.extractUniqueCoordinates(t)}else if(x(arguments[0],w)){let t=arguments[0];this._siteCoords=Oo.unique($.toCoordinateArray(t))}}getEdges(t){return this.create(),this._subdiv.getEdges(t)}getSubdivision(){return this.create(),this._subdiv}getTriangles(t){return this.create(),this._subdiv.getTriangles(t)}getClass(){return Oo}get interfaces_(){return[]}}Oo.constructor_=function(){this._siteCoords=null,this._tolerance=0,this._subdiv=null};class Po{constructor(){Po.constructor_.apply(this,arguments)}static createConstraintSegments(){if(1===arguments.length){let n=arguments[0];for(var t=De.getLines(n),e=new C,i=t.iterator();i.hasNext();){var r=i.next();Po.createConstraintSegments(r,e)}return e}if(2===arguments.length){let t=arguments[0],e=arguments[1];var n=t.getCoordinates();for(i=1;i<n.length;i++)e.add(new Co(n[i-1],n[i]))}}createSiteVertices(t){for(var e=new C,i=t.iterator();i.hasNext();){var r=i.next();this._constraintVertexMap.containsKey(r)||e.add(new fo(r))}return e}create(){if(null!==this._subdiv)return null;var t=Oo.envelope(this._siteCoords),e=new C;null!==this._constraintLines&&(t.expandToInclude(this._constraintLines.getEnvelopeInternal()),this.createVertices(this._constraintLines),e=Po.createConstraintSegments(this._constraintLines));var i=this.createSiteVertices(this._siteCoords),r=new No(i,this._tolerance);r.setConstraints(e,new C(this._constraintVertexMap.values())),r.formInitialDelaunay(),r.enforceConstraints(),this._subdiv=r.getSubdivision()}setTolerance(t){this._tolerance=t}setConstraints(t){this._constraintLines=t}setSites(t){this._siteCoords=Oo.extractUniqueCoordinates(t)}getEdges(t){return this.create(),this._subdiv.getEdges(t)}getSubdivision(){return this.create(),this._subdiv}getTriangles(t){return this.create(),this._subdiv.getTriangles(t)}createVertices(t){for(var e=t.getCoordinates(),i=0;i<e.length;i++){var r=new fo(e[i]);this._constraintVertexMap.put(e[i],r)}}getClass(){return Po}get interfaces_(){return[]}}Po.constructor_=function(){this._siteCoords=null,this._constraintLines=null,this._tolerance=0,this._subdiv=null,this._constraintVertexMap=new pt};class Lo{constructor(){Lo.constructor_.apply(this,arguments)}static clipGeometryCollection(t,e){for(var i=t.getFactory().toGeometry(e),r=new C,n=0;n<t.getNumGeometries();n++){var s=t.getGeometryN(n),o=null;e.contains(s.getEnvelopeInternal())?o=s:e.intersects(s.getEnvelopeInternal())&&(o=i.intersection(s)).setUserData(s.getUserData()),null===o||o.isEmpty()||r.add(o)}return t.getFactory().createGeometryCollection(oe.toGeometryArray(r))}create(){if(null!==this._subdiv)return null;var t=Oo.envelope(this._siteCoords);this._diagramEnv=t;var e=Math.max(this._diagramEnv.getWidth(),this._diagramEnv.getHeight());this._diagramEnv.expandBy(e),null!==this._clipEnv&&this._diagramEnv.expandToInclude(this._clipEnv);var i=Oo.toVertices(this._siteCoords);this._subdiv=new wo(t,this._tolerance),new mo(this._subdiv).insertSites(i)}getDiagram(t){this.create();var e=this._subdiv.getVoronoiDiagram(t);return Lo.clipGeometryCollection(e,this._diagramEnv)}setTolerance(t){this._tolerance=t}setSites(){if(arguments[0]instanceof V){let t=arguments[0];this._siteCoords=Oo.extractUniqueCoordinates(t)}else if(x(arguments[0],w)){let t=arguments[0];this._siteCoords=Oo.unique($.toCoordinateArray(t))}}setClipEnvelope(t){this._clipEnv=t}getSubdivision(){return this.create(),this._subdiv}getClass(){return Lo}get interfaces_(){return[]}}Lo.constructor_=function(){this._siteCoords=null,this._tolerance=0,this._subdiv=null,this._clipEnv=null,this._diagramEnv=null};var Ao=Object.freeze({Vertex:go}),Ro=Object.freeze({ConformingDelaunayTriangulationBuilder:Po,DelaunayTriangulationBuilder:Oo,VoronoiDiagramBuilder:Lo,quadedge:Ao});class Mo{constructor(){Mo.constructor_.apply(this,arguments)}static getEndLocation(t){var e=new Mo;return e.setToEnd(t),e}static pointAlongSegmentByFraction(t,e,i){if(i<=0)return t;if(i>=1)return e;var r=(e.x-t.x)*i+t.x,n=(e.y-t.y)*i+t.y,s=(e.z-t.z)*i+t.z;return new y(r,n,s)}static compareLocationValues(t,e,i,r,n,s){return t<r?-1:t>r?1:e<n?-1:e>n?1:i<s?-1:i>s?1:0}getSegmentIndex(){return this._segmentIndex}getComponentIndex(){return this._componentIndex}isEndpoint(t){var e=t.getGeometryN(this._componentIndex).getNumPoints()-1;return this._segmentIndex>=e||this._segmentIndex===e&&this._segmentFraction>=1}isValid(t){if(this._componentIndex<0||this._componentIndex>=t.getNumGeometries())return!1;var e=t.getGeometryN(this._componentIndex);return!(this._segmentIndex<0||this._segmentIndex>e.getNumPoints()||this._segmentIndex===e.getNumPoints()&&0!==this._segmentFraction||this._segmentFraction<0||this._segmentFraction>1)}normalize(){this._segmentFraction<0&&(this._segmentFraction=0),this._segmentFraction>1&&(this._segmentFraction=1),this._componentIndex<0&&(this._componentIndex=0,this._segmentIndex=0,this._segmentFraction=0),this._segmentIndex<0&&(this._segmentIndex=0,this._segmentFraction=0),1===this._segmentFraction&&(this._segmentFraction=0,this._segmentIndex+=1)}toLowest(t){var e=t.getGeometryN(this._componentIndex).getNumPoints()-1;return this._segmentIndex<e?this:new Mo(this._componentIndex,e,1,!1)}getCoordinate(t){var e=t.getGeometryN(this._componentIndex),i=e.getCoordinateN(this._segmentIndex);if(this._segmentIndex>=e.getNumPoints()-1)return i;var r=e.getCoordinateN(this._segmentIndex+1);return Mo.pointAlongSegmentByFraction(i,r,this._segmentFraction)}getSegmentFraction(){return this._segmentFraction}getSegment(t){var e=t.getGeometryN(this._componentIndex),i=e.getCoordinateN(this._segmentIndex);if(this._segmentIndex>=e.getNumPoints()-1){var r=e.getCoordinateN(e.getNumPoints()-2);return new fe(r,i)}var n=e.getCoordinateN(this._segmentIndex+1);return new fe(i,n)}clamp(t){if(this._componentIndex>=t.getNumGeometries())return this.setToEnd(t),null;if(this._segmentIndex>=t.getNumPoints()){var e=t.getGeometryN(this._componentIndex);this._segmentIndex=e.getNumPoints()-1,this._segmentFraction=1}}setToEnd(t){this._componentIndex=t.getNumGeometries()-1;var e=t.getGeometryN(this._componentIndex);this._segmentIndex=e.getNumPoints()-1,this._segmentFraction=1}compareTo(t){var e=t;return this._componentIndex<e._componentIndex?-1:this._componentIndex>e._componentIndex?1:this._segmentIndex<e._segmentIndex?-1:this._segmentIndex>e._segmentIndex?1:this._segmentFraction<e._segmentFraction?-1:this._segmentFraction>e._segmentFraction?1:0}copy(){return new Mo(this._componentIndex,this._segmentIndex,this._segmentFraction)}toString(){return"LinearLoc["+this._componentIndex+", "+this._segmentIndex+", "+this._segmentFraction+"]"}isOnSameSegment(t){return this._componentIndex===t._componentIndex&&(this._segmentIndex===t._segmentIndex||t._segmentIndex-this._segmentIndex==1&&0===t._segmentFraction||this._segmentIndex-t._segmentIndex==1&&0===this._segmentFraction)}snapToVertex(t,e){if(this._segmentFraction<=0||this._segmentFraction>=1)return null;var i=this.getSegmentLength(t),r=this._segmentFraction*i,n=i-r;r<=n&&r<e?this._segmentFraction=0:n<=r&&n<e&&(this._segmentFraction=1)}compareLocationValues(t,e,i){return this._componentIndex<t?-1:this._componentIndex>t?1:this._segmentIndex<e?-1:this._segmentIndex>e?1:this._segmentFraction<i?-1:this._segmentFraction>i?1:0}getSegmentLength(t){var e=t.getGeometryN(this._componentIndex),i=this._segmentIndex;this._segmentIndex>=e.getNumPoints()-1&&(i=e.getNumPoints()-2);var r=e.getCoordinateN(i),n=e.getCoordinateN(i+1);return r.distance(n)}isVertex(){return this._segmentFraction<=0||this._segmentFraction>=1}getClass(){return Mo}get interfaces_(){return[c]}}Mo.constructor_=function(){if(this._componentIndex=0,this._segmentIndex=0,this._segmentFraction=0,0===arguments.length);else if(1===arguments.length){let t=arguments[0];this._componentIndex=t._componentIndex,this._segmentIndex=t._segmentIndex,this._segmentFraction=t._segmentFraction}else if(2===arguments.length){let t=arguments[0],e=arguments[1];Mo.constructor_.call(this,0,t,e)}else if(3===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2];this._componentIndex=t,this._segmentIndex=e,this._segmentFraction=i,this.normalize()}else if(4===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2],r=arguments[3];this._componentIndex=t,this._segmentIndex=e,this._segmentFraction=i,r&&this.normalize()}};class Do{constructor(){Do.constructor_.apply(this,arguments)}static segmentEndVertexIndex(t){return t.getSegmentFraction()>0?t.getSegmentIndex()+1:t.getSegmentIndex()}getComponentIndex(){return this._componentIndex}getLine(){return this._currentLine}getVertexIndex(){return this._vertexIndex}getSegmentEnd(){return this._vertexIndex<this.getLine().getNumPoints()-1?this._currentLine.getCoordinateN(this._vertexIndex+1):null}next(){if(!this.hasNext())return null;this._vertexIndex++,this._vertexIndex>=this._currentLine.getNumPoints()&&(this._componentIndex++,this.loadCurrentLine(),this._vertexIndex=0)}loadCurrentLine(){if(this._componentIndex>=this._numLines)return this._currentLine=null,null;this._currentLine=this._linearGeom.getGeometryN(this._componentIndex)}getSegmentStart(){return this._currentLine.getCoordinateN(this._vertexIndex)}isEndOfLine(){return!(this._componentIndex>=this._numLines||this._vertexIndex<this._currentLine.getNumPoints()-1)}hasNext(){return!(this._componentIndex>=this._numLines||this._componentIndex===this._numLines-1&&this._vertexIndex>=this._currentLine.getNumPoints())}getClass(){return Do}get interfaces_(){return[]}}Do.constructor_=function(){if(this._linearGeom=null,this._numLines=null,this._currentLine=null,this._componentIndex=0,this._vertexIndex=0,1===arguments.length){let t=arguments[0];Do.constructor_.call(this,t,0,0)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];Do.constructor_.call(this,t,e.getComponentIndex(),Do.segmentEndVertexIndex(e))}else if(3===arguments.length){let t=arguments[0],e=arguments[1],r=arguments[2];if(!x(t,gt))throw new i("Lineal geometry is required");this._linearGeom=t,this._numLines=t.getNumGeometries(),this._componentIndex=e,this._vertexIndex=r,this.loadCurrentLine()}};class Fo{constructor(){Fo.constructor_.apply(this,arguments)}static indexOf(t,e){return new Fo(t).indexOf(e)}static indexOfAfter(t,e,i){return new Fo(t).indexOfAfter(e,i)}indexOf(t){return this.indexOfFromStart(t,null)}indexOfFromStart(t,e){for(var i=n.MAX_VALUE,r=0,s=0,o=-1,a=new fe,h=new Do(this._linearGeom);h.hasNext();h.next())if(!h.isEndOfLine()){a.p0=h.getSegmentStart(),a.p1=h.getSegmentEnd();var l=a.distance(t),u=a.segmentFraction(t),c=h.getComponentIndex(),d=h.getVertexIndex();l<i&&(null===e||e.compareLocationValues(c,d,u)<0)&&(r=c,s=d,o=u,i=l)}return i===n.MAX_VALUE?new Mo(e):new Mo(r,s,o)}indexOfAfter(t,e){if(null===e)return this.indexOf(t);var i=Mo.getEndLocation(this._linearGeom);if(i.compareTo(e)<=0)return i;var r=this.indexOfFromStart(t,e);return m.isTrue(r.compareTo(e)>=0,"computed location is before specified minimum location"),r}getClass(){return Fo}get interfaces_(){return[]}}Fo.constructor_=function(){this._linearGeom=null;let t=arguments[0];this._linearGeom=t};class Bo{constructor(){Bo.constructor_.apply(this,arguments)}static indicesOf(t,e){return new Bo(t).indicesOf(e)}indicesOf(t){var e=t.getGeometryN(0).getCoordinateN(0),i=t.getGeometryN(t.getNumGeometries()-1),r=i.getCoordinateN(i.getNumPoints()-1),n=new Fo(this._linearGeom),s=new Array(2).fill(null);return s[0]=n.indexOf(e),0===t.getLength()?s[1]=s[0].copy():s[1]=n.indexOfAfter(r,s[0]),s}getClass(){return Bo}get interfaces_(){return[]}}Bo.constructor_=function(){this._linearGeom=null;let t=arguments[0];this._linearGeom=t};class ko{constructor(){ko.constructor_.apply(this,arguments)}getGeometry(){return this.endLine(),this._geomFact.buildGeometry(this._lines)}getLastCoordinate(){return this._lastPt}endLine(){if(null===this._coordList)return null;if(this._ignoreInvalidLines&&this._coordList.size()<2)return this._coordList=null,null;var t=this._coordList.toCoordinateArray(),e=t;this._fixInvalidLines&&(e=this.validCoordinateSequence(t)),this._coordList=null;var r=null;try{r=this._geomFact.createLineString(e)}catch(t){if(!(t instanceof i))throw t;if(!this._ignoreInvalidLines)throw t}null!==r&&this._lines.add(r)}setFixInvalidLines(t){this._fixInvalidLines=t}add(){if(1===arguments.length){let t=arguments[0];this.add(t,!0)}else if(2===arguments.length){let t=arguments[0],e=arguments[1];null===this._coordList&&(this._coordList=new O),this._coordList.add(t,e),this._lastPt=t}}setIgnoreInvalidLines(t){this._ignoreInvalidLines=t}validCoordinateSequence(t){return t.length>=2?t:[t[0],t[0]]}getClass(){return ko}get interfaces_(){return[]}}ko.constructor_=function(){this._geomFact=null,this._lines=new C,this._coordList=null,this._ignoreInvalidLines=!1,this._fixInvalidLines=!1,this._lastPt=null;let t=arguments[0];this._geomFact=t};class Go{constructor(){Go.constructor_.apply(this,arguments)}static extract(t,e,i){return new Go(t).extract(e,i)}computeLinear(t,e){var i=new ko(this._line.getFactory());i.setFixInvalidLines(!0),t.isVertex()||i.add(t.getCoordinate(this._line));for(var r=new Do(this._line,t);r.hasNext()&&!(e.compareLocationValues(r.getComponentIndex(),r.getVertexIndex(),0)<0);r.next()){var n=r.getSegmentStart();i.add(n),r.isEndOfLine()&&i.endLine()}return e.isVertex()||i.add(e.getCoordinate(this._line)),i.getGeometry()}computeLine(t,e){var i=this._line.getCoordinates(),r=new O,n=t.getSegmentIndex();t.getSegmentFraction()>0&&(n+=1);var s=e.getSegmentIndex();1===e.getSegmentFraction()&&(s+=1),s>=i.length&&(s=i.length-1),t.isVertex()||r.add(t.getCoordinate(this._line));for(var o=n;o<=s;o++)r.add(i[o]);e.isVertex()||r.add(e.getCoordinate(this._line)),r.size()<=0&&r.add(t.getCoordinate(this._line));var a=r.toCoordinateArray();return a.length<=1&&(a=[a[0],a[0]]),this._line.getFactory().createLineString(a)}extract(t,e){return e.compareTo(t)<0?this.reverse(this.computeLinear(e,t)):this.computeLinear(t,e)}reverse(t){return t instanceof Ft?t.reverse():t instanceof It?t.reverse():(m.shouldNeverReachHere("non-linear geometry encountered"),null)}getClass(){return Go}get interfaces_(){return[]}}Go.constructor_=function(){this._line=null;let t=arguments[0];this._line=t};class Uo{constructor(){Uo.constructor_.apply(this,arguments)}clampIndex(t){var e=t.copy();return e.clamp(this._linearGeom),e}project(t){return Fo.indexOf(this._linearGeom,t)}checkGeometryType(){if(!(this._linearGeom instanceof Ft||this._linearGeom instanceof It))throw new i("Input geometry must be linear")}extractPoint(){if(1===arguments.length)return arguments[0].getCoordinate(this._linearGeom);if(2===arguments.length){let e=arguments[0],i=arguments[1];var t=e.toLowest(this._linearGeom);return t.getSegment(this._linearGeom).pointAlongOffset(t.getSegmentFraction(),i)}}isValidIndex(t){return t.isValid(this._linearGeom)}getEndIndex(){return Mo.getEndLocation(this._linearGeom)}getStartIndex(){return new Mo}indexOfAfter(t,e){return Fo.indexOfAfter(this._linearGeom,t,e)}extractLine(t,e){return Go.extract(this._linearGeom,t,e)}indexOf(t){return Fo.indexOf(this._linearGeom,t)}indicesOf(t){return Bo.indicesOf(this._linearGeom,t)}getClass(){return Uo}get interfaces_(){return[]}}Uo.constructor_=function(){this._linearGeom=null;let t=arguments[0];this._linearGeom=t,this.checkGeometryType()};class Yo{constructor(){Yo.constructor_.apply(this,arguments)}static indexOf(t,e){return new Yo(t).indexOf(e)}static indexOfAfter(t,e,i){return new Yo(t).indexOfAfter(e,i)}indexOf(t){return this.indexOfFromStart(t,-1)}indexOfFromStart(t,e){for(var i=n.MAX_VALUE,r=e,s=0,o=new fe,a=new Do(this._linearGeom);a.hasNext();){if(!a.isEndOfLine()){o.p0=a.getSegmentStart(),o.p1=a.getSegmentEnd();var h=o.distance(t),l=this.segmentNearestMeasure(o,t,s);h<i&&l>e&&(r=l,i=h),s+=o.getLength()}a.next()}return r}indexOfAfter(t,e){if(e<0)return this.indexOf(t);var i=this._linearGeom.getLength();if(i<e)return i;var r=this.indexOfFromStart(t,e);return m.isTrue(r>=e,"computed index is before specified minimum index"),r}segmentNearestMeasure(t,e,i){var r=t.projectionFactor(e);return r<=0?i:r<=1?i+r*t.getLength():i+t.getLength()}getClass(){return Yo}get interfaces_(){return[]}}Yo.constructor_=function(){this._linearGeom=null;let t=arguments[0];this._linearGeom=t};class zo{constructor(){zo.constructor_.apply(this,arguments)}static getLength(t,e){return new zo(t).getLength(e)}static getLocation(){if(2===arguments.length){let t=arguments[0],e=arguments[1];return new zo(t).getLocation(e)}if(3===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2];return new zo(t).getLocation(e,i)}}getLength(t){for(var e=0,i=new Do(this._linearGeom);i.hasNext();){if(!i.isEndOfLine()){var r=i.getSegmentStart(),n=i.getSegmentEnd().distance(r);if(t.getComponentIndex()===i.getComponentIndex()&&t.getSegmentIndex()===i.getVertexIndex())return e+n*t.getSegmentFraction();e+=n}i.next()}return e}resolveHigher(t){if(!t.isEndpoint(this._linearGeom))return t;var e=t.getComponentIndex();if(e>=this._linearGeom.getNumGeometries()-1)return t;do{e++}while(e<this._linearGeom.getNumGeometries()-1&&0===this._linearGeom.getGeometryN(e).getLength());return new Mo(e,0,0)}getLocation(){if(1===arguments.length){let t=arguments[0];return this.getLocation(t,!0)}if(2===arguments.length){let i=arguments[0],r=arguments[1];var t=i;i<0&&(t=this._linearGeom.getLength()+i);var e=this.getLocationForward(t);return r?e:this.resolveHigher(e)}}getLocationForward(t){if(t<=0)return new Mo;for(var e=0,i=new Do(this._linearGeom);i.hasNext();){if(i.isEndOfLine()){if(e===t){var r=i.getComponentIndex(),n=i.getVertexIndex();return new Mo(r,n,0)}}else{var s=i.getSegmentStart(),o=i.getSegmentEnd().distance(s);if(e+o>t){var a=(t-e)/o;return r=i.getComponentIndex(),n=i.getVertexIndex(),new Mo(r,n,a)}e+=o}i.next()}return Mo.getEndLocation(this._linearGeom)}getClass(){return zo}get interfaces_(){return[]}}zo.constructor_=function(){this._linearGeom=null;let t=arguments[0];this._linearGeom=t};class Xo{constructor(){Xo.constructor_.apply(this,arguments)}clampIndex(t){var e=this.positiveIndex(t),i=this.getStartIndex();if(e<i)return i;var r=this.getEndIndex();return e>r?r:e}locationOf(){if(1===arguments.length){let t=arguments[0];return zo.getLocation(this._linearGeom,t)}if(2===arguments.length){let t=arguments[0],e=arguments[1];return zo.getLocation(this._linearGeom,t,e)}}project(t){return Yo.indexOf(this._linearGeom,t)}positiveIndex(t){return t>=0?t:this._linearGeom.getLength()+t}extractPoint(){if(1===arguments.length){let t=arguments[0];return zo.getLocation(this._linearGeom,t).getCoordinate(this._linearGeom)}if(2===arguments.length){let e=arguments[0],i=arguments[1];var t=zo.getLocation(this._linearGeom,e).toLowest(this._linearGeom);return t.getSegment(this._linearGeom).pointAlongOffset(t.getSegmentFraction(),i)}}isValidIndex(t){return t>=this.getStartIndex()&&t<=this.getEndIndex()}getEndIndex(){return this._linearGeom.getLength()}getStartIndex(){return 0}indexOfAfter(t,e){return Yo.indexOfAfter(this._linearGeom,t,e)}extractLine(t,e){new Uo(this._linearGeom);var i=this.clampIndex(t),r=this.clampIndex(e),n=i===r,s=this.locationOf(i,n),o=this.locationOf(r);return Go.extract(this._linearGeom,s,o)}indexOf(t){return Yo.indexOf(this._linearGeom,t)}indicesOf(t){var e=Bo.indicesOf(this._linearGeom,t);return[zo.getLength(this._linearGeom,e[0]),zo.getLength(this._linearGeom,e[1])]}getClass(){return Xo}get interfaces_(){return[]}}Xo.constructor_=function(){this._linearGeom=null;let t=arguments[0];this._linearGeom=t};var qo=Object.freeze({LengthIndexedLine:Xo,LengthLocationMap:zo,LinearGeometryBuilder:ko,LinearIterator:Do,LinearLocation:Mo,LocationIndexedLine:Uo});class Ho{get interfaces_(){return[]}getClass(){return Ho}static union(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return ns.createEmptyResult(ns.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),is.overlayOp(t,e,ns.UNION)}}V.prototype.equalsTopo=function(t){return!!this.getEnvelopeInternal().equals(t.getEnvelopeInternal())&&Cs.relate(this,t).isEquals(this.getDimension(),t.getDimension())},V.prototype.union=function(){if(0===arguments.length)return Rs.union(this);if(1===arguments.length){let t=arguments[0];return Ho.union(this,t)}},V.prototype.isValid=function(){return Us.isValid(this)},V.prototype.intersection=function(t){return ns.intersection(this,t)},V.prototype.covers=function(t){return Cs.covers(this,t)},V.prototype.coveredBy=function(t){return Cs.covers(t,this)},V.prototype.touches=function(t){return Cs.touches(this,t)},V.prototype.intersects=function(t){return Cs.intersects(this,t)},V.prototype.within=function(t){return Cs.contains(t,this)},V.prototype.overlaps=function(t){return Cs.overlaps(this,t)},V.prototype.disjoint=function(t){return Cs.disjoint(this,t)},V.prototype.crosses=function(t){return Cs.crosses(this,t)},V.prototype.buffer=function(){if(1===arguments.length){let t=arguments[0];return yn.bufferOp(this,t)}if(2===arguments.length){let t=arguments[0],e=arguments[1];return yn.bufferOp(this,t,e)}if(3===arguments.length){let t=arguments[0],e=arguments[1],i=arguments[2];return yn.bufferOp(this,t,e,i)}},V.prototype.convexHull=function(){return new ti(this).getConvexHull()},V.prototype.relate=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];if(1===arguments.length){let t=arguments[0];return Cs.relate(this,t)}if(2===arguments.length){let t=arguments[0],e=arguments[1];return Cs.relate(this,t).matches(e)}},V.prototype.getCentroid=function(){if(this.isEmpty())return this._factory.createPoint();var t=Ze.getCentroid(this);return this.createPointFromInternalCoord(t,this)},V.prototype.getInteriorPoint=function(){if(this.isEmpty())return this._factory.createPoint();var t=null,e=this.getDimension();return t=0===e?new si(this).getInteriorPoint():1===e?new ni(this).getInteriorPoint():new ii(this).getInteriorPoint(),this.createPointFromInternalCoord(t,this)},V.prototype.symDifference=function(t){return ns.symDifference(this,t)},V.prototype.createPointFromInternalCoord=function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)},V.prototype.toText=function(){return(new de).write(this)},V.prototype.toString=function(){this.toText()},V.prototype.contains=function(t){return Cs.contains(this,t)},V.prototype.difference=function(t){return ns.difference(this,t)},V.prototype.isSimple=function(){return new Gr(this).isSimple()},V.prototype.isWithinDistance=function(t,e){return!(this.getEnvelopeInternal().distance(t.getEnvelopeInternal())>e)&&In.isWithinDistance(this,t,e)},V.prototype.distance=function(t){return In.distance(this,t)},V.prototype.isEquivalentClass=function(t){return this.getClass()===t.getClass()},t.algorithm=li,t.densify=pi,t.dissolve=Ei,t.geom=xe,t.geomgraph=Hi,t.index=_r,t.io=wr,t.linearref=qo,t.noding=kr,t.operation=zs,t.precision=Hs,t.simplify=ho,t.triangulate=Ro,t.version="2.0.4 (c9e3376)",Object.defineProperty(t,"__esModule",{value:!0})}(e)},function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,i){(function(t,i){!function(e){"use strict";function r(t){var e=d.indexOf(t);-1<e&&d.splice(e,1),d.push(t),m=0,g&&!p&&(a=_(E),p=!0)}function n(t){for(var e=0;e<d.length;e++)if(t===d[e])return d[e];return null}function s(){return p}function o(){return v}var a,h="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:this||(void 0!==e?e:{}),l=h.requestAnimationFrame||function(t){return h.setTimeout(t,50/3)},u=h.cancelAnimationFrame||function(t){return h.clearTimeout(t)},c=function(){if(void 0===i||void 0===i.hrtime||i.versions&&void 0!==i.versions.electron){if(void 0!==h.performance&&void 0!==h.performance.now)return h.performance.now.bind(h.performance);var t=h.performance&&h.performance.timing&&h.performance.timing.navigationStart?h.performance.timing.navigationStart:Date.now();return function(){return Date.now()-t}}return function(){var t=i.hrtime();return 1e3*t[0]+t[1]/1e6}}(),d=[],p=!1,g=!1,f=[],_=l,m=0,y=120,v=!0,x=function(t){var e=d.indexOf(t);-1!==e&&d.splice(e,1),0===d.length&&(u(a),p=!1)},E=function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:c(),i=1<arguments.length?arguments[1]:void 0;if(y<=m&&v)return p=!1,m=0,u(a),!1;g&&p?a=_(t):function(){for(var t=0;t<f.length;t++)f[t]()}(),d.length||m++;for(var r=0,n=d.length;r<n;)d[r++].update(e,i),n>d.length&&r--,n=d.length;return!0},w={},b={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return Math.pow(t,2)},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*Math.pow(t,2):-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return Math.pow(t,3)},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*Math.pow(t,3):.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return Math.pow(t,4)},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*Math.pow(t,4):-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return Math.pow(t,5)},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*Math.pow(t,5):.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1}},Back:{In:function(t){return t*t*(2.70158*t-1.70158)},Out:function(t){return--t*t*(2.70158*t+1.70158)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((1+e)*t-e)*.5:.5*((t-=2)*t*((1+e)*t+e)+2)}},Bounce:{In:function(t){return 1-b.Bounce.Out(1-t)},Out:function(t){var e=2.75,i=7.5625;return t<1/e?i*t*t:t<2/e?i*(t-=1.5/e)*t+.75:t<2.5/e?i*(t-=2.25/e)*t+.9375:i*(t-=2.625/e)*t+.984375},InOut:function(t){return t<.5?.5*b.Bounce.In(2*t):.5*b.Bounce.Out(2*t-1)+.5}},Stepped:{steps:function(t){return function(e){return(e*t|0)/t}}}};function I(t){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function T(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function S(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function C(t,e,i){return e&&S(t.prototype,e),i&&S(t,i),t}function N(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},r=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),r.forEach(function(e){var r,n,s;r=t,s=i[n=e],n in r?Object.defineProperty(r,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):r[n]=s})}return t}function O(t){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function P(t,e){return(P=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function L(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function A(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?L(t):e}function R(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=[],r=!0,n=!1,s=void 0;try{for(var o,a=t[Symbol.iterator]();!(r=(o=a.next()).done)&&(i.push(o.value),!e||i.length!==e);r=!0);}catch(t){n=!0,s=t}finally{try{r||null==a.return||a.return()}finally{if(n)throw s}}return i}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var M=50/3,D="_chainedTweens",F="Callback",B="update",k="complete",G="start",U="repeat",Y="reverse",z="restart",X="STRING_PROP",q=/\s+|([A-Za-z?().,{}:""[\]#%]+)|([-+]=+)?([-+]+)?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]=?\d+)?/g;function H(t){if(t&&t.nodeType||void 0===t||"object"!==I(t))return t;if(Array.isArray(t))return[].concat(t);if("object"!==I(t))return t;var e={};for(var i in t)e[i]=H(t[i]);return e}var V=function(t){return isNaN(+t)||("+"===t[0]||"-"===t[0])&&"="===t[1]||""===t||" "===t},j=/^#([0-9a-f]{6}|[0-9a-f]{3})$/gi,W=function(t,e){var i,r,n;3===e.length&&(e=(i=e[0])+i+(r=e[1])+r+(n=e[2])+n);var s=parseInt(e,16);return"rgb("+(i=s>>16&255)+", "+(r=s>>8&255)+", "+(n=255&s)+")"};function K(t){if(t&&t.splice&&t.isString)return t;if("string"!=typeof t)return t;if("="===t.charAt(1))return t;var e=t.replace(j,W).match(q).map(function(t){return V(t)?t:+t});return e.isString=!0,e}function Z(t,e,i,r){var n=i[t],s=r[t];if(n===s)return!0;if(Array.isArray(n)&&Array.isArray(s)&&n.length===s.length)for(var o=0,a=s.length;o<a;o++){var h=n[o],l=s[o];h===l||"number"==typeof h&&"number"==typeof l||Z(o,e[t],n,s)}if("number"==typeof n&&"number"==typeof s);else if(n&&n.splice&&n.isString&&s&&s.splice&&s.isString);else{if("string"==typeof n&&Array.isArray(s)){var u=K(n),c=s.map(K);return i[t]=u,r[t]=c,!0}if("string"==typeof n||"string"==typeof s){var d=Array.isArray(n)&&n[0]===X?n:K(n),p=Array.isArray(s)&&s[0]===X?s:K(s);if(void 0===d)return;for(var g=1;g<d.length;)d[g]===p[g]&&"string"==typeof d[g-1]?(d.splice(g-1,2,d[g-1]+d[g]),p.splice(g-1,2,p[g-1]+p[g])):g++;return d[g=0]===X&&d.shift(),p[0]===X&&p.shift(),i[t]=d,r[t]=p,!0}if("object"===I(n)&&"object"===I(s)){if(Array.isArray(n)&&!n.isString)return n.map(function(i,r){return Z(r,e[t],n,s)});for(var f in s)Z(f,e[t],n,s);return!0}}return!1}var J="rgba(",Q=function(t,e){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"rgb(";return"number"==typeof t[e]&&(t[e-1]===i||t[e-3]===i||t[e-5]===i)};function $(t,e,i,r,n,s,o){var a=o?i:i[t],h=o?r:r[t];if(void 0===h)return a;if(void 0===a||"string"==typeof a||a===h)return h;if("object"===I(a)&&"object"===I(h)){if(!a||!h)return e[t];if("object"===I(a)&&a&&a.isString&&h&&h.splice&&h.isString){for(var l="",u=0,c=a.length;u<c;u++)if(a[u]!==h[u]||"number"!=typeof a[u]||"number"==typeof h[u]){var d="number"==typeof a[u]&&"string"==typeof h[u]&&"="===h[u][1],p="number"!=typeof a[u]?a[u]:d?a[u]+parseFloat(h[u][0]+h[u].substr(2))*n:a[u]+(h[u]-a[u])*n;(Q(a,u)||Q(a,u,J))&&(p|=0),l+=p,d&&1===s&&(a[u]=a[u]+parseFloat(h[u][0]+h[u].substr(2)))}else l+=a[u];return o||(e[t]=l),l}if(Array.isArray(a)&&a[0]!==X)for(var g=0,f=a.length;g<f;g++)a[g]!==h[g]&&"string"!=typeof e[t]&&$(g,e[t],a,h,n,s);else if("object"===I(a)&&a&&!a.isString)for(var _ in a)a[_]!==h[_]&&$(_,e[t],a,h,n,s)}else if("number"==typeof a){var m="string"==typeof h;e[t]=m?a+parseFloat(h[0]+h.substr(2))*n:a+(h-a)*n,m&&1===s&&(i[t]=e[t])}else"function"==typeof h&&(e[t]=h(n));return e[t]}function tt(t,e){var i=t[e],r=e.replace(nt,"").split(rt),n=r.length-1,s=Array.isArray(t),o="object"===I(t)&&!s;return o?(t[e]=null,delete t[e]):s&&t.splice(e,1),r.reduce(function(t,e,a){s&&"."!==e&&"["!==e&&(e*=1);var h="["===r[a+1];if("."===e||"["===e)return"."===e?s=!(o=!0):"["===e&&(s=!(o=!1)),t;if(void 0===t[e]){if(s||o)return t[e]=a===n?i:s||h?[]:o?{}:null,o=s=!1,t[e]}else if(void 0!==t[e])return a===n&&(t[e]=i),t[e];return t},t)}function et(t){if("object"===I(t)&&t)for(var e in t)if(-1!==e.indexOf(".")||-1!==e.indexOf("["))tt(t,e);else if("object"===I(t[e])&&t[e]){var i=t[e];for(var r in i)if(-1!==r.indexOf(".")||-1!==r.indexOf("["))tt(i,r);else if("object"===I(i[r])&&i[r]){var n=i[r];for(var s in n)-1===s.indexOf(".")&&-1===s.indexOf("[")||tt(n,s)}}return t}var it,rt=/([.[])/g,nt=/\]/g,st=Object.freeze({FRAME_MS:M,TOO_LONG_FRAME_MS:250,CHAINED_TWEENS:D,EVENT_CALLBACK:F,EVENT_UPDATE:B,EVENT_COMPLETE:k,EVENT_START:G,EVENT_REPEAT:U,EVENT_REVERSE:Y,EVENT_PAUSE:"pause",EVENT_PLAY:"play",EVENT_RESTART:z,EVENT_STOP:"stop",EVENT_SEEK:"seek",STRING_PROP:X,NUM_REGEX:q,deepCopy:H,decomposeString:K,decompose:Z,RGB:"rgb(",RGBA:J,isRGBColor:Q,recompose:$,SET_NESTED:et}),ot={Linear:function(t,e,i){var r=t.length-1,n=r*e,s=Math.floor(n),o=ot.Utils.Linear;return e<0?o(t[0],t[1],n,i):1<e?o(t[r],t[r-1],r-n,i):o(t[s],t[r<s+1?r:s+1],n-s,i)},Bezier:function(t,e,i){for(var r=ot.Utils.Reset(i),n=t.length-1,s=Math.pow,o=ot.Utils.Bernstein,a=Array.isArray(r),h=0;h<=n;h++)if("number"==typeof r)r+=s(1-e,n-h)*s(e,h)*t[h]*o(n,h);else if(a)for(var l=0,u=r.length;l<u;l++)"number"==typeof r[l]?r[l]+=s(1-e,n-h)*s(e,h)*t[h][l]*o(n,h):r[l]=t[h][l];else if("object"===I(r))for(var c in r)"number"==typeof r[c]?r[c]+=s(1-e,n-h)*s(e,h)*t[h][c]*o(n,h):r[c]=t[h][c];else if("string"==typeof r){for(var d="",p=t[Math.round(n*e)],g=1,f=p.length;g<f;g++)d+=p[g];return d}return r},CatmullRom:function(t,e,i){var r=t.length-1,n=r*e,s=Math.floor(n),o=ot.Utils.CatmullRom;return t[0]===t[r]?(e<0&&(s=Math.floor(n=r*(1+e))),o(t[(s-1+r)%r],t[s],t[(s+1)%r],t[(s+2)%r],n-s,i)):e<0?o(t[1],t[1],t[0],t[0],-e,i):1<e?o(t[r-1],t[r-1],t[r],t[r],(0|e)-e,i):o(t[s?s-1:0],t[s],t[r<s+1?r:s+1],t[r<s+2?r:s+2],n-s,i)},Utils:{Linear:function(t,e,i,r){if(t===e||"string"==typeof t){if(e.length&&e.splice&&e.isString){e="";for(var n=0,s=t.length;n<s;n++)e+=t[n]}return e}if("number"==typeof t)return"function"==typeof t?t(i):t+(e-t)*i;if("object"===I(t)){if(void 0!==t.length){var o="string"==typeof t[0]||t.isString;if(o||t[0]===X){for(var a="",h=o?0:1,l=t.length;h<l;h++){var u=0===i?t[h]:1===i?e[h]:"number"==typeof t[h]?t[h]+(e[h]-t[h])*i:e[h];(0<i&&i<1&&Q(t,h)||Q(t,h,J))&&(u|=0),a+=u}return a}if(r&&r.length&&r.splice)for(var c=0,d=r.length;c<d;c++)r[c]=ot.Utils.Linear(t[c],e[c],i,r[c])}else for(var p in r)r[p]=ot.Utils.Linear(t[p],e[p],i,r[p]);return r}},Reset:function(t){if(Array.isArray(t)){for(var e=0,i=t.length;e<i;e++)t[e]=ot.Utils.Reset(t[e]);return t}if("object"!==I(t))return"number"==typeof t?0:t;for(var r in t)t[r]=ot.Utils.Reset(t[r]);return t},Bernstein:function(t,e){var i=ot.Utils.Factorial;return i(t)/i(e)/i(t-e)},Factorial:(it=[1],function(t){var e=1;if(it[t])return it[t];for(var i=t;1<i;i--)e*=i;return it[t]=e}),CatmullRom:function(t,e,i,r,n,s){if("string"==typeof t)return e;if("number"==typeof t){var o=.5*(i-t),a=.5*(r-e),h=n*n;return(2*e-2*i+o+a)*(n*h)+(-3*e+3*i-2*o-a)*h+o*n+e}if("object"===I(t)){if(void 0!==t.length){if(t[0]===X){for(var l="",u=1,c=t.length;u<c;u++){var d="number"==typeof t[u]?ot.Utils.CatmullRom(t[u],e[u],i[u],r[u],n):r[u];(Q(t,u)||Q(t,u,J))&&(d|=0),l+=d}return l}for(var p=0,g=s.length;p<g;p++)s[p]=ot.Utils.CatmullRom(t[p],e[p],i[p],r[p],n,s[p])}else for(var f in s)s[f]=ot.Utils.CatmullRom(t[f],e[f],i[f],r[f],n,s[f]);return s}}}},at={};function ht(t,e,i){if(!t||!t.nodeType)return e;var r=t.queueID||"q_"+Date.now();t.queueID||(t.queueID=r);var n=at[r];if(n){if(n.object===e&&t===n.tween.node&&i._startTime===n.tween._startTime)x(n.tween);else if("object"===I(e)&&e&&n.object){for(var s in e)s in n.object&&(i._startTime===n.tween._startTime?delete n.object[s]:n.propNormaliseRequired=!0);Object.assign(n.object,e)}return n.object}return"object"===I(e)&&e?(at[r]={tween:i,object:e,propNormaliseRequired:!1},at[r].object):e}function lt(t,e,i){return e?t?"undefined"!=typeof window&&t===window||"undefined"!=typeof document&&t===document?[t]:"string"==typeof t?!!document.querySelectorAll&&document.querySelectorAll(t):Array.isArray(t)?t:t.nodeType?[t]:i?t:[]:null:t?"undefined"!=typeof window&&t===window||"undefined"!=typeof document&&t===document?t:"string"==typeof t?!!document.querySelector&&document.querySelector(t):Array.isArray(t)?t[0]:t.nodeType?t:i?t:null:null}var ut=0,ct=b.Linear.None,dt=function(){function t(e,i){return T(this,t),this.id=ut++,!e||"object"!==I(e)||i||e.nodeType?e&&(e.nodeType||e.length||"string"==typeof e)&&(e=this.node=lt(e),i=this.object=ht(e,i,this)):(i=this.object=e,e=null),this._valuesEnd=null,this._valuesStart=Array.isArray(i)?[]:{},this._duration=1e3,this._easingFunction=ct,this._easingReverse=ct,this._interpolationFunction=ot.Linear,this._startTime=0,this._initTime=0,this._delayTime=0,this._repeat=0,this._r=0,this._isPlaying=!1,this._yoyo=!1,this._reversed=!1,this._onStartCallbackFired=!1,this._pausedTime=null,this._isFinite=!0,this._maxListener=15,this._chainedTweensCount=0,this._prevTime=null,this}return C(t,null,[{key:"fromTo",value:function(e,i,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};n.quickRender=n.quickRender?n.quickRender:!r;var s=new t(e,i).to(r,n);return n.quickRender&&(s.render().update(s._startTime),s._rendered=!1,s._onStartCallbackFired=!1),s}},{key:"to",value:function(e,i,r){return t.fromTo(e,null,i,r)}},{key:"from",value:function(e,i,r){return t.fromTo(e,i,null,r)}}]),C(t,[{key:"setMaxListener",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:15;return this._maxListener=t,this}},{key:"on",value:function(t,e){for(var i=this._maxListener,r=t+F,n=0;n<i;n++){var s=r+n;if(!this[s]){this[s]=e;break}}return this}},{key:"once",value:function(t,e){for(var i=this,r=this._maxListener,n=t+F,s=function(t){var r=n+t;if(!i[r])return i[r]=function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];e.apply(i,n),i[r]=null},"break"},o=0;o<r&&"break"!==s(o);o++);return this}},{key:"off",value:function(t,e){for(var i=this._maxListener,r=t+F,n=0;n<i;n++){var s=r+n;this[s]===e&&(this[s]=null)}return this}},{key:"emit",value:function(t,e,i,r){var n=this._maxListener,s=t+F;if(!this[s+0])return this;for(var o=0;o<n;o++){var a=s+o;this[a]&&this[a](e,i,r)}return this}},{key:"isPlaying",value:function(){return this._isPlaying}},{key:"isStarted",value:function(){return this._onStartCallbackFired}},{key:"reverse",value:function(t){var e=this._reversed;return this._reversed=void 0!==t?t:!e,this}},{key:"reversed",value:function(){return this._reversed}},{key:"pause",value:function(){return this._isPlaying?(this._isPlaying=!1,x(this),this._pausedTime=c(),this.emit("pause",this.object)):this}},{key:"play",value:function(){return this._isPlaying?this:(this._isPlaying=!0,this._startTime+=c()-this._pausedTime,this._initTime=this._startTime,r(this),this._pausedTime=c(),this.emit("play",this.object))}},{key:"restart",value:function(t){return this._repeat=this._r,this.reassignValues(),r(this),this.emit(z,this.object)}},{key:"seek",value:function(t,e){var i=this._duration,r=this._initTime,n=this._startTime,s=this._reversed,o=r+t;return this._isPlaying=!0,o<n&&r<=n&&(this._startTime-=i,this._reversed=!s),this.update(t,!1),this.emit("seek",t,this.object),e?this:this.pause()}},{key:"duration",value:function(t){return this._duration="function"==typeof t?t(this._duration):t,this}},{key:"to",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1e3;if(this._valuesEnd=t,"number"==typeof e||"function"==typeof e)this._duration="function"==typeof e?e(this._duration):e;else if("object"===I(e))for(var i in e)if("function"==typeof this[i]){var r=R(Array.isArray(e[i])?e[i]:[e[i]],4),n=r[0],s=void 0===n?null:n,o=r[1],a=void 0===o?null:o,h=r[2],l=void 0===h?null:h,u=r[3],c=void 0===u?null:u;this[i](s,a,l,c)}return this}},{key:"render",value:function(){if(this._rendered)return this;var e=this._valuesStart,i=this._valuesEnd,r=this.object,n=this.node,s=this.InitialValues;if(et(r),et(i),n&&n.queueID&&at[n.queueID]){var o=at[n.queueID];if(o.propNormaliseRequired&&o.tween!==this){for(var a in i)o.tween._valuesEnd[a];o.normalisedProp=!0,o.propNormaliseRequired=!1}}if(n&&s&&(r&&0!==Object.keys(r).length?i&&0!==Object.keys(i).length||(i=this._valuesEnd=s(n,r)):r=this.object=ht(n,s(n,i),this)),!e.processed){for(var h in i){var l=r&&r[h]&&H(r[h]),u=i[h];if(!(w[h]&&w[h].init&&(w[h].init.call(this,l,u,h,r),void 0===l&&e[h]&&(l=e[h]),w[h].skipProcess)||"number"==typeof l&&isNaN(l)||null===l||null===u||!1===l||!1===u||void 0===l||void 0===u||l===u)){if(e[h]=l,Array.isArray(u))if(Array.isArray(l))u.isString&&r[h].isString&&!l.isString?l.isString=!0:Z(h,r,e,i);else{u.unshift(l);for(var c=0,d=u.length;c<d;c++)"string"==typeof u[c]&&(u[c]=K(u[c]))}else Z(h,r,e,i);"number"!=typeof l||"string"!=typeof u||u[1]}}e.processed=!0}return t.Renderer&&this.node&&t.Renderer.init&&(t.Renderer.init.call(this,r,e,i),this.__render=!0),this._rendered=!0,this}},{key:"start",value:function(t){return this._startTime=void 0!==t?"string"==typeof t?c()+parseFloat(t):t:c(),this._startTime+=this._delayTime,this._initTime=this._prevTime=this._startTime,this._onStartCallbackFired=!1,this._rendered=!1,this._isPlaying=!0,r(this),this}},{key:"stop",value:function(){var t=this._isPlaying,e=this._isFinite,i=this.object,r=this._startTime,n=this._duration,s=this._r,o=this._yoyo,a=this._reversed;if(!t)return this;var h=e?(s+1)%2==1:!a;return this._reversed=!1,o&&h?this.update(r):this.update(r+n),x(this),this.emit("stop",i)}},{key:"delay",value:function(t){return this._delayTime="function"==typeof t?t(this._delayTime):t,this}},{key:"chainedTweens",value:function(){if(this._chainedTweensCount=arguments.length,!this._chainedTweensCount)return this;for(var t=0,e=this._chainedTweensCount;t<e;t++)this[D+t]=arguments[t];return this}},{key:"repeat",value:function(t){return this._repeat=this._duration?"function"==typeof t?t(this._repeat):t:0,this._r=this._repeat,this._isFinite=isFinite(t),this}},{key:"reverseDelay",value:function(t){return this._reverseDelayTime="function"==typeof t?t(this._reverseDelayTime):t,this}},{key:"yoyo",value:function(t,e){return this._yoyo="function"==typeof t?t(this._yoyo):null===t?this._yoyo:t,t||(this._reversed=!1),this._easingReverse=e||null,this}},{key:"easing",value:function(t){return this._easingFunction=t,this}},{key:"interpolation",value:function(t){return"function"==typeof t&&(this._interpolationFunction=t),this}},{key:"reassignValues",value:function(t){var e=this._valuesStart,i=this.object,n=this._delayTime;for(var s in this._isPlaying=!0,this._startTime=void 0!==t?t:c(),this._startTime+=n,this._reversed=!1,r(this),e){var o=e[s];i[s]=o}return this}},{key:"update",value:function(e,i,r){var n,a,h,l=this._onStartCallbackFired,u=this._easingFunction,d=this._interpolationFunction,p=this._easingReverse,g=this._repeat,f=this._delayTime,_=this._reverseDelayTime,m=this._yoyo,y=this._reversed,v=this._startTime,E=this._prevTime,b=this._duration,I=this._valuesStart,T=this._valuesEnd,S=this.object,C=this._isFinite,N=this._isPlaying,O=this.__render,P=this._chainedTweensCount,L=0;if(b){var A=(e=void 0!==e?e:c())-E;if(this._prevTime=e,250<A&&s()&&o()&&(e-=A-M),!N||e<v&&!r)return!0;n=1<(n=(e-v)/b)?1:n,n=y?1-n:n}else n=1,g=0;if(l||(this._rendered||(this.render(),this._rendered=!0),this.emit(G,S),this._onStartCallbackFired=!0),a=y&&p||u,!S)return!0;for(h in T){var R=I[h];if(null!=R||w[h]&&w[h].update){var F=T[h],z=a[h]?a[h](n):"function"==typeof a?a(n):ct(n),X=d[h]?d[h]:"function"==typeof d?d:ot.Linear;"number"==typeof F?S[h]=R+(F-R)*z:!Array.isArray(F)||F.isString||Array.isArray(R)?F&&F.update?F.update(z):"function"==typeof F?S[h]=F(z):"string"==typeof F&&"number"==typeof R?S[h]=R+parseFloat(F[0]+F.substr(2))*z:$(h,S,I,T,z,n):S[h]=X(F,z,S[h]),w[h]&&w[h].update&&w[h].update.call(this,S[h],R,F,z,n,h),L++}}if(!L)return x(this),!1;if(O&&t.Renderer&&t.Renderer.update&&t.Renderer.update.call(this,S,n),this.emit(B,S,n,e),1===n||y&&0===n){if(0<g&&0<b){if(C&&this._repeat--,m)this._reversed=!y;else for(h in T){var q=T[h];"string"==typeof q&&"number"==typeof I[h]&&(I[h]+=parseFloat(q[0]+q.substr(2)))}return this.emit(m&&!y?Y:U,S),this._startTime=y&&_?e-_:e+f,!0}if(i||(this._isPlaying=!1,x(this),ut--),this.emit(k,S),this._repeat=this._r,P)for(var H=0;H<P;H++)this[D+H].start(e+b);return!1}return!0}}]),t}(),pt=function(){function t(){T(this,t),this.totalTime=0,this.labels=[],this.offsets=[]}return C(t,[{key:"parseLabel",value:function(t,e){var i=this.offsets,r=this.labels,n=r.indexOf(t);if("string"==typeof t&&-1!==t.indexOf("=")&&!e&&-1===n){var s=t.substr(t.indexOf("=")-1,2),o=t.split(s);e=2===o.length?s+o[1]:null,t=o[0],n=r.indexOf(t)}if(-1!==n&&t){var a=i[n]||0;if("number"==typeof e)a=e;else if("string"==typeof e&&-1!==e.indexOf("=")){var h=e.charAt(0);e=Number(e.substr(2)),"+"===h||"-"===h?a+=parseFloat(h+e):"*"===h?a*=e:"/"===h?a/=e:"%"===h&&(a*=e/100)}return a}return"number"==typeof e?e:0}},{key:"addLabel",value:function(t,e){return this.labels.push(t),this.offsets.push(this.parseLabel(t,e)),this}},{key:"setLabel",value:function(t,e){var i=this.labels.indexOf(t);return-1!==i&&this.offsets.splice(i,1,this.parseLabel(t,e)),this}},{key:"eraseLabel",value:function(t){var e=this.labels.indexOf(t);return-1!==e&&(this.labels.splice(e,1),this.offsets.splice(e,1)),this}}]),t}(),gt=0,ft=function(t){function e(t){var i;return T(this,e),(i=A(this,O(e).call(this)))._duration=0,i._startTime=t&&void 0!==t.startTime?t.startTime:c(),i._tweens=[],i.elapsed=0,i._id=gt++,i._defaultParams=t,i.position=new pt,i.position.addLabel("afterLast",i._duration),i.position.addLabel("afterInit",i._startTime),i._onStartCallbackFired=!1,A(i,L(i))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&P(t,e)}(e,dt),C(e,[{key:"mapTotal",value:function(t){return t.call(this,this._tweens),this}},{key:"timingOrder",value:function(t){var e=t(this._tweens.map(function(t){return t._startTime}));return this._tweens.map(function(t,i){t._startTime=e[i]}),this}},{key:"getTiming",value:function(t,e,i){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;if("reverse"===t){var n=i.stagger,s=(n||0)*(e.length-1);return e.map(function(t,e){return s-(n||0)*e+r})}if("async"===t)return e.map(function(t){return r});if("sequence"===t||"delayed"===t){var o=i.stagger;return o||(o=(i.duration||1e3)/(e.length-1)),e.map(function(t,e){return o*e+r})}if("oneByOne"===t)return e.map(function(t){return i.duration});if("shuffle"===t){var a=i.stagger;return function(t){var e,i,r;for(r=t.length;r;r-=1)e=Math.floor(Math.random()*r),i=t[r-1],t[r-1]=t[e],t[e]=i;return t}(e.map(function(t,e){return(a||0)*e+r}))}var h=i.stagger;return e.map(function(t,e){return(h||0)*e+r})}},{key:"fromTo",value:function(t,e,i,r){if((t=lt(t,!0,!0))&&t.length){this._defaultParams&&(r=r?N({},this._defaultParams,r):this._defaultParams);for(var n,s=r.label,o="number"==typeof s?s:this.position.parseLabel(void 0!==s?s:"afterLast",null),a=this.getTiming(r.mode,t,r,o),h=0,l=t.length;h<l;h++)n=t[h],this.add(dt.fromTo(n,"function"==typeof e?e(h,t.length):"object"===I(e)&&e?N({},e):null,"function"==typeof i?i(h,t.length):i,"function"==typeof r?r(h,t.length):r),a[h])}return this.start()}},{key:"from",value:function(t,e,i){return this.fromTo(t,e,null,i)}},{key:"to",value:function(t,e,i){return this.fromTo(t,null,e,i)}},{key:"addLabel",value:function(t,e){return this.position.addLabel(t,e),this}},{key:"map",value:function(t){for(var e=0,i=this._tweens.length;e<i;e++){var r=this._tweens[e];t(r,e),this._duration=Math.max(this._duration,r._duration+r._startTime)}return this}},{key:"add",value:function(t,e){var i=this;if(Array.isArray(t))return t.map(function(t){i.add(t,e)}),this;"object"!==I(t)||t instanceof dt||(t=new dt(t.from).to(t.to,t));var r=this._defaultParams,n=this._duration;if(r)for(var s in r)"function"==typeof t[s]&&t[s](r[s]);var o="number"==typeof e?e:this.position.parseLabel(void 0!==e?e:"afterLast",null);return t._startTime=Math.max(this._startTime,t._delayTime,o),t._delayTime=o,t._isPlaying=!0,this._duration=Math.max(n,Math.max(t._startTime+t._delayTime,t._duration)),this._tweens.push(t),this.position.setLabel("afterLast",this._duration),this}},{key:"restart",value:function(){return this._startTime+=c(),r(this),this.emit(z)}},{key:"easing",value:function(t){return this.map(function(e){return e.easing(t)})}},{key:"interpolation",value:function(t){return this.map(function(e){return e.interpolation(t)})}},{key:"update",value:function(t){var e,i=this._tweens,r=this._duration,n=this._reverseDelayTime,a=this._startTime,h=this._reversed,l=this._yoyo,u=this._repeat,d=this._isFinite,p=this._isPlaying,g=this._prevTime,f=this._onStartCallbackFired,_=(t=void 0!==t?t:c())-g;if(this._prevTime=t,250<_&&s()&&o()&&(t-=_-M),!p||t<a)return!0;e=1<(e=(t-a)/r)?1:e,e=h?1-e:e,this.elapsed=e,f||(this.emit(G),this._onStartCallbackFired=!0);for(var m=t-a,y=h?r-m:m,v=0;v<i.length;)i[v].update(y),v++;if(this.emit(B,e,m),1===e||h&&0===e){if(u){for(d&&this._repeat--,this.emit(h?Y:U),l&&(this._reversed=!h,this.timingOrder(function(t){return t.reverse()})),this._startTime=h&&n?t+n:t,v=0;v<i.length;)i[v].reassignValues(t),v++;return!0}return this.emit(k),this._repeat=this._r,x(this),this._isPlaying=!1}return!0}},{key:"progress",value:function(t){return void 0!==t?this.update(t*this._duration):this.elapsed}}]),e}();e.Easing=b,e.FrameThrottle=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:120;y=1.05*t},e.Interpolation=ot,e.Interpolator=function(t,e){var i=Array.isArray(t)&&!t.isString,r="string"==typeof t?t:i?t.slice():N({},t);if(i)for(var n=0,s=t.length;n<s;n++)t[n]===e[n]&&"number"==typeof t[n]&&"number"!=typeof e[n]||Z(n,r,t,e);else if("object"===I(t))for(var o in t)t[o]===e[o]&&"number"==typeof t[o]&&"number"!=typeof e[o]||Z(o,r,t,e);else if("string"==typeof t){t=K(t),e=K(e);for(var a=1;a<t.length;)t[a]===e[a]&&"string"==typeof t[a-1]?(t.splice(a-1,2,t[a-1]+t[a]),e.splice(a-1,2,e[a-1]+e[a])):a++}return function(n){if(i)for(var s=0,o=t.length;s<o;s++)$(s,r,t,e,n);else if("object"===I(r))for(var a in t)$(a,r,t,e,n);else"string"==typeof r&&(r=$(0,0,t,e,n,n,!0));return r}},e.Plugins=w,e.Selector=lt,e.Timeline=ft,e.ToggleLagSmoothing=function(){var t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];v=t},e.Tween=dt,e.add=r,e.autoPlay=function(t){g=t},e.get=n,e.getAll=function(){return d},e.has=function(t){return null!==n(t)},e.isRunning=s,e.now=c,e.onRequestTick=function(t){f.push(t)},e.onTick=function(t){return d.push({update:t})},e.remove=x,e.removeAll=function(){d.length=0,u(a),p=!1},e.update=E,e.utils=st,Object.defineProperty(e,"__esModule",{value:!0})}(e)}).call(this,i(3),i(9))},function(t,e){class i{constructor(t){this.article=t}update(){}AABBs(t){var e=this.AABB;return!(t[2]<e[0]||e[2]<t[0]||t[3]<e[1]||e[3]<t[1])}collidesPoint(t){const e=this.vertices,i=e.length;let r=!1;for(let n=0,s=i-2;n<i;n+=2)e[n+1]>t.y!=e[s+1]>t.y&&t.x<(e[s]-e[n])*(t.y-e[n+1])/(e[s+1]-e[n+1])+e[n]&&(r=!r),s=n;return r}collidesCircle(){}collidesRectangle(){}collidesPolygon(t,e){const i=this.vertices,r=e?t:t.vertices,n=[i,r];let s,o,a,h,l;for(let t=0;t<n.length;t++){const e=n[t];for(let t=0;t<e.length;t+=2){var u=(t+2)%e.length,c={x:e[u+1]-e[t+1],y:e[t]-e[u]};s=o=null;for(let t=0;t<i.length;t+=2)a=c.x*i[t]+c.y*i[t+1],(null===s||a<s)&&(s=a),(null===o||a>o)&&(o=a);h=l=null;for(let t=0;t<r.length;t+=2)a=c.x*r[t]+c.y*r[t+1],(null===h||a<h)&&(h=a),(null===l||a>l)&&(l=a);if(o<h||l<s)return!1}}return!0}collidesLine(t,e){const r=this.vertices,n=r.length;if(this.collidesPoint(t))return!0;for(let s=0;s<n;s+=2){const o=(s+2)%n;if(i.lineLine(t,e,{x:r[s],y:r[s+1]},{x:r[o],y:r[o+1]}))return!0}return!1}collides(t){return this["collides"+t.SHAPE](t)}static lineLine(t,e,i,r){const n=t.x,s=t.y,o=e.x,a=e.y,h=i.x,l=i.y,u=o-n,c=a-s,d=r.x-h,p=r.y-l,g=(-c*(n-h)+u*(s-l))/(-d*c+u*p),f=(d*(s-l)-p*(n-h))/(-d*c+u*p);return g>=0&&g<=1&&f>=0&&f<=1}}t.exports=i},function(t,e,i){"use strict";var r=i(29),n=i(31);function s(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}e.parse=v,e.resolve=function(t,e){return v(t,!1,!0).resolve(e)},e.resolveObject=function(t,e){return t?v(t,!1,!0).resolveObject(e):e},e.format=function(t){n.isString(t)&&(t=v(t));return t instanceof s?t.format():s.prototype.format.call(t)},e.Url=s;var o=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,h=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,l=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),u=["'"].concat(l),c=["%","/","?",";","#"].concat(u),d=["/","?","#"],p=/^[+a-z0-9A-Z_-]{0,63}$/,g=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,f={javascript:!0,"javascript:":!0},_={javascript:!0,"javascript:":!0},m={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},y=i(32);function v(t,e,i){if(t&&n.isObject(t)&&t instanceof s)return t;var r=new s;return r.parse(t,e,i),r}s.prototype.parse=function(t,e,i){if(!n.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var s=t.indexOf("?"),a=-1!==s&&s<t.indexOf("#")?"?":"#",l=t.split(a);l[0]=l[0].replace(/\\/g,"/");var v=t=l.join(a);if(v=v.trim(),!i&&1===t.split("#").length){var x=h.exec(v);if(x)return this.path=v,this.href=v,this.pathname=x[1],x[2]?(this.search=x[2],this.query=e?y.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var E=o.exec(v);if(E){var w=(E=E[0]).toLowerCase();this.protocol=w,v=v.substr(E.length)}if(i||E||v.match(/^\/\/[^@\/]+@[^@\/]+/)){var b="//"===v.substr(0,2);!b||E&&_[E]||(v=v.substr(2),this.slashes=!0)}if(!_[E]&&(b||E&&!m[E])){for(var I,T,S=-1,C=0;C<d.length;C++){-1!==(N=v.indexOf(d[C]))&&(-1===S||N<S)&&(S=N)}-1!==(T=-1===S?v.lastIndexOf("@"):v.lastIndexOf("@",S))&&(I=v.slice(0,T),v=v.slice(T+1),this.auth=decodeURIComponent(I)),S=-1;for(C=0;C<c.length;C++){var N;-1!==(N=v.indexOf(c[C]))&&(-1===S||N<S)&&(S=N)}-1===S&&(S=v.length),this.host=v.slice(0,S),v=v.slice(S),this.parseHost(),this.hostname=this.hostname||"";var O="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!O)for(var P=this.hostname.split(/\./),L=(C=0,P.length);C<L;C++){var A=P[C];if(A&&!A.match(p)){for(var R="",M=0,D=A.length;M<D;M++)A.charCodeAt(M)>127?R+="x":R+=A[M];if(!R.match(p)){var F=P.slice(0,C),B=P.slice(C+1),k=A.match(g);k&&(F.push(k[1]),B.unshift(k[2])),B.length&&(v="/"+B.join(".")+v),this.hostname=F.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),O||(this.hostname=r.toASCII(this.hostname));var G=this.port?":"+this.port:"",U=this.hostname||"";this.host=U+G,this.href+=this.host,O&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==v[0]&&(v="/"+v))}if(!f[w])for(C=0,L=u.length;C<L;C++){var Y=u[C];if(-1!==v.indexOf(Y)){var z=encodeURIComponent(Y);z===Y&&(z=escape(Y)),v=v.split(Y).join(z)}}var X=v.indexOf("#");-1!==X&&(this.hash=v.substr(X),v=v.slice(0,X));var q=v.indexOf("?");if(-1!==q?(this.search=v.substr(q),this.query=v.substr(q+1),e&&(this.query=y.parse(this.query)),v=v.slice(0,q)):e&&(this.search="",this.query={}),v&&(this.pathname=v),m[w]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){G=this.pathname||"";var H=this.search||"";this.path=G+H}return this.href=this.format(),this},s.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",i=this.pathname||"",r=this.hash||"",s=!1,o="";this.host?s=t+this.host:this.hostname&&(s=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(s+=":"+this.port)),this.query&&n.isObject(this.query)&&Object.keys(this.query).length&&(o=y.stringify(this.query));var a=this.search||o&&"?"+o||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||m[e])&&!1!==s?(s="//"+(s||""),i&&"/"!==i.charAt(0)&&(i="/"+i)):s||(s=""),r&&"#"!==r.charAt(0)&&(r="#"+r),a&&"?"!==a.charAt(0)&&(a="?"+a),e+s+(i=i.replace(/[?#]/g,function(t){return encodeURIComponent(t)}))+(a=a.replace("#","%23"))+r},s.prototype.resolve=function(t){return this.resolveObject(v(t,!1,!0)).format()},s.prototype.resolveObject=function(t){if(n.isString(t)){var e=new s;e.parse(t,!1,!0),t=e}for(var i=new s,r=Object.keys(this),o=0;o<r.length;o++){var a=r[o];i[a]=this[a]}if(i.hash=t.hash,""===t.href)return i.href=i.format(),i;if(t.slashes&&!t.protocol){for(var h=Object.keys(t),l=0;l<h.length;l++){var u=h[l];"protocol"!==u&&(i[u]=t[u])}return m[i.protocol]&&i.hostname&&!i.pathname&&(i.path=i.pathname="/"),i.href=i.format(),i}if(t.protocol&&t.protocol!==i.protocol){if(!m[t.protocol]){for(var c=Object.keys(t),d=0;d<c.length;d++){var p=c[d];i[p]=t[p]}return i.href=i.format(),i}if(i.protocol=t.protocol,t.host||_[t.protocol])i.pathname=t.pathname;else{for(var g=(t.pathname||"").split("/");g.length&&!(t.host=g.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==g[0]&&g.unshift(""),g.length<2&&g.unshift(""),i.pathname=g.join("/")}if(i.search=t.search,i.query=t.query,i.host=t.host||"",i.auth=t.auth,i.hostname=t.hostname||t.host,i.port=t.port,i.pathname||i.search){var f=i.pathname||"",y=i.search||"";i.path=f+y}return i.slashes=i.slashes||t.slashes,i.href=i.format(),i}var v=i.pathname&&"/"===i.pathname.charAt(0),x=t.host||t.pathname&&"/"===t.pathname.charAt(0),E=x||v||i.host&&t.pathname,w=E,b=i.pathname&&i.pathname.split("/")||[],I=(g=t.pathname&&t.pathname.split("/")||[],i.protocol&&!m[i.protocol]);if(I&&(i.hostname="",i.port=null,i.host&&(""===b[0]?b[0]=i.host:b.unshift(i.host)),i.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===g[0]?g[0]=t.host:g.unshift(t.host)),t.host=null),E=E&&(""===g[0]||""===b[0])),x)i.host=t.host||""===t.host?t.host:i.host,i.hostname=t.hostname||""===t.hostname?t.hostname:i.hostname,i.search=t.search,i.query=t.query,b=g;else if(g.length)b||(b=[]),b.pop(),b=b.concat(g),i.search=t.search,i.query=t.query;else if(!n.isNullOrUndefined(t.search)){if(I)i.hostname=i.host=b.shift(),(O=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@"))&&(i.auth=O.shift(),i.host=i.hostname=O.shift());return i.search=t.search,i.query=t.query,n.isNull(i.pathname)&&n.isNull(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.href=i.format(),i}if(!b.length)return i.pathname=null,i.search?i.path="/"+i.search:i.path=null,i.href=i.format(),i;for(var T=b.slice(-1)[0],S=(i.host||t.host||b.length>1)&&("."===T||".."===T)||""===T,C=0,N=b.length;N>=0;N--)"."===(T=b[N])?b.splice(N,1):".."===T?(b.splice(N,1),C++):C&&(b.splice(N,1),C--);if(!E&&!w)for(;C--;C)b.unshift("..");!E||""===b[0]||b[0]&&"/"===b[0].charAt(0)||b.unshift(""),S&&"/"!==b.join("/").substr(-1)&&b.push("");var O,P=""===b[0]||b[0]&&"/"===b[0].charAt(0);I&&(i.hostname=i.host=P?"":b.length?b.shift():"",(O=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@"))&&(i.auth=O.shift(),i.host=i.hostname=O.shift()));return(E=E||i.host&&b.length)&&!P&&b.unshift(""),b.length?i.pathname=b.join("/"):(i.pathname=null,i.path=null),n.isNull(i.pathname)&&n.isNull(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.auth=t.auth||i.auth,i.slashes=i.slashes||t.slashes,i.href=i.format(),i},s.prototype.parseHost=function(){var t=this.host,e=a.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},function(t,e,i){"use strict";var r=i(35).Loader,n=i(15).Resource,s=i(14),o=i(36);r.Resource=n,r.async=s,r.encodeBinary=o,r.base64=o,t.exports=r,t.exports.Loader=r,t.exports.default=r},function(t,e,i){t.exports={Shape:i(5),Rectangle:i(37),Polygon:i(38),Circle:i(39)}},function(t,e){var i,r,n=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(t){if(i===setTimeout)return setTimeout(t,0);if((i===s||!i)&&setTimeout)return i=setTimeout,setTimeout(t,0);try{return i(t,0)}catch(e){try{return i.call(null,t,0)}catch(e){return i.call(this,t,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:s}catch(t){i=s}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(t){r=o}}();var h,l=[],u=!1,c=-1;function d(){u&&h&&(u=!1,h.length?l=h.concat(l):c=-1,l.length&&p())}function p(){if(!u){var t=a(d);u=!0;for(var e=l.length;e;){for(h=l,l=[];++c<e;)h&&h[c].run();c=-1,e=l.length}h=null,u=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function g(t,e){this.fun=t,this.array=e}function f(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];l.push(new g(t,e)),1!==l.length||u||a(p)},g.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=f,n.addListener=f,n.once=f,n.off=f,n.removeListener=f,n.removeAllListeners=f,n.emit=f,n.prependListener=f,n.prependOnceListener=f,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},function(t,e,i){"use strict";var r=Object.prototype.hasOwnProperty,n="~";function s(){}function o(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function a(t,e,i,r,s){if("function"!=typeof i)throw new TypeError("The listener must be a function");var a=new o(i,r||t,s),h=n?n+e:e;return t._events[h]?t._events[h].fn?t._events[h]=[t._events[h],a]:t._events[h].push(a):(t._events[h]=a,t._eventsCount++),t}function h(t,e){0==--t._eventsCount?t._events=new s:delete t._events[e]}function l(){this._events=new s,this._eventsCount=0}Object.create&&(s.prototype=Object.create(null),(new s).__proto__||(n=!1)),l.prototype.eventNames=function(){var t,e,i=[];if(0===this._eventsCount)return i;for(e in t=this._events)r.call(t,e)&&i.push(n?e.slice(1):e);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(t)):i},l.prototype.listeners=function(t){var e=n?n+t:t,i=this._events[e];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,s=i.length,o=new Array(s);r<s;r++)o[r]=i[r].fn;return o},l.prototype.listenerCount=function(t){var e=n?n+t:t,i=this._events[e];return i?i.fn?1:i.length:0},l.prototype.emit=function(t,e,i,r,s,o){var a=n?n+t:t;if(!this._events[a])return!1;var h,l,u=this._events[a],c=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),c){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,i),!0;case 4:return u.fn.call(u.context,e,i,r),!0;case 5:return u.fn.call(u.context,e,i,r,s),!0;case 6:return u.fn.call(u.context,e,i,r,s,o),!0}for(l=1,h=new Array(c-1);l<c;l++)h[l-1]=arguments[l];u.fn.apply(u.context,h)}else{var d,p=u.length;for(l=0;l<p;l++)switch(u[l].once&&this.removeListener(t,u[l].fn,void 0,!0),c){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,e);break;case 3:u[l].fn.call(u[l].context,e,i);break;case 4:u[l].fn.call(u[l].context,e,i,r);break;default:if(!h)for(d=1,h=new Array(c-1);d<c;d++)h[d-1]=arguments[d];u[l].fn.apply(u[l].context,h)}}return!0},l.prototype.on=function(t,e,i){return a(this,t,e,i,!1)},l.prototype.once=function(t,e,i){return a(this,t,e,i,!0)},l.prototype.removeListener=function(t,e,i,r){var s=n?n+t:t;if(!this._events[s])return this;if(!e)return h(this,s),this;var o=this._events[s];if(o.fn)o.fn!==e||r&&!o.once||i&&o.context!==i||h(this,s);else{for(var a=0,l=[],u=o.length;a<u;a++)(o[a].fn!==e||r&&!o[a].once||i&&o[a].context!==i)&&l.push(o[a]);l.length?this._events[s]=1===l.length?l[0]:l:h(this,s)}return this},l.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&h(this,e)):(this._events=new s,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=n,l.EventEmitter=l,t.exports=l},function(t,e,i){"use strict";function r(t,e,i){i=i||2;var r,a,h,l,u,p,f,_=e&&e.length,m=_?e[0]*i:t.length,y=n(t,0,m,i,!0),v=[];if(!y||y.next===y.prev)return v;if(_&&(y=function(t,e,i,r){var o,a,h,l,u,p=[];for(o=0,a=e.length;o<a;o++)h=e[o]*r,l=o<a-1?e[o+1]*r:t.length,(u=n(t,h,l,r,!1))===u.next&&(u.steiner=!0),p.push(g(u));for(p.sort(c),o=0;o<p.length;o++)d(p[o],i),i=s(i,i.next);return i}(t,e,y,i)),t.length>80*i){r=h=t[0],a=l=t[1];for(var x=i;x<m;x+=i)(u=t[x])<r&&(r=u),(p=t[x+1])<a&&(a=p),u>h&&(h=u),p>l&&(l=p);f=0!==(f=Math.max(h-r,l-a))?1/f:0}return o(y,v,i,r,a,f),v}function n(t,e,i,r,n){var s,o;if(n===T(t,e,i,r)>0)for(s=e;s<i;s+=r)o=w(s,t[s],t[s+1],o);else for(s=i-r;s>=e;s-=r)o=w(s,t[s],t[s+1],o);return o&&y(o,o.next)&&(b(o),o=o.next),o}function s(t,e){if(!t)return t;e||(e=t);var i,r=t;do{if(i=!1,r.steiner||!y(r,r.next)&&0!==m(r.prev,r,r.next))r=r.next;else{if(b(r),(r=e=r.prev)===r.next)break;i=!0}}while(i||r!==e);return e}function o(t,e,i,r,n,c,d){if(t){!d&&c&&function(t,e,i,r){var n=t;do{null===n.z&&(n.z=p(n.x,n.y,e,i,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==t);n.prevZ.nextZ=null,n.prevZ=null,function(t){var e,i,r,n,s,o,a,h,l=1;do{for(i=t,t=null,s=null,o=0;i;){for(o++,r=i,a=0,e=0;e<l&&(a++,r=r.nextZ);e++);for(h=l;a>0||h>0&&r;)0!==a&&(0===h||!r||i.z<=r.z)?(n=i,i=i.nextZ,a--):(n=r,r=r.nextZ,h--),s?s.nextZ=n:t=n,n.prevZ=s,s=n;i=r}s.nextZ=null,l*=2}while(o>1)}(n)}(t,r,n,c);for(var g,f,_=t;t.prev!==t.next;)if(g=t.prev,f=t.next,c?h(t,r,n,c):a(t))e.push(g.i/i),e.push(t.i/i),e.push(f.i/i),b(t),t=f.next,_=f.next;else if((t=f)===_){d?1===d?o(t=l(t,e,i),e,i,r,n,c,2):2===d&&u(t,e,i,r,n,c):o(s(t),e,i,r,n,c,1);break}}}function a(t){var e=t.prev,i=t,r=t.next;if(m(e,i,r)>=0)return!1;for(var n=t.next.next;n!==t.prev;){if(f(e.x,e.y,i.x,i.y,r.x,r.y,n.x,n.y)&&m(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function h(t,e,i,r){var n=t.prev,s=t,o=t.next;if(m(n,s,o)>=0)return!1;for(var a=n.x<s.x?n.x<o.x?n.x:o.x:s.x<o.x?s.x:o.x,h=n.y<s.y?n.y<o.y?n.y:o.y:s.y<o.y?s.y:o.y,l=n.x>s.x?n.x>o.x?n.x:o.x:s.x>o.x?s.x:o.x,u=n.y>s.y?n.y>o.y?n.y:o.y:s.y>o.y?s.y:o.y,c=p(a,h,e,i,r),d=p(l,u,e,i,r),g=t.prevZ,_=t.nextZ;g&&g.z>=c&&_&&_.z<=d;){if(g!==t.prev&&g!==t.next&&f(n.x,n.y,s.x,s.y,o.x,o.y,g.x,g.y)&&m(g.prev,g,g.next)>=0)return!1;if(g=g.prevZ,_!==t.prev&&_!==t.next&&f(n.x,n.y,s.x,s.y,o.x,o.y,_.x,_.y)&&m(_.prev,_,_.next)>=0)return!1;_=_.nextZ}for(;g&&g.z>=c;){if(g!==t.prev&&g!==t.next&&f(n.x,n.y,s.x,s.y,o.x,o.y,g.x,g.y)&&m(g.prev,g,g.next)>=0)return!1;g=g.prevZ}for(;_&&_.z<=d;){if(_!==t.prev&&_!==t.next&&f(n.x,n.y,s.x,s.y,o.x,o.y,_.x,_.y)&&m(_.prev,_,_.next)>=0)return!1;_=_.nextZ}return!0}function l(t,e,i){var r=t;do{var n=r.prev,s=r.next.next;!y(n,s)&&v(n,r,r.next,s)&&x(n,s)&&x(s,n)&&(e.push(n.i/i),e.push(r.i/i),e.push(s.i/i),b(r),b(r.next),r=t=s),r=r.next}while(r!==t);return r}function u(t,e,i,r,n,a){var h=t;do{for(var l=h.next.next;l!==h.prev;){if(h.i!==l.i&&_(h,l)){var u=E(h,l);return h=s(h,h.next),u=s(u,u.next),o(h,e,i,r,n,a),void o(u,e,i,r,n,a)}l=l.next}h=h.next}while(h!==t)}function c(t,e){return t.x-e.x}function d(t,e){if(e=function(t,e){var i,r=e,n=t.x,s=t.y,o=-1/0;do{if(s<=r.y&&s>=r.next.y&&r.next.y!==r.y){var a=r.x+(s-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=n&&a>o){if(o=a,a===n){if(s===r.y)return r;if(s===r.next.y)return r.next}i=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!i)return null;if(n===o)return i.prev;var h,l=i,u=i.x,c=i.y,d=1/0;r=i.next;for(;r!==l;)n>=r.x&&r.x>=u&&n!==r.x&&f(s<c?n:o,s,u,c,s<c?o:n,s,r.x,r.y)&&((h=Math.abs(s-r.y)/(n-r.x))<d||h===d&&r.x>i.x)&&x(r,t)&&(i=r,d=h),r=r.next;return i}(t,e)){var i=E(e,t);s(i,i.next)}}function p(t,e,i,r,n){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*n)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*n)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function g(t){var e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==t);return i}function f(t,e,i,r,n,s,o,a){return(n-o)*(e-a)-(t-o)*(s-a)>=0&&(t-o)*(r-a)-(i-o)*(e-a)>=0&&(i-o)*(s-a)-(n-o)*(r-a)>=0}function _(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&v(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(t,e)&&x(t,e)&&x(e,t)&&function(t,e){var i=t,r=!1,n=(t.x+e.x)/2,s=(t.y+e.y)/2;do{i.y>s!=i.next.y>s&&i.next.y!==i.y&&n<(i.next.x-i.x)*(s-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next}while(i!==t);return r}(t,e)}function m(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function y(t,e){return t.x===e.x&&t.y===e.y}function v(t,e,i,r){return!!(y(t,e)&&y(i,r)||y(t,r)&&y(i,e))||m(t,e,i)>0!=m(t,e,r)>0&&m(i,r,t)>0!=m(i,r,e)>0}function x(t,e){return m(t.prev,t,t.next)<0?m(t,e,t.next)>=0&&m(t,t.prev,e)>=0:m(t,e,t.prev)<0||m(t,t.next,e)<0}function E(t,e){var i=new I(t.i,t.x,t.y),r=new I(e.i,e.x,e.y),n=t.next,s=e.prev;return t.next=e,e.prev=t,i.next=n,n.prev=i,r.next=i,i.prev=r,s.next=r,r.prev=s,r}function w(t,e,i,r){var n=new I(t,e,i);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}function b(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function I(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function T(t,e,i,r){for(var n=0,s=e,o=i-r;s<i;s+=r)n+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return n}t.exports=r,t.exports.default=r,r.deviation=function(t,e,i,r){var n=e&&e.length,s=n?e[0]*i:t.length,o=Math.abs(T(t,0,s,i));if(n)for(var a=0,h=e.length;a<h;a++){var l=e[a]*i,u=a<h-1?e[a+1]*i:t.length;o-=Math.abs(T(t,l,u,i))}var c=0;for(a=0;a<r.length;a+=3){var d=r[a]*i,p=r[a+1]*i,g=r[a+2]*i;c+=Math.abs((t[d]-t[g])*(t[p+1]-t[d+1])-(t[d]-t[p])*(t[g+1]-t[d+1]))}return 0===o&&0===c?0:Math.abs((c-o)/o)},r.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},r=0,n=0;n<t.length;n++){for(var s=0;s<t[n].length;s++)for(var o=0;o<e;o++)i.vertices.push(t[n][s][o]);n>0&&(r+=t[n-1].length,i.holes.push(r))}return i}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}();function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var s=function(){function t(e,i,r){void 0===i&&(i=!1),n(this,t),this._fn=e,this._once=i,this._thisArg=r,this._next=this._prev=this._owner=null}return r(t,[{key:"detach",value:function(){return null!==this._owner&&(this._owner.detach(this),!0)}}]),t}();function o(t,e){return t._head?(t._tail._next=e,e._prev=t._tail,t._tail=e):(t._head=e,t._tail=e),e._owner=t,e}var a=function(){function t(){n(this,t),this._head=this._tail=void 0}return r(t,[{key:"handlers",value:function(){var t=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],e=this._head;if(t)return!!e;for(var i=[];e;)i.push(e),e=e._next;return i}},{key:"has",value:function(t){if(!(t instanceof s))throw new Error("MiniSignal#has(): First arg must be a MiniSignalBinding object.");return t._owner===this}},{key:"dispatch",value:function(){var t=this._head;if(!t)return!1;for(;t;)t._once&&this.detach(t),t._fn.apply(t._thisArg,arguments),t=t._next;return!0}},{key:"add",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof t)throw new Error("MiniSignal#add(): First arg must be a Function.");return o(this,new s(t,!1,e))}},{key:"once",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof t)throw new Error("MiniSignal#once(): First arg must be a Function.");return o(this,new s(t,!0,e))}},{key:"detach",value:function(t){if(!(t instanceof s))throw new Error("MiniSignal#detach(): First arg must be a MiniSignalBinding object.");return t._owner!==this?this:(t._prev&&(t._prev._next=t._next),t._next&&(t._next._prev=t._prev),t===this._head?(this._head=t._next,null===t._next&&(this._tail=null)):t===this._tail&&(this._tail=t._prev,this._tail._next=null),t._owner=null,this)}},{key:"detachAll",value:function(){var t=this._head;if(!t)return this;for(this._head=this._tail=null;t;)t._owner=null,t=t._next;return this}}]),t}();a.MiniSignalBinding=s,e.default=a,t.exports=e.default},function(t,e,i){"use strict";t.exports=function(t,e){e=e||{};for(var i={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},r=i.parser[e.strictMode?"strict":"loose"].exec(t),n={},s=14;s--;)n[i.key[s]]=r[s]||"";return n[i.q.name]={},n[i.key[12]].replace(i.q.parser,function(t,e,r){e&&(n[i.q.name][e]=r)}),n}},function(t,e,i){"use strict";function r(){}function n(t){return function(){if(null===t)throw new Error("Callback was already called.");var e=t;t=null,e.apply(this,arguments)}}e.__esModule=!0,e.eachSeries=function(t,e,i,r){var n=0,s=t.length;!function o(a){a||n===s?i&&i(a):r?setTimeout(function(){e(t[n++],o)},1):e(t[n++],o)}()},e.queue=function(t,e){if(null==e)e=1;else if(0===e)throw new Error("Concurrency must not be zero");var i=0,s={_tasks:[],concurrency:e,saturated:r,unsaturated:r,buffer:e/4,empty:r,drain:r,error:r,started:!1,paused:!1,push:function(t,e){o(t,!1,e)},kill:function(){i=0,s.drain=r,s.started=!1,s._tasks=[]},unshift:function(t,e){o(t,!0,e)},process:function(){for(;!s.paused&&i<s.concurrency&&s._tasks.length;){var e=s._tasks.shift();0===s._tasks.length&&s.empty(),(i+=1)===s.concurrency&&s.saturated(),t(e.data,n(a(e)))}},length:function(){return s._tasks.length},running:function(){return i},idle:function(){return s._tasks.length+i===0},pause:function(){!0!==s.paused&&(s.paused=!0)},resume:function(){if(!1!==s.paused){s.paused=!1;for(var t=1;t<=s.concurrency;t++)s.process()}}};function o(t,e,i){if(null!=i&&"function"!=typeof i)throw new Error("task callback must be a function");if(s.started=!0,null==t&&s.idle())setTimeout(function(){return s.drain()},1);else{var n={data:t,callback:"function"==typeof i?i:r};e?s._tasks.unshift(n):s._tasks.push(n),setTimeout(function(){return s.process()},1)}}function a(t){return function(){i-=1,t.callback.apply(t,arguments),null!=arguments[0]&&s.error(arguments[0],t.data),i<=s.concurrency-s.buffer&&s.unsaturated(),s.idle()&&s.drain(),s.process()}}return s}},function(t,e,i){"use strict";e.__esModule=!0,e.Resource=void 0;var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),n=o(i(13)),s=o(i(12));function o(t){return t&&t.__esModule?t:{default:t}}var a=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest),h=null;function l(){}var u=e.Resource=function(){function t(e,i,r){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),"string"!=typeof e||"string"!=typeof i)throw new Error("Both name and url are required for constructing a resource.");r=r||{},this._flags=0,this._setFlag(t.STATUS_FLAGS.DATA_URL,0===i.indexOf("data:")),this.name=e,this.url=i,this.extension=this._getExtension(),this.data=null,this.crossOrigin=!0===r.crossOrigin?"anonymous":r.crossOrigin,this.timeout=r.timeout||0,this.loadType=r.loadType||this._determineLoadType(),this.xhrType=r.xhrType,this.metadata=r.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=t.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=l,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new s.default,this.onProgress=new s.default,this.onComplete=new s.default,this.onAfterMiddleware=new s.default}return t.setExtensionLoadType=function(e,i){c(t._loadTypeMap,e,i)},t.setExtensionXhrType=function(e,i){c(t._xhrTypeMap,e,i)},t.prototype.complete=function(){this._clearEvents(),this._finish()},t.prototype.abort=function(e){if(!this.error){if(this.error=new Error(e),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=t.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},t.prototype.load=function(e){var i=this;if(!this.isLoading)if(this.isComplete)e&&setTimeout(function(){return e(i)},1);else switch(e&&this.onComplete.once(e),this._setFlag(t.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),!1!==this.crossOrigin&&"string"==typeof this.crossOrigin||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case t.LOAD_TYPE.IMAGE:this.type=t.TYPE.IMAGE,this._loadElement("image");break;case t.LOAD_TYPE.AUDIO:this.type=t.TYPE.AUDIO,this._loadSourceElement("audio");break;case t.LOAD_TYPE.VIDEO:this.type=t.TYPE.VIDEO,this._loadSourceElement("video");break;case t.LOAD_TYPE.XHR:default:a&&this.crossOrigin?this._loadXdr():this._loadXhr()}},t.prototype._hasFlag=function(t){return 0!=(this._flags&t)},t.prototype._setFlag=function(t,e){this._flags=e?this._flags|t:this._flags&~t},t.prototype._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},t.prototype._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(t.STATUS_FLAGS.COMPLETE,!0),this._setFlag(t.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},t.prototype._loadElement=function(t){this.metadata.loadElement?this.data=this.metadata.loadElement:"image"===t&&void 0!==window.Image?this.data=new Image:this.data=document.createElement(t),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},t.prototype._loadSourceElement=function(t){if(this.metadata.loadElement?this.data=this.metadata.loadElement:"audio"===t&&void 0!==window.Audio?this.data=new Audio:this.data=document.createElement(t),null!==this.data){if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=this.metadata.mimeType,i=0;i<this.url.length;++i)this.data.appendChild(this._createSource(t,this.url[i],Array.isArray(e)?e[i]:e));else{var r=this.metadata.mimeType;this.data.appendChild(this._createSource(t,this.url,Array.isArray(r)?r[0]:r))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))}else this.abort("Unsupported element: "+t)},t.prototype._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XMLHttpRequest;e.open("GET",this.url,!0),e.timeout=this.timeout,this.xhrType===t.XHR_RESPONSE_TYPE.JSON||this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT?e.responseType=t.XHR_RESPONSE_TYPE.TEXT:e.responseType=this.xhrType,e.addEventListener("error",this._boundXhrOnError,!1),e.addEventListener("timeout",this._boundXhrOnTimeout,!1),e.addEventListener("abort",this._boundXhrOnAbort,!1),e.addEventListener("progress",this._boundOnProgress,!1),e.addEventListener("load",this._boundXhrOnLoad,!1),e.send()},t.prototype._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XDomainRequest;t.timeout=this.timeout||5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXhrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout(function(){return t.send()},1)},t.prototype._createSource=function(t,e,i){i||(i=t+"/"+this._getExtension(e));var r=document.createElement("source");return r.src=e,r.type=i,r},t.prototype._onError=function(t){this.abort("Failed to load element using: "+t.target.nodeName)},t.prototype._onProgress=function(t){t&&t.lengthComputable&&this.onProgress.dispatch(this,t.loaded/t.total)},t.prototype._onTimeout=function(){this.abort("Load timed out.")},t.prototype._xhrOnError=function(){var t=this.xhr;this.abort(d(t)+" Request failed. Status: "+t.status+', text: "'+t.statusText+'"')},t.prototype._xhrOnTimeout=function(){var t=this.xhr;this.abort(d(t)+" Request timed out.")},t.prototype._xhrOnAbort=function(){var t=this.xhr;this.abort(d(t)+" Request was aborted by the user.")},t.prototype._xhrOnLoad=function(){var e=this.xhr,i="",r=void 0===e.status?200:e.status;if(""!==e.responseType&&"text"!==e.responseType&&void 0!==e.responseType||(i=e.responseText),0===r&&(i.length>0||e.responseType===t.XHR_RESPONSE_TYPE.BUFFER)?r=200:1223===r&&(r=204),2===(r/100|0)){if(this.xhrType===t.XHR_RESPONSE_TYPE.TEXT)this.data=i,this.type=t.TYPE.TEXT;else if(this.xhrType===t.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(i),this.type=t.TYPE.JSON}catch(t){return void this.abort("Error trying to parse loaded json: "+t)}else if(this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var n=new DOMParser;this.data=n.parseFromString(i,"text/xml")}else{var s=document.createElement("div");s.innerHTML=i,this.data=s}this.type=t.TYPE.XML}catch(t){return void this.abort("Error trying to parse loaded xml: "+t)}else this.data=e.response||i;this.complete()}else this.abort("["+e.status+"] "+e.statusText+": "+e.responseURL)},t.prototype._determineCrossOrigin=function(t,e){if(0===t.indexOf("data:"))return"";if(window.origin!==window.location.origin)return"anonymous";e=e||window.location,h||(h=document.createElement("a")),h.href=t;var i=!(t=(0,n.default)(h.href,{strictMode:!0})).port&&""===e.port||t.port===e.port,r=t.protocol?t.protocol+":":"";return t.host===e.hostname&&i&&r===e.protocol?"":"anonymous"},t.prototype._determineXhrType=function(){return t._xhrTypeMap[this.extension]||t.XHR_RESPONSE_TYPE.TEXT},t.prototype._determineLoadType=function(){return t._loadTypeMap[this.extension]||t.LOAD_TYPE.XHR},t.prototype._getExtension=function(){var t=this.url,e="";if(this.isDataUrl){var i=t.indexOf("/");e=t.substring(i+1,t.indexOf(";",i))}else{var r=t.indexOf("?"),n=t.indexOf("#"),s=Math.min(r>-1?r:t.length,n>-1?n:t.length);e=(t=t.substring(0,s)).substring(t.lastIndexOf(".")+1)}return e.toLowerCase()},t.prototype._getMimeFromXhrType=function(e){switch(e){case t.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case t.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case t.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case t.XHR_RESPONSE_TYPE.JSON:return"application/json";case t.XHR_RESPONSE_TYPE.DEFAULT:case t.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},r(t,[{key:"isDataUrl",get:function(){return this._hasFlag(t.STATUS_FLAGS.DATA_URL)}},{key:"isComplete",get:function(){return this._hasFlag(t.STATUS_FLAGS.COMPLETE)}},{key:"isLoading",get:function(){return this._hasFlag(t.STATUS_FLAGS.LOADING)}}]),t}();function c(t,e,i){e&&0===e.indexOf(".")&&(e=e.substring(1)),e&&(t[e]=i)}function d(t){return t.toString().replace("object ","")}u.STATUS_FLAGS={NONE:0,DATA_URL:1,COMPLETE:2,LOADING:4},u.TYPE={UNKNOWN:0,JSON:1,XML:2,IMAGE:3,AUDIO:4,VIDEO:5,TEXT:6},u.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},u.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},u._loadTypeMap={gif:u.LOAD_TYPE.IMAGE,png:u.LOAD_TYPE.IMAGE,bmp:u.LOAD_TYPE.IMAGE,jpg:u.LOAD_TYPE.IMAGE,jpeg:u.LOAD_TYPE.IMAGE,tif:u.LOAD_TYPE.IMAGE,tiff:u.LOAD_TYPE.IMAGE,webp:u.LOAD_TYPE.IMAGE,tga:u.LOAD_TYPE.IMAGE,svg:u.LOAD_TYPE.IMAGE,"svg+xml":u.LOAD_TYPE.IMAGE,mp3:u.LOAD_TYPE.AUDIO,ogg:u.LOAD_TYPE.AUDIO,wav:u.LOAD_TYPE.AUDIO,mp4:u.LOAD_TYPE.VIDEO,webm:u.LOAD_TYPE.VIDEO},u._xhrTypeMap={xhtml:u.XHR_RESPONSE_TYPE.DOCUMENT,html:u.XHR_RESPONSE_TYPE.DOCUMENT,htm:u.XHR_RESPONSE_TYPE.DOCUMENT,xml:u.XHR_RESPONSE_TYPE.DOCUMENT,tmx:u.XHR_RESPONSE_TYPE.DOCUMENT,svg:u.XHR_RESPONSE_TYPE.DOCUMENT,tsx:u.XHR_RESPONSE_TYPE.DOCUMENT,gif:u.XHR_RESPONSE_TYPE.BLOB,png:u.XHR_RESPONSE_TYPE.BLOB,bmp:u.XHR_RESPONSE_TYPE.BLOB,jpg:u.XHR_RESPONSE_TYPE.BLOB,jpeg:u.XHR_RESPONSE_TYPE.BLOB,tif:u.XHR_RESPONSE_TYPE.BLOB,tiff:u.XHR_RESPONSE_TYPE.BLOB,webp:u.XHR_RESPONSE_TYPE.BLOB,tga:u.XHR_RESPONSE_TYPE.BLOB,json:u.XHR_RESPONSE_TYPE.JSON,text:u.XHR_RESPONSE_TYPE.TEXT,txt:u.XHR_RESPONSE_TYPE.TEXT,ttf:u.XHR_RESPONSE_TYPE.BUFFER,otf:u.XHR_RESPONSE_TYPE.BUFFER},u.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",t.exports.default=u},function(t,e,i){(function(r,n){var s;!function(r){var o=r.Promise,a=o&&"resolve"in o&&"reject"in o&&"all"in o&&"race"in o&&function(){var t;return new o(function(e){t=e}),"function"==typeof t}();e?(e.Promise=a?o:C,e.Polyfill=C):void 0===(s=function(){return a?o:C}.call(e,i,e,t))||(t.exports=s);var h="pending",l="sealed",u="fulfilled",c="rejected",d=function(){};function p(t){return"[object Array]"===Object.prototype.toString.call(t)}var g,f=void 0!==n?n:setTimeout,_=[];function m(){for(var t=0;t<_.length;t++)_[t][0](_[t][1]);_=[],g=!1}function y(t,e){_.push([t,e]),g||(g=!0,f(m,0))}function v(t){var e=t.owner,i=e.state_,r=e.data_,n=t[i],s=t.then;if("function"==typeof n){i=u;try{r=n(r)}catch(t){b(s,t)}}x(s,r)||(i===u&&E(s,r),i===c&&b(s,r))}function x(t,e){var i;try{if(t===e)throw new TypeError("A promises callback cannot return that same promise.");if(e&&("function"==typeof e||"object"==typeof e)){var r=e.then;if("function"==typeof r)return r.call(e,function(r){i||(i=!0,e!==r?E(t,r):w(t,r))},function(e){i||(i=!0,b(t,e))}),!0}}catch(e){return i||b(t,e),!0}return!1}function E(t,e){t!==e&&x(t,e)||w(t,e)}function w(t,e){t.state_===h&&(t.state_=l,t.data_=e,y(T,t))}function b(t,e){t.state_===h&&(t.state_=l,t.data_=e,y(S,t))}function I(t){var e=t.then_;t.then_=void 0;for(var i=0;i<e.length;i++)v(e[i])}function T(t){t.state_=u,I(t)}function S(t){t.state_=c,I(t)}function C(t){if("function"!=typeof t)throw new TypeError("Promise constructor takes a function argument");if(this instanceof C==!1)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this.then_=[],function(t,e){function i(t){b(e,t)}try{t(function(t){E(e,t)},i)}catch(t){i(t)}}(t,this)}C.prototype={constructor:C,state_:h,then_:null,data_:void 0,then:function(t,e){var i={owner:this,then:new this.constructor(d),fulfilled:t,rejected:e};return this.state_===u||this.state_===c?y(v,i):this.then_.push(i),i.then},catch:function(t){return this.then(null,t)}},C.all=function(t){if(!p(t))throw new TypeError("You must pass an array to Promise.all().");return new this(function(e,i){var r=[],n=0;function s(t){return n++,function(i){r[t]=i,--n||e(r)}}for(var o,a=0;a<t.length;a++)(o=t[a])&&"function"==typeof o.then?o.then(s(a),i):r[a]=o;n||e(r)})},C.race=function(t){if(!p(t))throw new TypeError("You must pass an array to Promise.race().");return new this(function(e,i){for(var r,n=0;n<t.length;n++)(r=t[n])&&"function"==typeof r.then?r.then(e,i):e(r)})},C.resolve=function(t){return t&&"object"==typeof t&&t.constructor===this?t:new this(function(e){e(t)})},C.reject=function(t){return new this(function(e,i){i(t)})}}("undefined"!=typeof window?window:void 0!==r?r:"undefined"!=typeof self?self:this)}).call(this,i(3),i(27).setImmediate)},function(t,e,i){"use strict";var r=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},i=0;i<10;i++)e["_"+String.fromCharCode(i)]=i;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(t){r[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var i,o,a=function(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),h=1;h<arguments.length;h++){for(var l in i=Object(arguments[h]))n.call(i,l)&&(a[l]=i[l]);if(r){o=r(i);for(var u=0;u<o.length;u++)s.call(i,o[u])&&(a[o[u]]=i[o[u]])}}return a}},function(t,e,i){var r;!function(){function n(t,e,i){return t.call.apply(t.bind,arguments)}function s(t,e,i){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function o(t,e,i){return(o=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?n:s).apply(null,arguments)}var a=Date.now||function(){return+new Date};function h(t,e){this.a=t,this.o=e||t,this.c=this.o.document}var l=!!window.FontFace;function u(t,e,i,r){if(e=t.c.createElement(e),i)for(var n in i)i.hasOwnProperty(n)&&("style"==n?e.style.cssText=i[n]:e.setAttribute(n,i[n]));return r&&e.appendChild(t.c.createTextNode(r)),e}function c(t,e,i){(t=t.c.getElementsByTagName(e)[0])||(t=document.documentElement),t.insertBefore(i,t.lastChild)}function d(t){t.parentNode&&t.parentNode.removeChild(t)}function p(t,e,i){e=e||[],i=i||[];for(var r=t.className.split(/\s+/),n=0;n<e.length;n+=1){for(var s=!1,o=0;o<r.length;o+=1)if(e[n]===r[o]){s=!0;break}s||r.push(e[n])}for(e=[],n=0;n<r.length;n+=1){for(s=!1,o=0;o<i.length;o+=1)if(r[n]===i[o]){s=!0;break}s||e.push(r[n])}t.className=e.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function g(t,e){for(var i=t.className.split(/\s+/),r=0,n=i.length;r<n;r++)if(i[r]==e)return!0;return!1}function f(t,e,i){function r(){a&&n&&s&&(a(o),a=null)}e=u(t,"link",{rel:"stylesheet",href:e,media:"all"});var n=!1,s=!0,o=null,a=i||null;l?(e.onload=function(){n=!0,r()},e.onerror=function(){n=!0,o=Error("Stylesheet failed to load"),r()}):setTimeout(function(){n=!0,r()},0),c(t,"head",e)}function _(t,e,i,r){var n=t.c.getElementsByTagName("head")[0];if(n){var s=u(t,"script",{src:e}),o=!1;return s.onload=s.onreadystatechange=function(){o||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(o=!0,i&&i(null),s.onload=s.onreadystatechange=null,"HEAD"==s.parentNode.tagName&&n.removeChild(s))},n.appendChild(s),setTimeout(function(){o||(o=!0,i&&i(Error("Script load timeout")))},r||5e3),s}return null}function m(){this.a=0,this.c=null}function y(t){return t.a++,function(){t.a--,x(t)}}function v(t,e){t.c=e,x(t)}function x(t){0==t.a&&t.c&&(t.c(),t.c=null)}function E(t){this.a=t||"-"}function w(t,e){this.c=t,this.f=4,this.a="n";var i=(e||"n4").match(/^([nio])([1-9])$/i);i&&(this.a=i[1],this.f=parseInt(i[2],10))}function b(t){var e=[];t=t.split(/,\s*/);for(var i=0;i<t.length;i++){var r=t[i].replace(/['"]/g,"");-1!=r.indexOf(" ")||/^\d/.test(r)?e.push("'"+r+"'"):e.push(r)}return e.join(",")}function I(t){return t.a+t.f}function T(t){var e="normal";return"o"===t.a?e="oblique":"i"===t.a&&(e="italic"),e}function S(t){var e=4,i="n",r=null;return t&&((r=t.match(/(normal|oblique|italic)/i))&&r[1]&&(i=r[1].substr(0,1).toLowerCase()),(r=t.match(/([1-9]00|normal|bold)/i))&&r[1]&&(/bold/i.test(r[1])?e=7:/[1-9]00/.test(r[1])&&(e=parseInt(r[1].substr(0,1),10)))),i+e}function C(t,e){this.c=t,this.f=t.o.document.documentElement,this.h=e,this.a=new E("-"),this.j=!1!==e.events,this.g=!1!==e.classes}function N(t){if(t.g){var e=g(t.f,t.a.c("wf","active")),i=[],r=[t.a.c("wf","loading")];e||i.push(t.a.c("wf","inactive")),p(t.f,i,r)}O(t,"inactive")}function O(t,e,i){t.j&&t.h[e]&&(i?t.h[e](i.c,I(i)):t.h[e]())}function P(){this.c={}}function L(t,e){this.c=t,this.f=e,this.a=u(this.c,"span",{"aria-hidden":"true"},this.f)}function A(t){c(t.c,"body",t.a)}function R(t){return"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+b(t.c)+";font-style:"+T(t)+";font-weight:"+t.f+"00;"}function M(t,e,i,r,n,s){this.g=t,this.j=e,this.a=r,this.c=i,this.f=n||3e3,this.h=s||void 0}function D(t,e,i,r,n,s,o){this.v=t,this.B=e,this.c=i,this.a=r,this.s=o||"BESbswy",this.f={},this.w=n||3e3,this.u=s||null,this.m=this.j=this.h=this.g=null,this.g=new L(this.c,this.s),this.h=new L(this.c,this.s),this.j=new L(this.c,this.s),this.m=new L(this.c,this.s),t=R(t=new w(this.a.c+",serif",I(this.a))),this.g.a.style.cssText=t,t=R(t=new w(this.a.c+",sans-serif",I(this.a))),this.h.a.style.cssText=t,t=R(t=new w("serif",I(this.a))),this.j.a.style.cssText=t,t=R(t=new w("sans-serif",I(this.a))),this.m.a.style.cssText=t,A(this.g),A(this.h),A(this.j),A(this.m)}E.prototype.c=function(t){for(var e=[],i=0;i<arguments.length;i++)e.push(arguments[i].replace(/[\W_]+/g,"").toLowerCase());return e.join(this.a)},M.prototype.start=function(){var t=this.c.o.document,e=this,i=a(),r=new Promise(function(r,n){!function s(){a()-i>=e.f?n():t.fonts.load(function(t){return T(t)+" "+t.f+"00 300px "+b(t.c)}(e.a),e.h).then(function(t){1<=t.length?r():setTimeout(s,25)},function(){n()})}()}),n=null,s=new Promise(function(t,i){n=setTimeout(i,e.f)});Promise.race([s,r]).then(function(){n&&(clearTimeout(n),n=null),e.g(e.a)},function(){e.j(e.a)})};var F={D:"serif",C:"sans-serif"},B=null;function k(){if(null===B){var t=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent);B=!!t&&(536>parseInt(t[1],10)||536===parseInt(t[1],10)&&11>=parseInt(t[2],10))}return B}function G(t,e,i){for(var r in F)if(F.hasOwnProperty(r)&&e===t.f[F[r]]&&i===t.f[F[r]])return!0;return!1}function U(t){var e,i=t.g.a.offsetWidth,r=t.h.a.offsetWidth;(e=i===t.f.serif&&r===t.f["sans-serif"])||(e=k()&&G(t,i,r)),e?a()-t.A>=t.w?k()&&G(t,i,r)&&(null===t.u||t.u.hasOwnProperty(t.a.c))?Y(t,t.v):Y(t,t.B):function(t){setTimeout(o(function(){U(this)},t),50)}(t):Y(t,t.v)}function Y(t,e){setTimeout(o(function(){d(this.g.a),d(this.h.a),d(this.j.a),d(this.m.a),e(this.a)},t),0)}function z(t,e,i){this.c=t,this.a=e,this.f=0,this.m=this.j=!1,this.s=i}D.prototype.start=function(){this.f.serif=this.j.a.offsetWidth,this.f["sans-serif"]=this.m.a.offsetWidth,this.A=a(),U(this)};var X=null;function q(t){0==--t.f&&t.j&&(t.m?((t=t.a).g&&p(t.f,[t.a.c("wf","active")],[t.a.c("wf","loading"),t.a.c("wf","inactive")]),O(t,"active")):N(t.a))}function H(t){this.j=t,this.a=new P,this.h=0,this.f=this.g=!0}function V(t,e,i,r,n){var s=0==--t.h;(t.f||t.g)&&setTimeout(function(){var t=n||null,a=r||{};if(0===i.length&&s)N(e.a);else{e.f+=i.length,s&&(e.j=s);var h,l=[];for(h=0;h<i.length;h++){var u=i[h],c=a[u.c],d=e.a,g=u;if(d.g&&p(d.f,[d.a.c("wf",g.c,I(g).toString(),"loading")]),O(d,"fontloading",g),d=null,null===X)if(window.FontFace){g=/Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent);var f=/OS X.*Version\/10\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor);X=g?42<parseInt(g[1],10):!f}else X=!1;d=X?new M(o(e.g,e),o(e.h,e),e.c,u,e.s,c):new D(o(e.g,e),o(e.h,e),e.c,u,e.s,t,c),l.push(d)}for(h=0;h<l.length;h++)l[h].start()}},0)}function j(t,e){this.c=t,this.a=e}function W(t,e){this.c=t,this.a=e}function K(t,e){this.c=t||Z,this.a=[],this.f=[],this.g=e||""}z.prototype.g=function(t){var e=this.a;e.g&&p(e.f,[e.a.c("wf",t.c,I(t).toString(),"active")],[e.a.c("wf",t.c,I(t).toString(),"loading"),e.a.c("wf",t.c,I(t).toString(),"inactive")]),O(e,"fontactive",t),this.m=!0,q(this)},z.prototype.h=function(t){var e=this.a;if(e.g){var i=g(e.f,e.a.c("wf",t.c,I(t).toString(),"active")),r=[],n=[e.a.c("wf",t.c,I(t).toString(),"loading")];i||r.push(e.a.c("wf",t.c,I(t).toString(),"inactive")),p(e.f,r,n)}O(e,"fontinactive",t),q(this)},H.prototype.load=function(t){this.c=new h(this.j,t.context||this.j),this.g=!1!==t.events,this.f=!1!==t.classes,function(t,e,i){var r=[],n=i.timeout;!function(t){t.g&&p(t.f,[t.a.c("wf","loading")]),O(t,"loading")}(e);var r=function(t,e,i){var r,n=[];for(r in e)if(e.hasOwnProperty(r)){var s=t.c[r];s&&n.push(s(e[r],i))}return n}(t.a,i,t.c),s=new z(t.c,e,n);for(t.h=r.length,e=0,i=r.length;e<i;e++)r[e].load(function(e,i,r){V(t,s,e,i,r)})}(this,new C(this.c,t),t)},j.prototype.load=function(t){var e=this,i=e.a.projectId,r=e.a.version;if(i){var n=e.c.o;_(this.c,(e.a.api||"https://fast.fonts.net/jsapi")+"/"+i+".js"+(r?"?v="+r:""),function(r){r?t([]):(n["__MonotypeConfiguration__"+i]=function(){return e.a},function e(){if(n["__mti_fntLst"+i]){var r,s=n["__mti_fntLst"+i](),o=[];if(s)for(var a=0;a<s.length;a++){var h=s[a].fontfamily;null!=s[a].fontStyle&&null!=s[a].fontWeight?(r=s[a].fontStyle+s[a].fontWeight,o.push(new w(h,r))):o.push(new w(h))}t(o)}else setTimeout(function(){e()},50)}())}).id="__MonotypeAPIScript__"+i}else t([])},W.prototype.load=function(t){var e,i,r=this.a.urls||[],n=this.a.families||[],s=this.a.testStrings||{},o=new m;for(e=0,i=r.length;e<i;e++)f(this.c,r[e],y(o));var a=[];for(e=0,i=n.length;e<i;e++)if((r=n[e].split(":"))[1])for(var h=r[1].split(","),l=0;l<h.length;l+=1)a.push(new w(r[0],h[l]));else a.push(new w(r[0]));v(o,function(){t(a,s)})};var Z="https://fonts.googleapis.com/css";function J(t){this.f=t,this.a=[],this.c={}}var Q={latin:"BESbswy","latin-ext":"",cyrillic:"",greek:"",khmer:"",Hanuman:""},$={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},tt={i:"i",italic:"i",n:"n",normal:"n"},et=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;function it(t,e){this.c=t,this.a=e}var rt={Arimo:!0,Cousine:!0,Tinos:!0};function nt(t,e){this.c=t,this.a=e}function st(t,e){this.c=t,this.f=e,this.a=[]}it.prototype.load=function(t){var e=new m,i=this.c,r=new K(this.a.api,this.a.text),n=this.a.families;!function(t,e){for(var i=e.length,r=0;r<i;r++){var n=e[r].split(":");3==n.length&&t.f.push(n.pop());var s="";2==n.length&&""!=n[1]&&(s=":"),t.a.push(n.join(s))}}(r,n);var s=new J(n);!function(t){for(var e=t.f.length,i=0;i<e;i++){var r=t.f[i].split(":"),n=r[0].replace(/\+/g," "),s=["n4"];if(2<=r.length){var o;if(o=[],a=r[1])for(var a,h=(a=a.split(",")).length,l=0;l<h;l++){var u;if((u=a[l]).match(/^[\w-]+$/))if(null==(d=et.exec(u.toLowerCase())))u="";else{if(u=null==(u=d[2])||""==u?"n":tt[u],null==(d=d[1])||""==d)d="4";else var c=$[d],d=c||(isNaN(d)?"4":d.substr(0,1));u=[u,d].join("")}else u="";u&&o.push(u)}0<o.length&&(s=o),3==r.length&&(o=[],0<(r=(r=r[2])?r.split(","):o).length&&(r=Q[r[0]])&&(t.c[n]=r))}for(t.c[n]||(r=Q[n])&&(t.c[n]=r),r=0;r<s.length;r+=1)t.a.push(new w(n,s[r]))}}(s),f(i,function(t){if(0==t.a.length)throw Error("No fonts to load!");if(-1!=t.c.indexOf("kit="))return t.c;for(var e=t.a.length,i=[],r=0;r<e;r++)i.push(t.a[r].replace(/ /g,"+"));return e=t.c+"?family="+i.join("%7C"),0<t.f.length&&(e+="&subset="+t.f.join(",")),0<t.g.length&&(e+="&text="+encodeURIComponent(t.g)),e}(r),y(e)),v(e,function(){t(s.a,s.c,rt)})},nt.prototype.load=function(t){var e=this.a.id,i=this.c.o;e?_(this.c,(this.a.api||"https://use.typekit.net")+"/"+e+".js",function(e){if(e)t([]);else if(i.Typekit&&i.Typekit.config&&i.Typekit.config.fn){e=i.Typekit.config.fn;for(var r=[],n=0;n<e.length;n+=2)for(var s=e[n],o=e[n+1],a=0;a<o.length;a++)r.push(new w(s,o[a]));try{i.Typekit.load({events:!1,classes:!1,async:!0})}catch(t){}t(r)}},2e3):t([])},st.prototype.load=function(t){var e=this.f.id,i=this.c.o,r=this;e?(i.__webfontfontdeckmodule__||(i.__webfontfontdeckmodule__={}),i.__webfontfontdeckmodule__[e]=function(e,i){for(var n=0,s=i.fonts.length;n<s;++n){var o=i.fonts[n];r.a.push(new w(o.name,S("font-weight:"+o.weight+";font-style:"+o.style)))}t(r.a)},_(this.c,(this.f.api||"https://f.fontdeck.com/s/css/js/")+function(t){return t.o.location.hostname||t.a.location.hostname}(this.c)+"/"+e+".js",function(e){e&&t([])})):t([])};var ot=new H(window);ot.a.c.custom=function(t,e){return new W(e,t)},ot.a.c.fontdeck=function(t,e){return new st(e,t)},ot.a.c.monotype=function(t,e){return new j(e,t)},ot.a.c.typekit=function(t,e){return new nt(e,t)},ot.a.c.google=function(t,e){return new it(e,t)};var at={load:o(ot.load,ot)};void 0===(r=function(){return at}.call(e,i,e,t))||(t.exports=r)}()},function(t,e,i){t.exports=i.p+"assets/img/Sword.svg"},function(t,e,i){t.exports=i.p+"assets/img/SimpleBow.svg"},function(t,e,i){t.exports=i.p+"assets/img/SimpleArrow.svg"},function(t,e,i){t.exports=i.p+"assets/img/Shield.svg"},function(t,e,i){t.exports=i.p+"assets/img/RoundShield.svg"},function(t,e,i){t.exports=i.p+"assets/img/Crate.svg"},function(t,e,i){t.exports=i.p+"assets/img/Grass.png"},function(t,e,i){"use strict";(function(t){var e=i(16),r=i(17),n=i.n(r);window.Promise||(window.Promise=e.Polyfill),Object.assign||(Object.assign=n.a);var s="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{};if(Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),!s.performance||!s.performance.now){var o=Date.now();s.performance||(s.performance={}),s.performance.now=function(){return Date.now()-o}}for(var a=Date.now(),h=["ms","moz","webkit","o"],l=0;l<h.length&&!s.requestAnimationFrame;++l){var u=h[l];s.requestAnimationFrame=s[u+"RequestAnimationFrame"],s.cancelAnimationFrame=s[u+"CancelAnimationFrame"]||s[u+"CancelRequestAnimationFrame"]}s.requestAnimationFrame||(s.requestAnimationFrame=function(t){if("function"!=typeof t)throw new TypeError(t+"is not a function");var e=Date.now(),i=16+a-e;return i<0&&(i=0),a=e,setTimeout(function(){a=Date.now(),t(performance.now())},i)}),s.cancelAnimationFrame||(s.cancelAnimationFrame=function(t){return clearTimeout(t)}),Math.sign||(Math.sign=function(t){return 0===(t=Number(t))||isNaN(t)?t:t>0?1:-1}),Number.isInteger||(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),window.ArrayBuffer||(window.ArrayBuffer=Array),window.Float32Array||(window.Float32Array=Array),window.Uint32Array||(window.Uint32Array=Array),window.Uint16Array||(window.Uint16Array=Array),window.Uint8Array||(window.Uint8Array=Array),window.Int32Array||(window.Int32Array=Array)}).call(this,i(3))},function(t,e,i){(function(t){var r=void 0!==t&&t||"undefined"!=typeof self&&self||window,n=Function.prototype.apply;function s(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new s(n.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new s(n.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},i(28),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,i(3))},function(t,e,i){(function(t,e){!function(t,i){"use strict";if(!t.setImmediate){var r,n,s,o,a,h=1,l={},u=!1,c=t.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(t);d=d&&d.setTimeout?d:t,"[object process]"==={}.toString.call(t.process)?r=function(t){e.nextTick(function(){g(t)})}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,i=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=i,e}}()?t.MessageChannel?((s=new MessageChannel).port1.onmessage=function(t){g(t.data)},r=function(t){s.port2.postMessage(t)}):c&&"onreadystatechange"in c.createElement("script")?(n=c.documentElement,r=function(t){var e=c.createElement("script");e.onreadystatechange=function(){g(t),e.onreadystatechange=null,n.removeChild(e),e=null},n.appendChild(e)}):r=function(t){setTimeout(g,0,t)}:(o="setImmediate$"+Math.random()+"$",a=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(o)&&g(+e.data.slice(o.length))},t.addEventListener?t.addEventListener("message",a,!1):t.attachEvent("onmessage",a),r=function(e){t.postMessage(o+e,"*")}),d.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),i=0;i<e.length;i++)e[i]=arguments[i+1];var n={callback:t,args:e};return l[h]=n,r(h),h++},d.clearImmediate=p}function p(t){delete l[t]}function g(t){if(u)setTimeout(g,0,t);else{var e=l[t];if(e){u=!0;try{!function(t){var e=t.callback,r=t.args;switch(r.length){case 0:e();break;case 1:e(r[0]);break;case 2:e(r[0],r[1]);break;case 3:e(r[0],r[1],r[2]);break;default:e.apply(i,r)}}(e)}finally{p(t),u=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,i(3),i(9))},function(t,e,i){(function(t,r){var n;!function(s){e&&e.nodeType,t&&t.nodeType;var o="object"==typeof r&&r;o.global!==o&&o.window!==o&&o.self;var a,h=2147483647,l=36,u=1,c=26,d=38,p=700,g=72,f=128,_="-",m=/^xn--/,y=/[^\x20-\x7E]/,v=/[\x2E\u3002\uFF0E\uFF61]/g,x={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},E=l-u,w=Math.floor,b=String.fromCharCode;function I(t){throw RangeError(x[t])}function T(t,e){for(var i=t.length,r=[];i--;)r[i]=e(t[i]);return r}function S(t,e){var i=t.split("@"),r="";return i.length>1&&(r=i[0]+"@",t=i[1]),r+T((t=t.replace(v,".")).split("."),e).join(".")}function C(t){for(var e,i,r=[],n=0,s=t.length;n<s;)(e=t.charCodeAt(n++))>=55296&&e<=56319&&n<s?56320==(64512&(i=t.charCodeAt(n++)))?r.push(((1023&e)<<10)+(1023&i)+65536):(r.push(e),n--):r.push(e);return r}function N(t){return T(t,function(t){var e="";return t>65535&&(e+=b((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=b(t)}).join("")}function O(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function P(t,e,i){var r=0;for(t=i?w(t/p):t>>1,t+=w(t/e);t>E*c>>1;r+=l)t=w(t/E);return w(r+(E+1)*t/(t+d))}function L(t){var e,i,r,n,s,o,a,d,p,m,y,v=[],x=t.length,E=0,b=f,T=g;for((i=t.lastIndexOf(_))<0&&(i=0),r=0;r<i;++r)t.charCodeAt(r)>=128&&I("not-basic"),v.push(t.charCodeAt(r));for(n=i>0?i+1:0;n<x;){for(s=E,o=1,a=l;n>=x&&I("invalid-input"),((d=(y=t.charCodeAt(n++))-48<10?y-22:y-65<26?y-65:y-97<26?y-97:l)>=l||d>w((h-E)/o))&&I("overflow"),E+=d*o,!(d<(p=a<=T?u:a>=T+c?c:a-T));a+=l)o>w(h/(m=l-p))&&I("overflow"),o*=m;T=P(E-s,e=v.length+1,0==s),w(E/e)>h-b&&I("overflow"),b+=w(E/e),E%=e,v.splice(E++,0,b)}return N(v)}function A(t){var e,i,r,n,s,o,a,d,p,m,y,v,x,E,T,S=[];for(v=(t=C(t)).length,e=f,i=0,s=g,o=0;o<v;++o)(y=t[o])<128&&S.push(b(y));for(r=n=S.length,n&&S.push(_);r<v;){for(a=h,o=0;o<v;++o)(y=t[o])>=e&&y<a&&(a=y);for(a-e>w((h-i)/(x=r+1))&&I("overflow"),i+=(a-e)*x,e=a,o=0;o<v;++o)if((y=t[o])<e&&++i>h&&I("overflow"),y==e){for(d=i,p=l;!(d<(m=p<=s?u:p>=s+c?c:p-s));p+=l)T=d-m,E=l-m,S.push(b(O(m+T%E,0))),d=w(T/E);S.push(b(O(d,0))),s=P(i,x,r==n),i=0,++r}++i,++e}return S.join("")}a={version:"1.3.2",ucs2:{decode:C,encode:N},decode:L,encode:A,toASCII:function(t){return S(t,function(t){return y.test(t)?"xn--"+A(t):t})},toUnicode:function(t){return S(t,function(t){return m.test(t)?L(t.slice(4).toLowerCase()):t})}},void 0===(n=function(){return a}.call(e,i,e,t))||(t.exports=n)}()}).call(this,i(30)(t),i(3))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,i){"use strict";t.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},function(t,e,i){"use strict";e.decode=e.parse=i(33),e.encode=e.stringify=i(34)},function(t,e,i){"use strict";function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,i,s){e=e||"&",i=i||"=";var o={};if("string"!=typeof t||0===t.length)return o;var a=/\+/g;t=t.split(e);var h=1e3;s&&"number"==typeof s.maxKeys&&(h=s.maxKeys);var l=t.length;h>0&&l>h&&(l=h);for(var u=0;u<l;++u){var c,d,p,g,f=t[u].replace(a,"%20"),_=f.indexOf(i);_>=0?(c=f.substr(0,_),d=f.substr(_+1)):(c=f,d=""),p=decodeURIComponent(c),g=decodeURIComponent(d),r(o,p)?n(o[p])?o[p].push(g):o[p]=[o[p],g]:o[p]=g}return o};var n=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},function(t,e,i){"use strict";var r=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,i,a){return e=e||"&",i=i||"=",null===t&&(t=void 0),"object"==typeof t?s(o(t),function(o){var a=encodeURIComponent(r(o))+i;return n(t[o])?s(t[o],function(t){return a+encodeURIComponent(r(t))}).join(e):a+encodeURIComponent(r(t[o]))}).join(e):a?encodeURIComponent(r(a))+i+encodeURIComponent(r(t)):""};var n=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function s(t,e){if(t.map)return t.map(e);for(var i=[],r=0;r<t.length;r++)i.push(e(t[r],r));return i}var o=Object.keys||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.push(i);return e}},function(t,e,i){"use strict";e.__esModule=!0,e.Loader=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),s=l(i(12)),o=l(i(13)),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(i(14)),h=i(15);function l(t){return t&&t.__esModule?t:{default:t}}var u=/(#[\w-]+)?$/,c=e.Loader=function(){function t(){var e=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.baseUrl=i,this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(t,i){return e._loadResource(t,i)},this._queue=a.queue(this._boundLoadResource,r),this._queue.pause(),this.resources={},this.onProgress=new s.default,this.onError=new s.default,this.onLoad=new s.default,this.onStart=new s.default,this.onComplete=new s.default;for(var n=0;n<t._defaultBeforeMiddleware.length;++n)this.pre(t._defaultBeforeMiddleware[n]);for(var o=0;o<t._defaultAfterMiddleware.length;++o)this.use(t._defaultAfterMiddleware[o])}return t.prototype.add=function(t,e,i,n){if(Array.isArray(t)){for(var s=0;s<t.length;++s)this.add(t[s]);return this}if("object"===(void 0===t?"undefined":r(t))&&(n=e||t.callback||t.onComplete,i=t,e=t.url,t=t.name||t.key||t.url),"string"!=typeof e&&(n=i,i=e,e=t),"string"!=typeof e)throw new Error("No url passed to add resource to loader.");if("function"==typeof i&&(n=i,i=null),this.loading&&(!i||!i.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[t])throw new Error('Resource named "'+t+'" already exists.');if(e=this._prepareUrl(e),this.resources[t]=new h.Resource(t,e,i),"function"==typeof n&&this.resources[t].onAfterMiddleware.once(n),this.loading){for(var o=i.parentResource,a=[],l=0;l<o.children.length;++l)o.children[l].isComplete||a.push(o.children[l]);var u=o.progressChunk*(a.length+1)/(a.length+2);o.children.push(this.resources[t]),o.progressChunk=u;for(var c=0;c<a.length;++c)a[c].progressChunk=u;this.resources[t].progressChunk=u}return this._queue.push(this.resources[t]),this},t.prototype.pre=function(t){return this._beforeMiddleware.push(t),this},t.prototype.use=function(t){return this._afterMiddleware.push(t),this},t.prototype.reset=function(){for(var t in this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause(),this.resources){var e=this.resources[t];e._onLoadBinding&&e._onLoadBinding.detach(),e.isLoading&&e.abort()}return this.resources={},this},t.prototype.load=function(t){if("function"==typeof t&&this.onComplete.once(t),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var e=100/this._queue._tasks.length,i=0;i<this._queue._tasks.length;++i)this._queue._tasks[i].data.progressChunk=e;this._onStart(),this._queue.resume()}return this},t.prototype._prepareUrl=function(t){var e=(0,o.default)(t,{strictMode:!0}),i=void 0;if(i=e.protocol||!e.path||0===t.indexOf("//")?t:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==t.charAt(0)?this.baseUrl+"/"+t:this.baseUrl+t,this.defaultQueryString){var r=u.exec(i)[0];-1!==(i=i.substr(0,i.length-r.length)).indexOf("?")?i+="&"+this.defaultQueryString:i+="?"+this.defaultQueryString,i+=r}return i},t.prototype._loadResource=function(t,e){var i=this;t._dequeue=e,a.eachSeries(this._beforeMiddleware,function(e,r){e.call(i,t,function(){r(t.isComplete?{}:null)})},function(){t.isComplete?i._onLoad(t):(t._onLoadBinding=t.onComplete.once(i._onLoad,i),t.load())},!0)},t.prototype._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},t.prototype._onComplete=function(){this.progress=100,this.loading=!1,this.onComplete.dispatch(this,this.resources)},t.prototype._onLoad=function(t){var e=this;t._onLoadBinding=null,this._resourcesParsing.push(t),t._dequeue(),a.eachSeries(this._afterMiddleware,function(i,r){i.call(e,t,r)},function(){t.onAfterMiddleware.dispatch(t),e.progress=Math.min(100,e.progress+t.progressChunk),e.onProgress.dispatch(e,t),t.error?e.onError.dispatch(t.error,e,t):e.onLoad.dispatch(e,t),e._resourcesParsing.splice(e._resourcesParsing.indexOf(t),1),e._queue.idle()&&0===e._resourcesParsing.length&&e._onComplete()},!0)},n(t,[{key:"concurrency",get:function(){return this._queue.concurrency},set:function(t){this._queue.concurrency=t}}]),t}();c._defaultBeforeMiddleware=[],c._defaultAfterMiddleware=[],c.pre=function(t){return c._defaultBeforeMiddleware.push(t),c},c.use=function(t){return c._defaultAfterMiddleware.push(t),c}},function(t,e,i){"use strict";e.__esModule=!0,e.encodeBinary=n;var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function n(t){for(var e="",i=0;i<t.length;){for(var n=[0,0,0],s=[0,0,0,0],o=0;o<n.length;++o)i<t.length?n[o]=255&t.charCodeAt(i++):n[o]=0;switch(s[0]=n[0]>>2,s[1]=(3&n[0])<<4|n[1]>>4,s[2]=(15&n[1])<<2|n[2]>>6,s[3]=63&n[2],i-(t.length-1)){case 2:s[3]=64,s[2]=64;break;case 1:s[3]=64}for(var a=0;a<s.length;++a)e+=r.charAt(s[a])}return e}t.exports.default=n},function(t,e,i){const r=i(5);class n extends r{constructor(t,e){super(t),this.SHAPE="Rectangle",e=e||{},this._vertices=[],this.AABB=[0,0,0,0],this.set(e)}set(t){this.center=t.center||this.article,this.rotation=t.rotation?t.rotation:t.center?t.center:this.article,void 0!==t.square?this._width=this._height=t.square:(this._width=t.width||this.article.width,this._height=t.height||this.article.height),this.noRotate=t.noRotate,this.hw=this._width/2,this.hh=this._height/2,this.update()}get width(){return this._width}set width(t){this._width=t,this.hw=t/2}get height(){return this._height}set height(t){this._height=t,this.hh=t/2}update(){const t=this.AABB,e=this.center;if(this.noRotate){const i=this.hw,r=this.hh;t[0]=e.x-i,t[1]=e.y-r,t[2]=e.x+i,t[3]=e.y+r}else{const i=Math.abs(Math.sin(this.rotation.rotation)/2),r=Math.abs(Math.cos(this.rotation.rotation)/2),n=this._width,s=this._height,o=s*i+n*r,a=s*r+n*i;t[0]=e.x-o,t[1]=e.y-a,t[2]=e.x+o,t[3]=e.y+a}this.verticesDirty=!0}updateVertices(){const t=this._vertices,e=this.center,i=this.hw,r=this.hh;if(this.noRotate){const e=this.AABB;t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[1],t[4]=e[2],t[5]=e[3],t[6]=e[0],t[7]=e[3]}else{const n=this.rotation.rotation,s=Math.sin(n),o=Math.cos(n);t[0]=e.x-i*o+r*s,t[1]=e.y-i*s-r*o,t[2]=e.x+i*o+r*s,t[3]=e.y+i*s-r*o,t[4]=e.x+i*o-r*s,t[5]=e.y+i*s+r*o,t[6]=e.x-i*o-r*s,t[7]=e.y-i*s+r*o}this.verticesDirty=!1}get vertices(){return this.verticesDirty&&this.updateVertices(),this._vertices}collidesRectangle(t){return this.noRotate&&t.noRotate?this.AABBs(t.AABB):this.collidesPolygon(t)}collidesCircle(t){return t.collidesRectangle(this)}static fromRectangle(t,e,i,r){return new n({x:t+i/2,y:e+r/2},{width:i,height:r,noRotate:!0})}}t.exports=n},function(t,e,i){const r=i(5);t.exports=class extends r{constructor(t,e,i){super(t),this.SHAPE="Polygon",i=i||{},this.points=e,this.vertices=[],this.AABB=[],this.set(i)}set(t){t.point&&(this.points=t.points),this.center=t.center||this.article,this.rotation=t.rotation?t.rotation:t.center?t.center:this.article,this.update()}update(){const t=this.rotation.rotation,e=Math.sin(t),i=Math.cos(t);let r=1/0,n=0,s=1/0,o=0;const a=this.points,h=a.length,l=this.vertices,u=this.center;for(let t=0;t<h;t+=2){const h=a[t],c=a[t+1],d=l[t]=u.x+h*i-c*e,p=l[t+1]=u.y+h*e+c*i;r=d<r?d:r,n=d>n?d:n,s=p<s?p:s,o=p>o?p:o}this.AABB[0]=r,this.AABB[1]=s,this.AABB[2]=n,this.AABB[3]=o,this.width=n-r,this.height=o-s,this.hw=(n-r)/2,this.hh=(o-s)/2}collidesRectangle(t){return this.collidesPolygon(t)}collidesCircle(t){return t.collidesPolygon(this)}}},function(t,e,i){const r=i(5);t.exports=class extends r{constructor(t,e){super(t),this.SHAPE="Circle",this.AABB=[],e=e||{},this.set(e)}set(t){this.radius=t.radius||this.article.width/2,this.radiusSquared=this.radius*this.radius,this.center=t.positionObject?t.positionObject:this.article,this.update()}update(){const t=this.AABB,e=this.radius,i=this.center;t[0]=i.x-e,t[1]=i.y-e,t[2]=i.x+e,t[3]=i.y+e}collidesCircle(t){const e=this.center,i=t.center,r=i.x-e.x,n=i.y-e.y,s=t.radius+this.radius;return r*r+n*n<=s*s}collidesPoint(t){const e=t.x-this.center.x,i=t.y-this.center.y;return e*e+i*i<=this.radiusSquared}collidesLine(t,e){function i(t,e){return t[0]*e[0]+t[1]*e[1]}const r=this.center,n=[r.x-t.x,r.y-t.y],s=[e.x-t.x,e.y-t.y],o=i(s,s);let a=i(n,s)/o,h=[s[0]*(a=(a=a<0?0:a)>1?1:a)+t.x-r.x,s[1]*a+t.y-r.y];return i(h,h)<=this.radiusSquared}collidesRectangle(t){if(t.noRotate){const e=t.AABB,i=(e[2]-e[0])/2,r=(e[3]-e[1])/2,n=this.center,s=this.radius,o=Math.abs(n.x-e[0]),a=Math.abs(n.y-e[1]);if(o>i+s||a>r+s)return!1;if(o<=i||a<=r)return!0;const h=o-i,l=a-r;return h*h+l*l<=this.radiusSquared}{const e=this.center;if(t.collidesPoint(e))return!0;const i=t.vertices;return this.collidesLine({x:i[0],y:i[1]},{x:i[2],y:i[3]})||this.collidesLine({x:i[2],y:i[3]},{x:i[4],y:i[5]})||this.collidesLine({x:i[4],y:i[5]},{x:i[6],y:i[7]})||this.collidesLine({x:i[6],y:i[7]},{x:i[0],y:i[1]})}}collidesPolygon(t){const e=this.center;if(t.collidesPoint(e))return!0;const i=t.vertices,r=i.length;for(let t=0;t<r-2;t+=2)if(this.collidesLine({x:i[t],y:i[t+1]},{x:i[t+2],y:i[t+3]}))return!0;return this.collidesLine({x:i[0],y:i[1]},{x:i[r-2],y:i[r-1]})}}},function(t,e,i){var r=i(41);"string"==typeof r&&(r=[[t.i,r,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};i(43)(r,n);r.locals&&(t.exports=r.locals)},function(t,e,i){(t.exports=i(42)(!1)).push([t.i,"/* http://meyerweb.com/eric/tools/css/reset/\n   v4.0 | 20180602\n   License: none (public domain)\n*/\n\nhtml, body, div, span, applet, object, iframe,\nh1, h2, h3, h4, h5, h6, p, blockquote, pre,\na, abbr, acronym, address, big, cite, code,\ndel, dfn, em, img, ins, kbd, q, s, samp,\nsmall, strike, strong, sub, sup, tt, var,\nb, u, i, center,\ndl, dt, dd, ol, ul, li,\nfieldset, form, label, legend,\ntable, caption, tbody, tfoot, thead, tr, th, td,\narticle, aside, canvas, details, embed,\nfigure, figcaption, footer, header, hgroup,\nmain, menu, nav, output, ruby, section, summary,\ntime, mark, audio, video {\n\tmargin: 0;\n\tpadding: 0;\n\tborder: 0;\n\tfont-size: 100%;\n\tfont: inherit;\n\tvertical-align: baseline;\n}\n/* HTML5 display-role reset for older browsers */\narticle, aside, details, figcaption, figure,\nfooter, header, hgroup, main, menu, nav, section {\n\tdisplay: block;\n}\n/* HTML5 hidden-attribute fix for newer browsers */\n*[hidden] {\n    display: none;\n}\nbody {\n\tline-height: 1;\n}\nol, ul {\n\tlist-style: none;\n}\nblockquote, q {\n\tquotes: none;\n}\nblockquote:before, blockquote:after,\nq:before, q:after {\n\tcontent: '';\n\tcontent: none;\n}\ntable {\n\tborder-collapse: collapse;\n\tborder-spacing: 0;\n}\n",""])},function(t,e,i){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var i=function(t,e){var i=t[1]||"",r=t[3];if(!r)return i;if(e&&"function"==typeof btoa){var n=(o=r,a=btoa(unescape(encodeURIComponent(JSON.stringify(o)))),h="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(h," */")),s=r.sources.map(function(t){return"/*# sourceURL=".concat(r.sourceRoot).concat(t," */")});return[i].concat(s).concat([n]).join("\n")}var o,a,h;return[i].join("\n")}(e,t);return e[2]?"@media ".concat(e[2],"{").concat(i,"}"):i}).join("")},e.i=function(t,i){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},n=0;n<this.length;n++){var s=this[n][0];null!=s&&(r[s]=!0)}for(var o=0;o<t.length;o++){var a=t[o];null!=a[0]&&r[a[0]]||(i&&!a[2]?a[2]=i:i&&(a[2]="(".concat(a[2],") and (").concat(i,")")),e.push(a))}},e}},function(t,e,i){var r,n,s={},o=(r=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===n&&(n=r.apply(this,arguments)),n}),a=function(t){var e={};return function(t,i){if("function"==typeof t)return t();if(void 0===e[t]){var r=function(t,e){return e?e.querySelector(t):document.querySelector(t)}.call(this,t,i);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(t){r=null}e[t]=r}return e[t]}}(),h=null,l=0,u=[],c=i(44);function d(t,e){for(var i=0;i<t.length;i++){var r=t[i],n=s[r.id];if(n){n.refs++;for(var o=0;o<n.parts.length;o++)n.parts[o](r.parts[o]);for(;o<r.parts.length;o++)n.parts.push(y(r.parts[o],e))}else{var a=[];for(o=0;o<r.parts.length;o++)a.push(y(r.parts[o],e));s[r.id]={id:r.id,refs:1,parts:a}}}}function p(t,e){for(var i=[],r={},n=0;n<t.length;n++){var s=t[n],o=e.base?s[0]+e.base:s[0],a={css:s[1],media:s[2],sourceMap:s[3]};r[o]?r[o].parts.push(a):i.push(r[o]={id:o,parts:[a]})}return i}function g(t,e){var i=a(t.insertInto);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var r=u[u.length-1];if("top"===t.insertAt)r?r.nextSibling?i.insertBefore(e,r.nextSibling):i.appendChild(e):i.insertBefore(e,i.firstChild),u.push(e);else if("bottom"===t.insertAt)i.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var n=a(t.insertAt.before,i);i.insertBefore(e,n)}}function f(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=u.indexOf(t);e>=0&&u.splice(e,1)}function _(t){var e=document.createElement("style");if(void 0===t.attrs.type&&(t.attrs.type="text/css"),void 0===t.attrs.nonce){var r=function(){0;return i.nc}();r&&(t.attrs.nonce=r)}return m(e,t.attrs),g(t,e),e}function m(t,e){Object.keys(e).forEach(function(i){t.setAttribute(i,e[i])})}function y(t,e){var i,r,n,s;if(e.transform&&t.css){if(!(s="function"==typeof e.transform?e.transform(t.css):e.transform.default(t.css)))return function(){};t.css=s}if(e.singleton){var o=l++;i=h||(h=_(e)),r=E.bind(null,i,o,!1),n=E.bind(null,i,o,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(i=function(t){var e=document.createElement("link");return void 0===t.attrs.type&&(t.attrs.type="text/css"),t.attrs.rel="stylesheet",m(e,t.attrs),g(t,e),e}(e),r=function(t,e,i){var r=i.css,n=i.sourceMap,s=void 0===e.convertToAbsoluteUrls&&n;(e.convertToAbsoluteUrls||s)&&(r=c(r));n&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */");var o=new Blob([r],{type:"text/css"}),a=t.href;t.href=URL.createObjectURL(o),a&&URL.revokeObjectURL(a)}.bind(null,i,e),n=function(){f(i),i.href&&URL.revokeObjectURL(i.href)}):(i=_(e),r=function(t,e){var i=e.css,r=e.media;r&&t.setAttribute("media",r);if(t.styleSheet)t.styleSheet.cssText=i;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(i))}}.bind(null,i),n=function(){f(i)});return r(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;r(t=e)}else n()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=o()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var i=p(t,e);return d(i,e),function(t){for(var r=[],n=0;n<i.length;n++){var o=i[n];(a=s[o.id]).refs--,r.push(a)}t&&d(p(t,e),e);for(n=0;n<r.length;n++){var a;if(0===(a=r[n]).refs){for(var h=0;h<a.parts.length;h++)a.parts[h]();delete s[a.id]}}}};var v,x=(v=[],function(t,e){return v[t]=e,v.filter(Boolean).join("\n")});function E(t,e,i,r){var n=i?"":r.css;if(t.styleSheet)t.styleSheet.cssText=x(e,n);else{var s=document.createTextNode(n),o=t.childNodes;o[e]&&t.removeChild(o[e]),o.length?t.insertBefore(s,o[e]):t.appendChild(s)}}},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var i=e.protocol+"//"+e.host,r=i+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,e){var n,s=e.trim().replace(/^"(.*)"$/,function(t,e){return e}).replace(/^'(.*)'$/,function(t,e){return e});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(s)?t:(n=0===s.indexOf("//")?s:0===s.indexOf("/")?i+s:r+s.replace(/^\.\//,""),"url("+JSON.stringify(n)+")")})}},function(t,e,i){"use strict";i.r(e);i(26);var r=i(1),n=i.n(r);var s={MIPMAP_TEXTURES:1,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function(t){var e=!0;if(n.a.tablet||n.a.phone){if(e=!1,n.a.apple.device){var i=navigator.userAgent.match(/OS (\d+)_(\d+)?/);i&&parseInt(i[1],10)>=11&&(e=!0)}if(n.a.android.device){var r=navigator.userAgent.match(/Android\s([0-9.]*)/);r&&parseInt(r[1],10)>=7&&(e=!0)}}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:n.a.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:!n.a.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},o=i(10),a=i.n(o),h=i(11),l=i.n(h),u=i(6),c=i.n(u),d={WEBGL_LEGACY:0,WEBGL:1,WEBGL2:2},p={UNKNOWN:0,WEBGL:1,CANVAS:2},g={NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16,NORMAL_NPM:17,ADD_NPM:18,SCREEN_NPM:19,NONE:20,SRC_OVER:0,SRC_IN:21,SRC_OUT:22,SRC_ATOP:23,DST_OVER:24,DST_IN:25,DST_OUT:26,DST_ATOP:27,ERASE:26,SUBTRACT:28},f={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},_={RGBA:6408,RGB:6407,ALPHA:6406,LUMINANCE:6409,LUMINANCE_ALPHA:6410,DEPTH_COMPONENT:6402,DEPTH_STENCIL:34041},m={TEXTURE_2D:3553,TEXTURE_CUBE_MAP:34067,TEXTURE_2D_ARRAY:35866,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074},y={UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123,UNSIGNED_SHORT_5_6_5:33635,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,FLOAT:5126,HALF_FLOAT:36193},v=33071,x=10497,E=1,w=1,b={LOW:"lowp",MEDIUM:"mediump",HIGH:"highp"};s.RETINA_PREFIX=/@([0-9\.]+)x/;var I,T=!1,S="5.0.4";function C(t,e){return(e=e||[])[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e}function N(t){return t=t.toString(16),"#"+(t="000000".substr(0,6-t.length)+t)}var O=function(){for(var t=[],e=[],i=0;i<32;i++)t[i]=i,e[i]=i;t[g.NORMAL_NPM]=g.NORMAL,t[g.ADD_NPM]=g.ADD,t[g.SCREEN_NPM]=g.SCREEN,e[g.NORMAL]=g.NORMAL_NPM,e[g.ADD]=g.ADD_NPM,e[g.SCREEN]=g.SCREEN_NPM;var r=[];return r.push(e),r.push(t),r}();function P(t,e){return O[e?1:0][t]}function L(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var i=t>>16&255,r=t>>8&255,n=255&t;return(255*e<<24)+((i=i*e+.5|0)<<16)+((r=r*e+.5|0)<<8)+(n=n*e+.5|0)}function A(t,e,i,r){return(i=i||new Float32Array(4))[0]=(t>>16&255)/255,i[1]=(t>>8&255)/255,i[2]=(255&t)/255,(r||void 0===r)&&(i[0]*=e,i[1]*=e,i[2]*=e),i[3]=e,i}function R(t,e,i){var r,n=t.length;if(!(e>=n||0===i)){var s=n-(i=e+i>n?n-e:i);for(r=e;r<s;++r)t[r]=t[r+i];t.length=s}}var M=0;function D(){return++M}function F(t){return 0===t?0:t<0?-1:1}function B(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function k(t){return!(t&t-1||!t)}function G(t){var e=(t>65535)<<4,i=((t>>>=e)>255)<<3;return e|=i,e|=i=((t>>>=i)>15)<<2,(e|=i=((t>>>=i)>3)<<1)|(t>>>=i)>>1}var U={},Y=Object.create(null),z=Object.create(null);var X=function(t,e,i){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=i||s.RESOLUTION,this.resize(t,e)},q={width:{configurable:!0},height:{configurable:!0}};X.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},X.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},X.prototype.destroy=function(){this.context=null,this.canvas=null},q.width.get=function(){return this.canvas.width},q.width.set=function(t){this.canvas.width=t},q.height.get=function(){return this.canvas.height},q.height.set=function(t){this.canvas.height=t},Object.defineProperties(X.prototype,q);var H;function V(t,e){var i=s.RETINA_PREFIX.exec(t);return i?parseFloat(i[1]):void 0!==e?e:1}var j={};function W(t,e,i){if(void 0===i&&(i=3),!j[e]){var r=(new Error).stack;void 0===r?console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t):(r=r.split("\n").splice(i).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",e+"\nDeprecated since v"+t),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t),console.warn(r))),j[e]=!0}}var K=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e};K.prototype.clone=function(){return new K(this.x,this.y)},K.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},K.prototype.copyTo=function(t){return t.set(this.x,this.y),t},K.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},K.prototype.set=function(t,e){this.x=t||0,this.y=e||(0!==e?this.x:0)};var Z=function(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0),this._x=i,this._y=r,this.cb=t,this.scope=e},J={x:{configurable:!0},y:{configurable:!0}};Z.prototype.clone=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null);var i=t||this.cb,r=e||this.scope;return new Z(i,r,this._x,this._y)},Z.prototype.set=function(t,e){var i=t||0,r=e||(0!==e?i:0);this._x===i&&this._y===r||(this._x=i,this._y=r,this.cb.call(this.scope))},Z.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},Z.prototype.copyTo=function(t){return t.set(this._x,this._y),t},Z.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},J.x.get=function(){return this._x},J.x.set=function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},J.y.get=function(){return this._y},J.y.set=function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},Object.defineProperties(Z.prototype,J);var Q=2*Math.PI,$=180/Math.PI,tt=Math.PI/180,et={POLY:0,RECT:1,CIRC:2,ELIP:3,RREC:4},it=function(t,e,i,r,n,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s,this.array=null},rt={IDENTITY:{configurable:!0},TEMP_MATRIX:{configurable:!0}};it.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},it.prototype.set=function(t,e,i,r,n,s){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=s,this},it.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i},it.prototype.apply=function(t,e){e=e||new K;var i=t.x,r=t.y;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e},it.prototype.applyInverse=function(t,e){e=e||new K;var i=1/(this.a*this.d+this.c*-this.b),r=t.x,n=t.y;return e.x=this.d*i*r+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*n+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,e},it.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},it.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},it.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,s=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=s*e-this.ty*i,this.ty=s*i+this.ty*e,this},it.prototype.append=function(t){var e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this},it.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(i*this.a+r*this.c),this.ty=e-(i*this.b+r*this.d),this},it.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},it.prototype.decompose=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,s=-Math.atan2(-r,n),o=Math.atan2(i,e),a=Math.abs(s+o);return a<1e-5||Math.abs(Q-a)<1e-5?(t.rotation=o,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=o),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx,t.position.y=this.ty,t},it.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,s=t*r-e*i;return this.a=r/s,this.b=-e/s,this.c=-i/s,this.d=t/s,this.tx=(i*this.ty-r*n)/s,this.ty=-(t*this.ty-e*n)/s,this},it.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},it.prototype.clone=function(){var t=new it;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},it.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},it.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},rt.IDENTITY.get=function(){return new it},rt.TEMP_MATRIX.get=function(){return new it},Object.defineProperties(it,rt);var nt=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],st=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],ot=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],at=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],ht=[],lt=[];function ut(t){return t<0?-1:t>0?1:0}!function(){for(var t=0;t<16;t++){var e=[];lt.push(e);for(var i=0;i<16;i++)for(var r=ut(nt[t]*nt[i]+ot[t]*st[i]),n=ut(st[t]*nt[i]+at[t]*st[i]),s=ut(nt[t]*ot[i]+ot[t]*at[i]),o=ut(st[t]*ot[i]+at[t]*at[i]),a=0;a<16;a++)if(nt[a]===r&&st[a]===n&&ot[a]===s&&at[a]===o){e.push(a);break}}for(var h=0;h<16;h++){var l=new it;l.set(nt[h],st[h],ot[h],at[h],0,0),ht.push(l)}}();var ct={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MIRROR_HORIZONTAL:12,uX:function(t){return nt[t]},uY:function(t){return st[t]},vX:function(t){return ot[t]},vY:function(t){return at[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return lt[t][e]},sub:function(t,e){return lt[t][ct.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?e>=0?ct.S:ct.N:2*Math.abs(e)<=Math.abs(t)?t>0?ct.E:ct.W:e>0?t>0?ct.SE:ct.SW:t>0?ct.NE:ct.NW},matrixAppendRotationInv:function(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0);var n=ht[ct.inv(e)];n.tx=i,n.ty=r,t.append(n)}},dt=function(){this.worldTransform=new it,this.localTransform=new it,this.position=new Z(this.onChange,this,0,0),this.scale=new Z(this.onChange,this,1,1),this.pivot=new Z(this.onChange,this,0,0),this.skew=new Z(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0},pt={rotation:{configurable:!0}};dt.prototype.onChange=function(){this._localID++},dt.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew._y),this._sx=Math.sin(this._rotation+this.skew._y),this._cy=-Math.sin(this._rotation-this.skew._x),this._sy=Math.cos(this._rotation-this.skew._x),this._localID++},dt.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale._x,t.b=this._sx*this.scale._x,t.c=this._cy*this.scale._y,t.d=this._sy*this.scale._y,t.tx=this.position._x-(this.pivot._x*t.a+this.pivot._y*t.c),t.ty=this.position._y-(this.pivot._x*t.b+this.pivot._y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},dt.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale._x,e.b=this._sx*this.scale._x,e.c=this._cy*this.scale._y,e.d=this._sy*this.scale._y,e.tx=this.position._x-(this.pivot._x*e.a+this.pivot._y*e.c),e.ty=this.position._y-(this.pivot._x*e.b+this.pivot._y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var i=t.worldTransform,r=this.worldTransform;r.a=e.a*i.a+e.b*i.c,r.b=e.a*i.b+e.b*i.d,r.c=e.c*i.a+e.d*i.c,r.d=e.c*i.b+e.d*i.d,r.tx=e.tx*i.a+e.ty*i.c+i.tx,r.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}},dt.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},pt.rotation.get=function(){return this._rotation},pt.rotation.set=function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},Object.defineProperties(dt.prototype,pt),dt.IDENTITY=new dt;var gt=function(t,e,i,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(r),this.type=et.RECT},ft={left:{configurable:!0},right:{configurable:!0},top:{configurable:!0},bottom:{configurable:!0}},_t={EMPTY:{configurable:!0}};ft.left.get=function(){return this.x},ft.right.get=function(){return this.x+this.width},ft.top.get=function(){return this.y},ft.bottom.get=function(){return this.y+this.height},_t.EMPTY.get=function(){return new gt(0,0,0,0)},gt.prototype.clone=function(){return new gt(this.x,this.y,this.width,this.height)},gt.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},gt.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},gt.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height)},gt.prototype.pad=function(t,e){t=t||0,e=e||(0!==e?t:0),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e},gt.prototype.fit=function(t){var e=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(n-r,0)},gt.prototype.ceil=function(t,e){void 0===t&&(t=1),void 0===e&&(e=.001);var i=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=r-this.y},gt.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);this.x=e,this.width=i-e,this.y=r,this.height=n-r},Object.defineProperties(gt.prototype,ft),Object.defineProperties(gt,_t);var mt=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.radius=i,this.type=et.CIRC};mt.prototype.clone=function(){return new mt(this.x,this.y,this.radius)},mt.prototype.contains=function(t,e){if(this.radius<=0)return!1;var i=this.radius*this.radius,r=this.x-t,n=this.y-e;return(r*=r)+(n*=n)<=i},mt.prototype.getBounds=function(){return new gt(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)};var yt=function(t,e,i,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=t,this.y=e,this.width=i,this.height=r,this.type=et.ELIP};yt.prototype.clone=function(){return new yt(this.x,this.y,this.width,this.height)},yt.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,r=(e-this.y)/this.height;return(i*=i)+(r*=r)<=1},yt.prototype.getBounds=function(){return new gt(this.x-this.width,this.y-this.height,this.width,this.height)};var vt=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];if(Array.isArray(t[0])&&(t=t[0]),t[0]instanceof K){for(var i=[],r=0,n=t.length;r<n;r++)i.push(t[r].x,t[r].y);t=i}this.points=t,this.type=et.POLY,this.closeStroke=!0};vt.prototype.clone=function(){var t=new vt(this.points.slice());return t.closeStroke=this.closeStroke,t},vt.prototype.contains=function(t,e){for(var i=!1,r=this.points.length/2,n=0,s=r-1;n<r;s=n++){var o=this.points[2*n],a=this.points[2*n+1],h=this.points[2*s],l=this.points[2*s+1];a>e!=l>e&&t<(e-a)/(l-a)*(h-o)+o&&(i=!i)}return i};var xt=function(t,e,i,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),void 0===n&&(n=20),this.x=t,this.y=e,this.width=i,this.height=r,this.radius=n,this.type=et.RREC};xt.prototype.clone=function(){return new xt(this.x,this.y,this.width,this.height,this.radius)},xt.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){if(e>=this.y+this.radius&&e<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var i=t-(this.x+this.radius),r=e-(this.y+this.radius),n=this.radius*this.radius;if(i*i+r*r<=n)return!0;if((i=t-(this.x+this.width-this.radius))*i+r*r<=n)return!0;if(i*i+(r=e-(this.y+this.height-this.radius))*r<=n)return!0;if((i=t-(this.x+this.radius))*i+r*r<=n)return!0}return!1},s.SORTABLE_CHILDREN=!1;var Et=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null};Et.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},Et.prototype.clear=function(){this.updateID++,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},Et.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?gt.EMPTY:((t=t||new gt(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},Et.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},Et.prototype.addQuad=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY,s=t[0],o=t[1];e=s<e?s:e,i=o<i?o:i,r=s>r?s:r,n=o>n?o:n,e=(s=t[2])<e?s:e,i=(o=t[3])<i?o:i,r=s>r?s:r,n=o>n?o:n,e=(s=t[4])<e?s:e,i=(o=t[5])<i?o:i,r=s>r?s:r,n=o>n?o:n,e=(s=t[6])<e?s:e,i=(o=t[7])<i?o:i,r=s>r?s:r,n=o>n?o:n,this.minX=e,this.minY=i,this.maxX=r,this.maxY=n},Et.prototype.addFrame=function(t,e,i,r,n){var s=t.worldTransform,o=s.a,a=s.b,h=s.c,l=s.d,u=s.tx,c=s.ty,d=this.minX,p=this.minY,g=this.maxX,f=this.maxY,_=o*e+h*i+u,m=a*e+l*i+c;d=_<d?_:d,p=m<p?m:p,g=_>g?_:g,f=m>f?m:f,d=(_=o*r+h*i+u)<d?_:d,p=(m=a*r+l*i+c)<p?m:p,g=_>g?_:g,f=m>f?m:f,d=(_=o*e+h*n+u)<d?_:d,p=(m=a*e+l*n+c)<p?m:p,g=_>g?_:g,f=m>f?m:f,d=(_=o*r+h*n+u)<d?_:d,p=(m=a*r+l*n+c)<p?m:p,g=_>g?_:g,f=m>f?m:f,this.minX=d,this.minY=p,this.maxX=g,this.maxY=f},Et.prototype.addVertexData=function(t,e,i){for(var r=this.minX,n=this.minY,s=this.maxX,o=this.maxY,a=e;a<i;a+=2){var h=t[a],l=t[a+1];r=h<r?h:r,n=l<n?l:n,s=h>s?h:s,o=l>o?l:o}this.minX=r,this.minY=n,this.maxX=s,this.maxY=o},Et.prototype.addVertices=function(t,e,i,r){for(var n=t.worldTransform,s=n.a,o=n.b,a=n.c,h=n.d,l=n.tx,u=n.ty,c=this.minX,d=this.minY,p=this.maxX,g=this.maxY,f=i;f<r;f+=2){var _=e[f],m=e[f+1],y=s*_+a*m+l,v=h*m+o*_+u;c=y<c?y:c,d=v<d?v:d,p=y>p?y:p,g=v>g?v:g}this.minX=c,this.minY=d,this.maxX=p,this.maxY=g},Et.prototype.addBounds=function(t){var e=this.minX,i=this.minY,r=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>n?t.maxY:n},Et.prototype.addBoundsMask=function(t,e){var i=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=n&&r<=s){var o=this.minX,a=this.minY,h=this.maxX,l=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=n>h?n:h,this.maxY=s>l?s:l}},Et.prototype.addBoundsArea=function(t,e){var i=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=n&&r<=s){var o=this.minX,a=this.minY,h=this.maxX,l=this.maxY;this.minX=i<o?i:o,this.minY=r<a?r:a,this.maxX=n>h?n:h,this.maxY=s>l?s:l}};var wt=function(t){function e(){t.call(this),this.tempDisplayObjectParent=null,this.transform=new dt,this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new Et,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._destroyed=!1,this.isSprite=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return e.mixin=function(t){for(var i=Object.keys(t),r=0;r<i.length;++r){var n=i[r];Object.defineProperty(e.prototype,n,Object.getOwnPropertyDescriptor(t,n))}},i._tempDisplayObjectParent.get=function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new e),this.tempDisplayObjectParent},e.prototype.updateTransform=function(){this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha,this._bounds.updateID++},e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},e.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&this.calculateBounds(),e||(this._boundsRect||(this._boundsRect=new gt),e=this._boundsRect),this._bounds.getRectangle(e)},e.prototype.getLocalBounds=function(t){var e=this.transform,i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,t||(this._localBoundsRect||(this._localBoundsRect=new gt),t=this._localBoundsRect);var r=this.getBounds(!1,t);return this.parent=i,this.transform=e,r},e.prototype.toGlobal=function(t,e,i){return void 0===i&&(i=!1),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},e.prototype.toLocal=function(t,e,i,r){return e&&(t=e.toGlobal(t,i,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)},e.prototype.render=function(t){},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},e.prototype.setTransform=function(t,e,i,r,n,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=1),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=r||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},e.prototype.destroy=function(){this.removeAllListeners(),this.parent&&this.parent.removeChild(this),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filterArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},i.x.get=function(){return this.position.x},i.x.set=function(t){this.transform.position.x=t},i.y.get=function(){return this.position.y},i.y.set=function(t){this.transform.position.y=t},i.worldTransform.get=function(){return this.transform.worldTransform},i.localTransform.get=function(){return this.transform.localTransform},i.position.get=function(){return this.transform.position},i.position.set=function(t){this.transform.position.copyFrom(t)},i.scale.get=function(){return this.transform.scale},i.scale.set=function(t){this.transform.scale.copyFrom(t)},i.pivot.get=function(){return this.transform.pivot},i.pivot.set=function(t){this.transform.pivot.copyFrom(t)},i.skew.get=function(){return this.transform.skew},i.skew.set=function(t){this.transform.skew.copyFrom(t)},i.rotation.get=function(){return this.transform.rotation},i.rotation.set=function(t){this.transform.rotation=t},i.angle.get=function(){return this.transform.rotation*$},i.angle.set=function(t){this.transform.rotation=t*tt},i.zIndex.get=function(){return this._zIndex},i.zIndex.set=function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},i.worldVisible.get=function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},i.mask.get=function(){return this._mask},i.mask.set=function(t){this._mask&&(this._mask.renderable=!0,this._mask.isMask=!1),this._mask=t,this._mask&&(this._mask.renderable=!1,this._mask.isMask=!0)},Object.defineProperties(e.prototype,i),e}(a.a);function bt(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}wt.prototype.displayObjectUpdateTransform=wt.prototype.updateTransform;var It=function(t){function e(){t.call(this),this.children=[],this.sortableChildren=s.SORTABLE_CHILDREN,this.sortDirty=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={width:{configurable:!0},height:{configurable:!0}};return e.prototype.onChildrenChange=function(){},e.prototype.addChild=function(t){var e=arguments,i=arguments.length;if(i>1)for(var r=0;r<i;r++)this.addChild(e[r]);else t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this);return t},e.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t},e.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),r=this.getChildIndex(e);this.children[i]=e,this.children[r]=t,this.onChildrenChange(i<r?i:r)}},e.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},e.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var i=this.getChildIndex(t);R(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},e.prototype.removeChild=function(t){var e=arguments,i=arguments.length;if(i>1)for(var r=0;r<i;r++)this.removeChild(e[r]);else{var n=this.children.indexOf(t);if(-1===n)return null;t.parent=null,t.transform._parentID=-1,R(this.children,n,1),this._boundsID++,this.onChildrenChange(n),t.emit("removed",this),this.emit("childRemoved",t,this,n)}return t},e.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,R(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},e.prototype.removeChildren=function(t,e){void 0===t&&(t=0);var i,r=t,n="number"==typeof e?e:this.children.length,s=n-r;if(s>0&&s<=n){i=this.children.splice(r,s);for(var o=0;o<i.length;++o)i[o].parent=null,i[o].transform&&(i[o].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(var a=0;a<i.length;++a)i[a].emit("removed",this),this.emit("childRemoved",i[a],this,a);return i}if(0===s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},e.prototype.sortChildren=function(){for(var t=!1,e=0,i=this.children.length;e<i;++e){var r=this.children[e];r._lastSortedIndex=e,t||0===r.zIndex||(t=!0)}t&&this.children.length>1&&this.children.sort(bt),this.sortDirty=!1},e.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var i=this.children[t];i.visible&&i.updateTransform()}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];e.visible&&e.renderable&&(e.calculateBounds(),e._mask?(e._mask.calculateBounds(),this._bounds.addBoundsMask(e._bounds,e._mask._bounds)):e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds))}this._lastBoundsID=this._boundsID},e.prototype._calculateBounds=function(){},e.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters)this.renderAdvanced(t);else{this._render(t);for(var e=0,i=this.children.length;e<i;++e)this.children[e].render(t)}},e.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var r=0;r<e.length;r++)e[r].enabled&&this._enabledFilters.push(e[r]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}i&&t.mask.push(this,this._mask),this._render(t);for(var n=0,s=this.children.length;n<s;n++)this.children[n].render(t);t.batch.flush(),i&&t.mask.pop(this,this._mask),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},e.prototype._render=function(t){},e.prototype.destroy=function(e){t.prototype.destroy.call(this),this.sortDirty=!1;var i="boolean"==typeof e?e:e&&e.children,r=this.removeChildren(0,this.children.length);if(i)for(var n=0;n<r.length;++n)r[n].destroy(e)},i.width.get=function(){return this.scale.x*this.getLocalBounds().width},i.width.set=function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},i.height.get=function(){return this.scale.y*this.getLocalBounds().height},i.height.set=function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},Object.defineProperties(e.prototype,i),e}(wt);It.prototype.containerUpdateTransform=It.prototype.updateTransform;wt.mixin({accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:!1});var Tt=function(t){this._hookDiv=null,(n.a.tablet||n.a.phone)&&this.createTouchHook();var e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.zIndex=2,this.div=e,this.pool=[],this.renderId=0,this.debug=!1,this.renderer=t,this.children=[],this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this.isActive=!1,this.isMobileAccessibility=!1,window.addEventListener("keydown",this._onKeyDown,!1)};Tt.prototype.createTouchHook=function(){var t=this,e=document.createElement("button");e.style.width="1px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.style.zIndex=2,e.style.backgroundColor="#FF0000",e.title="HOOK DIV",e.addEventListener("focus",function(){t.isMobileAccessibility=!0,t.activate(),t.destroyTouchHook()}),document.body.appendChild(e),this._hookDiv=e},Tt.prototype.destroyTouchHook=function(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)},Tt.prototype.activate=function(){this.isActive||(this.isActive=!0,window.document.addEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode&&this.renderer.view.parentNode.appendChild(this.div))},Tt.prototype.deactivate=function(){this.isActive&&!this.isMobileAccessibility&&(this.isActive=!1,window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode&&this.div.parentNode.removeChild(this.div))},Tt.prototype.updateAccessibleObjects=function(t){if(t.visible){t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);for(var e=t.children,i=0;i<e.length;i++)this.updateAccessibleObjects(e[i])}},Tt.prototype.update=function(){if(this.renderer.renderingToScreen){this.updateAccessibleObjects(this.renderer._lastObjectRendered);var t=this.renderer.view.getBoundingClientRect(),e=t.width/this.renderer.width,i=t.height/this.renderer.height,r=this.div;r.style.left=t.left+"px",r.style.top=t.top+"px",r.style.width=this.renderer.width+"px",r.style.height=this.renderer.height+"px";for(var n=0;n<this.children.length;n++){var s=this.children[n];if(s.renderId!==this.renderId)s._accessibleActive=!1,R(this.children,n,1),this.div.removeChild(s._accessibleDiv),this.pool.push(s._accessibleDiv),s._accessibleDiv=null,n--,0===this.children.length&&this.deactivate();else{r=s._accessibleDiv;var o=s.hitArea,a=s.worldTransform;s.hitArea?(r.style.left=(a.tx+o.x*a.a)*e+"px",r.style.top=(a.ty+o.y*a.d)*i+"px",r.style.width=o.width*a.a*e+"px",r.style.height=o.height*a.d*i+"px"):(o=s.getBounds(),this.capHitArea(o),r.style.left=o.x*e+"px",r.style.top=o.y*i+"px",r.style.width=o.width*e+"px",r.style.height=o.height*i+"px",r.title!==s.accessibleTitle&&null!==s.accessibleTitle&&(r.title=s.accessibleTitle),r.getAttribute("aria-label")!==s.accessibleHint&&null!==s.accessibleHint&&r.setAttribute("aria-label",s.accessibleHint))}}this.renderId++}},Tt.prototype.capHitArea=function(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0),t.x+t.width>this.renderer.width&&(t.width=this.renderer.width-t.x),t.y+t.height>this.renderer.height&&(t.height=this.renderer.height-t.y)},Tt.prototype.addChild=function(t){var e=this.pool.pop();e||((e=document.createElement("button")).style.width="100px",e.style.height="100px",e.style.backgroundColor=this.debug?"rgba(255,0,0,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=2,e.style.borderStyle="none",navigator.userAgent.toLowerCase().indexOf("chrome")>-1?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),t.accessibleTitle&&null!==t.accessibleTitle?e.title=t.accessibleTitle:t.accessibleHint&&null!==t.accessibleHint||(e.title="displayObject "+t.tabIndex),t.accessibleHint&&null!==t.accessibleHint&&e.setAttribute("aria-label",t.accessibleHint),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex},Tt.prototype._onClick=function(t){var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"click",e.eventData)},Tt.prototype._onFocus=function(t){t.target.getAttribute("aria-live","off")||t.target.setAttribute("aria-live","assertive");var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"mouseover",e.eventData)},Tt.prototype._onFocusOut=function(t){t.target.getAttribute("aria-live","off")||t.target.setAttribute("aria-live","polite");var e=this.renderer.plugins.interaction;e.dispatchEvent(t.target.displayObject,"mouseout",e.eventData)},Tt.prototype._onKeyDown=function(t){9===t.keyCode&&this.activate()},Tt.prototype._onMouseMove=function(t){0===t.movementX&&0===t.movementY||this.deactivate()},Tt.prototype.destroy=function(){this.destroyTouchHook(),this.div=null;for(var t=0;t<this.children.length;t++)this.children[t].div=null;window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null};var St=function(t){this.items=[],this._name=t},Ct={empty:{configurable:!0},name:{configurable:!0}};St.prototype.emit=function(t,e,i,r,n,s,o,a){if(arguments.length>8)throw new Error("max arguments reached");for(var h=this.name,l=this.items,u=0,c=l.length;u<c;u++)l[u][h](t,e,i,r,n,s,o,a);return this},St.prototype.add=function(t){return t[this._name]&&(this.remove(t),this.items.push(t)),this},St.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&this.items.splice(e,1),this},St.prototype.contains=function(t){return-1!==this.items.indexOf(t)},St.prototype.removeAll=function(){return this.items.length=0,this},St.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Ct.empty.get=function(){return 0===this.items.length},Ct.name.get=function(){return this._name},Object.defineProperties(St.prototype,Ct),St.prototype.dispatch=St.prototype.emit,St.prototype.run=St.prototype.emit,s.TARGET_FPMS=.06;var Nt=50,Ot=0,Pt=-25,Lt=-50,At=function(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=0),void 0===r&&(r=!1),this.fn=t,this.context=e,this.priority=i,this.once=r,this.next=null,this.previous=null,this._destroyed=!1};At.prototype.match=function(t,e){return e=e||null,this.fn===t&&this.context===e},At.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},At.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},At.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e};var Rt=function(){var t=this;this._head=new At(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/s.TARGET_FPMS,this.elapsedMS=1/s.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}},Mt={FPS:{configurable:!0},minFPS:{configurable:!0},maxFPS:{configurable:!0}},Dt={shared:{configurable:!0},system:{configurable:!0}};Rt.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._requestId=requestAnimationFrame(this._tick))},Rt.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},Rt.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},Rt.prototype.add=function(t,e,i){return void 0===i&&(i=Ot),this._addListener(new At(t,e,i))},Rt.prototype.addOnce=function(t,e,i){return void 0===i&&(i=Ot),this._addListener(new At(t,e,i,!0))},Rt.prototype._addListener=function(t){var e=this._head.next,i=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(i);break}i=e,e=e.next}t.previous||t.connect(i)}else t.connect(i);return this._startIfPossible(),this},Rt.prototype.remove=function(t,e){for(var i=this._head.next;i;)i=i.match(t,e)?i.destroy():i.next;return this._head.next||this._cancelIfNeeded(),this},Rt.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},Rt.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},Rt.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},Rt.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS&&e+1<this._minElapsedMS)return;this.deltaMS=e,this.deltaTime=this.deltaMS*s.TARGET_FPMS;for(var i=this._head,r=i.next;r;)r=r.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Mt.FPS.get=function(){return 1e3/this.elapsedMS},Mt.minFPS.get=function(){return 1e3/this._maxElapsedMS},Mt.minFPS.set=function(t){var e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,s.TARGET_FPMS);this._maxElapsedMS=1/i},Mt.maxFPS.get=function(){return this._minElapsedMS?1e3/this._minElapsedMS:1e3*s.TARGET_FPMS},Mt.maxFPS.set=function(t){if(t/1e3>=s.TARGET_FPMS)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t),i=Math.min(Math.max(1,e)/1e3,s.TARGET_FPMS);this._minElapsedMS=1/i}},Dt.shared.get=function(){if(!Rt._shared){var t=Rt._shared=new Rt;t.autoStart=!0,t._protected=!0}return Rt._shared},Dt.system.get=function(){if(!Rt._system){var t=Rt._system=new Rt;t.autoStart=!0,t._protected=!0}return Rt._system},Object.defineProperties(Rt.prototype,Mt),Object.defineProperties(Rt,Dt);var Ft=function(){};Ft.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,Pt)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?Rt.shared:new Rt,t.autoStart&&this.start()},Ft.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}};var Bt=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new St("setRealSize",2),this.onUpdate=new St("update")},kt={valid:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};Bt.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),(this._width||this._height)&&this.onResize.run(this._width,this._height)},Bt.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t)},Bt.prototype.resize=function(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,this.onResize.run(t,e))},kt.valid.get=function(){return!!this._width&&!!this._height},Bt.prototype.update=function(){this.destroyed||this.onUpdate.run()},Bt.prototype.load=function(){return Promise.resolve()},kt.width.get=function(){return this._width},kt.height.get=function(){return this._height},Bt.prototype.upload=function(t,e,i){return!1},Bt.prototype.style=function(t,e,i){return!1},Bt.prototype.dispose=function(){},Bt.prototype.destroy=function(){this.destroyed||(this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null,this.destroyed=!0,this.dispose())},Object.defineProperties(Bt.prototype,kt);var Gt=function(t){function e(e){var i=e.naturalWidth||e.videoWidth||e.width,r=e.naturalHeight||e.videoHeight||e.height;t.call(this,i,r),this.source=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.crossOrigin=function(t,e,i){void 0===i&&0!==e.indexOf("data:")?t.crossOrigin=function(t,e){if(void 0===e&&(e=window.location),0===t.indexOf("data:"))return"";e=e||window.location,H||(H=document.createElement("a")),H.href=t;var i=!(t=c.a.parse(H.href)).port&&""===e.port||t.port===e.port;return t.hostname===e.hostname&&i&&t.protocol===e.protocol?"":"anonymous"}(e):!1!==i&&(t.crossOrigin="string"==typeof i?i:"anonymous")},e.prototype.upload=function(t,e,i,r){var n=t.gl,s=e.realWidth,o=e.realHeight;return r=r||this.source,n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),e.target===n.TEXTURE_2D&&i.width===s&&i.height===o?n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,e.type,r):(i.width=s,i.height=o,n.texImage2D(e.target,0,e.format,e.format,e.type,r)),!0},e.prototype.update=function(){if(!this.destroyed){var e=this.source.naturalWidth||this.source.videoWidth||this.source.width,i=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(e,i),t.prototype.update.call(this)}},e.prototype.dispose=function(){this.source=null},e}(Bt),Ut=function(t){function e(e,i){if(i=i||{},!(e instanceof HTMLImageElement)){var r=new Image;t.crossOrigin(r,e,i.crossorigin),r.src=e,e=r}t.call(this,e),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(void 0!==i.createBitmap?i.createBitmap:s.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,this.premultiplyAlpha=!1!==i.premultiplyAlpha,this.bitmap=null,this._load=null,!1!==i.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(t){var e=this;return void 0!==t&&(this.createBitmap=t),this._load?this._load:(this._load=new Promise(function(t){e.url=e.source.src;var i=e.source,r=function(){e.destroyed||(i.onload=null,i.onerror=null,e.resize(i.width,i.height),e._load=null,e.createBitmap?t(e.process()):t(e))};i.complete&&i.src?r():i.onload=r}),this._load)},e.prototype.process=function(){var t=this;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(this.source,0,0,this.source.width,this.source.height,{premultiplyAlpha:this.premultiplyAlpha?"premultiply":"none"}).then(function(e){return t.destroyed?Promise.reject():(t.bitmap=e,t.update(),t._process=null,Promise.resolve(t))}),this._process):Promise.resolve(this)},e.prototype.upload=function(e,i,r){if(i.premultiplyAlpha=this.premultiplyAlpha,!this.createBitmap)return t.prototype.upload.call(this,e,i,r);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(t.prototype.upload.call(this,e,i,r,this.bitmap),!this.preserveBitmap){var n=!0;for(var s in i._glTextures){var o=i._glTextures[s];if(o!==r&&o.dirtyId!==i.dirtyId){n=!1;break}}n&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},e}(Gt),Yt=[];function zt(t,e){if(!t)return null;var i="";if("string"==typeof t){var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);r&&(i=r[1].toLowerCase())}for(var n=Yt.length-1;n>=0;--n){var s=Yt[n];if(s.test&&s.test(t,i))return new s(t,e)}return new Ut(t,e)}var Xt=function(t){function e(e,i){var r=i||{},n=r.width,s=r.height;if(!n||!s)throw new Error("BufferResource width or height invalid");t.call(this,n,s),this.data=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.upload=function(t,e,i){var r=t.gl;if(r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),i.width===e.width&&i.height===e.height)r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data);else{i.width=e.width,i.height=e.height;var n=e.format;2===t.context.webGLVersion&&e.type===t.gl.FLOAT&&e.format===t.gl.RGBA&&(n=t.gl.RGBA32F),r.texImage2D(e.target,0,n,e.width,e.height,0,e.format,e.type,this.data)}return!0},e.prototype.dispose=function(){this.data=null},e.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},e}(Bt),qt={scaleMode:0,format:_.RGBA,premultiplyAlpha:!1},Ht=function(t){function e(e,i){void 0===e&&(e=null),void 0===i&&(i=null),t.call(this);var r=(i=i||{}).premultiplyAlpha,n=i.mipmap,o=i.scaleMode,a=i.width,h=i.height,l=i.wrapMode,u=i.format,c=i.type,d=i.target,p=i.resolution,g=i.resourceOptions;!e||e instanceof Bt||((e=zt(e,g)).internal=!0),this.width=a||0,this.height=h||0,this.resolution=p||s.RESOLUTION,this.mipmap=void 0!==n?n:s.MIPMAP_TEXTURES,this.wrapMode=l||s.WRAP_MODE,this.scaleMode=void 0!==o?o:s.SCALE_MODE,this.format=u||_.RGBA,this.type=c||y.UNSIGNED_BYTE,this.target=d||m.TEXTURE_2D,this.premultiplyAlpha=!1!==r,this.uid=D(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&h>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this.setResource(e)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={realWidth:{configurable:!0},realHeight:{configurable:!0}};return i.realWidth.get=function(){return this.width*this.resolution},i.realHeight.get=function(){return this.height*this.resolution},e.prototype.setStyle=function(t,e){var i;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,i=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,i=!0),i&&this.dirtyStyleId++,this},e.prototype.setSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t,this.height=e,this._refreshPOT(),this.update(),this},e.prototype.setRealSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},e.prototype._refreshPOT=function(){this.isPowerOfTwo=k(this.realWidth)&&k(this.realHeight)},e.prototype.setResolution=function(t){var e=this.resolution;return e===t?this:(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),this._refreshPOT(),this)},e.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},e.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},e.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete z[this.cacheId],delete Y[this.cacheId],this.cacheId=null),this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},e.prototype.dispose=function(){this.emit("dispose",this)},e.from=function(t,i){var r=null;"string"==typeof t?r=t:(t._pixiId||(t._pixiId="pixiid_"+D()),r=t._pixiId);var n=z[r];return n||((n=new e(t,i)).cacheId=r,e.addToCache(n,r)),n},e.fromBuffer=function(t,i,r,n){t=t||new Float32Array(i*r*4);var s=new Xt(t,{width:i,height:r}),o=t instanceof Float32Array?y.FLOAT:y.UNSIGNED_BYTE;return new e(s,Object.assign(qt,n||{width:i,height:r,type:o}))},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),z[e]&&console.warn("BaseTexture added to the cache with an id ["+e+"] that already had an entry"),z[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=z[t];if(e){var i=e.textureCacheIds.indexOf(t);return i>-1&&e.textureCacheIds.splice(i,1),delete z[t],e}}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)delete z[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},Object.defineProperties(e.prototype,i),e}(a.a);Ht._globalBatch=0;var Vt=function(t){function e(e,i){var r;i=i||{};var n=e;Array.isArray(e)&&(r=e,n=e.length),t.call(this,i.width,i.height),this.items=[],this.itemDirtyIds=[];for(var s=0;s<n;s++){var o=new Ht;this.items.push(o),this.itemDirtyIds.push(-1)}if(this.length=n,this._load=null,r)for(var a=0;a<n;a++)this.addResourceAt(zt(r[a],i),a)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},e.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=m.TEXTURE_2D_ARRAY;for(var i=0;i<this.length;i++)this.items[i].on("update",e.update,e)},e.prototype.unbind=function(e){t.prototype.unbind.call(this,e);for(var i=0;i<this.length;i++)this.items[i].off("update",e.update,e)},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.items.map(function(t){return t.resource}),i=e.map(function(t){return t.load()});return this._load=Promise.all(i).then(function(){var i=e[0],r=i.width,n=i.height;return t.resize(r,n),Promise.resolve(t)}),this._load},e.prototype.upload=function(t,e,i){var r=this.length,n=this.itemDirtyIds,s=this.items,o=t.gl;i.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,e.format,this._width,this._height,r,0,e.format,e.type,null);for(var a=0;a<r;a++){var h=s[a];n[a]<h.dirtyId&&(n[a]=h.dirtyId,h.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,a,h.resource.width,h.resource.height,1,e.format,e.type,h.resource.source))}return!0},e}(Bt),jt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.test=function(t){return t instanceof HTMLCanvasElement},e}(Gt),Wt=function(t){function e(i,r){if(r=r||{},t.call(this,i,r),this.length!==e.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(var n=0;n<e.SIDES;n++)this.items[n].target=m.TEXTURE_CUBE_MAP_POSITIVE_X+n;!1!==r.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=m.TEXTURE_CUBE_MAP},e.prototype.upload=function(t,i,r){for(var n=this.itemDirtyIds,s=0;s<e.SIDES;s++){var o=this.items[s];n[s]<o.dirtyId&&(n[s]=o.dirtyId,o.valid&&o.resource.upload(t,o,r))}return!0},e}(Vt);Wt.SIDES=6;var Kt=function(t){function e(e,i){i=i||{},t.call(this,document.createElement("canvas")),this.svg=e,this.scale=i.scale||1,this._resolve=null,this._crossorigin=i.crossorigin,this._load=null,!1!==i.autoLoad&&this.load()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.load=function(){var t=this;return this._load?this._load:(this._load=new Promise(function(e){if(t._resolve=function(){t.resize(t.source.width,t.source.height),e(t)},/^\<svg/.test(t.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");t.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t.svg)))}t._loadSvg()}),this._load)},e.prototype._loadSvg=function(){var e=this,i=new Image;t.crossOrigin(i,this.svg,this._crossorigin),i.src=this.svg,i.onload=function(){var t=i.width,r=i.height;if(!t||!r)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var n=Math.round(t*e.scale),s=Math.round(r*e.scale),o=e.source;o.width=n,o.height=s,o._pixiId="canvas_"+D(),o.getContext("2d").drawImage(i,0,0,t,r,0,0,n,s),e._resolve(),e._resolve=null}},e.getSize=function(t){var i=e.SVG_SIZE.exec(t),r={};return i&&(r[i[1]]=Math.round(parseFloat(i[3])),r[i[5]]=Math.round(parseFloat(i[7]))),r},e.prototype.dispose=function(){t.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},e.test=function(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},e}(Gt);Kt.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var Zt=function(t){function e(e,i){if(i=i||{},!(e instanceof HTMLVideoElement)){var r=document.createElement("video");r.setAttribute("webkit-playsinline",""),r.setAttribute("playsinline",""),"string"==typeof e&&(e=[e]),t.crossOrigin(r,e[0].src||e[0],i.crossorigin);for(var n=0;n<e.length;++n){var s=document.createElement("source"),o=e[n],a=o.src,h=o.mime,l=(a=a||e[n]).split("?").shift().toLowerCase(),u=l.substr(l.lastIndexOf(".")+1);h=h||"video/"+u,s.src=a,s.type=h,r.appendChild(s)}e=r}t.call(this,e),this._autoUpdate=!0,this._isAutoUpdating=!1,this._updateFPS=i.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==i.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),!1!==i.autoLoad&&this.load()}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return e.prototype.update=function(e){if(void 0===e&&(e=0),!this.destroyed){var i=Rt.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-i),(!this._updateFPS||this._msToNextUpdate<=0)&&(t.prototype.update.call(this,e),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay)),this._load=new Promise(function(i){t.valid?i(t):(t._resolve=i,e.load())}),this._load},e.prototype._isSourcePlaying=function(){var t=this.source;return t.currentTime>0&&!1===t.paused&&!1===t.ended&&t.readyState>2},e.prototype._isSourceReady=function(){return 3===this.source.readyState||4===this.source.readyState},e.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),!this._isAutoUpdating&&this.autoUpdate&&(Rt.shared.add(this.update,this),this._isAutoUpdating=!0)},e.prototype._onPlayStop=function(){this._isAutoUpdating&&(Rt.shared.remove(this.update,this),this._isAutoUpdating=!1)},e.prototype._onCanPlay=function(){var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},e.prototype.dispose=function(){this._isAutoUpdating&&Rt.shared.remove(this.update,this),this.source&&(this.source.pause(),this.source.src="",this.source.load()),t.prototype.dispose.call(this)},i.autoUpdate.get=function(){return this._autoUpdate},i.autoUpdate.set=function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isAutoUpdating?(Rt.shared.remove(this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(Rt.shared.add(this.update,this),this._isAutoUpdating=!0))},i.updateFPS.get=function(){return this._updateFPS},i.updateFPS.set=function(t){t!==this._updateFPS&&(this._updateFPS=t)},e.test=function(t,i){return t instanceof HTMLVideoElement||e.TYPES.indexOf(i)>-1},Object.defineProperties(e.prototype,i),e}(Gt);Zt.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],Yt.push(Ut,jt,Zt,Kt,Xt,Wt,Vt);var Jt=function(t){this.renderer=t,this.renderer.runners.contextChange.add(this)};Jt.prototype.contextChange=function(t){},Jt.prototype.destroy=function(){this.renderer.runners.contextChange.remove(this),this.renderer=null};var Qt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.upload=function(t,e,i){var r=t.gl;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(e.target,0,r.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}(Xt),$t=function(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new St("disposeFramebuffer",2)},te={colorTexture:{configurable:!0}};te.colorTexture.get=function(){return this.colorTextures[0]},$t.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),this.colorTextures[t]=e||new Ht(null,{scaleMode:0,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},$t.prototype.addDepthTexture=function(t){return this.depthTexture=t||new Ht(new Qt(null,{width:this.width,height:this.height}),{scaleMode:0,resolution:1,width:this.width,height:this.height,mipmap:!1,format:_.DEPTH_COMPONENT,type:y.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},$t.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},$t.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},$t.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var i=0;i<this.colorTextures.length;i++){var r=this.colorTextures[i],n=r.resolution;r.setSize(t/n,e/n)}if(this.depthTexture){var s=this.depthTexture.resolution;this.depthTexture.setSize(t/s,e/s)}}},$t.prototype.dispose=function(){this.disposeRunner.run(this,!1)},Object.defineProperties($t.prototype,te);var ee=function(t){function e(e){"number"==typeof e&&(e={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]});t.call(this,null,e);var i=e||{},r=i.width,n=i.height;this.mipmap=!1,this.width=Math.ceil(r)||100,this.height=Math.ceil(n)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new $t(this.width*this.resolution,this.height*this.resolution).addColorTexture(0,this).enableStencil(),this.stencilMaskStack=[],this.filterStack=[{}]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),this.framebuffer.resize(t*this.resolution,e*this.resolution)},e.prototype.dispose=function(){this.framebuffer.dispose(),t.prototype.dispose.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this,!0),this.framebuffer=null,this.renderer=null},e}(Ht),ie=function(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)};ie.prototype.set=function(t,e,i){var r=e.width,n=e.height;if(i){var s=t.width/2/r,o=t.height/2/n,a=t.x/r+s,h=t.y/n+o;i=ct.add(i,ct.NW),this.x0=a+s*ct.uX(i),this.y0=h+o*ct.uY(i),i=ct.add(i,2),this.x1=a+s*ct.uX(i),this.y1=h+o*ct.uY(i),i=ct.add(i,2),this.x2=a+s*ct.uX(i),this.y2=h+o*ct.uY(i),i=ct.add(i,2),this.x3=a+s*ct.uX(i),this.y3=h+o*ct.uY(i)}else this.x0=t.x/r,this.y0=t.y/n,this.x1=(t.x+t.width)/r,this.y1=t.y/n,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/n,this.x3=t.x/r,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var re=new ie,ne=function(t){function e(i,r,n,s,o,a){if(t.call(this),this.noFrame=!1,r||(this.noFrame=!0,r=new gt(0,0,1,1)),i instanceof e&&(i=i.baseTexture),this.baseTexture=i,this._frame=r,this.trim=s,this.valid=!1,this.requiresUpdate=!1,this._uvs=re,this.uvMatrix=null,this.orig=n||r,this._rotate=Number(o||0),!0===o)this._rotate=2;else if(this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=a?new K(a.x,a.y):new K(0,0),this._updateID=0,this.textureCacheIds=[],i.valid?this.noFrame?i.valid&&this.onBaseTextureUpdated(i):this.frame=r:i.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&i.on("update",this.onBaseTextureUpdated,this)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={frame:{configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return e.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},e.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},e.prototype.destroy=function(t){if(this.baseTexture){if(t){var i=this.baseTexture.resource;i&&Y[i.url]&&e.removeFromCache(i.url),this.baseTexture.destroy()}this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,e.removeFromCache(this),this.textureCacheIds=null},e.prototype.clone=function(){return new e(this.baseTexture,this.frame,this.orig,this.trim,this.rotate,this.defaultAnchor)},e.prototype.updateUvs=function(){this._uvs===re&&(this._uvs=new ie),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},e.from=function(t,i){void 0===i&&(i={});var r=null;"string"==typeof t?r=t:(t._pixiId||(t._pixiId="pixiid_"+D()),r=t._pixiId);var n=Y[r];return n||(i.resolution||(i.resolution=V(t)),(n=new e(new Ht(t,i))).baseTexture.cacheId=r,Ht.addToCache(n.baseTexture,r),e.addToCache(n,r)),n},e.fromBuffer=function(t,i,r,n){return new e(Ht.fromBuffer(t,i,r,n))},e.fromLoader=function(t,i,r){var n=new Ut(t);n.url=i;var o=new e(new Ht(n,{scaleMode:s.SCALE_MODE,resolution:V(i)}));return r||(r=i),Ht.addToCache(o.baseTexture,r),e.addToCache(o,r),r!==i&&(Ht.addToCache(o.baseTexture,i),e.addToCache(o,i)),o},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),Y[e]&&console.warn("Texture added to the cache with an id ["+e+"] that already had an entry"),Y[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=Y[t];if(e){var i=e.textureCacheIds.indexOf(t);return i>-1&&e.textureCacheIds.splice(i,1),delete Y[t],e}}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)Y[t.textureCacheIds[r]]===t&&delete Y[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},i.frame.get=function(){return this._frame},i.frame.set=function(t){this._frame=t,this.noFrame=!1;var e=t.x,i=t.y,r=t.width,n=t.height,s=e+r>this.baseTexture.width,o=i+n>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",h="X: "+e+" + "+r+" = "+(e+r)+" > "+this.baseTexture.width,l="Y: "+i+" + "+n+" = "+(i+n)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+l)}this.valid=r&&n&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},i.rotate.get=function(){return this._rotate},i.rotate.set=function(t){this._rotate=t,this.valid&&this.updateUvs()},i.width.get=function(){return this.orig.width},i.height.get=function(){return this.orig.height},Object.defineProperties(e.prototype,i),e}(a.a);function se(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}ne.EMPTY=new ne(new Ht),se(ne.EMPTY),se(ne.EMPTY.baseTexture),ne.WHITE=function(){var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new ne(new Ht(new jt(t)))}(),se(ne.WHITE),se(ne.WHITE.baseTexture);var oe=function(t){function e(e,i){var r=null;if(!(e instanceof ee)){var n=arguments[1],s=arguments[2],o=arguments[3],a=arguments[4];console.warn("Please use RenderTexture.create("+n+", "+s+") instead of the ctor directly."),r=arguments[0],i=null,e=new ee({width:n,height:s,scaleMode:o,resolution:a})}t.call(this,e,i),this.legacyRenderer=r,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.resize=function(t,e,i){void 0===i&&(i=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=t>0&&e>0,this._frame.width=this.orig.width=t,this._frame.height=this.orig.height=e,i&&this.baseTexture.resize(t,e),this.updateUvs()},e.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},e.create=function(t){return"number"==typeof t&&(t={width:t,height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}),new e(new ee(t))},e}(ne),ae=function(t,e,i,r,n,s,o){void 0===i&&(i=!1),void 0===r&&(r=5126),this.buffer=t,this.size=e,this.normalized=i,this.type=r,this.stride=n,this.start=s,this.instance=o};ae.prototype.destroy=function(){this.buffer=null},ae.from=function(t,e,i,r,n){return new ae(t,e,i,r,n)};var he=0,le=function(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=e,this.id=he++,this.disposeRunner=new St("disposeBuffer",2)};function ue(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}le.prototype.update=function(t){this.data=t||this.data,this._updateID++},le.prototype.dispose=function(){this.disposeRunner.run(this,!1)},le.prototype.destroy=function(){this.dispose(),this.data=null},le.from=function(t){return t instanceof Array&&(t=new Float32Array(t)),new le(t)};var ce={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};var de={5126:4,5123:2,5121:1},pe=0,ge={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array},fe=function(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=pe++,this.instanced=!1,this.instanceCount=1,this._size=null,this.disposeRunner=new St("disposeGeometry",2),this.refCount=0};fe.prototype.addAttribute=function(t,e,i,r,n,s,o,a){if(void 0===r&&(r=!1),void 0===a&&(a=!1),!e)throw new Error("You must pass a buffer when creating an attribute");e.data||(e instanceof Array&&(e=new Float32Array(e)),e=new le(e));var h=t.split("|");if(h.length>1){for(var l=0;l<h.length;l++)this.addAttribute(h[l],e,i,r,n);return this}var u=this.buffers.indexOf(e);return-1===u&&(this.buffers.push(e),u=this.buffers.length-1),this.attributes[t]=new ae(u,i,r,n,s,o,a),this.instanced=this.instanced||a,this},fe.prototype.getAttribute=function(t){return this.attributes[t]},fe.prototype.getBuffer=function(t){return this.buffers[this.getAttribute(t).buffer]},fe.prototype.addIndex=function(t){return t.data||(t instanceof Array&&(t=new Uint16Array(t)),t=new le(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},fe.prototype.getIndex=function(){return this.indexBuffer},fe.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],i=[],r=new le;for(t in this.attributes){var n=this.attributes[t],s=this.buffers[n.buffer];e.push(s.data),i.push(n.size*de[n.type]/4),n.buffer=0}for(r.data=function(t,e){for(var i=0,r=0,n={},s=0;s<t.length;s++)r+=e[s],i+=t[s].length;for(var o=new ArrayBuffer(4*i),a=null,h=0,l=0;l<t.length;l++){var u=e[l],c=t[l],d=ue(c);n[d]||(n[d]=new ce[d](o)),a=n[d];for(var p=0;p<c.length;p++)a[(p/u|0)*r+h+p%u]=c[p];h+=u}return new Float32Array(o)}(e,i),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[r],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},fe.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},fe.prototype.dispose=function(){this.disposeRunner.run(this,!1)},fe.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer.destroy(),this.attributes=null},fe.prototype.clone=function(){for(var t=new fe,e=0;e<this.buffers.length;e++)t.buffers[e]=new le(this.buffers[e].data.slice());for(var i in this.attributes){var r=this.attributes[i];t.attributes[i]=new ae(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.index=!0),t},fe.merge=function(t){for(var e,i=new fe,r=[],n=[],s=[],o=0;o<t.length;o++){e=t[o];for(var a=0;a<e.buffers.length;a++)n[a]=n[a]||0,n[a]+=e.buffers[a].data.length,s[a]=0}for(var h=0;h<e.buffers.length;h++)r[h]=new(ge[ue(e.buffers[h].data)])(n[h]),i.buffers[h]=new le(r[h]);for(var l=0;l<t.length;l++){e=t[l];for(var u=0;u<e.buffers.length;u++)r[u].set(e.buffers[u].data,s[u]),s[u]+=e.buffers[u].data.length}if(i.attributes=e.attributes,e.indexBuffer){i.indexBuffer=i.buffers[e.buffers.indexOf(e.indexBuffer)],i.indexBuffer.index=!0;for(var c=0,d=0,p=0,g=0,f=0;f<e.buffers.length;f++)if(e.buffers[f]!==e.indexBuffer){g=f;break}for(var _ in e.attributes){var m=e.attributes[_];(0|m.buffer)===g&&(d+=m.size*de[m.type]/4)}for(var y=0;y<t.length;y++){for(var v=t[y].indexBuffer.data,x=0;x<v.length;x++)i.indexBuffer.data[x+p]+=c;c+=e.buffers[g].data.length/d,p+=v.length}}return i};var _e=function(t){function e(){t.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(fe),me=function(t){function e(){t.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new le(this.vertices),this.uvBuffer=new le(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.map=function(t,e){var i=0,r=0;return this.uvs[0]=i,this.uvs[1]=r,this.uvs[2]=i+e.width/t.width,this.uvs[3]=r,this.uvs[4]=i+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=i,this.uvs[7]=r+e.height/t.height,i=e.x,r=e.y,this.vertices[0]=i,this.vertices[1]=r,this.vertices[2]=i+e.width,this.vertices[3]=r,this.vertices[4]=i+e.width,this.vertices[5]=r+e.height,this.vertices[6]=i,this.vertices[7]=r+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(fe),ye=0,ve=function(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=ye++,this.static=!!e};ve.prototype.update=function(){this.dirtyId++},ve.prototype.add=function(t,e,i){this.uniforms[t]=new ve(e,i)},ve.from=function(t,e){return new ve(t,e)};var xe=function(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.sourceFrame=new gt,this.destinationFrame=new gt,this.filters=[]};xe.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null};var Ee=function(t){function e(e){t.call(this,e),this.defaultFilterStack=[{}],this.texturePool={},this.statePool=[],this.quad=new _e,this.quadUv=new me,this.tempRect=new gt,this.activeState={},this.globalUniforms=new ve({outputFrame:this.tempRect,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this._pixelsWidth=e.view.width,this._pixelsHeight=e.view.height}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.push=function(t,e){for(var i=this.renderer,r=this.defaultFilterStack,n=this.statePool.pop()||new xe,s=e[0].resolution,o=e[0].padding,a=e[0].autoFit,h=e[0].legacy,l=1;l<e.length;l++){var u=e[l];s=Math.min(s,u.resolution),o=Math.max(o,u.padding),a=a||u.autoFit,h=h||u.legacy}1===r.length&&(this.defaultFilterStack[0].renderTexture=i.renderTexture.current),r.push(n),n.resolution=s,n.legacy=h,n.target=t,n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(o),a&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(s),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,s),n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height,n.renderTexture.filterFrame=n.sourceFrame,i.renderTexture.bind(n.renderTexture,n.sourceFrame),i.renderTexture.clear()},e.prototype.pop=function(){var t=this.defaultFilterStack,e=t.pop(),i=e.filters;this.activeState=e;var r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;var n=r.inputSize,s=r.inputPixel,o=r.inputClamp;if(n[0]=e.destinationFrame.width,n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],s[0]=n[0]*e.resolution,s[1]=n[1]*e.resolution,s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*n[2]-.5*s[2],o[3]=e.sourceFrame.height*n[3]-.5*s[3],e.legacy){var a=r.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();var h=t[t.length-1];if(1===i.length)i[0].apply(this,e.renderTexture,h.renderTexture,!1,e),this.returnFilterTexture(e.renderTexture);else{var l=e.renderTexture,u=this.getOptimalFilterTexture(l.width,l.height,e.resolution);u.filterFrame=l.filterFrame;var c=0;for(c=0;c<i.length-1;++c){i[c].apply(this,l,u,!0,e);var d=l;l=u,u=d}i[c].apply(this,l,h.renderTexture,!1,e),this.returnFilterTexture(l),this.returnFilterTexture(u)}e.clear(),this.statePool.push(e)},e.prototype.applyFilter=function(t,e,i,r){var n=this.renderer;n.renderTexture.bind(i,i?i.filterFrame:null),r&&n.renderTexture.clear(),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.state.setState(t.state),n.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(f.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(f.TRIANGLE_STRIP))},e.prototype.calculateSpriteMatrix=function(t,e){var i=this.activeState,r=i.sourceFrame,n=i.destinationFrame,s=e._texture.orig,o=t.set(n.width,0,0,n.height,r.x,r.y),a=e.worldTransform.copyTo(it.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o},e.prototype.destroy=function(t){void 0===t&&(t=!1),t?this.texturePool={}:this.emptyPool()},e.prototype.getOptimalFilterTexture=function(t,e,i){void 0===i&&(i=1);var r="screen";e*=i,(t*=i)===this._pixelsWidth&&e===this._pixelsHeight||(r=(65535&(t=B(t)))<<16|65535&(e=B(e))),this.texturePool[r]||(this.texturePool[r]=[]);var n=this.texturePool[r].pop();return n||(n=oe.create({width:t,height:e})),n.filterPoolKey=r,n.setResolution(i),n},e.prototype.getFilterTexture=function(t){var e=this.activeState.renderTexture,i=this.getOptimalFilterTexture(e.width,e.height,t||e.baseTexture.resolution);return i.filterFrame=e.filterFrame,i},e.prototype.returnFilterTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},e.prototype.emptyPool=function(){for(var t in this.texturePool){var e=this.texturePool[t];if(e)for(var i=0;i<e.length;i++)e[i].destroy(!0)}this.texturePool={}},e.prototype.resize=function(){var t=this.texturePool.screen;if(t)for(var e=0;e<t.length;e++)t[e].destroy(!0);this.texturePool.screen=[],this._pixelsWidth=this.renderer.view.width,this._pixelsHeight=this.renderer.view.height},e}(Jt),we=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.start=function(){},e.prototype.stop=function(){this.flush()},e.prototype.flush=function(){},e.prototype.render=function(t){},e}(Jt),be=function(t){function e(e){t.call(this,e),this.emptyRenderer=new we(e),this.currentRenderer=this.emptyRenderer}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},e.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},e}(Jt);s.PREFER_ENV=n.a.any?d.WEBGL:d.WEBGL2;var Ie=0,Te=function(t){function e(e){t.call(this,e),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),e.view.addEventListener("webglcontextlost",this.handleContextLost,!1),e.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={isLost:{configurable:!0}};return i.isLost.get=function(){return!this.gl||this.gl.isContextLost()},e.prototype.contextChange=function(t){this.gl=t,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext()},e.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=Ie++,this.renderer.runners.contextChange.run(t)},e.prototype.initFromOptions=function(t){var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},e.prototype.createContext=function(t,e){var i;if(s.PREFER_ENV>=d.WEBGL2&&(i=t.getContext("webgl2",e)),i)this.webGLVersion=2;else if(this.webGLVersion=1,!(i=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),i},e.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion&&Object.assign(this.extensions,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBKIT_WEBGL_depth_texture"),floatTexture:t.getExtension("OES_texture_float"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint")})},e.prototype.handleContextLost=function(t){t.preventDefault()},e.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.run(this.gl)},e.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},e.prototype.postrender=function(){this.gl.flush()},e.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(e.prototype,i),e}(Jt),Se=function(t){function e(e){t.call(this,e),this.managedFramebuffers=[],this.unknownFramebuffer=new $t(10,10)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={size:{configurable:!0}};return e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new gt,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){var e=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;s.PREFER_ENV===d.WEBGL_LEGACY&&(e=null,i=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),i||(this.writeDepthTexture=!1)}},e.prototype.bind=function(t,e){var i=this.gl;if(t){var r=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,r.framebuffer)),r.dirtyId!==t.dirtyId&&(r.dirtyId=t.dirtyId,r.dirtyFormat!==t.dirtyFormat?(r.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):r.dirtySize!==t.dirtySize&&(r.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var n=0;n<t.colorTextures.length;n++)t.colorTextures[n].texturePart?this.renderer.texture.unbind(t.colorTextures[n].texture):this.renderer.texture.unbind(t.colorTextures[n]);t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},e.prototype.setViewport=function(t,e,i,r){var n=this.viewport;n.width===i&&n.height===r&&n.x===t&&n.y===e||(n.x=t,n.y=e,n.width=i,n.height=r,this.gl.viewport(t,e,i,r))},i.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},e.prototype.clear=function(t,e,i,r){var n=this.gl;n.clearColor(t,e,i,r),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)},e.prototype.initFramebuffer=function(t){var e={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return t.glFramebuffers[this.CONTEXT_UID]=e,this.managedFramebuffers.push(t),t.disposeRunner.add(this),e},e.prototype.resizeFramebuffer=function(t){var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID];i.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var r=t.colorTextures,n=0;n<r.length;n++)this.renderer.texture.bind(r[n],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},e.prototype.updateFramebuffer=function(t){var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID],r=t.colorTextures.length;e.drawBuffers||(r=Math.min(r,1));for(var n=[],s=0;s<r;s++){var o=t.colorTextures[s];o.texturePart?(this.renderer.texture.bind(o.texture,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_CUBE_MAP_NEGATIVE_X+o.side,o.texture._glTextures[this.CONTEXT_UID].texture,0)):(this.renderer.texture.bind(o,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+s,e.TEXTURE_2D,o._glTextures[this.CONTEXT_UID].texture,0)),n.push(e.COLOR_ATTACHMENT0+s)}if((n.length>1&&e.drawBuffers(n),t.depthTexture)&&this.writeDepthTexture){var a=t.depthTexture;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,0)}i.stencil||!t.stencil&&!t.depth||(i.stencil=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,i.stencil),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height))},e.prototype.disposeFramebuffer=function(t,e){var i=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(i){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);n>=0&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(i.framebuffer),i.stencil&&r.deleteRenderbuffer(i.stencil))}},e.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var i=0;i<e.count;i++)this.disposeFramebuffer(e[i],t)},e.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new gt},Object.defineProperties(e.prototype,i),e}(Jt),Ce=function(t){this.buffer=t,this.updateID=-1,this.byteLength=-1,this.refCount=0},Ne={5126:4,5123:2,5121:1},Oe=function(t){function e(e){t.call(this,e),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){var i=this.renderer.context.extensions.vertexArrayObject;s.PREFER_ENV===d.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=function(){return i.createVertexArrayOES()},t.bindVertexArray=function(t){return i.bindVertexArrayOES(t)},t.deleteVertexArray=function(t){return i.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){},t.bindVertexArray=function(){},t.deleteVertexArray=function(){})}if(!t.vertexAttribDivisor){var r=t.getExtension("ANGLE_instanced_arrays");r?(t.vertexAttribDivisor=function(t,e){return r.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,i,n,s){return r.drawElementsInstancedANGLE(t,e,i,n,s)},t.drawArraysInstanced=function(t,e,i,n){return r.drawArraysInstancedANGLE(t,e,i,n)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},e.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var i=this.gl,r=t.glVertexArrayObjects[this.CONTEXT_UID];r||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={});var n=r[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==n&&(this._activeVao=n,this.hasVao?i.bindVertexArray(n):this.activateVao(t,e.program)),this.updateBuffers()},e.prototype.reset=function(){this.unbind()},e.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,i=0;i<t.buffers.length;i++){var r=t.buffers[i],n=r._glBuffers[this.CONTEXT_UID];if(r._updateID!==n.updateID){n.updateID=r._updateID;var s=r.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(s,n.buffer),this._boundBuffer=n,n.byteLength>=r.data.byteLength)e.bufferSubData(s,0,r.data);else{var o=r.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;n.byteLength=r.data.byteLength,e.bufferData(s,r.data,o)}}}},e.prototype.checkCompatibility=function(t,e){var i=t.attributes,r=e.attributeData;for(var n in r)if(!i[n])throw new Error('shader and geometry incompatible, geometry missing the "'+n+'" attribute')},e.prototype.getSignature=function(t,e){var i=t.attributes,r=e.attributeData,n=["g",t.id];for(var s in i)r[s]&&n.push(s);return n.join("-")},e.prototype.initGeometryVao=function(t,e){this.checkCompatibility(t,e);var i=this.gl,r=this.CONTEXT_UID,n=this.getSignature(t,e),s=t.glVertexArrayObjects[this.CONTEXT_UID],o=s[n];if(o)return s[e.id]=o,o;var a=t.buffers,h=t.attributes,l={},u={};for(var c in a)l[c]=0,u[c]=0;for(var d in h)!h[d].size&&e.attributeData[d]?h[d].size=e.attributeData[d].size:h[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),l[h[d].buffer]+=h[d].size*Ne[h[d].type];for(var p in h){var g=h[p],f=g.size;void 0===g.stride&&(l[g.buffer]===f*Ne[g.type]?g.stride=0:g.stride=l[g.buffer]),void 0===g.start&&(g.start=u[g.buffer],u[g.buffer]+=f*Ne[g.type])}o=i.createVertexArray(),i.bindVertexArray(o);for(var _=0;_<a.length;_++){var m=a[_];m._glBuffers[r]||(m._glBuffers[r]=new Ce(i.createBuffer()),this.managedBuffers[m.id]=m,m.disposeRunner.add(this)),m._glBuffers[r].refCount++}return this.activateVao(t,e),this._activeVao=o,s[e.id]=o,s[n]=o,o},e.prototype.disposeBuffer=function(t,e){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var i=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),i&&(e||r.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}},e.prototype.disposeGeometry=function(t,e){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var i=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,n=t.buffers;if(t.disposeRunner.remove(this),i){for(var s=0;s<n.length;s++){var o=n[s]._glBuffers[this.CONTEXT_UID];o.refCount--,0!==o.refCount||e||this.disposeBuffer(n[s],e)}if(!e)for(var a in i)if("g"===a[0]){var h=i[a];this._activeVao===h&&this.unbind(),r.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},e.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedGeometries),i=0;i<e.length;i++)this.disposeGeometry(this.managedGeometries[e[i]],t);e=Object.keys(this.managedBuffers);for(var r=0;r<e.length;r++)this.disposeBuffer(this.managedBuffers[e[r]],t)},e.prototype.activateVao=function(t,e){var i=this.gl,r=this.CONTEXT_UID,n=t.buffers,s=t.attributes;t.indexBuffer&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[r].buffer);var o=null;for(var a in s){var h=s[a],l=n[h.buffer]._glBuffers[r];if(e.attributeData[a]){o!==l&&(i.bindBuffer(i.ARRAY_BUFFER,l.buffer),o=l);var u=e.attributeData[a].location;if(i.enableVertexAttribArray(u),i.vertexAttribPointer(u,h.size,h.type||i.FLOAT,h.normalized,h.stride,h.start),h.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");i.vertexAttribDivisor(u,1)}}}},e.prototype.draw=function(t,e,i,r){var n=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,a=2===o?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(i||0)*o,r||1):n.drawElements(t,e||s.indexBuffer.data.length,a,(i||0)*o):console.warn("unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(t,i,e||s.getSize(),r||1):n.drawArrays(t,i,e||s.getSize());return this},e.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},e}(Jt);function Pe(t,e,i,r){var n=Le(t,t.VERTEX_SHADER,e),s=Le(t,t.FRAGMENT_SHADER,i),o=t.createProgram();if(t.attachShader(o,n),t.attachShader(o,s),r)for(var a in r)t.bindAttribLocation(o,r[a],a);return t.linkProgram(o),t.getProgramParameter(o,t.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(o,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(o)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(o)),t.deleteProgram(o),o=null),t.deleteShader(n),t.deleteShader(s),o}function Le(t,e,i){var r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS)?r:(console.warn(i),console.error(t.getShaderInfoLog(r)),null)}function Ae(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return Re(2*e);case"bvec3":return Re(3*e);case"bvec4":return Re(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function Re(t){for(var e=new Array(t),i=0;i<e.length;i++)e[i]=!1;return e}var Me,De=null;function Fe(){if(!De){var t,e=document.createElement("canvas");if(s.PREFER_ENV>=d.WEBGL2&&(t=e.getContext("webgl2",{})),!t){if(!(t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{})))throw new Error("This browser does not support WebGL. Try using the canvas renderer");t.getExtension("WEBGL_draw_buffers")}return De=t,t}return De}function Be(t,e,i){if("precision"!==t.substring(0,9)){var r=e;return e===b.HIGH&&i!==b.HIGH&&(r=b.MEDIUM),"precision "+r+" float;\n"+t}return i!==b.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t}var ke={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Ge(t){return ke[t]}var Ue=null,Ye={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray"};function ze(t,e){if(!Ue){var i=Object.keys(Ye);Ue={};for(var r=0;r<i.length;++r){var n=i[r];Ue[t[n]]=Ye[n]}}return Ue[e]}var Xe={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},qe={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var He,Ve=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function je(t){for(var e="",i=0;i<t;++i)i>0&&(e+="\nelse "),i<t-1&&(e+="if(test == "+i+".0){}");return e}var We=0,Ke={},Ze=function t(e,i,r){void 0===r&&(r="pixi-shader"),this.id=We++,this.vertexSrc=e||t.defaultVertexSrc,this.fragmentSrc=i||t.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(r=r.replace(/\s+/g,"-"),Ke[r]?(Ke[r]++,r+="-"+Ke[r]):Ke[r]=1,this.vertexSrc="#define SHADER_NAME "+r+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+r+"\n"+this.fragmentSrc,this.vertexSrc=Be(this.vertexSrc,s.PRECISION_VERTEX,b.HIGH),this.fragmentSrc=Be(this.fragmentSrc,s.PRECISION_FRAGMENT,function(){if(!Me){Me=b.MEDIUM;var t=Fe();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);Me=e.precision?b.HIGH:b.MEDIUM}}return Me}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},this.syncUniforms=null},Je={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};Ze.prototype.extractData=function(t,e){var i=Fe();if(i){var r=Pe(i,t,e);this.attributeData=this.getAttributeData(r,i),this.uniformData=this.getUniformData(r,i),i.deleteProgram(r)}else this.uniformData={},this.attributeData={}},Ze.prototype.getAttributeData=function(t,e){for(var i={},r=[],n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),s=0;s<n;s++){var o=e.getActiveAttrib(t,s),a=ze(e,o.type),h={type:a,name:o.name,size:Ge(a),location:0};i[o.name]=h,r.push(h)}r.sort(function(t,e){return t.name>e.name?1:-1});for(var l=0;l<r.length;l++)r[l].location=l;return i},Ze.prototype.getUniformData=function(t,e){for(var i={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),n=0;n<r;n++){var s=e.getActiveUniform(t,n),o=s.name.replace(/\[.*?\]/,""),a=s.name.match(/\[.*?\]/,""),h=ze(e,s.type);i[o]={type:h,size:s.size,isArray:a,value:Ae(h,s.size)}}return i},Je.defaultVertexSrc.get=function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"},Je.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},Ze.from=function(t,e,i){var r=t+e,n=U[r];return n||(U[r]=n=new Ze(t,e,i)),n},Object.defineProperties(Ze,Je);var Qe=function(t,e){for(var i in this.program=t,this.uniformGroup=e?e instanceof ve?e:new ve(e):new ve({}),t.uniformData)this.uniformGroup.uniforms[i]instanceof Array&&(this.uniformGroup.uniforms[i]=new Float32Array(this.uniformGroup.uniforms[i]))},$e={uniforms:{configurable:!0}};Qe.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var i in e.uniforms){var r=e.uniforms[i];if(r.group&&this.checkUniformExists(t,r))return!0}return!1},Qe.prototype.destroy=function(){this.uniformGroup=null},$e.uniforms.get=function(){return this.uniformGroup.uniforms},Qe.from=function(t,e,i){var r=Ze.from(t,e);return new Qe(r,i)},Object.defineProperties(Qe.prototype,$e);var ti=function(){this.data=0,this.blendMode=g.NORMAL,this.polygonOffset=0,this.blend=!0},ei={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{configurable:!0}};ei.blend.get=function(){return!!(1&this.data)},ei.blend.set=function(t){!!(1&this.data)!==t&&(this.data^=1)},ei.offsets.get=function(){return!!(2&this.data)},ei.offsets.set=function(t){!!(2&this.data)!==t&&(this.data^=2)},ei.culling.get=function(){return!!(4&this.data)},ei.culling.set=function(t){!!(4&this.data)!==t&&(this.data^=4)},ei.depthTest.get=function(){return!!(8&this.data)},ei.depthTest.set=function(t){!!(8&this.data)!==t&&(this.data^=8)},ei.clockwiseFrontFace.get=function(){return!!(16&this.data)},ei.clockwiseFrontFace.set=function(t){!!(16&this.data)!==t&&(this.data^=16)},ei.blendMode.get=function(){return this._blendMode},ei.blendMode.set=function(t){this.blend=t!==g.NONE,this._blendMode=t},ei.polygonOffset.get=function(){return this._polygonOffset},ei.polygonOffset.set=function(t){this.offsets=!!t,this._polygonOffset=t},ti.for2d=function(){var t=new ti;return t.depthTest=!1,t.blend=!0,t},Object.defineProperties(ti.prototype,ei);var ii=function(t){function e(i,r,n){var o=Ze.from(i||e.defaultVertexSrc,r||e.defaultFragmentSrc);t.call(this,o,n),this.padding=0,this.resolution=s.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new ti}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={blendMode:{configurable:!0}},r={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};return e.prototype.apply=function(t,e,i,r,n){t.applyFilter(this,e,i,r,n)},i.blendMode.get=function(){return this.state.blendMode},i.blendMode.set=function(t){this.state.blendMode=t},r.defaultVertexSrc.get=function(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"},r.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},Object.defineProperties(e.prototype,i),Object.defineProperties(e,r),e}(Qe);ii.SOURCE_KEY_MAP={};var ri="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n",ni="varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n",si=new it,oi=function(t,e){this._texture=t,this.mapCoord=new it,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1},ai={texture:{configurable:!0}};ai.texture.get=function(){return this._texture},ai.texture.set=function(t){this._texture=t,this._updateID=-1},oi.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var i=this.mapCoord,r=0;r<t.length;r+=2){var n=t[r],s=t[r+1];e[r]=n*i.a+s*i.c+i.tx,e[r+1]=n*i.b+s*i.d+i.ty}return e},oi.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._updateID===e._updateID)return!1;this._updateID=e._updateID;var i=e._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);var r=e.orig,n=e.trim;n&&(si.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(si));var s=e.baseTexture,o=this.uClampFrame,a=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+a+h)/s.width,o[1]=(e._frame.y+a+h)/s.height,o[2]=(e._frame.x+e._frame.width-a+h)/s.width,o[3]=(e._frame.y+e._frame.height-a+h)/s.height,this.uClampOffset[0]=h/s.realWidth,this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0},Object.defineProperties(oi.prototype,ai);var hi=function(t){function e(e){var i=new it;t.call(this,ri,ni),e.renderable=!1,this.maskSprite=e,this.maskMatrix=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.apply=function(t,e,i,r){var n=this.maskSprite,s=this.maskSprite.texture;s.valid&&(s.transform||(s.transform=new oi(s,0)),s.transform.update(),this.uniforms.npmAlpha=s.baseTexture.premultiplyAlpha?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.transform.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=s.transform.uClampFrame,t.applyFilter(this,e,i,r))},e}(ii),li=function(t){function e(e){t.call(this,e),this.scissor=!1,this.scissorData=null,this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.alphaMaskIndex=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.push=function(t,e){if(e.isSprite)this.pushSpriteMask(t,e);else if(this.enableScissor&&!this.scissor&&this.renderer._activeRenderTarget.root&&!this.renderer.stencil.stencilMaskStack.length&&e.isFastRect()){var i=e.worldTransform,r=Math.atan2(i.b,i.a);(r=Math.round(r*(180/Math.PI)))%90?this.pushStencilMask(e):this.pushScissorMask(t,e)}else this.pushStencilMask(e)},e.prototype.pop=function(t,e){e.isSprite?this.popSpriteMask(t,e):this.enableScissor&&!this.renderer.stencil.stencilMaskStack.length?this.popScissorMask(t,e):this.popStencilMask(t,e)},e.prototype.pushSpriteMask=function(t,e){var i=this.alphaMaskPool[this.alphaMaskIndex];i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new hi(e)]),i[0].resolution=this.renderer.resolution,i[0].maskSprite=e;var r=t.filterArea;t.filterArea=e.getBounds(!0),this.renderer.filter.push(t,i),t.filterArea=r,this.alphaMaskIndex++},e.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},e.prototype.pushStencilMask=function(t){this.renderer.batch.flush(),this.renderer.stencil.pushStencil(t)},e.prototype.popStencilMask=function(){this.renderer.stencil.popStencil()},e.prototype.pushScissorMask=function(t,e){e.renderable=!0;var i=this.renderer._activeRenderTarget,r=e.getBounds();r.fit(i.size),e.renderable=!1,this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST);var n=this.renderer.resolution;this.renderer.gl.scissor(r.x*n,(i.root?i.size.height-r.y-r.height:r.y)*n,r.width*n,r.height*n),this.scissorRenderTarget=i,this.scissorData=e,this.scissor=!0},e.prototype.popScissorMask=function(){this.scissorRenderTarget=null,this.scissorData=null,this.scissor=!1;var t=this.renderer.gl;t.disable(t.SCISSOR_TEST)},e}(Jt),ui=function(t){function e(e){t.call(this,e),this.stencilMaskStack=[]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setMaskStack=function(t){var e=this.renderer.gl;t.length!==this.stencilMaskStack.length&&(0===t.length?e.disable(e.STENCIL_TEST):e.enable(e.STENCIL_TEST)),this.stencilMaskStack=t},e.prototype.pushStencil=function(t){var e=this.renderer.gl,i=this.stencilMaskStack.length;0===i&&e.enable(e.STENCIL_TEST),this.stencilMaskStack.push(t),e.colorMask(!1,!1,!1,!1),e.stencilFunc(e.EQUAL,i,this._getBitwiseMask()),e.stencilOp(e.KEEP,e.KEEP,e.INCR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,this._useCurrent()},e.prototype.popStencil=function(){var t=this.renderer.gl,e=this.stencilMaskStack.pop();0===this.stencilMaskStack.length?(t.disable(t.STENCIL_TEST),t.clear(t.STENCIL_BUFFER_BIT),t.clearStencil(0)):(t.colorMask(!1,!1,!1,!1),t.stencilOp(t.KEEP,t.KEEP,t.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent())},e.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.stencilMaskStack.length,this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},e.prototype._getBitwiseMask=function(){return(1<<this.stencilMaskStack.length)-1},e.prototype.destroy=function(){t.prototype.destroy.call(this,this),this.stencilMaskStack=null},e}(Jt),ci=function(t){function e(e){t.call(this,e),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new it,this.transform=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.update=function(t,e,i,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,i,r),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},e.prototype.calculateProjection=function(t,e,i,r){var n=this.projectionMatrix;r?(n.a=1/t.width*2*i,n.d=-1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=1-e.y*n.d):(n.a=1/t.width*2*i,n.d=1/t.height*2*i,n.tx=-1-e.x*n.a,n.ty=-1-e.y*n.d)},e.prototype.setTransform=function(){},e}(Jt),di=new gt,pi=function(t){function e(e){t.call(this,e),this.clearColor=e._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new gt,this.destinationFrame=new gt}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.bind=function(t,e,i){void 0===t&&(t=null),this.current=t;var r,n=this.renderer;if(t){var s=t.baseTexture;r=s.resolution,i||(di.width=s.realWidth,di.height=s.realHeight,i=di),e||(e=i),this.renderer.framebuffer.bind(s.framebuffer,i),this.renderer.projection.update(i,e,r,!1),this.renderer.stencil.setMaskStack(s.stencilMaskStack)}else r=this.renderer.resolution,i||(di.width=n.width,di.height=n.height,i=di),e||(e=i),n.framebuffer.bind(null,i),this.renderer.projection.update(i,e,r,!0),this.renderer.stencil.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(e),this.destinationFrame.x=i.x/r,this.destinationFrame.y=i.y/r,this.destinationFrame.width=i.width/r,this.destinationFrame.height=i.height/r,e===i&&this.sourceFrame.copyFrom(this.destinationFrame)},e.prototype.clear=function(t){t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3])},e.prototype.resize=function(){this.bind(null)},e.prototype.reset=function(){this.bind(null)},e}(Jt),gi=function(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}};gi.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null};var fi=0,_i=function(t){function e(e){t.call(this,e),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=fi++}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.systemCheck=function(){if(!function(){if("boolean"==typeof He)return He;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;");He=!0===t({a:"b"},"a","b")}catch(t){He=!1}return He}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},e.prototype.contextChange=function(t){this.gl=t},e.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var i=t.program,r=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(r.program)),e||this.syncUniformGroup(t.uniformGroup),r},e.prototype.setUniforms=function(t){var e=this.shader.program,i=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(i.uniformData,t,this.renderer)},e.prototype.syncUniformGroup=function(t){var e=this.getglProgram();t.static&&t.dirtyId===e.uniformGroups[t.id]||(e.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,e))},e.prototype.syncUniforms=function(t,e){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer)},e.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=function(t,e){var i=0,r="var v = null;\n    var cv = null\n    var gl = renderer.gl";for(var n in t.uniforms){var s=e[n];s?"float"===s.type&&1===s.size?r+="\n            if(uv."+n+" !== ud."+n+".value)\n            {\n                ud."+n+".value = uv."+n+"\n                gl.uniform1f(ud."+n+".location, uv."+n+")\n            }\n":"sampler2D"!==s.type&&"samplerCube"!==s.type&&"sampler2DArray"!==s.type||1!==s.size||s.isArray?"mat3"===s.type&&1===s.size?void 0!==t.uniforms[n].a?r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+".toArray(true));\n                \n":r+="\n                gl.uniformMatrix3fv(ud."+n+".location, false, uv."+n+");\n                \n":"vec2"===s.type&&1===s.size?void 0!==t.uniforms[n].x?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+n+".location, v.x, v.y);\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+n+".location, v[0], v[1]);\n                }\n                \n":"vec4"===s.type&&1===s.size?void 0!==t.uniforms[n].width?r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+n+".location, v.x, v.y, v.width, v.height)\n                }\n":r+="\n                cv = ud."+n+".value;\n                v = uv."+n+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+n+".location, v[0], v[1], v[2], v[3])\n                }\n                \n":r+="\n            cv = ud."+n+".value;\n            v = uv."+n+";\n            "+(1===s.size?Xe:qe)[s.type].replace("location","ud."+n+".location")+";\n":(r+="\n            renderer.texture.bind(uv."+n+", "+i+");\n\n            if(ud."+n+".value !== "+i+")\n            {\n                ud."+n+".value = "+i+";\n                gl.uniform1i(ud."+n+".location, "+i+");\n; // eslint-disable-line max-len\n            }\n",i++):t.uniforms[n].group&&(r+="\n                    renderer.shader.syncUniformGroup(uv."+n+");\n                ")}return new Function("ud","uv","renderer",r)}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]},e.prototype.getSignature=function(t,e){var i=t.uniforms,r=[];for(var n in i)r.push(n),e[n]&&r.push(e[n].type);return r.join("-")},e.prototype.getglProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},e.prototype.generateShader=function(t){var e=this.gl,i=t.program,r={};for(var n in i.attributeData)r[n]=i.attributeData[n].location;var s=Pe(e,i.vertexSrc,i.fragmentSrc,r),o={};for(var a in i.uniformData){var h=i.uniformData[a];o[a]={location:e.getUniformLocation(s,a),value:Ae(h.type,h.size)}}var l=new gi(s,o);return i.glPrograms[this.renderer.CONTEXT_UID]=l,l},e.prototype.reset=function(){this.program=null,this.shader=null},e.prototype.destroy=function(){this.destroyed=!0},e}(Jt);var mi=0,yi=1,vi=2,xi=3,Ei=4,wi=function(t){function e(e){t.call(this,e),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=g.NONE,this._blendEq=!1,this.map=[],this.map[mi]=this.setBlend,this.map[yi]=this.setOffset,this.map[vi]=this.setCullFace,this.map[xi]=this.setDepthTest,this.map[Ei]=this.setFrontFace,this.checks=[],this.defaultState=new ti,this.defaultState.blend=!0,this.defaultState.depth=!0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(t){this.gl=t,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[g.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[g.ADD]=[t.ONE,t.ONE],e[g.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[g.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[g.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[g.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[g.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[g.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[g.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[g.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[g.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[g.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[g.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[g.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[g.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[g.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[g.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[g.NONE]=[0,0],e[g.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[g.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[g.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[g.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[g.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[g.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[g.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[g.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[g.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[g.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[g.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}(t),this.setState(this.defaultState),this.reset()},e.prototype.setState=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,i=0;e;)1&e&&this.map[i].call(this,!!(t.data&1<<i)),e>>=1,i++;this.stateId=t.data}for(var r=0;r<this.checks.length;r++)this.checks[r](this,t)},e.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(var i=0;i<this.checks.length;i++)this.checks[i](this,t);this.stateId=t.data},e.prototype.setBlend=function(t){this.updateCheck(e.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},e.prototype.setOffset=function(t){this.updateCheck(e.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},e.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},e.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},e.prototype.setFrontFace=function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])},e.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],i=this.gl;2===e.length?i.blendFunc(e[0],e[1]):i.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,i.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}},e.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},e.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},e.prototype.updateCheck=function(t,e){var i=this.checks.indexOf(t);e&&-1===i?this.checks.push(t):e||-1===i||this.checks.splice(i,1)},e.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},e.checkPolygonOffset=function(t,e){t.setPolygonOffset(e.polygonOffset,0)},e}(Jt),bi=function(t){function e(e){t.call(this,e),this.count=0,this.checkCount=0,this.maxIdle=s.GC_MAX_IDLE,this.checkCountMax=s.GC_MAX_CHECK_COUNT,this.mode=s.GC_MODE}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.postrender=function(){this.count++,this.mode!==w&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run()))},e.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,i=!1,r=0;r<e.length;r++){var n=e[r];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(t.destroyTexture(n,!0),e[r]=null,i=!0)}if(i){for(var s=0,o=0;o<e.length;o++)null!==e[o]&&(e[s++]=e[o]);e.length=s}},e.prototype.unload=function(t){var e=this.renderer.textureSystem;t._texture&&t._texture._glRenderTargets&&e.destroyTexture(t._texture);for(var i=t.children.length-1;i>=0;i--)this.unload(t.children[i])},e}(Jt),Ii=function(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071},Ti=function(t){function e(e){t.call(this,e),this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new Ht}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var i=0;i<e;i++)this.boundTextures[i]=null;this.emptyTextures={};var r=new Ii(t.createTexture());t.bindTexture(t.TEXTURE_2D,r.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=r,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new Ii(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var n=0;n<6;n++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(var s=0;s<this.boundTextures.length;s++)this.bind(null,s)},e.prototype.bind=function(t,e){void 0===e&&(e=0);var i=this.gl;if(t){if((t=t.baseTexture||t).valid){t.touched=this.renderer.textureGC.count;var r=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),this.boundTextures[e]!==t&&i.bindTexture(t.target,r.texture),r.dirtyId!==t.dirtyId&&this.updateTexture(t),this.boundTextures[e]=t}}else this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[e]=null},e.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},e.prototype.unbind=function(t){var e=this.gl,i=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var r=0;r<i.length;r++)i[r]===this.unknownTexture&&this.bind(null,r)}for(var n=0;n<i.length;n++)i[n]===t&&(this.currentLocation!==n&&(e.activeTexture(e.TEXTURE0+n),this.currentLocation=n),e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),i[n]=null)},e.prototype.initTexture=function(t){var e=new Ii(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e},e.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID],i=this.renderer;if(t.resource&&t.resource.upload(i,t,e));else{var r=t.realWidth,n=t.realHeight,s=i.gl;(e.width!==r||e.height!==n||e.dirtyId<0)&&(e.width=r,e.height=n,s.texImage2D(t.target,0,t.format,r,n,0,t.format,t.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId},e.prototype.destroyTexture=function(t,e){var i=this.gl;if((t=t.baseTexture||t)._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){var r=this.managedTextures.indexOf(t);-1!==r&&R(this.managedTextures,r,1)}},e.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(t.mipmap!==E&&2===this.webGLVersion||t.isPowerOfTwo?(e.mipmap=t.mipmap>=1,e.wrapMode=t.wrapMode):(e.mipmap=0,e.wrapMode=v),t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)},e.prototype.setStyle=function(t,e){var i=this.gl;e.mipmap&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,e.wrapMode),e.mipmap?i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST):i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode?i.LINEAR:i.NEAREST),i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode?i.LINEAR:i.NEAREST)},e}(Jt),Si=new it,Ci=function(t){function e(i){void 0===i&&(i={}),t.call(this,"WebGL",i),i=this.options,this.type=p.WEBGL,this.gl=null,this.CONTEXT_UID=0,this.runners={destroy:new St("destroy"),contextChange:new St("contextChange",1),reset:new St("reset"),update:new St("update"),postrender:new St("postrender"),prerender:new St("prerender"),resize:new St("resize",2)},this.globalUniforms=new ve({projectionMatrix:new it},!0),this.addSystem(li,"mask").addSystem(Te,"context").addSystem(wi,"state").addSystem(_i,"shader").addSystem(Ti,"texture").addSystem(Oe,"geometry").addSystem(Se,"framebuffer").addSystem(ui,"stencil").addSystem(ci,"projection").addSystem(bi,"textureGC").addSystem(Ee,"filter").addSystem(pi,"renderTexture").addSystem(be,"batch"),this.initPlugins(e.__plugins),i.context?this.context.initFromContext(i.context):this.context.initFromOptions({alpha:this.transparent,antialias:i.antialias,premultipliedAlpha:this.transparent&&"notMultiplied"!==this.transparent,stencil:!0,preserveDrawingBuffer:i.preserveDrawingBuffer,powerPreference:this.options.powerPreference}),this.renderingToScreen=!0,function(t){if(!T){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var e=["\n %c %c %c PixiJS "+S+" -  "+t+"   %c  %c  http://www.pixijs.com/  %c %c %c%c \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];window.console.log.apply(console,e)}else window.console&&window.console.log("PixiJS "+S+" - "+t+" - http://www.pixijs.com/");T=!0}}(2===this.context.webGLVersion?"WebGL 2":"WebGL 1"),this.resize(this.options.width,this.options.height)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.create=function(t){if(void 0===I&&(I=function(){var t={stencil:!0,failIfMajorPerformanceCaveat:!0};try{if(!window.WebGLRenderingContext)return!1;var e=document.createElement("canvas"),i=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),r=!(!i||!i.getContextAttributes().stencil);if(i){var n=i.getExtension("WEBGL_lose_context");n&&n.loseContext()}return i=null,r}catch(t){return!1}}()),I)return new e(t);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},e.prototype.addSystem=function(t,e){e||(e=t.name);var i=new t(this);if(this[e])throw new Error('Whoops! The name "'+e+'" is already in use');for(var r in this[e]=i,this.runners)this.runners[r].add(i);return this},e.prototype.render=function(t,e,i,r,n){if(this.renderingToScreen=!e,this.runners.prerender.run(),this.emit("prerender"),this.projection.transform=r,!this.context.isLost){if(e||(this._lastObjectRendered=t),!n){var s=t.parent;t.parent=this._tempDisplayObjectParent,t.updateTransform(),t.parent=s}this.renderTexture.bind(e),this.batch.currentRenderer.start(),(void 0!==i?i:this.clearBeforeRender)&&this.renderTexture.clear(),t.render(this),this.batch.currentRenderer.flush(),e&&e.baseTexture.update(),this.runners.postrender.run(),this.projection.transform=null,this.emit("postrender")}},e.prototype.resize=function(e,i){t.prototype.resize.call(this,e,i),this.runners.resize.run(e,i)},e.prototype.reset=function(){return this.runners.reset.run(),this},e.prototype.clear=function(){this.framebuffer.bind(),this.framebuffer.clear()},e.prototype.destroy=function(e){this.runners.destroy.run(),t.prototype.destroy.call(this,e),this.gl=null},e.registerPlugin=function(t,i){e.__plugins=e.__plugins||{},e.__plugins[t]=i},e}(function(t){function e(e,i){t.call(this),(i=Object.assign({},s.RENDER_OPTIONS,i)).roundPixels&&(s.ROUND_PIXELS=i.roundPixels,W("5.0.0","Renderer roundPixels option is deprecated, please use PIXI.settings.ROUND_PIXELS",2)),this.options=i,this.type=p.UNKNOWN,this.screen=new gt(0,0,i.width,i.height),this.view=i.view||document.createElement("canvas"),this.resolution=i.resolution||s.RESOLUTION,this.transparent=i.transparent,this.autoDensity=i.autoDensity||i.autoResize||!1,this.preserveDrawingBuffer=i.preserveDrawingBuffer,this.clearBeforeRender=i.clearBeforeRender,this._backgroundColor=0,this._backgroundColorRgba=[0,0,0,0],this._backgroundColorString="#000000",this.backgroundColor=i.backgroundColor||this._backgroundColor,this._tempDisplayObjectParent=new It,this._lastObjectRendered=this._tempDisplayObjectParent,this.plugins={}}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={width:{configurable:!0},height:{configurable:!0},backgroundColor:{configurable:!0}};return e.prototype.initPlugins=function(t){for(var e in t)this.plugins[e]=new t[e](this)},i.width.get=function(){return this.view.width},i.height.get=function(){return this.view.height},e.prototype.resize=function(t,e){this.screen.width=t,this.screen.height=e,this.view.width=t*this.resolution,this.view.height=e*this.resolution,this.autoDensity&&(this.view.style.width=t+"px",this.view.style.height=e+"px")},e.prototype.generateTexture=function(t,e,i,r){0===(r=r||t.getLocalBounds()).width&&(r.width=1),0===r.height&&(r.height=1);var n=oe.create(0|r.width,0|r.height,e,i);return Si.tx=-r.x,Si.ty=-r.y,this.render(t,n,!1,Si,!!t.parent),n},e.prototype.destroy=function(t){for(var e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null;t&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.plugins=null,this.type=p.UNKNOWN,this.view=null,this.screen=null,this.resolution=0,this.transparent=!1,this.autoDensity=!1,this.blendModes=null,this.options=null,this.preserveDrawingBuffer=!1,this.clearBeforeRender=!1,this._backgroundColor=0,this._backgroundColorRgba=null,this._backgroundColorString=null,this._tempDisplayObjectParent=null,this._lastObjectRendered=null},i.backgroundColor.get=function(){return this._backgroundColor},i.backgroundColor.set=function(t){this._backgroundColor=t,this._backgroundColorString=N(t),C(t,this._backgroundColorRgba)},Object.defineProperties(e.prototype,i),e}(a.a));var Ni="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n",Oi=function(t){function e(e){void 0===e&&(e=!1),t.call(this),this._buffer=new le(null,e,!1),this._indexBuffer=new le(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,y.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,y.FLOAT).addAttribute("aColor",this._buffer,4,!0,y.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,y.FLOAT).addIndex(this._indexBuffer)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(fe),Pi=function(){this.textures=[],this.ids=[],this.blend=0,this.textureCount=0,this.start=0,this.size=0,this.type=4},Li=function(t){this.vertices=new ArrayBuffer(t),this.float32View=new Float32Array(this.vertices),this.uint32View=new Uint32Array(this.vertices)};Li.prototype.destroy=function(){this.vertices=null,this.float32View=null,this.uint32View=null};var Ai="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",Ri=["varying vec2 vTextureCoord;","varying vec4 vColor;","varying float vTextureId;","uniform sampler2D uSamplers[%count%];","void main(void){","vec4 color;","%forloop%","gl_FragColor = color * vColor;","}"].join("\n"),Mi={},Di={};var Fi=function(t){function e(e){t.call(this,e),this.vertSize=6,this.vertByteSize=4*this.vertSize,this.size=8e3,this.currentSize=0,this.currentIndexSize=0,this.attributeBuffers={},this.aBuffers={},this.iBuffers={},this.onlySprites=!1,this.shader=null,this.currentIndex=0,this.groups=[];for(var i=0;i<this.size/4;i++)this.groups[i]=new Pi;this.elements=[],this.vaos=[],this.vaoMax=2,this.vertexCount=0,this.renderer.on("prerender",this.onPrerender,this),this.state=ti.for2d()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contextChange=function(){var t=this.renderer.gl;s.PREFER_ENV===d.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),s.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var i=e.createShader(e.FRAGMENT_SHADER);;){var r=Ve.replace(/%forloop%/gi,je(t));if(e.shaderSource(i,r),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS))break;t=t/2|0}return t}(this.MAX_TEXTURES,t)),this.shader=function(t,e){if(!Di[e]){for(var i=new Int32Array(e),r=0;r<e;r++)i[r]=r;Mi[e]=ve.from({uSamplers:i},!0);var n=Ri;n=(n=n.replace(/%count%/gi,e)).replace(/%forloop%/gi,function(t){var e="";e+="\n",e+="\n";for(var i=0;i<t;i++)i>0&&(e+="\nelse "),i<t-1&&(e+="if(vTextureId < "+i+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+i+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"}(e)),Di[e]=new Ze(Ai,n)}var s={tint:new Float32Array([1,1,1,1]),translationMatrix:new it,default:Mi[e]};return new Qe(Di[e],s)}(0,this.MAX_TEXTURES);for(var e=0;e<this.vaoMax;e++)this.vaos[e]=new Oi},e.prototype.onPrerender=function(){this.vertexCount=0},e.prototype.render=function(t){t._texture.valid&&(this.currentSize+t.vertexData.length/2>this.size&&this.flush(),this.elements[this.currentIndex++]=t,this.currentSize+=t.vertexData.length/2,this.currentIndexSize+=t.indices.length)},e.prototype.getIndexBuffer=function(t){var e=B(Math.ceil(t/12)),i=G(e),r=12*e;this.iBuffers.length<=i&&(this.iBuffers.length=i+1);var n=this.iBuffers[i];return n||(this.iBuffers[i]=n=new Uint16Array(r)),n},e.prototype.getAttributeBuffer=function(t){var e=B(Math.ceil(t/8)),i=G(e),r=8*e;this.aBuffers.length<=i&&(this.iBuffers.length=i+1);var n=this.aBuffers[r];return n||(this.aBuffers[r]=n=new Li(r*this.vertByteSize)),n},e.prototype.flush=function(){if(0!==this.currentSize){var t,e,i=this.renderer.gl,r=this.MAX_TEXTURES,n=this.getAttributeBuffer(this.currentSize),o=this.getIndexBuffer(this.currentIndexSize),a=this.elements,h=this.groups,l=n.float32View,u=n.uint32View,c=this.renderer.textureGC.count,d=0,p=0,g=0,f=0,_=h[0],m=-1;_.textureCount=0,_.start=0,_.blend=m;var y,v=++Ht._globalBatch;for(y=0;y<this.currentIndex;++y){var x=a[y];a[y]=null,t=x._texture.baseTexture;var E=O[t.premultiplyAlpha?1:0][x.blendMode];m!==E&&(m=E,e=null,f=r,v++),e!==t&&(e=t,t._batchEnabled!==v&&(f===r&&(v++,f=0,_.size=p-_.start,(_=h[g++]).textureCount=0,_.blend=m,_.start=p),t.touched=c,t._batchEnabled=v,t._id=f,_.textures[_.textureCount++]=t,f++)),this.packGeometry(x,l,u,o,d,p),d+=x.vertexData.length/2*this.vertSize,p+=x.indices.length}Ht._globalBatch=v,_.size=p-_.start,s.CAN_UPLOAD_SAME_BUFFER?(this.vaos[this.vertexCount]._buffer.update(n.vertices,0),this.vaos[this.vertexCount]._indexBuffer.update(o,0),this.renderer.geometry.updateBuffers()):(this.vaoMax<=this.vertexCount&&(this.vaoMax++,this.vaos[this.vertexCount]=new Oi),this.vaos[this.vertexCount]._buffer.update(n.vertices,0),this.vaos[this.vertexCount]._indexBuffer.update(o,0),this.renderer.geometry.bind(this.vaos[this.vertexCount]),this.renderer.geometry.updateBuffers(),this.vertexCount++);var w=this.renderer.texture,b=this.renderer.state;for(y=0;y<g;y++){for(var I=h[y],T=I.textureCount,S=0;S<T;S++)w.bind(I.textures[S],S),I.textures[S]=null;b.setBlendMode(I.blend),i.drawElements(I.type,I.size,i.UNSIGNED_SHORT,2*I.start)}this.currentIndex=0,this.currentSize=0,this.currentIndexSize=0}},e.prototype.packGeometry=function(t,e,i,r,n,s){for(var o=n/this.vertSize,a=t.uvs,h=t.indices,l=t.vertexData,u=t._texture.baseTexture._id,c=Math.min(t.worldAlpha,1),d=c<1&&t._texture.baseTexture.premultiplyAlpha?L(t._tintRGB,c):t._tintRGB+(255*c<<24),p=0;p<l.length;p+=2)e[n++]=l[p],e[n++]=l[p+1],e[n++]=a[p],e[n++]=a[p+1],i[n++]=d,e[n++]=u;for(var g=0;g<h.length;g++)r[s++]=o+h[g]},e.prototype.start=function(){this.renderer.state.setState(this.state),this.renderer.shader.bind(this.shader),s.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this.vaos[this.vertexCount])},e.prototype.stop=function(){this.flush()},e.prototype.destroy=function(){for(var e=0;e<this.vaoMax;e++)this.vaos[e]&&this.vaos[e].destroy();this.indexBuffer&&this.indexBuffer.destroy(),this.renderer.off("prerender",this.onPrerender,this),this.shader&&(this.shader.destroy(),this.shader=null),this.vaos=null,this.indexBuffer=null,this.indices=null,this.sprites=null,t.prototype.destroy.call(this)},e}(we),Bi=new gt,ki=function(t){this.renderer=t,t.extract=this};ki.prototype.image=function(t,e,i){var r=new Image;return r.src=this.base64(t,e,i),r},ki.prototype.base64=function(t,e,i){return this.canvas(t).toDataURL(e,i)},ki.prototype.canvas=function(t){var e,i,r,n=this.renderer,s=!1,o=!1;t&&(t instanceof oe?r=t:(r=this.renderer.generateTexture(t),o=!0)),r?(e=r.baseTexture.resolution,i=r.frame,s=!1,n.renderTexture.bind(r)):(e=this.renderer.resolution,s=!0,(i=Bi).width=this.renderer.width,i.height=this.renderer.height,n.renderTexture.bind(null));var a=i.width*e,h=i.height*e,l=new X(a,h,1),u=new Uint8Array(4*a*h),c=n.gl;c.readPixels(i.x*e,i.y*e,a,h,c.RGBA,c.UNSIGNED_BYTE,u);var d=l.context.getImageData(0,0,a,h);return d.data.set(u),l.context.putImageData(d,0,0),s&&(l.context.scale(1,-1),l.context.drawImage(l.canvas,0,-h)),o&&r.destroy(!0),l.canvas},ki.prototype.pixels=function(t){var e,i,r,n=this.renderer,s=!1;t&&(t instanceof oe?r=t:(r=this.renderer.generateTexture(t),s=!0)),r?(e=r.baseTexture.resolution,i=r.frame,n.renderTexture.bind(r)):(e=n.resolution,(i=Bi).width=n.width,i.height=n.height,n.renderTexture.bind(null));var o=i.width*e,a=i.height*e,h=new Uint8Array(4*o*a),l=n.gl;return l.readPixels(i.x*e,i.y*e,o,a,l.RGBA,l.UNSIGNED_BYTE,h),s&&r.destroy(!0),h},ki.prototype.destroy=function(){this.renderer.extract=null,this.renderer=null};var Gi=function(){this.global=new K,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0},Ui={pointerId:{configurable:!0}};Ui.pointerId.get=function(){return this.identifier},Gi.prototype.getLocalPosition=function(t,e,i){return t.worldTransform.applyInverse(i||this.global,e)},Gi.prototype.copyEvent=function(t){t.isPrimary&&(this.isPrimary=!0),this.button=t.button,this.buttons=Number.isInteger(t.buttons)?t.buttons:t.which,this.width=t.width,this.height=t.height,this.tiltX=t.tiltX,this.tiltY=t.tiltY,this.pointerType=t.pointerType,this.pressure=t.pressure,this.rotationAngle=t.rotationAngle,this.twist=t.twist||0,this.tangentialPressure=t.tangentialPressure||0},Gi.prototype.reset=function(){this.isPrimary=!1},Object.defineProperties(Gi.prototype,Ui);var Yi=function(){this.stopped=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null};Yi.prototype.stopPropagation=function(){this.stopped=!0},Yi.prototype.reset=function(){this.stopped=!1,this.currentTarget=null,this.target=null};var zi=function t(e){this._pointerId=e,this._flags=t.FLAGS.NONE},Xi={pointerId:{configurable:!0},flags:{configurable:!0},none:{configurable:!0},over:{configurable:!0},rightDown:{configurable:!0},leftDown:{configurable:!0}};zi.prototype._doSet=function(t,e){this._flags=e?this._flags|t:this._flags&~t},Xi.pointerId.get=function(){return this._pointerId},Xi.flags.get=function(){return this._flags},Xi.flags.set=function(t){this._flags=t},Xi.none.get=function(){return this._flags===this.constructor.FLAGS.NONE},Xi.over.get=function(){return 0!=(this._flags&this.constructor.FLAGS.OVER)},Xi.over.set=function(t){this._doSet(this.constructor.FLAGS.OVER,t)},Xi.rightDown.get=function(){return 0!=(this._flags&this.constructor.FLAGS.RIGHT_DOWN)},Xi.rightDown.set=function(t){this._doSet(this.constructor.FLAGS.RIGHT_DOWN,t)},Xi.leftDown.get=function(){return 0!=(this._flags&this.constructor.FLAGS.LEFT_DOWN)},Xi.leftDown.set=function(t){this._doSet(this.constructor.FLAGS.LEFT_DOWN,t)},Object.defineProperties(zi.prototype,Xi),zi.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4});var qi={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return"pointer"===this.cursor},set buttonMode(t){t?this.cursor="pointer":"pointer"===this.cursor&&(this.cursor=null)},cursor:null,get trackedPointers(){return void 0===this._trackedPointers&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0};wt.mixin(qi);var Hi=1,Vi={target:null,data:{global:null}},ji=function(t){function e(e,i){t.call(this),i=i||{},this.renderer=e,this.autoPreventDefault=void 0===i.autoPreventDefault||i.autoPreventDefault,this.interactionFrequency=i.interactionFrequency||10,this.mouse=new Gi,this.mouse.identifier=Hi,this.mouse.global.set(-999999),this.activeInteractionData={},this.activeInteractionData[Hi]=this.mouse,this.interactionDataPool=[],this.eventData=new Yi,this.interactionDOMElement=null,this.moveWhenInside=!1,this.eventsAdded=!1,this.mouseOverRenderer=!1,this.supportsTouchEvents="ontouchstart"in window,this.supportsPointerEvents=!!window.PointerEvent,this.onPointerUp=this.onPointerUp.bind(this),this.processPointerUp=this.processPointerUp.bind(this),this.onPointerCancel=this.onPointerCancel.bind(this),this.processPointerCancel=this.processPointerCancel.bind(this),this.onPointerDown=this.onPointerDown.bind(this),this.processPointerDown=this.processPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.processPointerMove=this.processPointerMove.bind(this),this.onPointerOut=this.onPointerOut.bind(this),this.processPointerOverOut=this.processPointerOverOut.bind(this),this.onPointerOver=this.onPointerOver.bind(this),this.cursorStyles={default:"inherit",pointer:"pointer"},this.currentCursorMode=null,this.cursor=null,this._tempPoint=new K,this.resolution=1,this.setTargetElement(this.renderer.view,this.renderer.resolution)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.hitTest=function(t,e){return Vi.target=null,Vi.data.global=t,e||(e=this.renderer._lastObjectRendered),this.processInteractive(Vi,e,null,!0),Vi.target},e.prototype.setTargetElement=function(t,e){void 0===e&&(e=1),this.removeEvents(),this.interactionDOMElement=t,this.resolution=e,this.addEvents()},e.prototype.addEvents=function(){this.interactionDOMElement&&(Rt.system.add(this.update,this,Nt),window.navigator.msPointerEnabled?(this.interactionDOMElement.style["-ms-content-zooming"]="none",this.interactionDOMElement.style["-ms-touch-action"]="none"):this.supportsPointerEvents&&(this.interactionDOMElement.style["touch-action"]="none"),this.supportsPointerEvents?(window.document.addEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,!0),window.addEventListener("pointercancel",this.onPointerCancel,!0),window.addEventListener("pointerup",this.onPointerUp,!0)):(window.document.addEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,!0),window.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,!0)),this.eventsAdded=!0)},e.prototype.removeEvents=function(){this.interactionDOMElement&&(Rt.system.remove(this.update,this),window.navigator.msPointerEnabled?(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]=""):this.supportsPointerEvents&&(this.interactionDOMElement.style["touch-action"]=""),this.supportsPointerEvents?(window.document.removeEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,!0),window.removeEventListener("pointercancel",this.onPointerCancel,!0),window.removeEventListener("pointerup",this.onPointerUp,!0)):(window.document.removeEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,!0),window.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.interactionDOMElement=null,this.eventsAdded=!1)},e.prototype.update=function(t){if(this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.interactionDOMElement))if(this.didMove)this.didMove=!1;else{for(var e in this.cursor=null,this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(e)){var i=this.activeInteractionData[e];if(i.originalEvent&&"touch"!==i.pointerType){var r=this.configureInteractionEventForDOMEvent(this.eventData,i.originalEvent,i);this.processInteractive(r,this.renderer._lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},e.prototype.setCursorMode=function(t){if(t=t||"default",this.currentCursorMode!==t){this.currentCursorMode=t;var e=this.cursorStyles[t];if(e)switch(typeof e){case"string":this.interactionDOMElement.style.cursor=e;break;case"function":e(t);break;case"object":Object.assign(this.interactionDOMElement.style,e)}else"string"!=typeof t||Object.prototype.hasOwnProperty.call(this.cursorStyles,t)||(this.interactionDOMElement.style.cursor=t)}},e.prototype.dispatchEvent=function(t,e,i){i.stopped||(i.currentTarget=t,i.type=e,t.emit(e,i),t[e]&&t[e](i))},e.prototype.mapPositionToPoint=function(t,e,i){var r;r=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:0,height:0};var n=1/this.resolution;t.x=(e-r.left)*(this.interactionDOMElement.width/r.width)*n,t.y=(i-r.top)*(this.interactionDOMElement.height/r.height)*n},e.prototype.processInteractive=function(t,e,i,r,n){if(!e||!e.visible)return!1;var s=t.data.global,o=!1,a=n=e.interactive||n,h=!0;if(e.hitArea?(r&&(e.worldTransform.applyInverse(s,this._tempPoint),e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?o=!0:(r=!1,h=!1)),a=!1):e._mask&&r&&(e._mask.containsPoint&&e._mask.containsPoint(s)||(r=!1)),h&&e.interactiveChildren&&e.children)for(var l=e.children,u=l.length-1;u>=0;u--){var c=l[u],d=this.processInteractive(t,c,i,r,a);if(d){if(!c.parent)continue;a=!1,d&&(t.target&&(r=!1),o=!0)}}return n&&(r&&!t.target&&!e.hitArea&&e.containsPoint&&e.containsPoint(s)&&(o=!0),e.interactive&&(o&&!t.target&&(t.target=e),i&&i(t,e,!!o))),o},e.prototype.onPointerDown=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);if(this.autoPreventDefault&&e[0].isNormalized)(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(var i=e.length,r=0;r<i;r++){var n=e[r],s=this.getInteractionDataForPointerId(n),o=this.configureInteractionEventForDOMEvent(this.eventData,n,s);if(o.data.originalEvent=t,this.processInteractive(o,this.renderer._lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",o),"touch"===n.pointerType)this.emit("touchstart",o);else if("mouse"===n.pointerType||"pen"===n.pointerType){var a=2===n.button;this.emit(a?"rightdown":"mousedown",this.eventData)}}}},e.prototype.processPointerDown=function(t,e,i){var r=t.data,n=t.data.identifier;if(i)if(e.trackedPointers[n]||(e.trackedPointers[n]=new zi(n)),this.dispatchEvent(e,"pointerdown",t),"touch"===r.pointerType)this.dispatchEvent(e,"touchstart",t);else if("mouse"===r.pointerType||"pen"===r.pointerType){var s=2===r.button;s?e.trackedPointers[n].rightDown=!0:e.trackedPointers[n].leftDown=!0,this.dispatchEvent(e,s?"rightdown":"mousedown",t)}},e.prototype.onPointerComplete=function(t,e,i){for(var r=this.normalizeToPointerData(t),n=r.length,s=t.target!==this.interactionDOMElement?"outside":"",o=0;o<n;o++){var a=r[o],h=this.getInteractionDataForPointerId(a),l=this.configureInteractionEventForDOMEvent(this.eventData,a,h);if(l.data.originalEvent=t,this.processInteractive(l,this.renderer._lastObjectRendered,i,e||!s),this.emit(e?"pointercancel":"pointerup"+s,l),"mouse"===a.pointerType||"pen"===a.pointerType){var u=2===a.button;this.emit(u?"rightup"+s:"mouseup"+s,l)}else"touch"===a.pointerType&&(this.emit(e?"touchcancel":"touchend"+s,l),this.releaseInteractionDataForPointerId(a.pointerId,h))}},e.prototype.onPointerCancel=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!0,this.processPointerCancel)},e.prototype.processPointerCancel=function(t,e){var i=t.data,r=t.data.identifier;void 0!==e.trackedPointers[r]&&(delete e.trackedPointers[r],this.dispatchEvent(e,"pointercancel",t),"touch"===i.pointerType&&this.dispatchEvent(e,"touchcancel",t))},e.prototype.onPointerUp=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!1,this.processPointerUp)},e.prototype.processPointerUp=function(t,e,i){var r=t.data,n=t.data.identifier,s=e.trackedPointers[n],o="touch"===r.pointerType,a="mouse"===r.pointerType||"pen"===r.pointerType,h=!1;if(a){var l=2===r.button,u=zi.FLAGS,c=l?u.RIGHT_DOWN:u.LEFT_DOWN,d=void 0!==s&&s.flags&c;i?(this.dispatchEvent(e,l?"rightup":"mouseup",t),d&&(this.dispatchEvent(e,l?"rightclick":"click",t),h=!0)):d&&this.dispatchEvent(e,l?"rightupoutside":"mouseupoutside",t),s&&(l?s.rightDown=!1:s.leftDown=!1)}i?(this.dispatchEvent(e,"pointerup",t),o&&this.dispatchEvent(e,"touchend",t),s&&(a&&!h||this.dispatchEvent(e,"pointertap",t),o&&(this.dispatchEvent(e,"tap",t),s.over=!1))):s&&(this.dispatchEvent(e,"pointerupoutside",t),o&&this.dispatchEvent(e,"touchendoutside",t)),s&&s.none&&delete e.trackedPointers[n]},e.prototype.onPointerMove=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);"mouse"!==e[0].pointerType&&"pen"!==e[0].pointerType||(this.didMove=!0,this.cursor=null);for(var i=e.length,r=0;r<i;r++){var n=e[r],s=this.getInteractionDataForPointerId(n),o=this.configureInteractionEventForDOMEvent(this.eventData,n,s);o.data.originalEvent=t;var a="touch"!==n.pointerType||this.moveWhenInside;this.processInteractive(o,this.renderer._lastObjectRendered,this.processPointerMove,a),this.emit("pointermove",o),"touch"===n.pointerType&&this.emit("touchmove",o),"mouse"!==n.pointerType&&"pen"!==n.pointerType||this.emit("mousemove",o)}"mouse"===e[0].pointerType&&this.setCursorMode(this.cursor)}},e.prototype.processPointerMove=function(t,e,i){var r=t.data,n="touch"===r.pointerType,s="mouse"===r.pointerType||"pen"===r.pointerType;s&&this.processPointerOverOut(t,e,i),this.moveWhenInside&&!i||(this.dispatchEvent(e,"pointermove",t),n&&this.dispatchEvent(e,"touchmove",t),s&&this.dispatchEvent(e,"mousemove",t))},e.prototype.onPointerOut=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t)[0];"mouse"===e.pointerType&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var i=this.getInteractionDataForPointerId(e),r=this.configureInteractionEventForDOMEvent(this.eventData,e,i);r.data.originalEvent=e,this.processInteractive(r,this.renderer._lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",r),"mouse"===e.pointerType||"pen"===e.pointerType?this.emit("mouseout",r):this.releaseInteractionDataForPointerId(i.identifier)}},e.prototype.processPointerOverOut=function(t,e,i){var r=t.data,n=t.data.identifier,s="mouse"===r.pointerType||"pen"===r.pointerType,o=e.trackedPointers[n];i&&!o&&(o=e.trackedPointers[n]=new zi(n)),void 0!==o&&(i&&this.mouseOverRenderer?(o.over||(o.over=!0,this.dispatchEvent(e,"pointerover",t),s&&this.dispatchEvent(e,"mouseover",t)),s&&null===this.cursor&&(this.cursor=e.cursor)):o.over&&(o.over=!1,this.dispatchEvent(e,"pointerout",this.eventData),s&&this.dispatchEvent(e,"mouseout",t),o.none&&delete e.trackedPointers[n]))},e.prototype.onPointerOver=function(t){var e=this.normalizeToPointerData(t)[0],i=this.getInteractionDataForPointerId(e),r=this.configureInteractionEventForDOMEvent(this.eventData,e,i);r.data.originalEvent=e,"mouse"===e.pointerType&&(this.mouseOverRenderer=!0),this.emit("pointerover",r),"mouse"!==e.pointerType&&"pen"!==e.pointerType||this.emit("mouseover",r)},e.prototype.getInteractionDataForPointerId=function(t){var e,i=t.pointerId;return i===Hi||"mouse"===t.pointerType?e=this.mouse:this.activeInteractionData[i]?e=this.activeInteractionData[i]:((e=this.interactionDataPool.pop()||new Gi).identifier=i,this.activeInteractionData[i]=e),e.copyEvent(t),e},e.prototype.releaseInteractionDataForPointerId=function(t){var e=this.activeInteractionData[t];e&&(delete this.activeInteractionData[t],e.reset(),this.interactionDataPool.push(e))},e.prototype.configureInteractionEventForDOMEvent=function(t,e,i){return t.data=i,this.mapPositionToPoint(i.global,e.clientX,e.clientY),"touch"===e.pointerType&&(e.globalX=i.global.x,e.globalY=i.global.y),i.originalEvent=e,t.reset(),t},e.prototype.normalizeToPointerData=function(t){var e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(var i=0,r=t.changedTouches.length;i<r;i++){var n=t.changedTouches[i];void 0===n.button&&(n.button=t.touches.length?1:0),void 0===n.buttons&&(n.buttons=t.touches.length?1:0),void 0===n.isPrimary&&(n.isPrimary=1===t.touches.length&&"touchstart"===t.type),void 0===n.width&&(n.width=n.radiusX||1),void 0===n.height&&(n.height=n.radiusY||1),void 0===n.tiltX&&(n.tiltX=0),void 0===n.tiltY&&(n.tiltY=0),void 0===n.pointerType&&(n.pointerType="touch"),void 0===n.pointerId&&(n.pointerId=n.identifier||0),void 0===n.pressure&&(n.pressure=n.force||.5),void 0===n.twist&&(n.twist=0),void 0===n.tangentialPressure&&(n.tangentialPressure=0),void 0===n.layerX&&(n.layerX=n.offsetX=n.clientX),void 0===n.layerY&&(n.layerY=n.offsetY=n.clientY),n.isNormalized=!0,e.push(n)}else!(t instanceof MouseEvent)||this.supportsPointerEvents&&t instanceof window.PointerEvent?e.push(t):(void 0===t.isPrimary&&(t.isPrimary=!0),void 0===t.width&&(t.width=1),void 0===t.height&&(t.height=1),void 0===t.tiltX&&(t.tiltX=0),void 0===t.tiltY&&(t.tiltY=0),void 0===t.pointerType&&(t.pointerType="mouse"),void 0===t.pointerId&&(t.pointerId=Hi),void 0===t.pressure&&(t.pressure=.5),void 0===t.twist&&(t.twist=0),void 0===t.tangentialPressure&&(t.tangentialPressure=0),t.isNormalized=!0,e.push(t));return e},e.prototype.destroy=function(){this.removeEvents(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this._tempPoint=null},e}(a.a),Wi={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,_segmentsCount:function(t,e){if(void 0===e&&(e=20),!this.adaptive)return e;var i=Math.ceil(t/this.maxLength);return i<this.minSegments?i=this.minSegments:i>this.maxSegments&&(i=this.maxSegments),i}},Ki=function(){this.reset()};Ki.prototype.clone=function(){var t=new Ki;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t},Ki.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=ne.WHITE,this.matrix=null,this.visible=!1},Ki.prototype.destroy=function(){this.texture=null,this.matrix=null};var Zi=function(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=null),void 0===r&&(r=null),this.shape=t,this.lineStyle=i,this.fillStyle=e,this.matrix=r,this.type=t.type,this.points=[],this.holes=[]};Zi.prototype.clone=function(){return new Zi(this.shape,this.fillStyle,this.lineStyle,this.matrix)},Zi.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null};var Ji={build:function(t){var e,i,r=t.shape,n=t.points,s=r.x,o=r.y;if(n.length=0,t.type===et.CIRC?(e=r.radius,i=r.radius):(e=r.width,i=r.height),0!==e&&0!==i){var a=Math.floor(30*Math.sqrt(r.radius))||Math.floor(15*Math.sqrt(r.width+r.height));a/=2.3;for(var h=2*Math.PI/a,l=0;l<a;l++)n.push(s+Math.sin(-h*l)*e,o+Math.cos(-h*l)*i);n.push(n[0],n[1])}},triangulate:function(t,e){var i=t.points,r=e.points,n=e.indices,s=r.length/2,o=s;r.push(t.shape.x,t.shape.y);for(var a=0;a<i.length;a+=2)r.push(i[a],i[a+1]),n.push(s++,o,s)}};function Qi(t,e){t.lineStyle.native?function(t,e){var i=0,r=t.points||t.shape.points;if(0===r.length)return;var n=e.points,s=e.indices,o=r.length/2,a=n.length/2;for(i=1;i<o;i++){var h=r[2*(i-1)],l=r[2*(i-1)+1],u=r[2*i],c=r[2*i+1];n.push(h,l),n.push(u,c),s.push(a++,a++)}}(t,e):function(t,e){var i=t.shape,r=t.points||i.points.slice();if(0===r.length)return;var n=t.lineStyle,s=new K(r[0],r[1]),o=new K(r[r.length-2],r[r.length-1]),a=i.type!==et.POLY||i.closeStroke,h=s.x===o.x&&s.y===o.y;if(a){r=r.slice(),h&&(r.pop(),r.pop(),o.set(r[r.length-2],r[r.length-1]));var l=o.x+.5*(s.x-o.x),u=o.y+.5*(s.y-o.y);r.unshift(l,u),r.push(l,u)}var c=e.points,d=r.length/2,p=r.length,g=c.length/2,f=n.width/2,_=r[0],m=r[1],y=r[2],v=r[3],x=0,E=0,w=-(m-v),b=_-y,I=0,T=0,S=0,C=0,N=Math.sqrt(w*w+b*b);w/=N,b/=N,w*=f,b*=f;var O=n.alignment,P=2*(1-O),L=2*O;c.push(_-w*P,m-b*P),c.push(_+w*L,m+b*L);for(var A=1;A<d-1;++A){_=r[2*(A-1)],m=r[2*(A-1)+1],y=r[2*A],v=r[2*A+1],x=r[2*(A+1)],E=r[2*(A+1)+1],w=-(m-v),b=_-y,N=Math.sqrt(w*w+b*b),w/=N,b/=N,w*=f,b*=f,I=-(v-E),T=y-x,N=Math.sqrt(I*I+T*T),I/=N,T/=N;var R=-b+m-(-b+v),M=-w+y-(-w+_),D=(-w+_)*(-b+v)-(-w+y)*(-b+m),F=-(T*=f)+E-(-T+v),B=-(I*=f)+y-(-I+x),k=(-I+x)*(-T+v)-(-I+y)*(-T+E),G=R*B-F*M;if(Math.abs(G)<.1)G+=10.1,c.push(y-w*P,v-b*P),c.push(y+w*L,v+b*L);else{var U=(M*k-B*D)/G,Y=(F*D-R*k)/G,z=(U-y)*(U-y)+(Y-v)*(Y-v);z>196*f*f?(S=w-I,C=b-T,N=Math.sqrt(S*S+C*C),S/=N,C/=N,S*=f,C*=f,c.push(y-S*P,v-C*P),c.push(y+S*L,v+C*L),c.push(y-S*L*P,v-C*P),p++):(c.push(y+(U-y)*P,v+(Y-v)*P),c.push(y-(U-y)*L,v-(Y-v)*L))}}_=r[2*(d-2)],m=r[2*(d-2)+1],y=r[2*(d-1)],v=r[2*(d-1)+1],w=-(m-v),b=_-y,N=Math.sqrt(w*w+b*b),w/=N,b/=N,w*=f,b*=f,c.push(y-w*P,v-b*P),c.push(y+w*L,v+b*L);for(var X=e.indices,q=0;q<p-2;++q)X.push(g,g+1,g+2),g++}(t,e)}var $i={build:function(t){t.points=t.shape.points.slice()},triangulate:function(t,e){var i=t.points,r=t.holes,n=e.points,s=e.indices;if(i.length>=6){for(var o=[],a=0;a<r.length;a++){var h=r[a];o.push(i.length/2),i=i.concat(h.points)}var u=l()(i,o,2);if(!u)return;for(var c=n.length/2,d=0;d<u.length;d+=3)s.push(u[d]+c),s.push(u[d+1]+c),s.push(u[d+2]+c);for(var p=0;p<i.length;p++)n.push(i[p])}}},tr={build:function(t){var e=t.shape,i=t.points,r=e.x,n=e.y,s=e.width,o=e.height,a=e.radius;i.length=0,ir(r,n+a,r,n,r+a,n,i),ir(r+s-a,n,r+s,n,r+s,n+a,i),ir(r+s,n+o-a,r+s,n+o,r+s-a,n+o,i),ir(r+a,n+o,r,n+o,r,n+o-a,i)},triangulate:function(t,e){for(var i=t.points,r=e.points,n=e.indices,s=r.length/2,o=l()(i,null,2),a=0,h=o.length;a<h;a+=3)n.push(o[a]+s),n.push(o[a+1]+s),n.push(o[a+2]+s);for(var u=0,c=i.length;u<c;u++)r.push(i[u],i[++u])}};function er(t,e,i){return t+(e-t)*i}function ir(t,e,i,r,n,s,o){void 0===o&&(o=[]);for(var a=o,h=0,l=0,u=0,c=0,d=0,p=0,g=0,f=0;g<=20;++g)h=er(t,i,f=g/20),l=er(e,r,f),u=er(i,n,f),c=er(r,s,f),d=er(h,u,f),p=er(l,c,f),a.push(d,p);return a}var rr=[],nr=[],sr={};sr[et.POLY]=$i,sr[et.CIRC]=Ji,sr[et.ELIP]=Ji,sr[et.RECT]={build:function(t){var e=t.shape,i=e.x,r=e.y,n=e.width,s=e.height,o=t.points;o.length=0,o.push(i,r,i+n,r,i+n,r+s,i,r+s)},triangulate:function(t,e){var i=t.points,r=e.points,n=r.length/2;r.push(i[0],i[1],i[2],i[3],i[6],i[7],i[4],i[5]),e.indices.push(n,n+1,n+2,n+1,n+2,n+3)}},sr[et.RREC]=tr;var or=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0},ar=function(t){function e(){t.call(this),this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.dirty=0,this.batchDirty=-1,this.cacheDirty=-1,this.clearDirty=0,this.drawCalls=[],this.batches=[],this.shapeIndex=0,this._bounds=new Et,this.boundsDirty=-1,this.boundsPadding=0,this.batchable=!1,this.indicesUint16=null,this.uvsFloat32=null}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={bounds:{configurable:!0}};return i.bounds.get=function(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},e.prototype.clear=function(){if(this.graphicsData.length>0){this.boundsDirty=-1,this.dirty++,this.clearDirty++,this.batchDirty++,this.graphicsData.length=0,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var t=0;t<this.drawCalls.length;t++)this.drawCalls[t].textures.length=0,nr.push(this.drawCalls[t]);this.drawCalls.length=0;for(var e=0;e<this.batches.length;e++){var i=this.batches[e];i.start=0,i.attribStart=0,i.style=null,rr.push(i)}this.batches.length=0}return this},e.prototype.drawShape=function(t,e,i,r){var n=new Zi(t,e,i,r);return this.graphicsData.push(n),this.dirty++,this},e.prototype.drawHole=function(t,e){if(!this.graphicsData.length)return null;var i=new Zi(t,null,null,e),r=this.graphicsData[this.graphicsData.length-1];return i.lineStyle=r.lineStyle,r.holes.push(i),this.dirty++,i},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e);for(var i=0;i<this.graphicsData.length;++i)this.graphicsData[i].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},e.prototype.containsPoint=function(t){for(var e=this.graphicsData,i=0;i<e.length;++i){var r=e[i];if(r.fillStyle.visible&&(r.shape&&r.shape.contains(t.x,t.y))){if(r.holes)for(var n=0;n<r.holes.length;n++){if(r.holes[n].shape.contains(t.x,t.y))return!1}return!0}}return!1},e.prototype.updateBatches=function(){if(this.dirty!==this.cacheDirty&&0!==this.graphicsData.length){if(this.dirty!==this.cacheDirty)for(var t=0;t<this.graphicsData.length;t++){var e=this.graphicsData[t];if(e.fillStyle&&!e.fillStyle.texture.baseTexture.valid)return;if(e.lineStyle&&!e.lineStyle.texture.baseTexture.valid)return}this.cacheDirty=this.dirty;var i=this.uvs,r=this.batches.pop()||rr.pop()||new or;r.style=r.style||this.graphicsData[0].fillStyle||this.graphicsData[0].lineStyle;var n=r.style.texture.baseTexture,s=r.style.color+r.style.alpha;this.batches.push(r);for(var o=this.shapeIndex;o<this.graphicsData.length;o++){this.shapeIndex++;var a=this.graphicsData[o],h=sr[a.type],l=a.fillStyle,u=a.lineStyle;h.build(a),a.matrix&&this.transformPoints(a.points,a.matrix);for(var c=0;c<2;c++){var d=0===c?l:u;if(d.visible){var p=d.texture.baseTexture;if(n!==p||d.color+d.alpha!==s){p.wrapMode=10497,n=p,s=d.color+d.alpha;var g=this.indices.length,f=this.points.length/2;r.size=g-r.start,r.attribSize=f-r.attribStart,r.size>0&&(r=rr.pop()||new or,this.batches.push(r)),r.style=d,r.start=g,r.attribStart=f}var _=this.points.length/2;if(0===c)a.holes.length?(this.processHoles(a.holes),$i.triangulate(a,this)):h.triangulate(a,this);else{Qi(a,this);for(var m=0;m<a.holes.length;m++)Qi(a.holes[m],this)}var y=this.points.length/2-_;this.addUvs(this.points,i,d.texture,_,y,d.matrix)}}}var v=this.indices.length,x=this.points.length/2;if(r.size=v-r.start,r.attribSize=x-r.attribStart,this.indicesUint16=new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var E=0;E<this.batches.length;E++)for(var w=this.batches[E],b=0;b<w.size;b++){var I=w.start+b;this.indicesUint16[I]=this.indicesUint16[I]-w.attribStart}}else this.buildDrawCalls()}},e.prototype.isBatchable=function(){for(var t=this.batches,i=0;i<t.length;i++)if(t[i].style.native)return!1;return this.points.length<2*e.BATCHABLE_SIZE},e.prototype.buildDrawCalls=function(){for(var t=++Ht._globalBatch,e=0;e<this.drawCalls.length;e++)this.drawCalls[e].textures.length=0,nr.push(this.drawCalls[e]);this.drawCalls.length=0;var i=this.uvs,r=this.colors,n=this.textureIds,s=nr.pop()||new Pi;s.textureCount=0,s.start=0,s.size=0,s.type=f.TRIANGLES;var o=0,a=null,h=0,l=!1,u=f.TRIANGLES,c=0;this.drawCalls.push(s);for(var d=0;d<this.batches.length;d++){var p=this.batches[d],g=p.style,_=g.texture.baseTexture;l!==g.native&&(u=(l=g.native)?f.LINES:f.TRIANGLES,a=null,o=8,t++),a!==_&&(a=_,_._batchEnabled!==t&&(8===o&&(t++,o=0,s.size>0&&(s=nr.pop()||new Pi,this.drawCalls.push(s)),s.start=c,s.size=0,s.textureCount=0,s.type=u),_.touched=1,_._batchEnabled=t,_._id=o,_.wrapMode=10497,s.textures[s.textureCount++]=_,o++)),s.size+=p.size,c+=p.size,h=_._id,this.addColors(r,g.color,g.alpha,p.attribSize),this.addTextureIds(n,h,p.attribSize)}Ht._globalBatch=t;for(var m=this.points,y=new ArrayBuffer(3*m.length*4),v=new Float32Array(y),x=new Uint32Array(y),E=0,w=0;w<m.length/2;w++)v[E++]=m[2*w],v[E++]=m[2*w+1],v[E++]=i[2*w],v[E++]=i[2*w+1],x[E++]=r[w],v[E++]=n[w];this._buffer.update(y),this._indexBuffer.update(this.indicesUint16)},e.prototype.processHoles=function(t){for(var e=0;e<t.length;e++){var i=t[e];sr[i.type].build(i),i.matrix&&this.transformPoints(i.points,i.matrix)}},e.prototype.calculateBounds=function(){var t=1/0,e=-1/0,i=1/0,r=-1/0;if(this.graphicsData.length)for(var n=null,s=0,o=0,a=0,h=0,l=0;l<this.graphicsData.length;l++){var u=this.graphicsData[l],c=u.type,d=u.lineStyle?u.lineStyle.width:0;if(n=u.shape,c===et.RECT||c===et.RREC)s=n.x-d/2,o=n.y-d/2,t=s<t?s:t,e=s+(a=n.width+d)>e?s+a:e,i=o<i?o:i,r=o+(h=n.height+d)>r?o+h:r;else if(c===et.CIRC)s=n.x,o=n.y,t=s-(a=n.radius+d/2)<t?s-a:t,e=s+a>e?s+a:e,i=o-(h=n.radius+d/2)<i?o-h:i,r=o+h>r?o+h:r;else if(c===et.ELIP)s=n.x,o=n.y,t=s-(a=n.width+d/2)<t?s-a:t,e=s+a>e?s+a:e,i=o-(h=n.height+d/2)<i?o-h:i,r=o+h>r?o+h:r;else for(var p=n.points,g=0,f=0,_=0,m=0,y=0,v=0,x=0,E=0,w=0;w+2<p.length;w+=2)s=p[w],o=p[w+1],g=p[w+2],f=p[w+3],_=Math.abs(g-s),m=Math.abs(f-o),h=d,(a=Math.sqrt(_*_+m*m))<1e-9||(t=(x=(g+s)/2)-(y=(h/a*m+_)/2)<t?x-y:t,e=x+y>e?x+y:e,i=(E=(f+o)/2)-(v=(h/a*_+m)/2)<i?E-v:i,r=E+v>r?E+v:r)}else t=0,e=0,i=0,r=0;var b=this.boundsPadding;this._bounds.minX=t-b,this._bounds.maxX=e+b,this._bounds.minY=i-b,this._bounds.maxY=r+b},e.prototype.transformPoints=function(t,e){for(var i=0;i<t.length/2;i++){var r=t[2*i],n=t[2*i+1];t[2*i]=e.a*r+e.c*n+e.tx,t[2*i+1]=e.b*r+e.d*n+e.ty}},e.prototype.addColors=function(t,e,i,r){for(var n=L((e>>16)+(65280&e)+((255&e)<<16),i);r-- >0;)t.push(n)},e.prototype.addTextureIds=function(t,e,i){for(;i-- >0;)t.push(e)},e.prototype.addUvs=function(t,e,i,r,n,s){for(var o=0,a=e.length,h=i.frame;o<n;){var l=t[2*(r+o)],u=t[2*(r+o)+1];if(s){var c=s.a*l+s.c*u+s.tx;u=s.b*l+s.d*u+s.ty,l=c}o++,e.push(l/h.width,u/h.height)}var d=i.baseTexture;(h.width<d.width||h.height<d.height)&&this.adjustUvs(e,i,a,n)},e.prototype.adjustUvs=function(t,e,i,r){for(var n=e.baseTexture,s=i+2*r,o=e.frame,a=o.width/n.width,h=o.height/n.height,l=o.x/o.width,u=o.y/o.height,c=Math.floor(t[i]+1e-6),d=Math.floor(t[i+1]+1e-6),p=i+2;p<s;p+=2)c=Math.min(c,Math.floor(t[p]+1e-6)),d=Math.min(d,Math.floor(t[p+1]+1e-6));l-=c,u-=d;for(var g=i;g<s;g+=2)t[g]=(t[g]+l)*a,t[g+1]=(t[g+1]+u)*h},Object.defineProperties(e.prototype,i),e}(Oi);ar.BATCHABLE_SIZE=100;var hr=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){var t=new e;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t},e.prototype.reset=function(){t.prototype.reset.call(this),this.color=0,this.width=0,this.alignment=.5,this.native=!1},e}(Ki),lr=function(){};lr.curveLength=function(t,e,i,r,n,s,o,a){for(var h=0,l=0,u=0,c=0,d=0,p=0,g=0,f=0,_=0,m=0,y=0,v=t,x=e,E=1;E<=10;++E)m=v-(f=(g=(p=(d=1-(l=E/10))*d)*d)*t+3*p*l*i+3*d*(u=l*l)*n+(c=u*l)*o),y=x-(_=g*e+3*p*l*r+3*d*u*s+c*a),v=f,x=_,h+=Math.sqrt(m*m+y*y);return h},lr.curveTo=function(t,e,i,r,n,s,o){var a=o[o.length-2],h=o[o.length-1];o.length-=2;var l=Wi._segmentsCount(lr.curveLength(a,h,t,e,i,r,n,s)),u=0,c=0,d=0,p=0,g=0;o.push(a,h);for(var f=1,_=0;f<=l;++f)d=(c=(u=1-(_=f/l))*u)*u,g=(p=_*_)*_,o.push(d*a+3*c*_*t+3*u*p*i+g*n,d*h+3*c*_*e+3*u*p*r+g*s)};var ur=function(){};ur.curveLength=function(t,e,i,r,n,s){var o=t-2*i+n,a=e-2*r+s,h=2*i-2*t,l=2*r-2*e,u=4*(o*o+a*a),c=4*(o*h+a*l),d=h*h+l*l,p=2*Math.sqrt(u+c+d),g=Math.sqrt(u),f=2*u*g,_=2*Math.sqrt(d),m=c/g;return(f*p+g*c*(p-_)+(4*d*u-c*c)*Math.log((2*g+m+p)/(m+_)))/(4*f)},ur.curveTo=function(t,e,i,r,n){for(var s=n[n.length-2],o=n[n.length-1],a=Wi._segmentsCount(ur.curveLength(s,o,t,e,i,r)),h=0,l=0,u=1;u<=a;++u){var c=u/a;h=s+(t-s)*c,l=o+(e-o)*c,n.push(h+(t+(i-t)*c-h)*c,l+(e+(r-e)*c-l)*c)}};var cr=function(){};cr.curveTo=function(t,e,i,r,n,s){var o=s[s.length-2],a=s[s.length-1]-e,h=o-t,l=r-e,u=i-t,c=Math.abs(a*u-h*l);if(c<1e-8||0===n)return s[s.length-2]===t&&s[s.length-1]===e||s.push(t,e),null;var d=a*a+h*h,p=l*l+u*u,g=a*l+h*u,f=n*Math.sqrt(d)/c,_=n*Math.sqrt(p)/c,m=f*g/d,y=_*g/p,v=f*u+_*h,x=f*l+_*a,E=h*(_+m),w=a*(_+m),b=u*(f+y),I=l*(f+y);return{cx:v+t,cy:x+e,radius:n,startAngle:Math.atan2(w-x,E-v),endAngle:Math.atan2(I-x,b-v),anticlockwise:h*l>u*a}},cr.arc=function(t,e,i,r,n,s,o,a,h){for(var l=o-s,u=Wi._segmentsCount(Math.abs(l)*n,40*Math.ceil(Math.abs(l)/Q)),c=l/(2*u),d=2*c,p=Math.cos(c),g=Math.sin(c),f=u-1,_=f%1/f,m=0;m<=f;++m){var y=c+s+d*(m+_*m),v=Math.cos(y),x=-Math.sin(y);h.push((p*v+g*x)*n+i,(p*-x+g*v)*n+r)}};var dr=function(t){function e(e,i,r,n,s,o){s=s||n/2;for(var a=-1*Math.PI/2+o,h=2*r,l=Q/h,u=[],c=0;c<h;c++){var d=c%2?s:n,p=c*l+a;u.push(e+d*Math.cos(p),i+d*Math.sin(p))}t.call(this,u)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(vt),pr=new Float32Array(3),gr=null,fr=function(t){function e(e){void 0===e&&(e=null),t.call(this),this.geometry=e||new ar,this.geometry.refCount++,this.shader=null,this.state=ti.for2d(),this._fillStyle=new Ki,this._lineStyle=new hr,this._matrix=null,this._holeMode=!1,this.currentPath=null,this.batches=[],this.batchTint=-1,this.vertexData=null,this._transformID=-1,this.batchDirty=-1,this.tint=16777215,this.blendMode=g.NORMAL}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={blendMode:{configurable:!0},tint:{configurable:!0},fill:{configurable:!0},line:{configurable:!0}};return e.prototype.clone=function(){return this.finishPoly(),new e(this.geometry)},i.blendMode.set=function(t){this.state.blendMode=t},i.blendMode.get=function(){return this.state.blendMode},i.tint.get=function(){return this._tint},i.tint.set=function(t){this._tint=t},i.fill.get=function(){return this._fillStyle},i.line.get=function(){return this._lineStyle},e.prototype.lineStyle=function(t,e,i,r,n){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=.5),void 0===n&&(n=!1),this.lineTextureStyle(t,ne.WHITE,e,i,null,r,n),this},e.prototype.lineTextureStyle=function(t,e,i,r,n,s,o){void 0===t&&(t=0),void 0===e&&(e=ne.WHITE),void 0===i&&(i=16777215),void 0===r&&(r=1),void 0===n&&(n=null),void 0===s&&(s=.5),void 0===o&&(o=!1),this.currentPath&&this.startPoly();var a=t>0&&r>0;return a?(n&&(n=n.clone()).invert(),Object.assign(this._lineStyle,{color:i,width:t,alpha:r,matrix:n,texture:e,alignment:s,native:o,visible:a})):this._lineStyle.reset(),this},e.prototype.startPoly=function(){if(this.currentPath){var t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new vt,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new vt,this.currentPath.closeStroke=!1},e.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},e.prototype.moveTo=function(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this},e.prototype.lineTo=function(t,e){this.currentPath||this.moveTo(0,0);var i=this.currentPath.points,r=i[i.length-2],n=i[i.length-1];return r===t&&n===e||i.push(t,e),this},e.prototype._initCurve=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[t,e]):this.moveTo(t,e)},e.prototype.quadraticCurveTo=function(t,e,i,r){this._initCurve();var n=this.currentPath.points;return 0===n.length&&this.moveTo(0,0),ur.curveTo(t,e,i,r,n),this},e.prototype.bezierCurveTo=function(t,e,i,r,n,s){return this._initCurve(),lr.curveTo(t,e,i,r,n,s,this.currentPath.points),this},e.prototype.arcTo=function(t,e,i,r,n){this._initCurve(t,e);var s=this.currentPath.points,o=cr.curveTo(t,e,i,r,n,s);if(o){var a=o.cx,h=o.cy,l=o.radius,u=o.startAngle,c=o.endAngle,d=o.anticlockwise;this.arc(a,h,l,u,c,d)}return this},e.prototype.arc=function(t,e,i,r,n,s){if(void 0===s&&(s=!1),r===n)return this;if(!s&&n<=r?n+=Q:s&&r<=n&&(r+=Q),0===n-r)return this;var o=t+Math.cos(r)*i,a=e+Math.sin(r)*i,h=this.currentPath?this.currentPath.points:null;if(h){var l=Math.abs(h[h.length-2]-o),u=Math.abs(h[h.length-1]-a);l<.001&&u<.001||h.push(o,a)}else this.moveTo(o,a),h=this.currentPath.points;return cr.arc(o,a,t,e,i,r,n,s,h),this},e.prototype.beginFill=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=1),this.beginTextureFill(ne.WHITE,t,e)},e.prototype.beginTextureFill=function(t,e,i,r){void 0===t&&(t=ne.WHITE),void 0===e&&(e=16777215),void 0===i&&(i=1),void 0===r&&(r=null),this.currentPath&&this.startPoly();var n=i>0;return n?(r&&(r=r.clone()).invert(),Object.assign(this._fillStyle,{color:e,alpha:i,texture:t,matrix:r,visible:n})):this._fillStyle.reset(),this},e.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},e.prototype.drawRect=function(t,e,i,r){return this.drawShape(new gt(t,e,i,r))},e.prototype.drawRoundedRect=function(t,e,i,r,n){return this.drawShape(new xt(t,e,i,r,n))},e.prototype.drawCircle=function(t,e,i){return this.drawShape(new mt(t,e,i))},e.prototype.drawEllipse=function(t,e,i,r){return this.drawShape(new yt(t,e,i,r))},e.prototype.drawPolygon=function(t){var e=arguments,i=t,r=!0;if(i.points&&(r=i.closeStroke,i=i.points),!Array.isArray(i)){i=new Array(arguments.length);for(var n=0;n<i.length;++n)i[n]=e[n]}var s=new vt(i);return s.closeStroke=r,this.drawShape(s),this},e.prototype.drawShape=function(t){return this._holeMode?this.geometry.drawHole(t,this._matrix):this.geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},e.prototype.drawStar=function(t,e,i,r,n,s){return void 0===s&&(s=0),this.drawPolygon(new dr(t,e,i,r,n,s))},e.prototype.clear=function(){return this.geometry.clear(),this._matrix=null,this._holeMode=!1,this.currentPath=null,this._spriteRect=null,this},e.prototype.isFastRect=function(){return!1},e.prototype._render=function(t){this.finishPoly();var e=this.geometry;if(e.updateBatches(),e.batchable){if(this.batchDirty!==e.batchDirty){this.batches=[],this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.vertexData=new Float32Array(e.points);for(var i=this.blendMode,r=0;r<e.batches.length;r++){var n=e.batches[r],s=n.style.color,o=new Float32Array(this.vertexData.buffer,4*n.attribStart*2,2*n.attribSize),a=new Float32Array(e.uvsFloat32.buffer,4*n.attribStart*2,2*n.attribSize),h={vertexData:o,blendMode:i,indices:new Uint16Array(e.indicesUint16.buffer,2*n.start,n.size),uvs:a,_batchRGB:C(s),_tintRGB:s,_texture:n.style.texture,alpha:n.style.alpha,worldAlpha:1};this.batches[r]=h}}if(t.batch.setObjectRenderer(t.plugins.batch),this.batches.length){this.calculateVertices(),this.calculateTints();for(var l=0;l<this.batches.length;l++){var u=this.batches[l];u.worldAlpha=this.worldAlpha*u.alpha,t.plugins.batch.render(u)}}}else{if(t.batch.flush(),!this.shader){if(!gr){for(var c=new Int32Array(16),d=0;d<16;d++)c[d]=d;var p={tint:new Float32Array([1,1,1,1]),translationMatrix:new it,default:ve.from({uSamplers:c},!0)},g=t.plugins.batch.shader.program;gr=new Qe(g,p)}this.shader=gr}var f=this.shader.uniforms;f.translationMatrix=this.transform.worldTransform;var _=this.tint,m=this.worldAlpha;f.tint[0]=(_>>16&255)/255*m,f.tint[1]=(_>>8&255)/255*m,f.tint[2]=(255&_)/255*m,f.tint[3]=m,t.shader.bind(this.shader),t.geometry.bind(e,this.shader),t.state.setState(this.state);for(var y=0;y<e.drawCalls.length;y++){for(var v=e.drawCalls[y],x=v.textureCount,E=0;E<x;E++)t.texture.bind(v.textures[E],E);t.geometry.draw(v.type,v.size,v.start)}}},e.prototype._calculateBounds=function(){this.finishPoly();var t=this.geometry.bounds;this._bounds.addFrame(this.transform,t.minX,t.minY,t.maxX,t.maxY)},e.prototype.containsPoint=function(t){return this.worldTransform.applyInverse(t,e._TEMP_POINT),this.geometry.containsPoint(e._TEMP_POINT)},e.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var t=C(this.tint,pr),e=0;e<this.batches.length;e++){var i=this.batches[e],r=i._batchRGB,n=(t[0]*r[0]*255<<16)+(t[1]*r[1]*255<<8)+(0|t[2]*r[2]*255);i._tintRGB=(n>>16)+(65280&n)+((255&n)<<16)}}},e.prototype.calculateVertices=function(){if(this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID;for(var t=this.transform.worldTransform,e=t.a,i=t.b,r=t.c,n=t.d,s=t.tx,o=t.ty,a=this.geometry.points,h=this.vertexData,l=0,u=0;u<a.length;u+=2){var c=a[u],d=a[u+1];h[l++]=e*c+r*d+s,h[l++]=n*d+i*c+o}}},e.prototype.closePath=function(){var t=this.currentPath;return t&&(t.closeStroke=!0),this},e.prototype.setMatrix=function(t){return this._matrix=t,this},e.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},e.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.geometry.refCount--,0===this.geometry.refCount&&this.geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this.geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,t.prototype.destroy.call(this,e)},Object.defineProperties(e.prototype,i),e}(It);fr._TEMP_POINT=new K;var _r=new K,mr=new Uint16Array([0,1,2,0,2,3]),yr=function(t){function e(e){t.call(this),this._anchor=new Z(this._onAnchorUpdate,this,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tint=null,this._tintRGB=null,this.tint=16777215,this.blendMode=g.NORMAL,this.shader=null,this._cachedTint=16777215,this.uvs=null,this.texture=e||ne.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=mr,this.size=4,this.start=0,this.pluginName="batch",this.isSprite=!0,this._roundPixels=s.ROUND_PIXELS}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={roundPixels:{configurable:!0},width:{configurable:!0},height:{configurable:!0},anchor:{configurable:!0},tint:{configurable:!0},texture:{configurable:!0}};return e.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this._width&&(this.scale.x=F(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=F(this.scale.y)*this._height/this._texture.orig.height)},e.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},e.prototype.calculateVertices=function(){var t=this._texture;if(this._transformID!==this.transform._worldID||this._textureID!==t._updateID){this._transformID=this.transform._worldID,this._textureID=t._updateID;var e=this.transform.worldTransform,i=e.a,r=e.b,n=e.c,s=e.d,o=e.tx,a=e.ty,h=this.vertexData,l=t.trim,u=t.orig,c=this._anchor,d=0,p=0,g=0,f=0;if(l?(d=(p=l.x-c._x*u.width)+l.width,g=(f=l.y-c._y*u.height)+l.height):(d=(p=-c._x*u.width)+u.width,g=(f=-c._y*u.height)+u.height),h[0]=i*p+n*f+o,h[1]=s*f+r*p+a,h[2]=i*d+n*f+o,h[3]=s*f+r*d+a,h[4]=i*d+n*g+o,h[5]=s*g+r*d+a,h[6]=i*p+n*g+o,h[7]=s*g+r*p+a,this._roundPixels)for(var _=0;_<8;_++)h[_]=Math.round(h[_])}},e.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var t=this._texture,e=this.vertexTrimmedData,i=t.orig,r=this._anchor,n=this.transform.worldTransform,s=n.a,o=n.b,a=n.c,h=n.d,l=n.tx,u=n.ty,c=-r._x*i.width,d=c+i.width,p=-r._y*i.height,g=p+i.height;e[0]=s*c+a*p+l,e[1]=h*p+o*c+u,e[2]=s*d+a*p+l,e[3]=h*p+o*d+u,e[4]=s*d+a*g+l,e[5]=h*g+o*d+u,e[6]=s*c+a*g+l,e[7]=h*g+o*c+u},e.prototype._render=function(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},e.prototype._calculateBounds=function(){var t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new gt),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,_r);var e=this._texture.orig.width,i=this._texture.orig.height,r=-e*this.anchor.x,n=0;return _r.x>=r&&_r.x<r+e&&(n=-i*this.anchor.y,_r.y>=n&&_r.y<n+i)},e.prototype.destroy=function(e){if(t.prototype.destroy.call(this,e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof e?e:e&&e.texture){var i="boolean"==typeof e?e:e&&e.baseTexture;this._texture.destroy(!!i)}this._texture=null,this.shader=null},e.from=function(t,i){return new e(t instanceof ne?t:ne.from(t,i))},i.roundPixels.set=function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},i.roundPixels.get=function(){return this._roundPixels},i.width.get=function(){return Math.abs(this.scale.x)*this._texture.orig.width},i.width.set=function(t){var e=F(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},i.height.get=function(){return Math.abs(this.scale.y)*this._texture.orig.height},i.height.set=function(t){var e=F(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},i.anchor.get=function(){return this._anchor},i.anchor.set=function(t){this._anchor.copyFrom(t)},i.tint.get=function(){return this._tint},i.tint.set=function(t){this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16)},i.texture.get=function(){return this._texture},i.texture.set=function(t){this._texture!==t&&(this._texture=t||ne.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))},Object.defineProperties(e.prototype,i),e}(It),vr=0,xr={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:vr,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},Er=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],wr=function(t){this.styleID=0,this.reset(),Sr(this,t,t)},br={align:{configurable:!0},breakWords:{configurable:!0},dropShadow:{configurable:!0},dropShadowAlpha:{configurable:!0},dropShadowAngle:{configurable:!0},dropShadowBlur:{configurable:!0},dropShadowColor:{configurable:!0},dropShadowDistance:{configurable:!0},fill:{configurable:!0},fillGradientType:{configurable:!0},fillGradientStops:{configurable:!0},fontFamily:{configurable:!0},fontSize:{configurable:!0},fontStyle:{configurable:!0},fontVariant:{configurable:!0},fontWeight:{configurable:!0},letterSpacing:{configurable:!0},lineHeight:{configurable:!0},leading:{configurable:!0},lineJoin:{configurable:!0},miterLimit:{configurable:!0},padding:{configurable:!0},stroke:{configurable:!0},strokeThickness:{configurable:!0},textBaseline:{configurable:!0},trim:{configurable:!0},whiteSpace:{configurable:!0},wordWrap:{configurable:!0},wordWrapWidth:{configurable:!0}};function Ir(t){return"number"==typeof t?N(t):("string"==typeof t&&0===t.indexOf("0x")&&(t=t.replace("0x","#")),t)}function Tr(t){if(Array.isArray(t)){for(var e=0;e<t.length;++e)t[e]=Ir(t[e]);return t}return Ir(t)}function Sr(t,e,i){for(var r in i)Array.isArray(e[r])?t[r]=e[r].slice():t[r]=e[r]}wr.prototype.clone=function(){var t={};return Sr(t,this,xr),new wr(t)},wr.prototype.reset=function(){Sr(this,xr,xr)},br.align.get=function(){return this._align},br.align.set=function(t){this._align!==t&&(this._align=t,this.styleID++)},br.breakWords.get=function(){return this._breakWords},br.breakWords.set=function(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)},br.dropShadow.get=function(){return this._dropShadow},br.dropShadow.set=function(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)},br.dropShadowAlpha.get=function(){return this._dropShadowAlpha},br.dropShadowAlpha.set=function(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)},br.dropShadowAngle.get=function(){return this._dropShadowAngle},br.dropShadowAngle.set=function(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)},br.dropShadowBlur.get=function(){return this._dropShadowBlur},br.dropShadowBlur.set=function(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)},br.dropShadowColor.get=function(){return this._dropShadowColor},br.dropShadowColor.set=function(t){var e=Tr(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)},br.dropShadowDistance.get=function(){return this._dropShadowDistance},br.dropShadowDistance.set=function(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)},br.fill.get=function(){return this._fill},br.fill.set=function(t){var e=Tr(t);this._fill!==e&&(this._fill=e,this.styleID++)},br.fillGradientType.get=function(){return this._fillGradientType},br.fillGradientType.set=function(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)},br.fillGradientStops.get=function(){return this._fillGradientStops},br.fillGradientStops.set=function(t){(function(t,e){if(!Array.isArray(t)||!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(var i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0})(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)},br.fontFamily.get=function(){return this._fontFamily},br.fontFamily.set=function(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)},br.fontSize.get=function(){return this._fontSize},br.fontSize.set=function(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)},br.fontStyle.get=function(){return this._fontStyle},br.fontStyle.set=function(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)},br.fontVariant.get=function(){return this._fontVariant},br.fontVariant.set=function(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)},br.fontWeight.get=function(){return this._fontWeight},br.fontWeight.set=function(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)},br.letterSpacing.get=function(){return this._letterSpacing},br.letterSpacing.set=function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)},br.lineHeight.get=function(){return this._lineHeight},br.lineHeight.set=function(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)},br.leading.get=function(){return this._leading},br.leading.set=function(t){this._leading!==t&&(this._leading=t,this.styleID++)},br.lineJoin.get=function(){return this._lineJoin},br.lineJoin.set=function(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)},br.miterLimit.get=function(){return this._miterLimit},br.miterLimit.set=function(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)},br.padding.get=function(){return this._padding},br.padding.set=function(t){this._padding!==t&&(this._padding=t,this.styleID++)},br.stroke.get=function(){return this._stroke},br.stroke.set=function(t){var e=Tr(t);this._stroke!==e&&(this._stroke=e,this.styleID++)},br.strokeThickness.get=function(){return this._strokeThickness},br.strokeThickness.set=function(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)},br.textBaseline.get=function(){return this._textBaseline},br.textBaseline.set=function(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)},br.trim.get=function(){return this._trim},br.trim.set=function(t){this._trim!==t&&(this._trim=t,this.styleID++)},br.whiteSpace.get=function(){return this._whiteSpace},br.whiteSpace.set=function(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)},br.wordWrap.get=function(){return this._wordWrap},br.wordWrap.set=function(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)},br.wordWrapWidth.get=function(){return this._wordWrapWidth},br.wordWrapWidth.set=function(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)},wr.prototype.toFontString=function(){var t="number"==typeof this.fontSize?this.fontSize+"px":this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(var i=e.length-1;i>=0;i--){var r=e[i].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&Er.indexOf(r)<0&&(r='"'+r+'"'),e[i]=r}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+t+" "+e.join(",")},Object.defineProperties(wr.prototype,br);var Cr=function(t,e,i,r,n,s,o,a,h){this.text=t,this.style=e,this.width=i,this.height=r,this.lines=n,this.lineWidths=s,this.lineHeight=o,this.maxLineWidth=a,this.fontProperties=h};Cr.measureText=function(t,e,i,r){void 0===r&&(r=Cr._canvas),i=null==i?e.wordWrap:i;var n=e.toFontString(),s=Cr.measureFont(n);0===s.fontSize&&(s.fontSize=e.fontSize,s.ascent=e.fontSize);var o=r.getContext("2d");o.font=n;for(var a=(i?Cr.wordWrap(t,e,r):t).split(/(?:\r\n|\r|\n)/),h=new Array(a.length),l=0,u=0;u<a.length;u++){var c=o.measureText(a[u]).width+(a[u].length-1)*e.letterSpacing;h[u]=c,l=Math.max(l,c)}var d=l+e.strokeThickness;e.dropShadow&&(d+=e.dropShadowDistance);var p=e.lineHeight||s.fontSize+e.strokeThickness,g=Math.max(p,s.fontSize+e.strokeThickness)+(a.length-1)*(p+e.leading);return e.dropShadow&&(g+=e.dropShadowDistance),new Cr(t,e,d,g,a,h,p+e.leading,l,s)},Cr.wordWrap=function(t,e,i){void 0===i&&(i=Cr._canvas);for(var r=i.getContext("2d"),n=0,s="",o="",a={},h=e.letterSpacing,l=e.whiteSpace,u=Cr.collapseSpaces(l),c=Cr.collapseNewlines(l),d=!u,p=e.wordWrapWidth+h,g=Cr.tokenize(t),f=0;f<g.length;f++){var _=g[f];if(Cr.isNewline(_)){if(!c){o+=Cr.addLine(s),d=!u,s="",n=0;continue}_=" "}if(u){var m=Cr.isBreakingSpace(_),y=Cr.isBreakingSpace(s[s.length-1]);if(m&&y)continue}var v=Cr.getFromCache(_,h,a,r);if(v>p)if(""!==s&&(o+=Cr.addLine(s),s="",n=0),Cr.canBreakWords(_,e.breakWords))for(var x=_.split(""),E=0;E<x.length;E++){for(var w=x[E],b=1;x[E+b];){var I=x[E+b],T=w[w.length-1];if(Cr.canBreakChars(T,I,_,E,e.breakWords))break;w+=I,b++}E+=w.length-1;var S=Cr.getFromCache(w,h,a,r);S+n>p&&(o+=Cr.addLine(s),d=!1,s="",n=0),s+=w,n+=S}else{s.length>0&&(o+=Cr.addLine(s),s="",n=0);var C=f===g.length-1;o+=Cr.addLine(_,!C),d=!1,s="",n=0}else v+n>p&&(d=!1,o+=Cr.addLine(s),s="",n=0),(s.length>0||!Cr.isBreakingSpace(_)||d)&&(s+=_,n+=v)}return o+=Cr.addLine(s,!1)},Cr.addLine=function(t,e){return void 0===e&&(e=!0),t=Cr.trimRight(t),t=e?t+"\n":t},Cr.getFromCache=function(t,e,i,r){var n=i[t];if(void 0===n){var s=t.length*e;n=r.measureText(t).width+s,i[t]=n}return n},Cr.collapseSpaces=function(t){return"normal"===t||"pre-line"===t},Cr.collapseNewlines=function(t){return"normal"===t},Cr.trimRight=function(t){if("string"!=typeof t)return"";for(var e=t.length-1;e>=0;e--){var i=t[e];if(!Cr.isBreakingSpace(i))break;t=t.slice(0,-1)}return t},Cr.isNewline=function(t){return"string"==typeof t&&Cr._newlines.indexOf(t.charCodeAt(0))>=0},Cr.isBreakingSpace=function(t){return"string"==typeof t&&Cr._breakingSpaces.indexOf(t.charCodeAt(0))>=0},Cr.tokenize=function(t){var e=[],i="";if("string"!=typeof t)return e;for(var r=0;r<t.length;r++){var n=t[r];Cr.isBreakingSpace(n)||Cr.isNewline(n)?(""!==i&&(e.push(i),i=""),e.push(n)):i+=n}return""!==i&&e.push(i),e},Cr.canBreakWords=function(t,e){return e},Cr.canBreakChars=function(t,e,i,r,n){return!0},Cr.measureFont=function(t){if(Cr._fonts[t])return Cr._fonts[t];var e={},i=Cr._canvas,r=Cr._context;r.font=t;var n=Cr.METRICS_STRING+Cr.BASELINE_SYMBOL,s=Math.ceil(r.measureText(n).width),o=Math.ceil(r.measureText(Cr.BASELINE_SYMBOL).width),a=2*o;o=o*Cr.BASELINE_MULTIPLIER|0,i.width=s,i.height=a,r.fillStyle="#f00",r.fillRect(0,0,s,a),r.font=t,r.textBaseline="alphabetic",r.fillStyle="#000",r.fillText(n,0,o);var h=r.getImageData(0,0,s,a).data,l=h.length,u=4*s,c=0,d=0,p=!1;for(c=0;c<o;++c){for(var g=0;g<u;g+=4)if(255!==h[d+g]){p=!0;break}if(p)break;d+=u}for(e.ascent=o-c,d=l-u,p=!1,c=a;c>o;--c){for(var f=0;f<u;f+=4)if(255!==h[d+f]){p=!0;break}if(p)break;d-=u}return e.descent=c-o,e.fontSize=e.ascent+e.descent,Cr._fonts[t]=e,e},Cr.clearMetrics=function(t){void 0===t&&(t=""),t?delete Cr._fonts[t]:Cr._fonts={}};var Nr=document.createElement("canvas");Nr.width=Nr.height=10,Cr._canvas=Nr,Cr._context=Nr.getContext("2d"),Cr._fonts={},Cr.METRICS_STRING="|q",Cr.BASELINE_SYMBOL="M",Cr.BASELINE_MULTIPLIER=1.4,Cr._newlines=[10,13],Cr._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var Or={texture:!0,children:!1,baseTexture:!0},Pr=function(t){function e(e,i,r){(r=r||document.createElement("canvas")).width=3,r.height=3;var n=ne.from(r);n.orig=new gt,n.trim=new gt,t.call(this,n),this.canvas=r,this.context=this.canvas.getContext("2d"),this._resolution=s.RESOLUTION,this._autoResolution=!0,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=e,this.style=i,this.localStyleID=-1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={width:{configurable:!0},height:{configurable:!0},style:{configurable:!0},text:{configurable:!0},resolution:{configurable:!0}};return e.prototype.updateText=function(t){var e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),this.dirty||!t){this._font=this._style.toFontString();var i,r,n,s=this.context,o=Cr.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),a=o.width,h=o.height,l=o.lines,u=o.lineHeight,c=o.lineWidths,d=o.maxLineWidth,p=o.fontProperties;if(this.canvas.width=Math.ceil((Math.max(1,a)+2*e.padding)*this._resolution),this.canvas.height=Math.ceil((Math.max(1,h)+2*e.padding)*this._resolution),s.scale(this._resolution,this._resolution),s.clearRect(0,0,this.canvas.width,this.canvas.height),s.font=this._font,s.strokeStyle=e.stroke,s.lineWidth=e.strokeThickness,s.textBaseline=e.textBaseline,s.lineJoin=e.lineJoin,s.miterLimit=e.miterLimit,e.dropShadow){var g=e.dropShadowColor,f=C("number"==typeof g?g:("string"==typeof(n=g)&&"#"===n[0]&&(n=n.substr(1)),parseInt(n,16)));s.shadowColor="rgba("+255*f[0]+","+255*f[1]+","+255*f[2]+","+e.dropShadowAlpha+")",s.shadowBlur=e.dropShadowBlur,s.shadowOffsetX=Math.cos(e.dropShadowAngle)*e.dropShadowDistance,s.shadowOffsetY=Math.sin(e.dropShadowAngle)*e.dropShadowDistance}else s.shadowColor=0,s.shadowBlur=0,s.shadowOffsetX=0,s.shadowOffsetY=0;s.fillStyle=this._generateFillStyle(e,l);for(var _=0;_<l.length;_++)i=e.strokeThickness/2,r=e.strokeThickness/2+_*u+p.ascent,"right"===e.align?i+=d-c[_]:"center"===e.align&&(i+=(d-c[_])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(l[_],i+e.padding,r+e.padding,!0),e.fill&&this.drawLetterSpacing(l[_],i+e.padding,r+e.padding);this.updateTexture()}},e.prototype.drawLetterSpacing=function(t,e,i,r){void 0===r&&(r=!1);var n=this._style.letterSpacing;if(0!==n)for(var s=e,o=Array.from?Array.from(t):t.split(""),a=0;a<o.length;++a){var h=o[a];r?this.context.strokeText(h,s,i):this.context.fillText(h,s,i),s+=this.context.measureText(h).width+n}else r?this.context.strokeText(t,e,i):this.context.fillText(t,e,i)},e.prototype.updateTexture=function(){var t=this.canvas;if(this._style.trim){var e=function(t){var e,i,r,n=t.width,s=t.height,o=t.getContext("2d"),a=o.getImageData(0,0,n,s).data,h=a.length,l={top:null,left:null,right:null,bottom:null},u=null;for(e=0;e<h;e+=4)0!==a[e+3]&&(i=e/4%n,r=~~(e/4/n),null===l.top&&(l.top=r),null===l.left?l.left=i:i<l.left&&(l.left=i),null===l.right?l.right=i+1:l.right<i&&(l.right=i+1),null===l.bottom?l.bottom=r:l.bottom<r&&(l.bottom=r));return null!==l.top&&(n=l.right-l.left,s=l.bottom-l.top+1,u=o.getImageData(l.left,l.top,n,s)),{height:s,width:n,data:u}}(t);e.data&&(t.width=e.width,t.height=e.height,this.context.putImageData(e.data,0,0))}var i=this._texture,r=this._style,n=r.trim?0:r.padding,s=i.baseTexture;i.trim.width=i._frame.width=t.width/this._resolution,i.trim.height=i._frame.height=t.height/this._resolution,i.trim.x=-n,i.trim.y=-n,i.orig.width=i._frame.width-2*n,i.orig.height=i._frame.height-2*n,this._onTextureUpdate(),s.setRealSize(t.width,t.height,this._resolution),this.dirty=!1},e.prototype.render=function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),t.prototype.render.call(this,e)},e.prototype._renderCanvas=function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),t.prototype._renderCanvas.call(this,e)},e.prototype.getLocalBounds=function(e){return this.updateText(!0),t.prototype.getLocalBounds.call(this,e)},e.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},e.prototype._onStyleChange=function(){this.dirty=!0},e.prototype._generateFillStyle=function(t,e){if(!Array.isArray(t.fill))return t.fill;var i,r,n,s,o=this.canvas.width/this._resolution,a=this.canvas.height/this._resolution,h=t.fill.slice(),l=t.fillGradientStops.slice();if(!l.length)for(var u=h.length+1,c=1;c<u;++c)l.push(c/u);if(h.unshift(t.fill[0]),l.unshift(0),h.push(t.fill[t.fill.length-1]),l.push(1),t.fillGradientType===vr){i=this.context.createLinearGradient(o/2,0,o/2,a),r=(h.length+1)*e.length,n=0;for(var d=0;d<e.length;d++){n+=1;for(var p=0;p<h.length;p++)s="number"==typeof l[p]?l[p]/e.length+d/e.length:n/r,i.addColorStop(s,h[p]),n++}}else{i=this.context.createLinearGradient(0,a/2,o,a/2),r=h.length+1,n=1;for(var g=0;g<h.length;g++)s="number"==typeof l[g]?l[g]:n/r,i.addColorStop(s,h[g]),n++}return i},e.prototype.destroy=function(e){"boolean"==typeof e&&(e={children:e}),e=Object.assign({},Or,e),t.prototype.destroy.call(this,e),this.context=null,this.canvas=null,this._style=null},i.width.get=function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},i.width.set=function(t){this.updateText(!0);var e=F(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},i.height.get=function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},i.height.set=function(t){this.updateText(!0);var e=F(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},i.style.get=function(){return this._style},i.style.set=function(t){t=t||{},this._style=t instanceof wr?t:new wr(t),this.localStyleID=-1,this.dirty=!0},i.text.get=function(){return this._text},i.text.set=function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},i.resolution.get=function(){return this._resolution},i.resolution.set=function(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)},Object.defineProperties(e.prototype,i),e}(yr);s.UPLOADS_PER_FRAME=4;var Lr=function(t){this.maxItemsPerFrame=t,this.itemsLeft=0};Lr.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},Lr.prototype.allowedToUpload=function(){return this.itemsLeft-- >0};var Ar=function(t){var e=this;this.limiter=new Lr(s.UPLOADS_PER_FRAME),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){e.queue&&e.prepareItems()},this.registerFindHook(kr),this.registerFindHook(Gr),this.registerFindHook(Rr),this.registerFindHook(Mr),this.registerFindHook(Dr),this.registerUploadHook(Fr),this.registerUploadHook(Br)};function Rr(t,e){var i=!1;if(t&&t._textures&&t._textures.length)for(var r=0;r<t._textures.length;r++)if(t._textures[r]instanceof ne){var n=t._textures[r].baseTexture;-1===e.indexOf(n)&&(e.push(n),i=!0)}return i}function Mr(t,e){return t instanceof Ht&&(-1===e.indexOf(t)&&e.push(t),!0)}function Dr(t,e){if(t._texture&&t._texture instanceof ne){var i=t._texture.baseTexture;return-1===e.indexOf(i)&&e.push(i),!0}return!1}function Fr(t,e){return e instanceof Pr&&(e.updateText(!0),!0)}function Br(t,e){if(e instanceof wr){var i=e.toFontString();return Cr.measureFont(i),!0}return!1}function kr(t,e){if(t instanceof Pr){-1===e.indexOf(t.style)&&e.push(t.style),-1===e.indexOf(t)&&e.push(t);var i=t._texture.baseTexture;return-1===e.indexOf(i)&&e.push(i),!0}return!1}function Gr(t,e){return t instanceof wr&&(-1===e.indexOf(t)&&e.push(t),!0)}Ar.prototype.upload=function(t,e){"function"==typeof t&&(e=t,t=null),t&&this.add(t),this.queue.length?(e&&this.completes.push(e),this.ticking||(this.ticking=!0,Rt.system.addOnce(this.tick,this,Lt))):e&&e()},Ar.prototype.tick=function(){setTimeout(this.delayedTick,0)},Ar.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var t=this.queue[0],e=!1;if(t&&!t._destroyed)for(var i=0,r=this.uploadHooks.length;i<r;i++)if(this.uploadHooks[i](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}e||this.queue.shift()}if(this.queue.length)Rt.system.addOnce(this.tick,this,Lt);else{this.ticking=!1;var n=this.completes.slice(0);this.completes.length=0;for(var s=0,o=n.length;s<o;s++)n[s]()}},Ar.prototype.registerFindHook=function(t){return t&&this.addHooks.push(t),this},Ar.prototype.registerUploadHook=function(t){return t&&this.uploadHooks.push(t),this},Ar.prototype.add=function(t){for(var e=0,i=this.addHooks.length;e<i&&!this.addHooks[e](t,this.queue);e++);if(t instanceof It)for(var r=t.children.length-1;r>=0;r--)this.add(t.children[r]);return this},Ar.prototype.destroy=function(){this.ticking&&Rt.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null};var Ur=function(t){function e(e){t.call(this,e),this.uploadHookHelper=this.renderer,this.registerFindHook(Xr),this.registerUploadHook(Yr),this.registerUploadHook(zr)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Ar);function Yr(t,e){return e instanceof Ht&&(e._glTextures[t.CONTEXT_UID]||t.textureManager.updateTexture(e),!0)}function zr(t,e){return e instanceof fr&&((e.dirty||e.clearDirty||!e._webGL[t.plugins.graphics.CONTEXT_UID])&&t.plugins.graphics.updateGraphics(e),!0)}function Xr(t,e){return t instanceof fr&&(e.push(t),!0)}var qr=function(t){this.maxMilliseconds=t,this.frameStart=0};qr.prototype.beginFrame=function(){this.frameStart=Date.now()},qr.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds};var Hr=function t(e){var i=this;e=Object.assign({forceCanvas:!1},e),this.renderer=function(t){return Ci.create(t)}(e),this.stage=new It,t._plugins.forEach(function(t){t.init.call(i,e)})},Vr={view:{configurable:!0},screen:{configurable:!0}};Hr.registerPlugin=function(t){Hr._plugins.push(t)},Hr.prototype.render=function(){this.renderer.render(this.stage)},Vr.view.get=function(){return this.renderer.view},Vr.screen.get=function(){return this.renderer.screen},Hr.prototype.destroy=function(t){var e=this,i=Hr._plugins.slice(0);i.reverse(),i.forEach(function(t){t.destroy.call(e)}),this.stage.destroy(),this.stage=null,this.renderer.destroy(t),this.renderer=null,this._options=null},Object.defineProperties(Hr.prototype,Vr),Hr._plugins=[];var jr=function(){};jr.init=function(t){var e=this;Object.defineProperty(this,"resizeTo",{set:function(t){window.removeEventListener("resize",this.resize),this._resizeTo=t,t&&(window.addEventListener("resize",this.resize),this.resize())},get:function(){return this._resizeTo}}),this.resize=function(){e._resizeTo&&(e._resizeTo===window?e.renderer.resize(window.innerWidth,window.innerHeight):e.renderer.resize(e._resizeTo.clientWidth,e._resizeTo.clientHeight))},this._resizeTo=null,this.resizeTo=t.resizeTo||null},jr.destroy=function(){this.resizeTo=null,this.resize=null},Hr.registerPlugin(jr);var Wr=i(7),Kr=i.n(Wr);function Zr(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Jr(t,e){return t(e={exports:{}},e.exports),e.exports}var Qr=function(t,e){e=e||{};for(var i={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},r=i.parser[e.strictMode?"strict":"loose"].exec(t),n={},s=14;s--;)n[i.key[s]]=r[s]||"";return n[i.q.name]={},n[i.key[12]].replace(i.q.parser,function(t,e,r){e&&(n[i.q.name][e]=r)}),n},$r=Jr(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}();function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function(){function t(e,i,n){void 0===i&&(i=!1),r(this,t),this._fn=e,this._once=i,this._thisArg=n,this._next=this._prev=this._owner=null}return i(t,[{key:"detach",value:function(){return null!==this._owner&&(this._owner.detach(this),!0)}}]),t}();function s(t,e){return t._head?(t._tail._next=e,e._prev=t._tail,t._tail=e):(t._head=e,t._tail=e),e._owner=t,e}var o=function(){function t(){r(this,t),this._head=this._tail=void 0}return i(t,[{key:"handlers",value:function(){var t=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],e=this._head;if(t)return!!e;for(var i=[];e;)i.push(e),e=e._next;return i}},{key:"has",value:function(t){if(!(t instanceof n))throw new Error("MiniSignal#has(): First arg must be a MiniSignalBinding object.");return t._owner===this}},{key:"dispatch",value:function(){var t=arguments,e=this._head;if(!e)return!1;for(;e;)e._once&&this.detach(e),e._fn.apply(e._thisArg,t),e=e._next;return!0}},{key:"add",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof t)throw new Error("MiniSignal#add(): First arg must be a Function.");return s(this,new n(t,!1,e))}},{key:"once",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof t)throw new Error("MiniSignal#once(): First arg must be a Function.");return s(this,new n(t,!0,e))}},{key:"detach",value:function(t){if(!(t instanceof n))throw new Error("MiniSignal#detach(): First arg must be a MiniSignalBinding object.");return t._owner!==this?this:(t._prev&&(t._prev._next=t._next),t._next&&(t._next._prev=t._prev),t===this._head?(this._head=t._next,null===t._next&&(this._tail=null)):t===this._tail&&(this._tail=t._prev,this._tail._next=null),t._owner=null,this)}},{key:"detachAll",value:function(){var t=this._head;if(!t)return this;for(this._head=this._tail=null;t;)t._owner=null,t=t._next;return this}}]),t}();o.MiniSignalBinding=n,e.default=o,t.exports=e.default});Zr($r);var tn=Jr(function(t,e){e.__esModule=!0,e.Resource=void 0;var i=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),r=s(Qr),n=s($r);function s(t){return t&&t.__esModule?t:{default:t}}var o=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest),a=null;function h(){}var l=e.Resource=function(){function t(e,i,r){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),"string"!=typeof e||"string"!=typeof i)throw new Error("Both name and url are required for constructing a resource.");r=r||{},this._flags=0,this._setFlag(t.STATUS_FLAGS.DATA_URL,0===i.indexOf("data:")),this.name=e,this.url=i,this.extension=this._getExtension(),this.data=null,this.crossOrigin=!0===r.crossOrigin?"anonymous":r.crossOrigin,this.timeout=r.timeout||0,this.loadType=r.loadType||this._determineLoadType(),this.xhrType=r.xhrType,this.metadata=r.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=t.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=h,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new n.default,this.onProgress=new n.default,this.onComplete=new n.default,this.onAfterMiddleware=new n.default}return t.setExtensionLoadType=function(e,i){u(t._loadTypeMap,e,i)},t.setExtensionXhrType=function(e,i){u(t._xhrTypeMap,e,i)},t.prototype.complete=function(){this._clearEvents(),this._finish()},t.prototype.abort=function(e){if(!this.error){if(this.error=new Error(e),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=t.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},t.prototype.load=function(e){var i=this;if(!this.isLoading)if(this.isComplete)e&&setTimeout(function(){return e(i)},1);else switch(e&&this.onComplete.once(e),this._setFlag(t.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),!1!==this.crossOrigin&&"string"==typeof this.crossOrigin||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case t.LOAD_TYPE.IMAGE:this.type=t.TYPE.IMAGE,this._loadElement("image");break;case t.LOAD_TYPE.AUDIO:this.type=t.TYPE.AUDIO,this._loadSourceElement("audio");break;case t.LOAD_TYPE.VIDEO:this.type=t.TYPE.VIDEO,this._loadSourceElement("video");break;case t.LOAD_TYPE.XHR:default:o&&this.crossOrigin?this._loadXdr():this._loadXhr()}},t.prototype._hasFlag=function(t){return 0!=(this._flags&t)},t.prototype._setFlag=function(t,e){this._flags=e?this._flags|t:this._flags&~t},t.prototype._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},t.prototype._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(t.STATUS_FLAGS.COMPLETE,!0),this._setFlag(t.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},t.prototype._loadElement=function(t){this.metadata.loadElement?this.data=this.metadata.loadElement:"image"===t&&void 0!==window.Image?this.data=new Image:this.data=document.createElement(t),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},t.prototype._loadSourceElement=function(t){if(this.metadata.loadElement?this.data=this.metadata.loadElement:"audio"===t&&void 0!==window.Audio?this.data=new Audio:this.data=document.createElement(t),null!==this.data){if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=this.metadata.mimeType,i=0;i<this.url.length;++i)this.data.appendChild(this._createSource(t,this.url[i],Array.isArray(e)?e[i]:e));else{var r=this.metadata.mimeType;this.data.appendChild(this._createSource(t,this.url,Array.isArray(r)?r[0]:r))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))}else this.abort("Unsupported element: "+t)},t.prototype._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XMLHttpRequest;e.open("GET",this.url,!0),e.timeout=this.timeout,this.xhrType===t.XHR_RESPONSE_TYPE.JSON||this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT?e.responseType=t.XHR_RESPONSE_TYPE.TEXT:e.responseType=this.xhrType,e.addEventListener("error",this._boundXhrOnError,!1),e.addEventListener("timeout",this._boundXhrOnTimeout,!1),e.addEventListener("abort",this._boundXhrOnAbort,!1),e.addEventListener("progress",this._boundOnProgress,!1),e.addEventListener("load",this._boundXhrOnLoad,!1),e.send()},t.prototype._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XDomainRequest;t.timeout=this.timeout||5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXhrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout(function(){return t.send()},1)},t.prototype._createSource=function(t,e,i){i||(i=t+"/"+this._getExtension(e));var r=document.createElement("source");return r.src=e,r.type=i,r},t.prototype._onError=function(t){this.abort("Failed to load element using: "+t.target.nodeName)},t.prototype._onProgress=function(t){t&&t.lengthComputable&&this.onProgress.dispatch(this,t.loaded/t.total)},t.prototype._onTimeout=function(){this.abort("Load timed out.")},t.prototype._xhrOnError=function(){var t=this.xhr;this.abort(c(t)+" Request failed. Status: "+t.status+', text: "'+t.statusText+'"')},t.prototype._xhrOnTimeout=function(){var t=this.xhr;this.abort(c(t)+" Request timed out.")},t.prototype._xhrOnAbort=function(){var t=this.xhr;this.abort(c(t)+" Request was aborted by the user.")},t.prototype._xhrOnLoad=function(){var e=this.xhr,i="",r=void 0===e.status?200:e.status;if(""!==e.responseType&&"text"!==e.responseType&&void 0!==e.responseType||(i=e.responseText),0===r&&(i.length>0||e.responseType===t.XHR_RESPONSE_TYPE.BUFFER)?r=200:1223===r&&(r=204),2===(r/100|0)){if(this.xhrType===t.XHR_RESPONSE_TYPE.TEXT)this.data=i,this.type=t.TYPE.TEXT;else if(this.xhrType===t.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(i),this.type=t.TYPE.JSON}catch(t){return void this.abort("Error trying to parse loaded json: "+t)}else if(this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var n=new DOMParser;this.data=n.parseFromString(i,"text/xml")}else{var s=document.createElement("div");s.innerHTML=i,this.data=s}this.type=t.TYPE.XML}catch(t){return void this.abort("Error trying to parse loaded xml: "+t)}else this.data=e.response||i;this.complete()}else this.abort("["+e.status+"] "+e.statusText+": "+e.responseURL)},t.prototype._determineCrossOrigin=function(t,e){if(0===t.indexOf("data:"))return"";if(window.origin!==window.location.origin)return"anonymous";e=e||window.location,a||(a=document.createElement("a")),a.href=t;var i=!(t=(0,r.default)(a.href,{strictMode:!0})).port&&""===e.port||t.port===e.port,n=t.protocol?t.protocol+":":"";return t.host===e.hostname&&i&&n===e.protocol?"":"anonymous"},t.prototype._determineXhrType=function(){return t._xhrTypeMap[this.extension]||t.XHR_RESPONSE_TYPE.TEXT},t.prototype._determineLoadType=function(){return t._loadTypeMap[this.extension]||t.LOAD_TYPE.XHR},t.prototype._getExtension=function(){var t=this.url,e="";if(this.isDataUrl){var i=t.indexOf("/");e=t.substring(i+1,t.indexOf(";",i))}else{var r=t.indexOf("?"),n=t.indexOf("#"),s=Math.min(r>-1?r:t.length,n>-1?n:t.length);e=(t=t.substring(0,s)).substring(t.lastIndexOf(".")+1)}return e.toLowerCase()},t.prototype._getMimeFromXhrType=function(e){switch(e){case t.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case t.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case t.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case t.XHR_RESPONSE_TYPE.JSON:return"application/json";case t.XHR_RESPONSE_TYPE.DEFAULT:case t.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},i(t,[{key:"isDataUrl",get:function(){return this._hasFlag(t.STATUS_FLAGS.DATA_URL)}},{key:"isComplete",get:function(){return this._hasFlag(t.STATUS_FLAGS.COMPLETE)}},{key:"isLoading",get:function(){return this._hasFlag(t.STATUS_FLAGS.LOADING)}}]),t}();function u(t,e,i){e&&0===e.indexOf(".")&&(e=e.substring(1)),e&&(t[e]=i)}function c(t){return t.toString().replace("object ","")}l.STATUS_FLAGS={NONE:0,DATA_URL:1,COMPLETE:2,LOADING:4},l.TYPE={UNKNOWN:0,JSON:1,XML:2,IMAGE:3,AUDIO:4,VIDEO:5,TEXT:6},l.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},l.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},l._loadTypeMap={gif:l.LOAD_TYPE.IMAGE,png:l.LOAD_TYPE.IMAGE,bmp:l.LOAD_TYPE.IMAGE,jpg:l.LOAD_TYPE.IMAGE,jpeg:l.LOAD_TYPE.IMAGE,tif:l.LOAD_TYPE.IMAGE,tiff:l.LOAD_TYPE.IMAGE,webp:l.LOAD_TYPE.IMAGE,tga:l.LOAD_TYPE.IMAGE,svg:l.LOAD_TYPE.IMAGE,"svg+xml":l.LOAD_TYPE.IMAGE,mp3:l.LOAD_TYPE.AUDIO,ogg:l.LOAD_TYPE.AUDIO,wav:l.LOAD_TYPE.AUDIO,mp4:l.LOAD_TYPE.VIDEO,webm:l.LOAD_TYPE.VIDEO},l._xhrTypeMap={xhtml:l.XHR_RESPONSE_TYPE.DOCUMENT,html:l.XHR_RESPONSE_TYPE.DOCUMENT,htm:l.XHR_RESPONSE_TYPE.DOCUMENT,xml:l.XHR_RESPONSE_TYPE.DOCUMENT,tmx:l.XHR_RESPONSE_TYPE.DOCUMENT,svg:l.XHR_RESPONSE_TYPE.DOCUMENT,tsx:l.XHR_RESPONSE_TYPE.DOCUMENT,gif:l.XHR_RESPONSE_TYPE.BLOB,png:l.XHR_RESPONSE_TYPE.BLOB,bmp:l.XHR_RESPONSE_TYPE.BLOB,jpg:l.XHR_RESPONSE_TYPE.BLOB,jpeg:l.XHR_RESPONSE_TYPE.BLOB,tif:l.XHR_RESPONSE_TYPE.BLOB,tiff:l.XHR_RESPONSE_TYPE.BLOB,webp:l.XHR_RESPONSE_TYPE.BLOB,tga:l.XHR_RESPONSE_TYPE.BLOB,json:l.XHR_RESPONSE_TYPE.JSON,text:l.XHR_RESPONSE_TYPE.TEXT,txt:l.XHR_RESPONSE_TYPE.TEXT,ttf:l.XHR_RESPONSE_TYPE.BUFFER,otf:l.XHR_RESPONSE_TYPE.BUFFER},l.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",t.exports.default=l});Zr(tn);tn.Resource;var en=Jr(function(t,e){e.__esModule=!0,e.encodeBinary=r;var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function r(t){for(var e="",r=0;r<t.length;){for(var n=[0,0,0],s=[0,0,0,0],o=0;o<n.length;++o)r<t.length?n[o]=255&t.charCodeAt(r++):n[o]=0;switch(s[0]=n[0]>>2,s[1]=(3&n[0])<<4|n[1]>>4,s[2]=(15&n[1])<<2|n[2]>>6,s[3]=63&n[2],r-(t.length-1)){case 2:s[3]=64,s[2]=64;break;case 1:s[3]=64}for(var a=0;a<s.length;++a)e+=i.charAt(s[a])}return e}t.exports.default=r});Zr(en);en.encodeBinary;var rn=Jr(function(t,e){e.__esModule=!0,e.blobMiddlewareFactory=function(){return function(t,e){if(t.data){if(t.xhr&&t.xhrType===tn.Resource.XHR_RESPONSE_TYPE.BLOB)if(window.Blob&&"string"!=typeof t.data){if(0===t.data.type.indexOf("image")){var r=i.createObjectURL(t.data);return t.blob=t.data,t.data=new Image,t.data.src=r,t.type=tn.Resource.TYPE.IMAGE,void(t.data.onload=function(){i.revokeObjectURL(r),t.data.onload=null,e()})}}else{var n=t.xhr.getResponseHeader("content-type");if(n&&0===n.indexOf("image"))return t.data=new Image,t.data.src="data:"+n+";base64,"+(0,en.encodeBinary)(t.xhr.responseText),t.type=tn.Resource.TYPE.IMAGE,void(t.data.onload=function(){t.data.onload=null,e()})}e()}else e()}};var i=window.URL||window.webkitURL});Zr(rn);var nn=rn.blobMiddlewareFactory,sn=function(){};sn.use=function(t,e){t.data&&t.type===Wr.Resource.TYPE.IMAGE&&(t.texture=ne.fromLoader(t.data,t.url,t.name)),e()};var on=function(t){function e(i,r){var n=this;t.call(this,i,r),a.a.call(this);for(var s=0;s<e._plugins.length;++s){var o=e._plugins[s],h=o.pre,l=o.use;h&&this.pre(h),l&&this.use(l)}this.onStart.add(function(t){return n.emit("start",t)}),this.onProgress.add(function(t,e){return n.emit("progress",t,e)}),this.onError.add(function(t,e,i){return n.emit("error",t,e,i)}),this.onLoad.add(function(t,e){return n.emit("load",t,e)}),this.onComplete.add(function(t,e){return n.emit("complete",t,e)}),this._protected=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={shared:{configurable:!0}};return e.prototype.destroy=function(){this._protected||(this.removeAllListeners(),this.reset())},i.shared.get=function(){var t=e._shared;return t||((t=new e)._protected=!0,e._shared=t),t},Object.defineProperties(e,i),e}(Kr.a);Object.assign(on.prototype,a.a.prototype),on._plugins=[],on.registerPlugin=function(t){return on._plugins.push(t),t.add&&t.add(),on},on.registerPlugin({use:nn()}),on.registerPlugin(sn);var an=function(){};an.init=function(t){t=Object.assign({sharedLoader:!1},t),this.loader=t.sharedLoader?on.shared:new on},an.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)};var hn=Wr.Resource,ln=function(t,e,i){this.geometry=new fe,this.indexBuffer=null,this.size=i,this.dynamicProperties=[],this.staticProperties=[];for(var r=0;r<t.length;++r){var n=t[r];n={attributeName:n.attributeName,size:n.size,uploadFunction:n.uploadFunction,type:n.type||y.FLOAT,offset:n.offset},e[r]?this.dynamicProperties.push(n):this.staticProperties.push(n)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()};ln.prototype.initBuffers=function(){var t=this.geometry,e=0;this.indexBuffer=new le(function(t){for(var e=6*t,i=new Uint16Array(e),r=0,n=0;r<e;r+=6,n+=4)i[r+0]=n+0,i[r+1]=n+1,i[r+2]=n+2,i[r+3]=n+0,i[r+4]=n+2,i[r+5]=n+3;return i}(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(var i=0;i<this.dynamicProperties.length;++i){var r=this.dynamicProperties[i];r.offset=e,e+=r.size,this.dynamicStride+=r.size}var n=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(n),this.dynamicDataUint32=new Uint32Array(n),this.dynamicBuffer=new le(this.dynamicData,!1,!1);var s=0;this.staticStride=0;for(var o=0;o<this.staticProperties.length;++o){var a=this.staticProperties[o];a.offset=s,s+=a.size,this.staticStride+=a.size}var h=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(h),this.staticDataUint32=new Uint32Array(h),this.staticBuffer=new le(this.staticData,!0,!1);for(var l=0;l<this.dynamicProperties.length;++l){var u=this.dynamicProperties[l];t.addAttribute(u.attributeName,this.dynamicBuffer,0,u.type===y.UNSIGNED_BYTE,u.type,4*this.dynamicStride,4*u.offset)}for(var c=0;c<this.staticProperties.length;++c){var d=this.staticProperties[c];t.addAttribute(d.attributeName,this.staticBuffer,0,d.type===y.UNSIGNED_BYTE,d.type,4*this.staticStride,4*d.offset)}},ln.prototype.uploadDynamic=function(t,e,i){for(var r=0;r<this.dynamicProperties.length;r++){var n=this.dynamicProperties[r];n.uploadFunction(t,e,i,n.type===y.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,n.offset)}this.dynamicBuffer._updateID++},ln.prototype.uploadStatic=function(t,e,i){for(var r=0;r<this.staticProperties.length;r++){var n=this.staticProperties[r];n.uploadFunction(t,e,i,n.type===y.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,n.offset)}this.staticBuffer._updateID++},ln.prototype.destroy=function(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()};var un="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n",cn="varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}",dn=function(t){function e(e){t.call(this,e),this.shader=null,this.properties=null,this.tempMatrix=new it,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:y.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=Qe.from(un,cn,{})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.render=function(t){var e=t.children,i=t._maxSize,r=t._batchSize,n=this.renderer,s=e.length;if(0!==s){s>i&&!t.autoResize&&(s=i);var o=t._buffers;o||(o=t._buffers=this.generateBuffers(t));var a=e[0]._texture.baseTexture;this.renderer.state.setBlendMode(P(t.blendMode,a.premultiplyAlpha));var h,l,u,c,d=n.gl,p=t.worldTransform.copyTo(this.tempMatrix);p.prepend(n.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=p.toArray(!0),this.shader.uniforms.uColor=(h=t.tintRgb,l=t.worldAlpha,u=this.shader.uniforms.uColor,c=a.premultiplyAlpha,u=u||new Float32Array(4),c||void 0===c?(u[0]=h[0]*l,u[1]=h[1]*l,u[2]=h[2]*l):(u[0]=h[0],u[1]=h[1],u[2]=h[2]),u[3]=l,u),this.shader.uniforms.uSampler=a,this.renderer.shader.bind(this.shader);for(var g=!1,f=0,_=0;f<s;f+=r,_+=1){var m=s-f;m>r&&(m=r),_>=o.length&&o.push(this._generateOneMoreBuffer(t));var y=o[_];y.uploadDynamic(e,f,m);var v=t._bufferUpdateIDs[_]||0;(g=g||y._updateID<v)&&(y._updateID=t._updateID,y.uploadStatic(e,f,m)),n.geometry.bind(y.geometry),d.drawElements(d.TRIANGLES,6*m,d.UNSIGNED_SHORT,0)}}},e.prototype.generateBuffers=function(t){for(var e=[],i=t._maxSize,r=t._batchSize,n=t._properties,s=0;s<i;s+=r)e.push(new ln(this.properties,n,r));return e},e.prototype._generateOneMoreBuffer=function(t){var e=t._batchSize,i=t._properties;return new ln(this.properties,i,e)},e.prototype.uploadVertices=function(t,e,i,r,n,s){for(var o=0,a=0,h=0,l=0,u=0;u<i;++u){var c=t[e+u],d=c._texture,p=c.scale.x,g=c.scale.y,f=d.trim,_=d.orig;f?(o=(a=f.x-c.anchor.x*_.width)+f.width,h=(l=f.y-c.anchor.y*_.height)+f.height):(o=_.width*(1-c.anchor.x),a=_.width*-c.anchor.x,h=_.height*(1-c.anchor.y),l=_.height*-c.anchor.y),r[s]=a*p,r[s+1]=l*g,r[s+n]=o*p,r[s+n+1]=l*g,r[s+2*n]=o*p,r[s+2*n+1]=h*g,r[s+3*n]=a*p,r[s+3*n+1]=h*g,s+=4*n}},e.prototype.uploadPosition=function(t,e,i,r,n,s){for(var o=0;o<i;o++){var a=t[e+o].position;r[s]=a.x,r[s+1]=a.y,r[s+n]=a.x,r[s+n+1]=a.y,r[s+2*n]=a.x,r[s+2*n+1]=a.y,r[s+3*n]=a.x,r[s+3*n+1]=a.y,s+=4*n}},e.prototype.uploadRotation=function(t,e,i,r,n,s){for(var o=0;o<i;o++){var a=t[e+o].rotation;r[s]=a,r[s+n]=a,r[s+2*n]=a,r[s+3*n]=a,s+=4*n}},e.prototype.uploadUvs=function(t,e,i,r,n,s){for(var o=0;o<i;++o){var a=t[e+o]._texture._uvs;a?(r[s]=a.x0,r[s+1]=a.y0,r[s+n]=a.x1,r[s+n+1]=a.y1,r[s+2*n]=a.x2,r[s+2*n+1]=a.y2,r[s+3*n]=a.x3,r[s+3*n+1]=a.y3,s+=4*n):(r[s]=0,r[s+1]=0,r[s+n]=0,r[s+n+1]=0,r[s+2*n]=0,r[s+2*n+1]=0,r[s+3*n]=0,r[s+3*n+1]=0,s+=4*n)}},e.prototype.uploadTint=function(t,e,i,r,n,s){for(var o=0;o<i;++o){var a=t[e+o],h=a._texture.baseTexture.premultiplyAlpha,l=a.alpha,u=l<1&&h?L(a._tintRGB,l):a._tintRGB+(255*l<<24);r[s]=u,r[s+n]=u,r[s+2*n]=u,r[s+3*n]=u,s+=4*n}},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null},e}(we),pn=function(t,e,i){void 0===i&&(i=null),this.baseTexture=t,this.textures={},this.animations={},this.data=e,this.resolution=this._updateResolution(i||(this.baseTexture.resource?this.baseTexture.resource.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null},gn={BATCH_SIZE:{configurable:!0}};gn.BATCH_SIZE.get=function(){return 1e3},pn.prototype._updateResolution=function(t){var e=this.data.meta.scale,i=V(t,null);return null===i&&(i=void 0!==e?parseFloat(e):1),1!==i&&this.baseTexture.setResolution(i),i},pn.prototype.parse=function(t){this._batchIndex=0,this._callback=t,this._frameKeys.length<=pn.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()},pn.prototype._processFrames=function(t){for(var e=t,i=pn.BATCH_SIZE;e-t<i&&e<this._frameKeys.length;){var r=this._frameKeys[e],n=this._frames[r],s=n.frame;if(s){var o=null,a=null,h=!1!==n.trimmed&&n.sourceSize?n.sourceSize:n.frame,l=new gt(0,0,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution);o=n.rotated?new gt(Math.floor(s.x)/this.resolution,Math.floor(s.y)/this.resolution,Math.floor(s.h)/this.resolution,Math.floor(s.w)/this.resolution):new gt(Math.floor(s.x)/this.resolution,Math.floor(s.y)/this.resolution,Math.floor(s.w)/this.resolution,Math.floor(s.h)/this.resolution),!1!==n.trimmed&&n.spriteSourceSize&&(a=new gt(Math.floor(n.spriteSourceSize.x)/this.resolution,Math.floor(n.spriteSourceSize.y)/this.resolution,Math.floor(s.w)/this.resolution,Math.floor(s.h)/this.resolution)),this.textures[r]=new ne(this.baseTexture,o,l,a,n.rotated?2:0,n.anchor),ne.addToCache(this.textures[r],r)}e++}},pn.prototype._processAnimations=function(){var t=this.data.animations||{};for(var e in t){this.animations[e]=[];for(var i=0;i<t[e].length;i++){var r=t[e][i];this.animations[e].push(this.textures[r])}}},pn.prototype._parseComplete=function(){var t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)},pn.prototype._nextBatch=function(){var t=this;this._processFrames(this._batchIndex*pn.BATCH_SIZE),this._batchIndex++,setTimeout(function(){t._batchIndex*pn.BATCH_SIZE<t._frameKeys.length?t._nextBatch():(t._processAnimations(),t._parseComplete())},0)},pn.prototype.destroy=function(t){for(var e in void 0===t&&(t=!1),this.textures)this.textures[e].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&this.baseTexture.destroy(),this.baseTexture=null},Object.defineProperties(pn,gn);var fn=function(){};fn.use=function(t,e){var i=t.name+"_image";if(t.data&&t.type===hn.TYPE.JSON&&t.data.frames&&!this.resources[i]){var r={crossOrigin:t.crossOrigin,metadata:t.metadata.imageMetadata,parentResource:t},n=fn.getResourcePath(t,this.baseUrl);this.add(i,n,r,function(i){if(i.error)e(i.error);else{var r=new pn(i.texture.baseTexture,t.data,t.url);r.parse(function(){t.spritesheet=r,t.textures=r.textures,e()})}})}else e()},fn.getResourcePath=function(t,e){return t.isDataUrl?t.data.meta.image:c.a.resolve(t.url.replace(e,""),t.data.meta.image)};var _n=new K,mn=function(t){function e(e,i,r){void 0===i&&(i=100),void 0===r&&(r=100),t.call(this,e),this.tileTransform=new dt,this._width=i,this._height=r,this._canvasPattern=null,this.uvMatrix=e.uvMatrix||new oi(e),this.pluginName="tilingSprite",this.uvRespectAnchor=!1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={clampMargin:{configurable:!0},tileScale:{configurable:!0},tilePosition:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return i.clampMargin.get=function(){return this.uvMatrix.clampMargin},i.clampMargin.set=function(t){this.uvMatrix.clampMargin=t,this.uvMatrix.update(!0)},i.tileScale.get=function(){return this.tileTransform.scale},i.tileScale.set=function(t){this.tileTransform.scale.copyFrom(t)},i.tilePosition.get=function(){return this.tileTransform.position},i.tilePosition.set=function(t){this.tileTransform.position.copyFrom(t)},e.prototype._onTextureUpdate=function(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215},e.prototype._render=function(t){var e=this._texture;e&&e.valid&&(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))},e.prototype._calculateBounds=function(){var t=this._width*-this._anchor._x,e=this._height*-this._anchor._y,i=this._width*(1-this._anchor._x),r=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,t,e,i,r)},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new gt),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,_n);var e=this._width,i=this._height,r=-e*this.anchor._x;if(_n.x>=r&&_n.x<r+e){var n=-i*this.anchor._y;if(_n.y>=n&&_n.y<n+i)return!0}return!1},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.tileTransform=null,this.uvMatrix=null},e.from=function(t,i,r){return new e(ne.from(t),i,r)},e.fromFrame=function(t,i,r){var n=Y[t];if(!n)throw new Error('The frameId "'+t+'" does not exist in the texture cache '+this);return new e(n,i,r)},e.fromImage=function(t,i,r,n){return n&&"object"!=typeof n&&(n={scaleMode:arguments[4],resourceOptions:{crossorigin:arguments[3]}}),new e(ne.from(t,n),i,r)},i.width.get=function(){return this._width},i.width.set=function(t){this._width=t},i.height.get=function(){return this._height},i.height.set=function(t){this._height=t},Object.defineProperties(e.prototype,i),e}(yr),yn="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n",vn="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = mod(vTextureCoord - uClampOffset, vec2(1.0, 1.0)) + uClampOffset;\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 sample = texture2D(uSampler, coord);\n    gl_FragColor = sample * uColor;\n}\n",xn="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 sample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = sample * uColor;\n}\n",En=new it,wn=function(t){function e(e){t.call(this,e);var i={globals:this.renderer.globalUniforms};this.shader=Qe.from(yn,vn,i),this.simpleShader=Qe.from(yn,xn,i),this.quad=new me}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.render=function(t){var e=this.renderer,i=this.quad,r=i.vertices;r[0]=r[6]=t._width*-t.anchor.x,r[1]=r[3]=t._height*-t.anchor.y,r[2]=r[4]=t._width*(1-t.anchor.x),r[5]=r[7]=t._height*(1-t.anchor.y),t.uvRespectAnchor&&((r=i.uvs)[0]=r[6]=-t.anchor.x,r[1]=r[3]=-t.anchor.y,r[2]=r[4]=1-t.anchor.x,r[5]=r[7]=1-t.anchor.y),i.invalidate();var n=t._texture,s=n.baseTexture,o=t.tileTransform.localTransform,a=t.uvMatrix,h=s.isPowerOfTwo&&n.frame.width===s.width&&n.frame.height===s.height;h&&(s._glTextures[e.CONTEXT_UID]?h=s.wrapMode!==v:s.wrapMode===v&&(s.wrapMode=x));var l=h?this.simpleShader:this.shader,u=n.width,c=n.height,d=t._width,p=t._height;En.set(o.a*u/d,o.b*u/p,o.c*c/d,o.d*c/p,o.tx/d,o.ty/p),En.invert(),h?En.prepend(a.mapCoord):(l.uniforms.uMapCoord=a.mapCoord.toArray(!0),l.uniforms.uClampFrame=a.uClampFrame,l.uniforms.uClampOffset=a.uClampOffset),l.uniforms.uTransform=En.toArray(!0),l.uniforms.uColor=A(t.tint,t.worldAlpha,l.uniforms.uColor,s.premultiplyAlpha),l.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),l.uniforms.uSampler=n,e.shader.bind(l),e.geometry.bind(i),e.state.setBlendMode(P(t.blendMode,s.premultiplyAlpha)),e.geometry.draw(this.renderer.gl.TRIANGLES,6,0)},e}(we),bn=function(t){function e(e,i){var r=this;void 0===i&&(i={}),t.call(this),this._textWidth=0,this._textHeight=0,this._glyphs=[],this._font={tint:void 0!==i.tint?i.tint:16777215,align:i.align||"left",name:null,size:0},this.font=i.font,this._text=e,this._maxWidth=0,this._maxLineHeight=0,this._letterSpacing=0,this._anchor=new Z(function(){r.dirty=!0},this,0,0),this.dirty=!1,this.roundPixels=s.ROUND_PIXELS,this.updateText()}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={tint:{configurable:!0},align:{configurable:!0},anchor:{configurable:!0},font:{configurable:!0},text:{configurable:!0},maxWidth:{configurable:!0},maxLineHeight:{configurable:!0},textWidth:{configurable:!0},letterSpacing:{configurable:!0},textHeight:{configurable:!0}};return e.prototype.updateText=function(){for(var t=e.fonts[this._font.name],i=this._font.size/t.size,r=new K,n=[],s=[],o=this._text.replace(/(?:\r\n|\r)/g,"\n")||" ",a=o.length,h=this._maxWidth*t.size/this._font.size,l=null,u=0,c=0,d=0,p=-1,g=0,f=0,_=0,m=0;m<a;m++){var y=o.charCodeAt(m),v=o.charAt(m);if(/(?:\s)/.test(v)&&(p=m,g=u),"\r"!==v&&"\n"!==v){var x=t.chars[y];x&&(l&&x.kerning[l]&&(r.x+=x.kerning[l]),n.push({texture:x.texture,line:d,charCode:y,position:new K(r.x+x.xOffset+this._letterSpacing/2,r.y+x.yOffset)}),r.x+=x.xAdvance+this._letterSpacing,u=r.x,_=Math.max(_,x.yOffset+x.texture.height),l=y,-1!==p&&h>0&&r.x>h&&(R(n,1+p-++f,1+m-p),m=p,p=-1,s.push(g),c=Math.max(c,g),d++,r.x=0,r.y+=t.lineHeight,l=null))}else s.push(u),c=Math.max(c,u),++d,++f,r.x=0,r.y+=t.lineHeight,l=null}var E=o.charAt(o.length-1);"\r"!==E&&"\n"!==E&&(/(?:\s)/.test(E)&&(u=g),s.push(u),c=Math.max(c,u));for(var w=[],b=0;b<=d;b++){var I=0;"right"===this._font.align?I=c-s[b]:"center"===this._font.align&&(I=(c-s[b])/2),w.push(I)}for(var T=n.length,S=this.tint,C=0;C<T;C++){var N=this._glyphs[C];N?N.texture=n[C].texture:((N=new yr(n[C].texture)).roundPixels=this.roundPixels,this._glyphs.push(N)),N.position.x=(n[C].position.x+w[n[C].line])*i,N.position.y=n[C].position.y*i,N.scale.x=N.scale.y=i,N.tint=S,N.parent||this.addChild(N)}for(var O=T;O<this._glyphs.length;++O)this.removeChild(this._glyphs[O]);if(this._textWidth=c*i,this._textHeight=(r.y+t.lineHeight)*i,0!==this.anchor.x||0!==this.anchor.y)for(var P=0;P<T;P++)this._glyphs[P].x-=this._textWidth*this.anchor.x,this._glyphs[P].y-=this._textHeight*this.anchor.y;this._maxLineHeight=_*i},e.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},e.prototype.getLocalBounds=function(){return this.validate(),t.prototype.getLocalBounds.call(this)},e.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},i.tint.get=function(){return this._font.tint},i.tint.set=function(t){this._font.tint="number"==typeof t&&t>=0?t:16777215,this.dirty=!0},i.align.get=function(){return this._font.align},i.align.set=function(t){this._font.align=t||"left",this.dirty=!0},i.anchor.get=function(){return this._anchor},i.anchor.set=function(t){"number"==typeof t?this._anchor.set(t):this._anchor.copyFrom(t)},i.font.get=function(){return this._font},i.font.set=function(t){t&&("string"==typeof t?(t=t.split(" "),this._font.name=1===t.length?t[0]:t.slice(1).join(" "),this._font.size=t.length>=2?parseInt(t[0],10):e.fonts[this._font.name].size):(this._font.name=t.name,this._font.size="number"==typeof t.size?t.size:parseInt(t.size,10)),this.dirty=!0)},i.text.get=function(){return this._text},i.text.set=function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},i.maxWidth.get=function(){return this._maxWidth},i.maxWidth.set=function(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)},i.maxLineHeight.get=function(){return this.validate(),this._maxLineHeight},i.textWidth.get=function(){return this.validate(),this._textWidth},i.letterSpacing.get=function(){return this._letterSpacing},i.letterSpacing.set=function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)},i.textHeight.get=function(){return this.validate(),this._textHeight},e.registerFont=function(t,i){var r={},n=t.getElementsByTagName("info")[0],o=t.getElementsByTagName("common")[0],a=t.getElementsByTagName("page"),h=V(a[0].getAttribute("file"),s.RESOLUTION),l={};r.font=n.getAttribute("face"),r.size=parseInt(n.getAttribute("size"),10),r.lineHeight=parseInt(o.getAttribute("lineHeight"),10)/h,r.chars={},i instanceof ne&&(i=[i]);for(var u=0;u<a.length;u++){var c=a[u].getAttribute("id"),d=a[u].getAttribute("file");l[c]=i instanceof Array?i[u]:i[d]}for(var p=t.getElementsByTagName("char"),g=0;g<p.length;g++){var f=p[g],_=parseInt(f.getAttribute("id"),10),m=f.getAttribute("page")||0,y=new gt(parseInt(f.getAttribute("x"),10)/h+l[m].frame.x/h,parseInt(f.getAttribute("y"),10)/h+l[m].frame.y/h,parseInt(f.getAttribute("width"),10)/h,parseInt(f.getAttribute("height"),10)/h);r.chars[_]={xOffset:parseInt(f.getAttribute("xoffset"),10)/h,yOffset:parseInt(f.getAttribute("yoffset"),10)/h,xAdvance:parseInt(f.getAttribute("xadvance"),10)/h,kerning:{},texture:new ne(l[m].baseTexture,y),page:m}}for(var v=t.getElementsByTagName("kerning"),x=0;x<v.length;x++){var E=v[x],w=parseInt(E.getAttribute("first"),10)/h,b=parseInt(E.getAttribute("second"),10)/h,I=parseInt(E.getAttribute("amount"),10)/h;r.chars[b]&&(r.chars[b].kerning[w]=I)}return e.fonts[r.font]=r,r},Object.defineProperties(e.prototype,i),e}(It);bn.fonts={};var In=function(){};In.parse=function(t,e){t.bitmapFont=bn.registerFont(t.data,e)},In.add=function(){hn.setExtensionXhrType("fnt",hn.XHR_RESPONSE_TYPE.DOCUMENT)},In.dirname=function(t){var e=t.replace(/\/$/,"").replace(/\/[^\/]*$/,"");return e===t?".":""===e?"/":e},In.use=function(t,e){if(t.data&&t.type===hn.TYPE.XML)if(0!==t.data.getElementsByTagName("page").length&&0!==t.data.getElementsByTagName("info").length&&null!==t.data.getElementsByTagName("info")[0].getAttribute("face")){var i=t.isDataUrl?"":In.dirname(t.url);t.isDataUrl&&("."===i&&(i=""),this.baseUrl&&i&&"/"===this.baseUrl.charAt(this.baseUrl.length-1)&&(i+="/")),(i=i.replace(this.baseUrl,""))&&"/"!==i.charAt(i.length-1)&&(i+="/");for(var r=t.data.getElementsByTagName("page"),n={},s=function(i){n[i.metadata.pageFile]=i.texture,Object.keys(n).length===r.length&&(In.parse(t,n),e())},o=0;o<r.length;++o){var a=r[o].getAttribute("file"),h=i+a,l=!1;for(var u in this.resources){var c=this.resources[u];if(c.url===h){c.metadata.pageFile=a,c.texture?s(c):c.onAfterMiddleware.add(s),l=!0;break}}if(!l){var d={crossOrigin:t.crossOrigin,loadType:hn.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:a},t.metadata.imageMetadata),parentResource:t};this.add(h,d,s)}}}else e();else e()};["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n");var Tn="varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n",Sn=function(t){function e(){var e={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};t.call(this,Ni,Tn,e),this.alpha=1}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={matrix:{configurable:!0},alpha:{configurable:!0}};return e.prototype._loadMatrix=function(t,e){void 0===e&&(e=!1);var i=t;e&&(this._multiply(i,this.uniforms.m,t),i=this._colorMatrix(i)),this.uniforms.m=i},e.prototype._multiply=function(t,e,i){return t[0]=e[0]*i[0]+e[1]*i[5]+e[2]*i[10]+e[3]*i[15],t[1]=e[0]*i[1]+e[1]*i[6]+e[2]*i[11]+e[3]*i[16],t[2]=e[0]*i[2]+e[1]*i[7]+e[2]*i[12]+e[3]*i[17],t[3]=e[0]*i[3]+e[1]*i[8]+e[2]*i[13]+e[3]*i[18],t[4]=e[0]*i[4]+e[1]*i[9]+e[2]*i[14]+e[3]*i[19]+e[4],t[5]=e[5]*i[0]+e[6]*i[5]+e[7]*i[10]+e[8]*i[15],t[6]=e[5]*i[1]+e[6]*i[6]+e[7]*i[11]+e[8]*i[16],t[7]=e[5]*i[2]+e[6]*i[7]+e[7]*i[12]+e[8]*i[17],t[8]=e[5]*i[3]+e[6]*i[8]+e[7]*i[13]+e[8]*i[18],t[9]=e[5]*i[4]+e[6]*i[9]+e[7]*i[14]+e[8]*i[19]+e[9],t[10]=e[10]*i[0]+e[11]*i[5]+e[12]*i[10]+e[13]*i[15],t[11]=e[10]*i[1]+e[11]*i[6]+e[12]*i[11]+e[13]*i[16],t[12]=e[10]*i[2]+e[11]*i[7]+e[12]*i[12]+e[13]*i[17],t[13]=e[10]*i[3]+e[11]*i[8]+e[12]*i[13]+e[13]*i[18],t[14]=e[10]*i[4]+e[11]*i[9]+e[12]*i[14]+e[13]*i[19]+e[14],t[15]=e[15]*i[0]+e[16]*i[5]+e[17]*i[10]+e[18]*i[15],t[16]=e[15]*i[1]+e[16]*i[6]+e[17]*i[11]+e[18]*i[16],t[17]=e[15]*i[2]+e[16]*i[7]+e[17]*i[12]+e[18]*i[17],t[18]=e[15]*i[3]+e[16]*i[8]+e[17]*i[13]+e[18]*i[18],t[19]=e[15]*i[4]+e[16]*i[9]+e[17]*i[14]+e[18]*i[19]+e[19],t},e.prototype._colorMatrix=function(t){var e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e},e.prototype.brightness=function(t,e){var i=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(i,e)},e.prototype.greyscale=function(t,e){var i=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(i,e)},e.prototype.blackAndWhite=function(t){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],t)},e.prototype.hue=function(t,e){t=(t||0)/180*Math.PI;var i=Math.cos(t),r=Math.sin(t),n=1/3,s=(0,Math.sqrt)(n),o=[i+(1-i)*n,n*(1-i)-s*r,n*(1-i)+s*r,0,0,n*(1-i)+s*r,i+n*(1-i),n*(1-i)-s*r,0,0,n*(1-i)-s*r,n*(1-i)+s*r,i+n*(1-i),0,0,0,0,0,1,0];this._loadMatrix(o,e)},e.prototype.contrast=function(t,e){var i=(t||0)+1,r=-.5*(i-1),n=[i,0,0,0,r,0,i,0,0,r,0,0,i,0,r,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.saturate=function(t,e){void 0===t&&(t=0);var i=2*t/3+1,r=-.5*(i-1),n=[i,r,r,0,0,r,i,r,0,0,r,r,i,0,0,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.desaturate=function(){this.saturate(-1)},e.prototype.negative=function(t){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],t)},e.prototype.sepia=function(t){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],t)},e.prototype.technicolor=function(t){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],t)},e.prototype.polaroid=function(t){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],t)},e.prototype.toBGR=function(t){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],t)},e.prototype.kodachrome=function(t){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],t)},e.prototype.browni=function(t){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],t)},e.prototype.vintage=function(t){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],t)},e.prototype.colorTone=function(t,e,i,r,n){var s=((i=i||16770432)>>16&255)/255,o=(i>>8&255)/255,a=(255&i)/255,h=((r=r||3375104)>>16&255)/255,l=(r>>8&255)/255,u=(255&r)/255,c=[.3,.59,.11,0,0,s,o,a,t=t||.2,0,h,l,u,e=e||.15,0,s-h,o-l,a-u,0,0];this._loadMatrix(c,n)},e.prototype.night=function(t,e){var i=[-2*(t=t||.1),-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0];this._loadMatrix(i,e)},e.prototype.predator=function(t,e){var i=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(i,e)},e.prototype.lsd=function(t){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],t)},e.prototype.reset=function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)},i.matrix.get=function(){return this.uniforms.m},i.matrix.set=function(t){this.uniforms.m=t},i.alpha.get=function(){return this.uniforms.uAlpha},i.alpha.set=function(t){this.uniforms.uAlpha=t},Object.defineProperties(e.prototype,i),e}(ii);Sn.prototype.grayscale=Sn.prototype.greyscale;var Cn=new it;wt.prototype._cacheAsBitmap=!1,wt.prototype._cacheData=!1;var Nn=function(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalHitTest=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.sprite=null};Object.defineProperties(wt.prototype,{cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(t){var e;this._cacheAsBitmap!==t&&(this._cacheAsBitmap=t,t?(this._cacheData||(this._cacheData=new Nn),(e=this._cacheData).originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((e=this._cacheData).sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea))}}}),wt.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))},wt.prototype._initCachedDisplayObject=function(t){if(!this._cacheData||!this._cacheData.sprite){var e=this.alpha;this.alpha=1,t.batch.flush();var i=this.getLocalBounds().clone();if(this.filters){var r=this.filters[0].padding;i.pad(r)}i.ceil(s.RESOLUTION);var n=t._activeRenderTarget,o=oe.create(i.width,i.height),a="cacheAsBitmap_"+D();this._cacheData.textureCacheId=a,Ht.addToCache(o.baseTexture,a),ne.addToCache(o,a);var h=Cn;h.tx=-i.x,h.ty=-i.y,this.transform.worldTransform.identity(),this.render=this._cacheData.originalRender,t.render(this,o,!0,h,!0),t.renderTexture.bind(n),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null;var l=new yr(o);l.transform.worldTransform=this.transform.worldTransform,l.anchor.x=-i.x/i.width,l.anchor.y=-i.y/i.height,l.alpha=e,l._bounds=this._bounds,this._cacheData.sprite=l,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=l.containsPoint.bind(l)}},wt.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))},wt.prototype._initCachedDisplayObjectCanvas=function(t){if(!this._cacheData||!this._cacheData.sprite){var e=this.getLocalBounds(),i=this.alpha;this.alpha=1;var r=t.context;e.ceil(s.RESOLUTION);var n=oe.create(e.width,e.height),o="cacheAsBitmap_"+D();this._cacheData.textureCacheId=o,Ht.addToCache(n.baseTexture,o),ne.addToCache(n,o);var a=Cn;this.transform.localTransform.copyTo(a),a.invert(),a.tx-=e.x,a.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,n,!0,a,!1),t.context=r,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null;var h=new yr(n);h.transform.worldTransform=this.transform.worldTransform,h.anchor.x=-e.x/e.width,h.anchor.y=-e.y/e.height,h.alpha=i,h._bounds=this._bounds,this._cacheData.sprite=h,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=h.containsPoint.bind(h)}},wt.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._lastBoundsID=this._boundsID},wt.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds()},wt.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,Ht.removeFromCache(this._cacheData.textureCacheId),ne.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},wt.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)},wt.prototype.name=null,It.prototype.getChildByName=function(t){for(var e=0;e<this.children.length;e++)if(this.children[e].name===t)return this.children[e];return null},wt.prototype.getGlobalPosition=function(t,e){return void 0===t&&(t=new K),void 0===e&&(e=!1),this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t};var On=function(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0};On.prototype.update=function(t){if(t||this._bufferUpdateId!==this.uvBuffer._updateID||this._textureUpdateId!==this.uvMatrix._updateID){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var e=this.uvBuffer.data;this.data&&this.data.length===e.length||(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}};var Pn=new K,Ln=new vt,An=function(t){function e(e,i,r,n){void 0===n&&(n=f.TRIANGLES),t.call(this),this.geometry=e,e.refCount++,this.shader=i,this.state=r||ti.for2d(),this.drawMode=n,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=0,this._transformID=-1,this.tint=16777215,this.blendMode=g.NORMAL,this._roundPixels=s.ROUND_PIXELS,this.batchUvs=null}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={uvBuffer:{configurable:!0},verticesBuffer:{configurable:!0},material:{configurable:!0},blendMode:{configurable:!0},roundPixels:{configurable:!0},tint:{configurable:!0},texture:{configurable:!0}};return i.uvBuffer.get=function(){return this.geometry.buffers[1]},i.verticesBuffer.get=function(){return this.geometry.buffers[0]},i.material.set=function(t){this.shader=t},i.material.get=function(){return this.shader},i.blendMode.set=function(t){this.state.blendMode=t},i.blendMode.get=function(){return this.state.blendMode},i.roundPixels.set=function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},i.roundPixels.get=function(){return this._roundPixels},i.tint.get=function(){return this.shader.tint},i.tint.set=function(t){this.shader.tint=t},i.texture.get=function(){return this.shader.texture},i.texture.set=function(t){this.shader.texture=t},e.prototype._render=function(t){var i=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===f.TRIANGLES&&i.length<2*e.BATCHABLE_SIZE?this._renderToBatch(t):this._renderDefault(t)},e.prototype._renderDefault=function(t){var e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.program.uniformData.translationMatrix&&(e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0)),t.shader.bind(e),t.state.setState(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)},e.prototype._renderToBatch=function(t){var e=this.geometry;this.shader.uvMatrix&&(this.shader.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=this.shader._tintRGB,this._texture=this.shader.texture;var i=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[i]),t.plugins[i].render(this)},e.prototype.calculateVertices=function(){var t=this.geometry,e=t.buffers[0].data;if(t.vertexDirtyId!==this.vertexDirty||this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));for(var i=this.transform.worldTransform,r=i.a,n=i.b,s=i.c,o=i.d,a=i.tx,h=i.ty,l=this.vertexData,u=0;u<l.length/2;u++){var c=e[2*u],d=e[2*u+1];l[2*u]=r*c+s*d+a,l[2*u+1]=n*c+o*d+h}if(this._roundPixels)for(var p=0;p<l.length;p++)l[p]=Math.round(l[p]);this.vertexDirty=t.vertexDirtyId}},e.prototype.calculateUvs=function(){var t=this.geometry.buffers[1];this.shader.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new On(t,this.shader.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)},e.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)},e.prototype.containsPoint=function(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,Pn);for(var e=this.geometry.getBuffer("aVertexPosition").data,i=Ln.points,r=this.geometry.getIndex().data,n=r.length,s=4===this.drawMode?3:1,o=0;o+2<n;o+=s){var a=2*r[o],h=2*r[o+1],l=2*r[o+2];if(i[0]=e[a],i[1]=e[a+1],i[2]=e[h],i[3]=e[h+1],i[4]=e[l],i[5]=e[l+1],Ln.contains(Pn.x,Pn.y))return!0}return!1},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.geometry.refCount--,0===this.geometry.refCount&&this.geometry.dispose(),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null},Object.defineProperties(e.prototype,i),e}(It);An.BATCHABLE_SIZE=100;Ci.registerPlugin("accessibility",Tt),Ci.registerPlugin("extract",ki),Ci.registerPlugin("interaction",ji),Ci.registerPlugin("particle",dn),Ci.registerPlugin("prepare",Ur),Ci.registerPlugin("batch",Fi),Ci.registerPlugin("tilingSprite",wn),on.registerPlugin(In),on.registerPlugin(fn),Hr.registerPlugin(Ft),Hr.registerPlugin(an);var Rn=i(4),Mn=i(18),Dn=i.n(Mn);class Fn extends It{constructor(t){super(),this.app=t,this.scenes=new Set,this.current=void 0}get(t){return this.getChildByName(t)}add(t){let e=t.name;return null!=e&&(!this.scenes.has(e)&&(this.scenes.add(e),this.addChild(t),t.app=this.app,1==this.scenes.size&&(this.current=e),this))}delete(t){if(!this.scenes.has(t))return!1;let e=this.get(t);return!!this.removeChild(e)&&this.scenes.delete(t)}clear(){return!!this.removeChildren()&&this.scenes.clear()}getCurrentScene(){return this.get(this.current)}showScene(t){let e=this.get(t);return e.visible=!0,this.bootScene(t),e}hideScene(t){let e=this.get(t);return e.visible=!1,e}switchTo(t){return this.scenes.forEach(e=>{t!=e&&this.hideScene(e)}),this.current=t,this.showScene(t)}bootScene(t){t||(t=this.current);let e=this.get(t);if(!e)return!1;e.init&&e.init.call(e);let i=on.shared;this.app.fonts;i&&e.preload?(e.preload.call(e),i.loading?(console.log("Wait for loading..."),i.onComplete.add(()=>{console.log("All resources are loaded, lets create scene now"),e.create.call(e)})):(console.log("Nothing to load, lets create scene"),e.create.call(e))):e.create.call(e)}}var Bn=i(8),kn=i.n(Bn);const Gn=1e-6;function Un(t,e,i=Gn){return Math.abs(t-e)<i}function Yn(t,e=1){return Math.round(t/e)*e}function zn(t,e=-1/0,i=1/0){return Math.min(i,Math.max(e,t))}function Xn(t){return t*t}function qn(t){return t.length?+t.reduce((t,e)=>t+(+e||0)):0}class Hn{constructor(t=0,e=0){this.x=t,this.y=e}get normal(){return this.scale(1/this.length)}get length(){return Math.sqrt(Xn(this.x)+Xn(this.y))}get inverse(){return new Hn(-this.x,-this.y)}get flip(){return new Hn(this.y,this.x)}get perpendicular(){return new Hn(-this.y,this.x)}get array(){return[this.x,this.y]}distanceFromLine(t){return Hn.distance(this,t.project(this))}clamp(t,e,i,r){return new Hn(zn(this.x,t,e),zn(this.y,i,r))}transform(t){if(!t)return this;let e=t[0][0]*this.x+t[0][1]*this.y+t[0][2],i=t[1][0]*this.x+t[1][1]*this.y+t[1][2];return new Hn(e,i)}rotate(t,e=Vn){let i=this.x-e.x,r=this.y-e.y,n=Math.cos(t),s=Math.sin(t),o=i*n-r*s+e.x,a=i*s+r*n+e.y;return new Hn(o,a)}reflect(t){let e=t.p2.x-t.p1.x,i=t.p2.y-t.p1.y,r=this.x-t.p1.x,n=(e*(this.y-t.p1.y)-i*r)/(e*e+i*i),s=this.x+2*n*i,o=this.y-2*n*e;return new Hn(s,o)}scale(t,e=t){return new Hn(this.x*t,this.y*e)}shift(t,e=t){return new Hn(this.x+t,this.y+e)}translate(t){return this.shift(t.x,t.y)}changeCoordinates(t,e){const i=e.xMin+(this.x-t.xMin)/t.dx*e.dx,r=e.yMin+(this.y-t.yMin)/t.dy*e.dy;return new Hn(i,r)}add(t){return Hn.sum(this,t)}subtract(t){return Hn.difference(this,t)}equals(t){return Hn.equals(this,t)}round(t=1){return new Hn(Yn(this.x,t),Yn(this.y,t))}floor(){return new Hn(Math.floor(this.x),Math.floor(this.y))}mod(t,e=t){return new Hn(this.x%t,this.y%e)}static average(...t){let e=qn(t.map(t=>t.x))/t.length,i=qn(t.map(t=>t.y))/t.length;return new Hn(e,i)}static dot(t,e){return t.x*e.x+t.y*e.y}static sum(t,e){return new Hn(t.x+e.x,t.y+e.y)}static difference(t,e){return new Hn(t.x-e.x,t.y-e.y)}static distance(t,e){return Math.sqrt(Xn(t.x-e.x)+Xn(t.y-e.y))}static manhattan(t,e){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)}static interpolate(t,e,i=.5){return new Hn(t.x+i*(e.x-t.x),t.y+i*(e.y-t.y))}static interpolateList(t,e=.5){const i=t.length-1,r=Math.floor(zn(e,0,1)*i);return Hn.interpolate(t[r],t[r+1],i*e-r)}static equals(t,e){return Un(t.x,e.x)&&Un(t.y,e.y)}static fromPolar(t,e=1){return new Hn(e*Math.cos(t),e*Math.sin(t))}}const Vn=new Hn(0,0);Math.PI;new WeakMap;new Map;var jn=i(2);class Wn{constructor(){}static cleanOptionsObject(t={},e={}){const i=Object.keys(e),r=Object.keys(t).filter(t=>i.includes(t)).reduce((e,i)=>({...e,[i]:t[i]}),{});return Object.assign({},e,r)}static distanceBetween(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}static distance(t,e){let i=e.x+this._getCenter(e,e.width,"x")-(t.x+this._getCenter(t,t.width,"x")),r=e.y+this._getCenter(e,e.height,"y")-(t.y+this._getCenter(t,t.height,"y"));return Math.sqrt(i*i+r*r)}static getLocal(t){return new K(t.x,t.y)}static getLocalCenter(t){let e=new K,i=t.getLocalBounds();return e.set(i.x+i.width/2,i.y+i.height/2),e}static getWorldCenter(t){let e=this.getLocalCenter(t),i=new K;return t.toGlobal(e,i),i}static followEase(t,e,i){let r=e.x+this._getCenter(e,e.width,"x")-(t.x+this._getCenter(t,t.width,"x")),n=e.y+this._getCenter(e,e.height,"y")-(t.y+this._getCenter(t,t.height,"y"));Math.sqrt(r*r+n*n)>=1&&(t.x+=r*i,t.y+=n*i)}static followConstant(t,e,i){let r=e.x+this._getCenter(e,e.width,"x")-(t.x+this._getCenter(t,t.width,"x")),n=e.y+this._getCenter(e,e.height,"y")-(t.y+this._getCenter(t,t.height,"y")),s=Math.sqrt(r*r+n*n);s>=i&&(t.x+=r/s*i,t.y+=n/s*i)}static follow(t,e,i){let r=e.x-t.x,n=e.y-t.y,s=Math.sqrt(r*r+n*n);return s>=i&&(t.x+=r/s*i,t.y+=n/s*i),s-i<=1}static angle(t,e){return Math.atan2(e.y+this._getCenter(e,e.height,"y")-(t.y+this._getCenter(t,t.height,"y")),e.x+this._getCenter(e,e.width,"x")-(t.x+this._getCenter(t,t.width,"x")))}static getAngle(t,e){return Math.atan2(e.y-(t.y+this._getCenter(t,t.height,"y")),e.x-(t.x+this._getCenter(t,t.width,"x")))}static getPointAngle(t,e){return Math.atan2(e.y-t.y,e.x-t.x)}static _getCenter(t,e,i){return void 0!==t.anchor?0!==t.anchor[i]?0:e/2:void 0!==t.pivot&&0!==t.pivot[i]?t.pivot[i]:e/2}static rotateAroundSprite(t,e,i,r){t.x=e.x+this._getCenter(e,e.width,"x")-t.parent.x+i*Math.cos(r)-this._getCenter(t,t.width,"x"),t.y=e.y+this._getCenter(e,e.height,"y")-t.parent.y+i*Math.sin(r)-this._getCenter(t,t.height,"y")}static rotateAroundPoint(t,e,i,r,n){let s={};return s.x=t+Math.cos(n)*i,s.y=e+Math.sin(n)*r,s}static randomInt(t,e){return Math.floor(Math.random()*(e-t+1))+t}static randomFloat(t,e){return t+Math.random()*(e-t)}static wait(t,e){setTimeout(e,t)}static move(...t){if(t[0]instanceof Array){let e=t[0];if(e.length>0)for(let t=e.length-1;t>=0;t--){let i=e[t];i.x+=i.vx,i.y+=i.vy}}else t.length>1?t.forEach(t=>{t.x+=t.vx,t.y+=t.vy}):(t[0].x+=t[0].vx,t[0].y+=t[0].vy)}static worldCamera(t,e,i,r){return{width:r.width,height:r.height,_x:0,_y:0,get x(){return this._x},set x(e){this._x=e,t.x=-this._x},get y(){return this._y},set y(e){this._y=e,t.y=-this._y},get centerX(){return this.x+this.width/2},get centerY(){return this.y+this.height/2},get rightInnerBoundary(){return this.x+this.width/2+this.width/4},get leftInnerBoundary(){return this.x+this.width/2-this.width/4},get topInnerBoundary(){return this.y+this.height/2-this.height/4},get bottomInnerBoundary(){return this.y+this.height/2+this.height/4},follow:function(t){t.x<this.leftInnerBoundary&&(this.x=t.x-this.width/4),t.y<this.topInnerBoundary&&(this.y=t.y-this.height/4),t.x+t.width>this.rightInnerBoundary&&(this.x=t.x+t.width-this.width/4*3),t.y+t.height>this.bottomInnerBoundary&&(this.y=t.y+t.height-this.height/4*3),this.x<0&&(this.x=0),this.y<0&&(this.y=0),this.x+this.width>e&&(this.x=e-this.width),this.y+this.height>i&&(this.y=i-this.height)},centerOver:function(t){this.x=t.x+t.halfWidth-this.width/2,this.y=t.y+t.halfHeight-this.height/2}}}static lineOfSight(t,e,i,r=32){let n=t.x+this._getCenter(t,t.width,"x"),s=t.y+this._getCenter(t,t.height,"y"),o=e.x+this._getCenter(e,e.width,"x"),a=e.y+this._getCenter(e,e.height,"y"),h=o-n,l=a-s,u=Math.sqrt(h*h+l*l),c=u/r;return(()=>{let t=[];for(let e=1;e<=c;e++){let i=r*e,o=n+h/u*i,a=s+l/u*i;t.push({x:o,y:a})}return t})().every(t=>i.every(e=>!((t,e)=>{let i=t.x>e.x,r=t.x<e.x+e.width,n=t.y>e.y,s=t.y<e.y+e.height;return i&&r&&n&&s})(t,e)))}static linesIntersect(...t){let[e,i,r,n,s,o,a,h]=t,l=new jn.geom.LineSegment(new jn.geom.Coordinate(e,i),new jn.geom.Coordinate(r,n)),u=new jn.geom.LineSegment(new jn.geom.Coordinate(s,o),new jn.geom.Coordinate(a,h));return l.intersection(u)}static unique(){return`f${(~~(1e8*Math.random())).toString(16)}`}static range(t=1,e=0){return[...Array(t).keys()].map(t=>t+e)}static flatToCoords(t=[],e="xy"){return t.reduce((t,i,r,n)=>(r%e.length==0&&t.push(Array.from(e).reduce((t,e,i)=>Object.assign(t,{[e]:n[r+i]}),{})),t),[])}static atoc(t=[],e="xy"){return t.reduce((t,i,r,n)=>(r%e.length==0&&t.push(Array.from(e).reduce((t,e,i)=>Object.assign(t,{[e]:n[r+i]}),{})),t),[])}static perfTest(t,e=1,i){if("function"!=typeof i)return!1;let r={n:e,name:t};return performance.mark(r.name),Wn.range(r.n).forEach(()=>i()),performance.measure(`${r.name} measure`,r.name),r.result=performance.getEntriesByName(`${r.name} measure`)[0],r}static sumPerf(t){return performance.getEntriesByName(t).reduce((t,e)=>t+e.duration,0)}}class Kn{static get Circle(){return kn.a.Circle}static get Rectangle(){return kn.a.Rectangle}static getShapeCenter(t){return Wn.getWorldCenter(t)}static getShapeTransform(t){return t.worldTransform.decompose(new dt)}static getShapeRotation(t){return this.getShapeTransform(t).rotation}static updateIntersectShape(t){let e=this.getShapeCenter(t),i={};t.shape instanceof this.Rectangle?t.Body?(e=this.getShapeCenter(t.Body),i={square:t.Body.width,center:e,noRotate:!0}):i={center:e,rotation:this.getShapeTransform(t)}:t.shape instanceof this.Circle&&(i={positionObject:e}),t.shape.set(i)}static updateShape(...t){t.forEach(t=>this.updateIntersectShape(t))}}var Zn=i(0);class Jn extends It{constructor(){super()}moveTo(t,e=1){this.x,this.y;Wn.follow(this,t,e)}rotateTo(t){this.rotation=Zn.normalize(t)}rotateBy(t){this.rotation+=t,Math.abs(this.rotation)>Zn.PI_2&&(this.rotation=Zn.normalize(this.rotation))}followTo(t,e){e||(e=this.getSpeed()/vs.target);let i=Zn.PI_2/vs.target,r=Wn.getPointAngle(this,t),n=Zn.differenceAngles(r,this.rotation),s=Zn.differenceAnglesSign(r,this.rotation);return n>5*_s?n>=i?this.rotateBy(s*i):this.rotateTo(r):this.moveTo(t,e),this}easeRotateTo(t){let e=Zn.PI_2/vs.target,i=Zn.differenceAngles(t,this.rotation),r=Zn.differenceAnglesSign(t,this.rotation);return i>5*_s&&(i>=e?this.rotateBy(r*e):this.rotateTo(t)),this}getAngleTo(t){}}class Qn{constructor(t){this.unit=t,this.actions=[]}analyse(){let t=this.unit,{enemy:e,friend:i}=t.sensor.getClosest(),r=e&&e.distance>=xs.unit.size;i&&(i.distance,xs.unit.size);return e?r?t.sensor.inLOS(e.unit)?{action:"followTo",params:[e.unit,t.getSpeed()/vs.target]}:{action:"getPathTo",params:[e.unit]}:{action:"pierce",params:[e.unit]}:{action:"returnToSpawnPoint"}}chooseAction(){let t=this.unit,e=t.getClosest(),i=e.enemy.distance>=xs.unit.size,r=e.friend,n=r&&r.distance>=xs.unit.size+32;if(!r)return i?{action:"followTo",params:[e.enemy.unit,t.getSpeed()/vs.target]}:void 0;if(i&&n)return{action:"followTo",params:[e.enemy.unit,t.getSpeed()/vs.target]};if(i&&!n){let i=[];return t.scene.fighters.forEach(e=>{e!=t&&i.push(e)}),Wn.lineOfSight(t,e.enemy.unit,i,xs.unit.size)?{action:"followTo",params:[e.enemy.unit,t.getSpeed()/vs.target]}:{action:"backwardStep",params:[r.unit,t.getSpeed()/vs.target]}}}}var $n={red:16711680,green:65280,blue:255,black:0,white:16777215,yellow:16776960,breeze:65535,pink:16711935,brown:6636321,sea:11259375,fedcba:16702650,monokai:1193046,metal:10066329,purple:6684774};class ts extends Jn{constructor(t,e={}){super(),this.app=void 0,this.name=t}init(){console.log("Init Scene...")}preload(){}create(){}update(){console.log("Updating...")}drawChild(t,e=new K(0,0)){this.addChild(t),t.scene=this,t.setTransform(e.x,e.y)}static createEllipse(t,e,i,r,n){let s=new fr;return s.clear(),s.beginFill(n),s.drawEllipse(t,e,i,r),s.endFill(),s}static createLine(t=new K(0,0),e=new K(10,0),i=$n.black,r=1){let n=new fr;return n.clear(),n.lineStyle(r,i),n.moveTo(t.x,t.y),n.lineTo(e.x,e.y),n}drawPath(t,e=$n.black,i=1,...r){if(t.pathHelper||(t.pathHelper=new fr,t.pathHelper.name="PathHelper"),!r.length)return this;t.pathHelper.clear(),t.pathHelper.lineStyle(i,e);for(let e=0;e<r.length-1;e++){let i=r[e],n=r[e+1];t.pathHelper.moveTo(i.x,i.y),t.pathHelper.lineTo(n.x,n.y)}return this.addChild(t.pathHelper),this}removePath(t){return t.pathHelper&&t.pathHelper.destroy(),this}static createShape(t,e){let i=new fr;return i.beginFill(e),i.drawShape(t),i.endFill(),i}drawBounds(t,e=$n.red){t.boundsHelper||(t.boundsHelper=new fr,t.boundsHelper.name="BoundsHelper",this.addChild(t.boundsHelper)),t.boundsHelper.clear(),t.boundsHelper.lineStyle(1,e),t.toGlobal(new K(t.x,t.y));let i=t.getLocalBounds(),r=t.worldTransform.decompose(new dt);return t.boundsHelper.drawShape(i),t.boundsHelper.setTransform(r.position.x,r.position.y,r.scale.x,r.scale.y,r.rotation,r.skew.x,r.skew.y,r.pivot.x,r.pivot.y),this}removeBounds(t){return t.boundsHelper&&t.boundsHelper.destroy(),this}drawCoords(t=64){this.coordHelper=new fr,this.coordHelper.name="CoordHelper",this.addChild(this.coordHelper),this.coordHelper.clear(),this.coordHelper.lineStyle(1,$n.red);let e=0;for(;e<=this.app.screen.width;)this.coordHelper.moveTo(e,0),this.coordHelper.lineTo(e,this.app.screen.height),e+=t;let i=0;for(;i<=this.app.screen.height;)this.coordHelper.moveTo(0,i),this.coordHelper.lineTo(this.app.screen.width,i),i+=t;return this}removeCoords(){return this.coordHelper&&this.coordHelper.destroy(),this}drawLOS(t,e,i=$n.black,r=1){if(t.losHelper||(t.losHelper=new Map),t.losHelper.has(e))return this;let n=t.sensor.getLOS(e),s=ts.createLine(n.start,n.end,i,r);return s.target=e,s.name="LOSHelper",t.losHelper.set(e,s),this.addChild(s),this}removeLOS(t,e){if(!t.losHelper)return this;let i=t.losHelper.get(e);t.losHelper.delete(e),i.destroy()}}class es{constructor(t){this.unit=t}getLOS(t){return{start:this.unit.getCenter(),end:t.getCenter()}}inLOS(t){return this.unit.scene.map.InLineOfSight({x:this.x,y:this.y},{x:t.x,y:t.y})}getClosest(){let t={enemy:void 0,friend:void 0};for(let e of this.unit.scene.fighters){if(e==this.unit||e.isDied())continue;let i=Wn.distance(this.unit,e);e.party!=this.unit.party?(!t.enemy||t.enemy.distance>i)&&(t.enemy={unit:e,distance:i}):(!t.friend||t.friend.distance>i)&&(t.friend={unit:e,distance:i})}return t}}class is{constructor(...t){this.vertices=t.length?t:[]}addPoint(t,e){let i={x:t,y:e};return this.vertices.push(i),i}pointInside(t,e=!0){performance.mark("pointInside()");let i=!1;if(this.vertices.length<3)return performance.measure("pointInside","pointInside()"),!1;let r=this.vertices[this.vertices.length-1],n=this.DistanceSquared(r.x,r.y,t.x,t.y);return this.vertices.forEach(s=>{let o,a,h=s,l=this.DistanceSquared(h.x,h.y,t.x,t.y);if(n+l+2*Math.sqrt(n*l)-this.DistanceSquared(h.x,h.y,r.x,r.y)<.5)return performance.measure("pointInside","pointInside()"),e;h.x>r.x?(o=r,a=h):(o=h,a=r),o.x<t.x&&t.x<=a.x&&(t.y-o.y)*(a.x-o.x)<(a.y-o.y)*(t.x-o.x)&&(i=!i),r=h,n=l}),performance.measure("pointInside","pointInside()"),i}DistanceSquared(t,e,i,r){return(t-i)*(t-i)+(e-r)*(e-r)}distanceToSegmentSquared(t,e,i,r,n,s){let o=this.DistanceSquared(i,r,n,s);if(0==o)return this.DistanceSquared(t,e,i,r);let a=((t-i)*(n-i)+(e-r)*(s-r))/o;return a<0?this.DistanceSquared(t,e,i,r):a>1?this.DistanceSquared(t,e,n,s):this.DistanceSquared(t,e,i+a*(n-i),r+a*(s-r))}distanceToSegment(t,e,i,r,n,s){return Math.sqrt(this.distanceToSegmentSquared(t,e,i,r,n,s))}getClosestPointOnEdge(t){let e=t.x,i=t.y,r=-1,n=-1,s=1e5;for(let t of Wn.range(this.vertices.length)){let o=this.distanceToSegment(e,i,this.vertices[t].x,this.vertices[t].y,this.vertices[(t+1)%this.vertices.length].x,this.vertices[(t+1)%this.vertices.length].y);o<s&&(s=o,r=t,n=(t+1)%this.vertices.length)}let o,a=this.vertices[r],h=this.vertices[n],l=a.x,u=a.y,c=h.x,d=h.y,p=((t.x-l)*(c-l)+(t.y-u)*(d-u))/((c-l)*(c-l)+(d-u)*(d-u));return o=p<0?{x:l,y:u}:p>1?{x:c,y:d}:{x:l+p*(c-l),y:u+p*(d-u)}}}class rs{constructor(t,e,i=1){this.from=t,this.to=e,this.cost=i}clone(){return new rs(this.from,this.to,this.cost)}}class ns{constructor(){this.nodes=[],this.edges=[]}clone(){let t=new ns;for(let e of Wn.range(this.nodes.length))t.nodes[e]=this.nodes[e].clone();for(let e of Wn.range(this.edges.length)){t.edges[e]=[];for(let i of this.edges[e])t.edges[e].push(i.clone())}return t}getEdge(t,e){let i=this.edges[t];for(let t of i)if(t.to==e)return t;return null}addNode(t){return this.nodes.push(t),this.edges.push(new Array),0}addEdge(t){null==this.getEdge(t.from,t.to)&&this.edges[t.from].push(t),null==this.getEdge(t.to,t.from)&&this.edges[t.to].push(new rs(t.to,t.from,t.cost))}}class ss{constructor(t){this.pos=t}clone(){return new ss({x:this.pos.x,y:this.pos.y})}}class os{constructor(t=[]){this.keys=t,this.data=[]}insert(t){this.data[this.data.length]=t,this.reorderUp()}pop(){let t=this.data[0];return this.data[0]=this.data[this.data.length-1],this.data.pop(),this.reorderDown(),t}reorderUp(){let t=this.data.length-1;for(;t>0;){if(!(this.keys[this.data[t]]<this.keys[this.data[t-1]]))return;{let e=this.data[t];this.data[t]=this.data[t-1],this.data[t-1]=e}t--}}reorderDown(){for(let t of Wn.range(this.data.length)){if(!(this.keys[this.data[t]]>this.keys[this.data[t+1]]))return;{let e=this.data[t];this.data[t]=this.data[t+1],this.data[t+1]=e}}}isEmpty(){return 0==this.data.length}}class as{constructor(t,e,i){this.graph=t,this.source=e,this.target=i,this.SPT=[],this.G_Cost=[],this.F_Cost=[],this.SF=[];for(let e of Wn.range(t.nodes.length))this.G_Cost[e]=0,this.F_Cost[e]=0;this.search()}search(){let t=new os(this.F_Cost);for(t.insert(this.source);!t.isEmpty();){let e=t.pop();if(this.SPT[e]=this.SF[e],e==this.target)return;let i=this.graph.edges[e];for(let r of i){let i=Wn.distanceBetween(this.graph.nodes[r.to].pos,this.graph.nodes[this.target].pos),n=this.G_Cost[e]+r.cost;r.to;null==this.SF[r.to]?(this.F_Cost[r.to]=n+i,this.G_Cost[r.to]=n,t.insert(r.to),this.SF[r.to]=r):n<this.G_Cost[r.to]&&null==this.SPT[r.to]&&(this.F_Cost[r.to]=n+i,this.G_Cost[r.to]=n,t.reorderUp(),this.SF[r.to]=r)}}}getPath(){let t=new Array;if(this.target<0)return t;let e=this.target;for(t.push(e);e!=this.source&&null!=this.SPT[e];)e=this.SPT[e].from,t.push(e);return t.reverse(),t}}class hs{constructor(t=0,e=0){this.mainwalkgraph=new ns,this.calculatedpath=[],this.vertices_concave=[],this.polygons=[],this.walkgraph=void 0,this.targetx=void 0,this.targety=void 0,this.startNodeIndex=0,this.endNodeIndex=0,t&&e&&this.setMainPolygon(t,e)}setMainPolygon(t,e){return this.polygons[0]=new is(...Wn.atoc([0,0,t,0,t,e,0,e])),this}Distance(t,e){return Wn.distanceBetween(t,e)}InLineOfSight(t,e){performance.mark("InLineOfSight()");if(performance.mark("checkInMainPoly()"),performance.measure("checkInMainPoly","checkInMainPoly()"),performance.mark("checkInTooClose()"),this.Distance(t,e)<.5)return performance.measure("checkInTooClose","checkInTooClose()"),performance.measure("InLineOfSight","InLineOfSight()"),!0;performance.measure("checkInTooClose","checkInTooClose()"),performance.mark("checkEdgesForCross()");for(let i of this.polygons)for(let r of Wn.range(i.vertices.length)){let n=i.vertices[r],s=i.vertices[(r+1)%i.vertices.length];if(this.LineSegmentsCross(t,e,n,s))return!1}performance.measure("checkEdgesForCross","checkEdgesForCross()"),performance.mark("checkMiddlePointInside()");let i={x:(t.x+e.x)/2,y:(t.y+e.y)/2},r=this.polygons[0].pointInside(i);for(let t of this.polygons)t!=this.polygons[0]&&t.pointInside(i,!1)&&(r=!1);return performance.measure("checkMiddlePointInside","checkMiddlePointInside()"),performance.measure("InLineOfSight","InLineOfSight()"),r}createGraph(){performance.mark("createGraph()"),this.mainwalkgraph=new ns;let t=!0;this.vertices_concave=[],performance.mark("vertexCollect()");for(let e of this.polygons){if(null!=e&&null!=e.vertices&&e.vertices.length>2)for(let i of Wn.range(e.vertices.length))if(this.IsVertexConcave(e.vertices,i)==t){this.vertices_concave.length;this.vertices_concave.push(e.vertices[i]),this.mainwalkgraph.addNode(new ss({x:e.vertices[i].x,y:e.vertices[i].y}))}t=!1}performance.measure("vertexCollect","vertexCollect()"),performance.mark("selfCrossing()"),this.vertices_concave.forEach((t,e)=>{this.vertices_concave.forEach((i,r)=>{this.InLineOfSight(t,i)&&this.mainwalkgraph.addEdge(new rs(e,r,this.Distance(t,i)))})}),performance.measure("selfCrossing","selfCrossing()"),performance.measure("createGraph","createGraph()")}LineSegmentsCross(t,e,i,r){performance.mark("LineSegmentsCross()");let n=(e.x-t.x)*(r.y-i.y)-(e.y-t.y)*(r.x-i.x);if(0==n)return performance.measure("LineSegmentsCross","LineSegmentsCross()"),!1;let s=(t.y-i.y)*(r.x-i.x)-(t.x-i.x)*(r.y-i.y),o=(t.y-i.y)*(e.x-t.x)-(t.x-i.x)*(e.y-t.y);if(0==s||0==o)return performance.measure("LineSegmentsCross","LineSegmentsCross()"),!1;let a=s/n,h=o/n;return performance.measure("LineSegmentsCross","LineSegmentsCross()"),a>0&&a<1&&h>0&&h<1}IsVertexConcave(t,e){let i=t[e],r=t[(e+1)%t.length],n=t[0==e?t.length-1:e-1],s=i.x-n.x,o=i.y-n.y,a=r.x-i.x;return s*(r.y-i.y)-o*a<0}calculatePath(t,e){performance.mark("calculatePath()"),this.walkgraph=this.mainwalkgraph.clone();this.startNodeIndex=this.walkgraph.nodes.length,this.targetx=e.x,this.targety=e.y;let i=new ss({x:t.x,y:t.y}),r={x:i.pos.x,y:i.pos.y};this.walkgraph.addNode(i),this.vertices_concave.forEach((t,e)=>{this.InLineOfSight(r,t)&&this.walkgraph.addEdge(new rs(this.startNodeIndex,e,this.Distance(r,t)))}),this.endNodeIndex=this.walkgraph.nodes.length;let n=new ss({x:e.x,y:e.y}),s={x:n.pos.x,y:n.pos.y};this.walkgraph.addNode(n),this.vertices_concave.forEach((t,e)=>{this.InLineOfSight(s,t)&&this.walkgraph.addEdge(new rs(this.endNodeIndex,e,this.Distance(s,t)))}),this.InLineOfSight(r,s)&&this.walkgraph.addEdge(new rs(this.startNodeIndex,this.endNodeIndex,this.Distance(r,s))),performance.mark("AstarAlgorithm()");let o=new as(this.walkgraph,this.startNodeIndex,this.endNodeIndex);return this.calculatedpath=o.getPath(),performance.measure("AstarAlgorithm","AstarAlgorithm()"),performance.measure("calculatePath","calculatePath()"),this.calculatedpath}getPathNodes(t){return t||(t=this.calculatedpath),t.reduce((t,e)=>[...t,this.walkgraph.nodes[e].pos],[])}}class ls extends fr{moveTo(t,e){return Wn.follow(this,e)}}class us extends ls{constructor(t={name:Es.body.name,attrs:Es.body.attrs,model:Es.body.model}){super();let{name:e=Es.body.name,attrs:i=Es.body.attrs,model:r=Es.body.model}=t;this.name=e,this.attrs=Wn.cleanOptionsObject(i,Es.body.attrs),this.initModel(r)}initModel(t=Es.body.model){let e=Wn.cleanOptionsObject(t,Es.body.model),i=e.size*xs.unit.size,r=[],n=ts.createShape(new yt(0,0,i/2,i/2),e.color);n.name="Body",r.push(n),this.addChild(...r),this.pivot.x+=.5*i,this.pivot.y+=.5*i,this.shape=new Kn.Circle(this)}getBody(){return this.getChildByName("Body")}getWidth(){return this.width}}class cs extends ls{constructor(t={name:Es.helmet.name,attrs:Es.helmet.attrs,model:Es.helmet.model}){super();let{name:e=Es.helmet.name,attrs:i=Es.helmet.attrs,model:r=Es.helmet.model}=t;this.name=e,this.attrs=Wn.cleanOptionsObject(i,Es.helmet.attrs),this.initModel(r)}initModel(t=Es.helmet.model){let e=Wn.cleanOptionsObject(t,Es.helmet.model),i=e.size*xs.unit.size/2,r=[],n=ts.createShape(new yt(0,0,i/2,i/2),e.color);n.name="Helmet",r.push(n),this.addChild(...r),this.pivot.x+=.5*i,this.pivot.y+=.5*i,this.shape=new Kn.Circle(this)}getModel(){return this.getChildByName("Helmet")}}class ds extends It{constructor(t={name:Es.weapon.name,attrs:Es.weapon.attrs,model:Es.weapon.model}){super();let{name:e=Es.weapon.name,attrs:i=Es.weapon.attrs,model:r=Es.weapon.model}=t;this.name=e,this.attrs=Wn.cleanOptionsObject(t,Es.weapon.attrs),this.initModel(r),this.piercing=!1,this.collider=!1}initModel(t=Es.weapon.model){let e,i=Wn.cleanOptionsObject(t,Es.weapon.model),r=i.size*xs.unit.size,n=[];if(i.texture&&i.texture.baseTexture){let t=i.texture.baseTexture.resource,s=Ht.from(t);s.setSize(r,t.height*r/t.width);let o=new ne(s);(e=yr.from(o)).name="Blade",n.push(e)}else{(e=ts.createShape(new gt(0,0,r,3),i.color)).name="Blade";let t=ts.createShape(new gt(r/4,-4.5,3,9),i.color);t.name="Guard",n.push(t),n.push(e)}this.addChild(...n),this.shape=new Kn.Rectangle(this)}getModel(){return this.getChildByName("Blade")}getLength(){return this.width}pierce(t,e=300){if(this.piercing)return;let i=this.width;const r=new Rn.Tween(this).to({x:i},e).repeat(1).easing(Rn.Easing.Linear.None).yoyo(!0).on("complete",()=>{this.piercing=!1,this.collider=!1}).start();this.piercing=r}}class ps extends Jn{constructor(t={name:Es.shield.name,attrs:Es.shield.attrs,model:Es.shield.model}){super();let{name:e=Es.shield.name,attrs:i=Es.shield.attrs,model:r=Es.shield.model}=t;this.name=e,this.attrs=Wn.cleanOptionsObject(i,Es.shield.attrs),this.initModel(r)}initModel(t=Es.shield.model){let e,i=Wn.cleanOptionsObject(t,Es.shield.model),r=i.size*xs.unit.size,n=[];if(i.texture&&i.texture.baseTexture){let t=i.texture.baseTexture.resource,s=Ht.from(t);s.setSize(r,t.height*r/t.width*.4);let o=new ne(s);(e=yr.from(o)).anchor.set(.5),e.pivot.x=.5*e.width,e.pivot.y=.5*e.height,e.rotation=Math.PI,e.name="Plate",n.push(e)}else(e=ts.createShape(new gt(0,0,r,7),i.color)).name="Plate",n.push(e);this.addChild(...n),this.pivot.x+=.5*e.width,this.pivot.y+=.5*e.height,this.shape=new Kn.Rectangle(this)}getModel(){return this.getChildByName("Plate")}}class gs extends Jn{constructor(t=Es.unit){super();let{name:e=Es.unit.name,spec:i=Es.unit.spec,attrs:r=Es.unit.attrs,skills:n=Es.unit.skills,equipment:s=Es.unit.equipment,model:o=Es.unit.model}=t;this.name=e,this.spec=i,this.division=void 0,this.party=void 0,this.init(),this.initAttrs(r),this.initSkills(n),this.initEquipment(s),this.initModel(o)}init(){this._righthand=void 0,this._lefthand=void 0,this.tactic=new Qn(this),this.sensor=new es(this)}initAttrs(t=Es.unit.attrs){this.attrs=Wn.cleanOptionsObject(t,Es.unit.attrs),null==this.attrs.hp&&(this.attrs.hp=this.getFullHp()),null==this.attrs.mp&&(this.attrs.mp=this.getFullMp())}initSkills(t=Es.unit.skills){this.skills=Wn.cleanOptionsObject(t,Es.unit.skills)}initEquipment(t=Es.unit.equipment){this.equipment=Wn.cleanOptionsObject(t,Es.unit.equipment)}initModel(t=Es.unit.model){let e=Wn.cleanOptionsObject(t,Es.unit.model),i=e.size/2,r=[],n=new us({model:{color:e.colors.armor}});n.setTransform(0,0),r.push(n);let s=new cs({model:{color:e.colors.helmet}});s.setTransform(0,0),r.push(s);let o=new ds({model:{color:e.colors.weapon,texture:e.textures.weapon}});o.x=0,o.y=e.size/2,this.rightHand=o,r.push(o);let a=i,h={x:a*Math.sin(45),y:-a*Math.cos(45)},l=new ps({model:{color:e.colors.shield,texture:e.textures.shield}});l.x=h.x,l.y=h.y,l.angle=45,this.leftHand=l,r.push(l),this.addChild(...r),this.pivot.x+=e.size/2,this.pivot.y+=e.size/2,this.shape=new Kn.Rectangle(this)}get rightHand(){return this._righthand}set rightHand(t){this._righthand=t}get leftHand(){return this._lefthand}set leftHand(t){this._lefthand=t}isReady(){return this.ready}get Body(){return this.getChildByName("Body")}get Helmet(){return this.getChildByName("Helmet")}get Weapon(){return this.getChildByName("Weapon")}get Shield(){return this.getChildByName("Shield")}hitHp(t){if(t.attrs.immortal)return;let e=this.calcHpDamage()-this.calcHpDefend();t.attrs.hp-=e,console.log(`${this.name} hitted ${t.name} with ${e} damage`),t.isDied()&&console.log(`${t.name} killed!`)}getFullHp(){return 10*this.attrs.lvl}isDied(){return this.attrs.hp<=0}getFullMp(){return 10*this.attrs.lvl}calcHpDamage(){return this.attrs.attack}calcHpDefend(){return this.attrs.defend}getSpeed(){let t=this.attrs.speed*xs.unit.size;return t+t*this.skills.agility/10}getWeaponSpeed(){return(this.skills.agility+1)/10/2}getWeaponTargetAngle(t){let e=Wn.getLocal(t),i=this.Weapon,r=Wn.getLocal(i),n=i.toGlobal(r);return Wn.getPointAngle(n,e)}getClosest(){return this.sensor.getClosest()}backwardStep(t,e){e||(e=this.getSpeed()/FPS.target);let i=new K(this.x-Math.sign(t.x-this.x)*e,this.y-Math.sign(t.y-this.y)*e);return this.followTo(i,e)}getClosestFriend(){let t=void 0;for(let e of this.party.units){if(e==this)continue;let i=Wn.distance(this,e);(!t||t.distance>i)&&(t={unit:e,distance:i})}return t}getCenter(){return Kn.getShapeCenter(this.Body)}getLOS(t,e=Colors.black,i=1){let r=this.sensor.getLOS(t),n=ts.createLine(r.start,r.end,e,i);return n.target=t,n}getPathTo(t){return this.scene.getMap(),this.scene.map.calculatePath(this.getCenter(),t.getCenter()),this.scene.map.getPathNodes()}}class fs extends gs{}const _s=Math.PI/180,ms={SPECIALIZATION:{INFANTRY:"infantry",ARCHERS:"archers",CAVALRY:"cavalry",SKIRMISHERS:"skirmishers",ARTILLERY:"artillery",SUPPORT:"support",GUARDS:"guards",HQ:"hq"},TYPE:{HERO:fs,UNIT:gs},PARTY:{HERO:"Heroes",ENEMY:"Enemies"}},ys={width:640,height:512,autoStart:!1,backgroundColor:$n.breeze},vs={min:10,max:60,target:60},xs={title:"CastleDef",version:"0.0.1-pixi",unit:{size:64}},Es={unit:{name:"John Doe",spec:ms.SPECIALIZATION.INFANTRY,attrs:{immortal:!1,lvl:0,hp:void 0,mp:void 0,attack:0,defend:0,speed:1},skills:{strength:0,agility:0,intellect:0},equipment:{head:void 0,hands:{right:void 0,left:void 0},fingers:void 0,foots:void 0,neck:void 0,legs:void 0,body:void 0,arms:void 0},model:{size:xs.unit.size,colors:{armor:$n.green,helmet:$n.black,weapon:$n.metal,shield:$n.brown},textures:{armor:void 0,helmet:void 0,weapon:void 0,shield:void 0}}},body:{name:"Body",attrs:{defend:0},model:{size:1,color:$n.green,texture:void 0}},helmet:{name:"Helmet",attrs:{defend:0},model:{size:1,color:$n.black,texture:void 0}},weapon:{name:"Weapon",attrs:{damage:1},model:{size:1,color:$n.metal,texture:void 0}},shield:{name:"Shield",attrs:{defend:1},model:{size:.75,color:$n.brown,texture:void 0}},crate:{name:"Crate",attrs:{defend:1e3},model:{size:1,color:$n.brown,texture:void 0}},party:{name:"Bandits",faction:"Bandits",color:$n.red}},ws={google:{families:["Press Start 2P:latin,cyrillic"]}};var bs=i(19),Is=i.n(bs),Ts=i(20),Ss=i.n(Ts),Cs=i(21),Ns=i.n(Cs),Os=i(22),Ps=i.n(Os),Ls=i(23),As=i.n(Ls),Rs=i(24),Ms=i.n(Rs),Ds=i(25),Fs=i.n(Ds);const Bs={Sword:Is.a,SimpleBow:Ss.a,SimpleArrow:Ns.a,Shield:Ps.a,RoundShield:As.a,Crate:Ms.a,Grass:Fs.a};i(40);class ks extends ts{constructor(t,e={}){super(t,e)}init(){}preload(){this.resourceLoadingProgress=0,console.log("SceneLoad preload()"),this.preloadWebfonts()}preloadWebfonts(){let t=this.app.fonts,e=Object.assign(ws,{active:()=>{this.fontsLoaded=!0,this.preloadResources()}});t.load(e)}preloadResources(){let t=on.shared;const e={};for(let e in Bs)t.add(e,Bs[e]);t.load((t,i)=>{for(let t in i){let r=i[t].name;e[r]=i[t].texture}Object.assign(this.app.textures,e)}),t.onProgress.add(t=>{})}create(){console.log("SceneLoad create()"),this.progressbar()}update(){this.resourceLoadingProgress+=.5,this.progressbar(this.resourceLoadingProgress),this.resourceLoadingProgress>=100&&(console.log("Switching to MainScene"),this.app.stage.switchTo("MainScene"))}progressbar(t=0){if(!this.progressBar){let e=new It;e.name="Progressbar";let i=.6*this.app.screen.width,r=40,n=10,s=new xt(0,0,i,r,n),o=new xt(0,0,1,r,n),a=ts.createShape(s,$n.brown);a.name="Background";let h=ts.createShape(o,$n.green);h.name="Progress";let l=new Pr(`${t}%`,{fontFamily:"Press Start 2P",fontWeight:400,fontSize:r/2,lineHeight:r/2,fill:$n.black,align:"center"});l.name="Text",l.anchor.set(.5),e.addChild(a,h,l),this.addChild(e),h.visible=!1,e.x=(this.app.screen.width-i)/2,e.y=this.app.screen.height/2-r/2,l.y=r/2,l.x=i/2,this.progressBar=e,this.lastProgress=t}if(t!=this.lastProgress&&t<=100){let e=this.progressBar.getChildByName("Progress"),i=this.progressBar.width*t/100,r=this.progressBar.height,n=new xt(0,0,i,r,10);if(e.clear(),e.beginFill($n.green),e.drawShape(n),e.endFill(),e.visible=!0,t%10==0){let e=this.progressBar.getChildByName("Text");e.text=`${t}%`,e.visible=!0}this.lastProgress=t}}}class Gs{constructor(t){this.type=t,this.units=new Set}addUnit(t){this.units.add(t),t.division=this.type}removeUnit(t){this.units.delete(t),t.division=void 0}getSize(){return this.units.size}getType(){return this.type}getBaseBattlePotential(){let t=0;for(let e of this.units)t+=e.attrs.lvl;return t}}class Us{constructor(t=Es.party,e,i=new Set){let r=Wn.cleanOptionsObject(t,Es.party);Object.assign(this,r);let n={};for(let t in ms.SPECIALIZATION){let e=ms.SPECIALIZATION[t];n[e]=new Gs(e)}this.divisions=n,this.units=new Set,e&&this.setLeader(e),this.addUnits(i)}setLeader(t){return this.leader=t,!!this.hireUnit(t,ms.SPECIALIZATION.HQ)&&this}addUnits(t=new Set){if(t.size)for(let e of t)this.hireUnit(e);return this}getPartySize(){return this.units.size}hireUnit(t,e){if(!(t instanceof gs))return!1;return this.units.add(t)&&(t.party=this,this.setUnitDivision(t)),this}disbandUnit(t){return!(t instanceof fs)&&(this.units.delete(t),t.party=void 0,this.divisions[t.division].removeUnit(t),!0)}setUnitDivision(t,e){if(!(t instanceof gs))return!1;e||(e=t.spec);for(let i in this.divisions){let r=this.divisions[i];r.type==e&&r.addUnit(t)}}}class Ys{constructor(t){this.scene=t,this.parties=new Map}get(t){return this.parties.get(t)}add(t){let e=t.name;return null!=e&&(!this.parties.has(e)&&(this.parties.set(e,t),this))}delete(t){return this.parties.delete(t)}clear(){return this.parties.clear()}}class zs extends Set{constructor(...t){super(...t)}get(t){return super.get(t)}add(t){return super.add(t)}delete(t){return super.delete(t)}clear(){return super.clear()}}class Xs extends zs{constructor(t){super(),this.scene=t}add(t){return super.add(t),this.scene.registry.add(t),this}delete(t){return this.scene.registry.delete(t),super.delete(t)}clear(){for(let t of this)this.scene.registry.delete(t);return super.clear()}}class qs extends zs{constructor(t){super(),this.scene=t}}class Hs extends Jn{constructor(t={name:Es.crate.name,attrs:Es.crate.attrs,model:Es.crate.model}){super();let{name:e=Es.crate.name,attrs:i=Es.crate.attrs,model:r=Es.crate.model}=t;this.name=e,this.attrs=Wn.cleanOptionsObject(i,Es.crate.attrs),this.initModel(r)}initModel(t=Es.crate.model){let e,i=Wn.cleanOptionsObject(t,Es.crate.model),r=i.size*xs.unit.size,n=r,s=[];if(i.texture&&i.texture.baseTexture){let t=i.texture.baseTexture.resource,o=Ht.from(t);o.setSize(r,n);let a=new ne(o);(e=yr.from(a)).x-=r/2,e.y-=n/2,e.name="Crate",s.push(e)}else(e=ts.createShape(new gt(0,0,r,n),i.color)).name="Crate",s.push(e);this.addChild(...s),this.pivot.x+=0,this.pivot.y+=0,this.shape=new Kn.Rectangle(this)}getModel(){return this.getChildByName("Crate")}}class Vs extends ts{constructor(t,e={}){super(t,e)}init(){this.initGameObjects()}preload(){}create(){let t=new mn(this.app.textures.Grass,this.app.screen.width,this.app.screen.height);this.addChild(t),this.drawCoords(32);let e=new Us({name:"Heroes",faction:"Good"}),i=new Us({name:"Enemies",faction:"Evil"});this.party.add(e).add(i);let r=this.getUnitSettingsByTemplate(ms.TYPE.HERO,{name:"John Wick"}),n=this.createUnit(r,ms.TYPE.HERO,ms.PARTY.HERO,new K(128,128));this.drawBounds(n),r=this.getUnitSettingsByTemplate(ms.TYPE.HERO,{name:"Baba Yaga",model:{colors:{armor:$n.monokai}}});let s=this.createUnit(r,ms.TYPE.HERO,ms.PARTY.HERO,new K(n.spawnPoint.x+160,n.spawnPoint.y+256));this.drawBounds(s);let o=this.getUnitSettingsByTemplate(ms.TYPE.UNIT,{name:"Bad Guy"}),a=this.createUnit(o,ms.TYPE.UNIT,ms.PARTY.ENEMY,new K(n.spawnPoint.x+256,n.spawnPoint.y+32));a.angle=-135,this.drawBounds(a),this.party.get(ms.PARTY.HERO).setLeader(n);Wn.flatToCoords([192,128,320,160]).forEach((t,e)=>{let i=new Hs({name:`Crate #${e}`,model:{texture:this.app.textures.Crate}});this.drawChild(i,t),this.registry.add(i)}),Kn.updateShape(...this.registry.values()),this.drawLOS(n,a,$n.green,1).drawLOS(n,s,$n.green,1).drawLOS(s,a,$n.green,1);let h=[],l=Wn.perfTest("create map and calculate path",10,()=>{h=n.getPathTo(a)});console.log(`${l.name} in ${l.result.duration/l.n}ms (${l.result.duration}ms for ${l.n} tests)`),this.drawPath(n,$n.pink,16,...h);console.table(["checkInMainPoly","checkInTooClose","checkMiddlePointInside","checkEdgesForCross","InLineOfSight","selfCrossing","vertexCollect","createGraph","calculatePath","AstarAlgorithm","pointInside","LineSegmentsCross"].reduce((t,e)=>[...t,[e,Wn.sumPerf(e)/l.n]],[]))}update(){this.fighters.forEach(t=>{if(t.isDied())return;this.drawBounds(t.Shield,$n.metal).drawBounds(t.Weapon,$n.pink);let e=t.getClosest();this.drawLOS(t,e.enemy.unit,$n.green,1),this.registry.forEach(t=>this.drawBounds(t))})}seekAndDestroy(t){let e=t.getClosest();if(t instanceof fs&&!e.enemy)return t.Body.alpha=1,t.Shield.alpha=1,void t.followTo(t.spawnPoint);t instanceof fs&&e.enemy.distance<=2.5*t.Weapon.getLength()&&(t.easeRotateTo(t.getWeaponTargetAngle(e.enemy.unit)),t.Weapon.pierce(e.enemy.unit)),this.clash(t,e)}getFighterIntersects(t,e){let i={weapon:t.Weapon},r={shield:e.Shield,body:e.Body};for(let t in i)Kn.updateIntersectShape(i[t]);for(let t in r)Kn.updateIntersectShape(r[t]);return{weapon2shield:i.weapon.shape.collidesRectangle(r.shield.shape),weapon2body:i.weapon.shape.collidesCircle(r.body.shape)}}clash(t,e){let i=e.enemy.unit,r=this.getFighterIntersects(t,i),n=!1;r.weapon2shield?(i.Shield.alpha=.2,n=!0):i.Shield.alpha=1,r.weapon2body?(i.Body.alpha=.2,n=!0):i.Body.alpha=1;let s=[];if(r.weapon2shield&&s.push("shield"),r.weapon2body&&s.push("body"),n&&r.weapon2body){if(t.Weapon.collider)return;if(t.Weapon.collider=!0,t.hitHp(i),i.isDied())return setTimeout(()=>{this.removeBounds(i).removeBounds(i.Weapon).removeBounds(i.Shield),i.party.disbandUnit(i),this.fighters.delete(i),i.destroy()},1e3),void setTimeout(()=>{let t={name:"Bad Guy",attrs:{lvl:10,attack:5},model:{textures:{weapon:this.app.textures.Sword,shield:this.app.textures.RoundShield}}};this.createUnit(t,ms.TYPE.UNIT,ms.PARTY.ENEMY,new K(Wn.randomInt(256,this.app.screen.width-32),Wn.randomInt(32,this.app.screen.height-32)))},5e3)}let o=t.tactic.chooseAction();o&&("followTo"!=o.action||t.followTo(...o.params))}initGameObjects(){this.party=new Ys(this),this.fighters=new Xs(this),this.registry=new qs(this)}initMap(){return this.map=new hs(this.app.screen.width,this.app.screen.height),[...this.registry].filter(t=>!(t instanceof gs)).forEach(t=>this.map.polygons.push(new is(...Wn.atoc(t.shape.vertices)))),this.map.createGraph(),this.map}getMap(t=!1){return this.map&&!t||this.initMap(),this.map}createUnit(t,e=ms.TYPE.UNIT,i=ms.PARTY.ENEMY,r=new K(0,0)){let n=new e(t);return n.spawnPoint=r,this.drawChild(n,n.spawnPoint),this.fighters.add(n),this.party.get(i).hireUnit(n),n}getUnitSettingsByTemplate(t,e){let i;switch(t){case ms.TYPE.HERO:i={name:"Some Hero",attrs:{lvl:10,attack:10,immortal:!0},model:{colors:{armor:$n.purple},textures:{weapon:this.app.textures.Sword,shield:this.app.textures.Shield}}};break;default:i={name:"Bad Guy",attrs:{lvl:10,attack:5},model:{textures:{weapon:this.app.textures.Sword,shield:this.app.textures.RoundShield}}}}return Object.assign({},i,e)}}class js extends Hr{constructor(t){super(t),document.body.appendChild(this.view),this.stage=new Fn(this),this.fonts=Dn.a,this.stop()}init(){this.textures={},this.initScenes(),this.ticker.add(t=>{Rn.update(),this.stage.getCurrentScene().update()})}initScenes(){let t=new ks("LoadScene");this.stage.add(t);let e=new Vs("MainScene");this.stage.add(e),this.stage.switchTo("LoadScene")}}new class{constructor(t){this.app=new js(t),document.body.appendChild(this.app.view),this.app.stop()}startGame(){this.app.init(),this.app.start()}stopGame(){this.app.stop()}}(ys).startGame()}]);